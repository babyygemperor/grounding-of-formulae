<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Tree-Structured Attention with Hierarchical Accumulation</title>
<!--Generated on Wed Sep 15 18:23:07 2021 by LaTeXML (version 0.8.5) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Tree-Structured Attention with Hierarchical Accumulation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xuan-Phi Nguyen<math id="id1.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="id1.1.m1.1a"><msup id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml"><mi id="id1.1.m1.1.1a" xref="id1.1.m1.1.1.cmml"/><mo id="id1.1.m1.1.1.1" xref="id1.1.m1.1.1.1.cmml">‡</mo></msup></semantics></math> , Shafiq Joty<math id="id2.2.m2.1" class="ltx_Math" alttext="{}^{\dagger\ddagger}" display="inline"><semantics id="id2.2.m2.1a"><msup id="id2.2.m2.1.1" xref="id2.2.m2.1.1.cmml"><mi id="id2.2.m2.1.1a" xref="id2.2.m2.1.1.cmml"/><mrow id="id2.2.m2.1.1.1" xref="id2.2.m2.1.1.1.cmml"><mi id="id2.2.m2.1.1.1.2" xref="id2.2.m2.1.1.1.2.cmml"/><mo id="id2.2.m2.1.1.1.1" xref="id2.2.m2.1.1.1.1.cmml">†</mo><mo id="id2.2.m2.1.1.1.3" xref="id2.2.m2.1.1.1.3.cmml">‡</mo></mrow></msup></semantics></math>, Steven C.H. Hoi<math id="id3.3.m3.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="id3.3.m3.1a"><msup id="id3.3.m3.1.1" xref="id3.3.m3.1.1.cmml"><mi id="id3.3.m3.1.1a" xref="id3.3.m3.1.1.cmml"/><mo id="id3.3.m3.1.1.1" xref="id3.3.m3.1.1.1.cmml">†</mo></msup></semantics></math>, Richard Socher<math id="id4.4.m4.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="id4.4.m4.1a"><msup id="id4.4.m4.1.1" xref="id4.4.m4.1.1.cmml"><mi id="id4.4.m4.1.1a" xref="id4.4.m4.1.1.cmml"/><mo id="id4.4.m4.1.1.1" xref="id4.4.m4.1.1.1.cmml">†</mo></msup></semantics></math> 
<br class="ltx_break"/><math id="id5.5.m5.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="id5.5.m5.1a"><msup id="id5.5.m5.1.1" xref="id5.5.m5.1.1.cmml"><mi id="id5.5.m5.1.1a" xref="id5.5.m5.1.1.cmml"/><mo id="id5.5.m5.1.1.1" xref="id5.5.m5.1.1.1.cmml">†</mo></msup></semantics></math>Salesforce Research
<br class="ltx_break"/><math id="id6.6.m6.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="id6.6.m6.1a"><msup id="id6.6.m6.1.1" xref="id6.6.m6.1.1.cmml"><mi id="id6.6.m6.1.1a" xref="id6.6.m6.1.1.cmml"/><mo id="id6.6.m6.1.1.1" xref="id6.6.m6.1.1.1.cmml">‡</mo></msup></semantics></math>Nanyang Technological University
<br class="ltx_break"/>nguyenxu002@e.ntu.edu.sg,{sjoty,shoi,rsocher}@salesforce.com

</span><span class="ltx_author_notes"><span>Work done during an internship at Salesforce Research Asia, Singapore.</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id8.id1" class="ltx_p"><span class="gd_word" id="id8.id1.1.w1">Incorporating</span><span> </span><span class="gd_word" id="id8.id1.1.w2">hierarchical</span><span> </span><span class="gd_word" id="id8.id1.1.w3">structures</span><span> </span><span class="gd_word" id="id8.id1.1.w4">like</span><span> </span><span class="gd_word" id="id8.id1.1.w5">constituency</span><span> </span><span class="gd_word" id="id8.id1.1.w6">trees</span><span> </span><span class="gd_word" id="id8.id1.1.w7">has</span><span> </span><span class="gd_word" id="id8.id1.1.w8">been</span><span> </span><span class="gd_word" id="id8.id1.1.w9">shown</span><span> </span><span class="gd_word" id="id8.id1.1.w10">to</span><span> </span><span class="gd_word" id="id8.id1.1.w11">be</span><span> </span><span class="gd_word" id="id8.id1.1.w12">effective</span><span> </span><span class="gd_word" id="id8.id1.1.w13">for</span><span> </span><span class="gd_word" id="id8.id1.1.w14">various</span><span> </span><span class="gd_word" id="id8.id1.1.w15">natural</span><span> </span><span class="gd_word" id="id8.id1.1.w16">language</span><span> </span><span class="gd_word" id="id8.id1.1.w17">processing</span><span> </span><span class="gd_word" id="id8.id1.1.w18">(NLP)</span><span> </span><span class="gd_word" id="id8.id1.1.w19">tasks.</span><span> </span><span class="gd_word" id="id8.id1.1.w20">However,</span><span> </span><span class="gd_word" id="id8.id1.1.w21">it</span><span> </span><span class="gd_word" id="id8.id1.1.w22">is</span><span> </span><span class="gd_word" id="id8.id1.1.w23">evident</span><span> </span><span class="gd_word" id="id8.id1.1.w24">that</span><span> </span><span class="gd_word" id="id8.id1.1.w25">state-of-the-art</span><span> </span><span class="gd_word" id="id8.id1.1.w26">(SOTA)</span><span> </span><span class="gd_word" id="id8.id1.1.w27">sequence-based</span><span> </span><span class="gd_word" id="id8.id1.1.w28">models</span><span> </span><span class="gd_word" id="id8.id1.1.w29">like</span><span> </span><span class="gd_word" id="id8.id1.1.w30">the</span><span> </span><span class="gd_word" id="id8.id1.1.w31">Transformer</span><span> </span><span class="gd_word" id="id8.id1.1.w32">struggle</span><span> </span><span class="gd_word" id="id8.id1.1.w33">to</span><span> </span><span class="gd_word" id="id8.id1.1.w34">encode</span><span> </span><span class="gd_word" id="id8.id1.1.w35">such</span><span> </span><span class="gd_word" id="id8.id1.1.w36">structures</span><span> </span><span class="gd_word" id="id8.id1.1.w37">inherently.</span><span> </span><span class="gd_word" id="id8.id1.1.w38">On</span><span> </span><span class="gd_word" id="id8.id1.1.w39">the</span><span> </span><span class="gd_word" id="id8.id1.1.w40">other</span><span> </span><span class="gd_word" id="id8.id1.1.w41">hand,</span><span> </span><span class="gd_word" id="id8.id1.1.w42">dedicated</span><span> </span><span class="gd_word" id="id8.id1.1.w43">models</span><span> </span><span class="gd_word" id="id8.id1.1.w44">like</span><span> </span><span class="gd_word" id="id8.id1.1.w45">the</span><span> </span><span class="gd_word" id="id8.id1.1.w46">Tree-LSTM,</span><span> </span><span class="gd_word" id="id8.id1.1.w47">while</span><span> </span><span class="gd_word" id="id8.id1.1.w48">explicitly</span><span> </span><span class="gd_word" id="id8.id1.1.w49">modeling</span><span> </span><span class="gd_word" id="id8.id1.1.w50">hierarchical</span><span> </span><span class="gd_word" id="id8.id1.1.w51">structures,</span><span> </span><span class="gd_word" id="id8.id1.1.w52">do</span><span> </span><span class="gd_word" id="id8.id1.1.w53">not</span><span> </span><span class="gd_word" id="id8.id1.1.w54">perform</span><span> </span><span class="gd_word" id="id8.id1.1.w55">as</span><span> </span><span class="gd_word" id="id8.id1.1.w56">efficiently</span><span> </span><span class="gd_word" id="id8.id1.1.w57">as</span><span> </span><span class="gd_word" id="id8.id1.1.w58">the</span><span> </span><span class="gd_word" id="id8.id1.1.w59">Transformer.</span><span> </span><span class="gd_word" id="id8.id1.1.w60">In</span><span> </span><span class="gd_word" id="id8.id1.1.w61">this</span><span> </span><span class="gd_word" id="id8.id1.1.w62">paper,</span><span> </span><span class="gd_word" id="id8.id1.1.w63">we</span><span> </span><span class="gd_word" id="id8.id1.1.w64">attempt</span><span> </span><span class="gd_word" id="id8.id1.1.w65">to</span><span> </span><span class="gd_word" id="id8.id1.1.w66">bridge</span><span> </span><span class="gd_word" id="id8.id1.1.w67">this</span><span> </span><span class="gd_word" id="id8.id1.1.w68">gap</span><span> </span><span class="gd_word" id="id8.id1.1.w69">with</span><span> </span><span class="gd_word" id="id8.id1.1.w70">“Hierarchical</span><span> </span><span class="gd_word" id="id8.id1.1.w71">Accumulation”</span><span> </span><span class="gd_word" id="id8.id1.1.w72">to</span><span> </span><span class="gd_word" id="id8.id1.1.w73">encode</span><span> </span><span class="gd_word" id="id8.id1.1.w74">parse</span><span> </span><span class="gd_word" id="id8.id1.1.w75">tree</span><span> </span><span class="gd_word" id="id8.id1.1.w76">structures</span><span> </span><span class="gd_word" id="id8.id1.1.w77">into</span><span> </span><span class="gd_word" id="id8.id1.1.w78">self-attention</span><span> </span><span class="gd_word" id="id8.id1.1.w79">at</span><span> </span><span class="gd_word" id="id8.id1.1.w80">constant</span><span> </span><span class="gd_word" id="id8.id1.1.w81">time</span><span> </span><span class="gd_word" id="id8.id1.1.w82">complexity.</span><span> </span><span class="gd_word" id="id8.id1.1.w83">Our</span><span> </span><span class="gd_word" id="id8.id1.1.w84">approach</span><span> </span><span class="gd_word" id="id8.id1.1.w85">outperforms</span><span> </span><span class="gd_word" id="id8.id1.1.w86">SOTA</span><span> </span><span class="gd_word" id="id8.id1.1.w87">methods</span><span> </span><span class="gd_word" id="id8.id1.1.w88">in</span><span> </span><span class="gd_word" id="id8.id1.1.w89">four</span><span> </span><span class="gd_word" id="id8.id1.1.w90">IWSLT</span><span> </span><span class="gd_word" id="id8.id1.1.w91">translation</span><span> </span><span class="gd_word" id="id8.id1.1.w92">tasks</span><span> </span><span class="gd_word" id="id8.id1.1.w93">and</span><span> </span><span class="gd_word" id="id8.id1.1.w94">the</span><span> </span><span class="gd_word" id="id8.id1.1.w95">WMT’14</span><span> </span><span class="gd_word" id="id8.id1.1.w96">English-German</span><span> </span><span class="gd_word" id="id8.id1.1.w97">translation</span><span> </span><span class="gd_word" id="id8.id1.1.w98">task.</span><span> </span><span class="gd_word" id="id8.id1.1.w99">It</span><span> </span><span class="gd_word" id="id8.id1.1.w100">also</span><span> </span><span class="gd_word" id="id8.id1.1.w101">yields</span><span> </span><span class="gd_word" id="id8.id1.1.w102">improvements</span><span> </span><span class="gd_word" id="id8.id1.1.w103">over</span><span> </span><span class="gd_word" id="id8.id1.1.w104">Transformer</span><span> </span><span class="gd_word" id="id8.id1.1.w105">and</span><span> </span><span class="gd_word" id="id8.id1.1.w106">Tree-LSTM</span><span> </span><span class="gd_word" id="id8.id1.1.w107">on</span><span> </span><span class="gd_word" id="id8.id1.1.w108">three</span><span> </span><span class="gd_word" id="id8.id1.1.w109">text</span><span> </span><span class="gd_word" id="id8.id1.1.w110">classification</span><span> </span><span class="gd_word" id="id8.id1.1.w111">tasks.</span><span> </span><span class="gd_word" id="id8.id1.1.w112">We</span><span> </span><span class="gd_word" id="id8.id1.1.w113">further</span><span> </span><span class="gd_word" id="id8.id1.1.w114">demonstrate</span><span> </span><span class="gd_word" id="id8.id1.1.w115">that</span><span> </span><span class="gd_word" id="id8.id1.1.w116">using</span><span> </span><span class="gd_word" id="id8.id1.1.w117">hierarchical</span><span> </span><span class="gd_word" id="id8.id1.1.w118">priors</span><span> </span><span class="gd_word" id="id8.id1.1.w119">can</span><span> </span><span class="gd_word" id="id8.id1.1.w120">compensate</span><span> </span><span class="gd_word" id="id8.id1.1.w121">for</span><span> </span><span class="gd_word" id="id8.id1.1.w122">data</span><span> </span><span class="gd_word" id="id8.id1.1.w123">shortage,</span><span> </span><span class="gd_word" id="id8.id1.1.w124">and</span><span> </span><span class="gd_word" id="id8.id1.1.w125">that</span><span> </span><span class="gd_word" id="id8.id1.1.w126">our</span><span> </span><span class="gd_word" id="id8.id1.1.w127">model</span><span> </span><span class="gd_word" id="id8.id1.1.w128">prefers</span><span> </span><span class="gd_word" id="id8.id1.1.w129">phrase-level</span><span> </span><span class="gd_word" id="id8.id1.1.w130">attentions</span><span> </span><span class="gd_word" id="id8.id1.1.w131">over</span><span> </span><span class="gd_word" id="id8.id1.1.w132">token-level</span><span> </span><span class="gd_word" id="id8.id1.1.w133">attentions.</span></p>
</div>
<span id="id1" class="ltx_ERROR undefined">\pgfplotsset</span>
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p"><span class="gd_word" id="p1.1.1.w1">compat=1.14
</span><span id="p1.1.1" class="ltx_ERROR undefined">\usetikzlibrary</span><span class="gd_word" id="p1.1.2.w1">positioning,arrows,trees,shapes,fit





</span></p>
</div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p ltx_align_bottom"><span class="gd_word" id="p2.1.1.w1">Tree-Structured</span><span> </span><span class="gd_word" id="p2.1.1.w2">Attention</span><span> </span><span class="gd_word" id="p2.1.1.w3">with</span><span> </span><span class="gd_word" id="p2.1.1.w4">Hierarchical</span><span> </span><span class="gd_word" id="p2.1.1.w5">Accumulation</span></p>
</div>
<div id="p3" class="ltx_para">
<table id="p3.6" class="ltx_tabular ltx_guessed_headers ltx_align_top">
<thead class="ltx_thead">
<tr id="p3.4.4" class="ltx_tr">
<th id="p3.4.4.4" class="ltx_td ltx_align_left ltx_th ltx_th_column">
<span class="ltx_rule" style="width:0.0pt;height:24.0pt;background:black;display:inline-block;"/>Xuan-Phi Nguyen<math id="p3.1.1.1.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="p3.1.1.1.1.m1.1a"><msup id="p3.1.1.1.1.m1.1.1" xref="p3.1.1.1.1.m1.1.1.cmml"><mi id="p3.1.1.1.1.m1.1.1a" xref="p3.1.1.1.1.m1.1.1.cmml"/><mo mathvariant="normal" id="p3.1.1.1.1.m1.1.1.1" xref="p3.1.1.1.1.m1.1.1.1.cmml">‡</mo></msup></semantics></math><span id="p3.4.4.4.4.1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span><span class="gd_word" id="p3.4.4.4.4.1.3.w1">Work</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w2">done</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w3">during</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w4">an</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w5">internship</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w6">at</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w7">Salesforce</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w8">Research</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w9">Asia,</span><span> </span><span class="gd_word" id="p3.4.4.4.4.1.3.w10">Singapore.</span></span></span></span> , Shafiq Joty<math id="p3.2.2.2.2.m2.1" class="ltx_Math" alttext="{}^{\dagger\ddagger}" display="inline"><semantics id="p3.2.2.2.2.m2.1a"><msup id="p3.2.2.2.2.m2.1.1" xref="p3.2.2.2.2.m2.1.1.cmml"><mi id="p3.2.2.2.2.m2.1.1a" xref="p3.2.2.2.2.m2.1.1.cmml"/><mrow id="p3.2.2.2.2.m2.1.1.1" xref="p3.2.2.2.2.m2.1.1.1.cmml"><mi id="p3.2.2.2.2.m2.1.1.1.2" xref="p3.2.2.2.2.m2.1.1.1.2.cmml"/><mo mathvariant="normal" id="p3.2.2.2.2.m2.1.1.1.1" xref="p3.2.2.2.2.m2.1.1.1.1.cmml">†</mo><mo mathvariant="normal" id="p3.2.2.2.2.m2.1.1.1.3" xref="p3.2.2.2.2.m2.1.1.1.3.cmml">‡</mo></mrow></msup></semantics></math>, Steven C.H. Hoi<math id="p3.3.3.3.3.m3.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="p3.3.3.3.3.m3.1a"><msup id="p3.3.3.3.3.m3.1.1" xref="p3.3.3.3.3.m3.1.1.cmml"><mi id="p3.3.3.3.3.m3.1.1a" xref="p3.3.3.3.3.m3.1.1.cmml"/><mo mathvariant="normal" id="p3.3.3.3.3.m3.1.1.1" xref="p3.3.3.3.3.m3.1.1.1.cmml">†</mo></msup></semantics></math>, Richard Socher<math id="p3.4.4.4.4.m4.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="p3.4.4.4.4.m4.1a"><msup id="p3.4.4.4.4.m4.1.1" xref="p3.4.4.4.4.m4.1.1.cmml"><mi id="p3.4.4.4.4.m4.1.1a" xref="p3.4.4.4.4.m4.1.1.cmml"/><mo mathvariant="normal" id="p3.4.4.4.4.m4.1.1.1" xref="p3.4.4.4.4.m4.1.1.1.cmml">†</mo></msup></semantics></math>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="p3.5.5" class="ltx_tr">
<td id="p3.5.5.1" class="ltx_td ltx_align_left">
<math id="p3.5.5.1.m1.1" class="ltx_Math" alttext="{}^{\dagger}" display="inline"><semantics id="p3.5.5.1.m1.1a"><msup id="p3.5.5.1.m1.1.1" xref="p3.5.5.1.m1.1.1.cmml"><mi id="p3.5.5.1.m1.1.1a" xref="p3.5.5.1.m1.1.1.cmml"/><mo id="p3.5.5.1.m1.1.1.1" xref="p3.5.5.1.m1.1.1.1.cmml">†</mo></msup></semantics></math>Salesforce Research</td>
</tr>
<tr id="p3.6.6" class="ltx_tr">
<td id="p3.6.6.1" class="ltx_td ltx_align_left">
<math id="p3.6.6.1.m1.1" class="ltx_Math" alttext="{}^{\ddagger}" display="inline"><semantics id="p3.6.6.1.m1.1a"><msup id="p3.6.6.1.m1.1.1" xref="p3.6.6.1.m1.1.1.cmml"><mi id="p3.6.6.1.m1.1.1a" xref="p3.6.6.1.m1.1.1.cmml"/><mo id="p3.6.6.1.m1.1.1.1" xref="p3.6.6.1.m1.1.1.1.cmml">‡</mo></msup></semantics></math>Nanyang Technological University</td>
</tr>
<tr id="p3.6.7.1" class="ltx_tr">
<td id="p3.6.7.1.1" class="ltx_td ltx_align_left">nguyenxu002@e.ntu.edu.sg,{sjoty,shoi,rsocher}@salesforce.com</td>
</tr>
</tbody>
</table>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para ltx_noindent">
<p id="S1.p1.1" class="ltx_p"><span class="gd_word" id="S1.p1.1.1.w1">Although</span><span> </span><span class="gd_word" id="S1.p1.1.1.w2">natural</span><span> </span><span class="gd_word" id="S1.p1.1.1.w3">language</span><span> </span><span class="gd_word" id="S1.p1.1.1.w4">has</span><span> </span><span class="gd_word" id="S1.p1.1.1.w5">a</span><span> </span><span class="gd_word" id="S1.p1.1.1.w6">linear</span><span> </span><span class="gd_word" id="S1.p1.1.1.w7">surface</span><span> </span><span class="gd_word" id="S1.p1.1.1.w8">form,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w9">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w10">underlying</span><span> </span><span class="gd_word" id="S1.p1.1.1.w11">construction</span><span> </span><span class="gd_word" id="S1.p1.1.1.w12">process</span><span> </span><span class="gd_word" id="S1.p1.1.1.w13">is</span><span> </span><span class="gd_word" id="S1.p1.1.1.w14">known</span><span> </span><span class="gd_word" id="S1.p1.1.1.w15">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w16">be</span><span> </span><span class="gd_word" id="S1.p1.1.1.w17">hierarchical</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Frege, <a href="#bib.bib4" title="" class="ltx_ref">1892</a>)</cite><span class="gd_word" id="S1.p1.1.2.w1">.</span><span> </span><span class="gd_word" id="S1.p1.1.2.w2">As</span><span> </span><span class="gd_word" id="S1.p1.1.2.w3">such,</span><span> </span><span class="gd_word" id="S1.p1.1.2.w4">different</span><span> </span><span class="gd_word" id="S1.p1.1.2.w5">tree-like</span><span> </span><span class="gd_word" id="S1.p1.1.2.w6">structures</span><span> </span><span class="gd_word" id="S1.p1.1.2.w7">have</span><span> </span><span class="gd_word" id="S1.p1.1.2.w8">been</span><span> </span><span class="gd_word" id="S1.p1.1.2.w9">proposed</span><span> </span><span class="gd_word" id="S1.p1.1.2.w10">to</span><span> </span><span class="gd_word" id="S1.p1.1.2.w11">represent</span><span> </span><span class="gd_word" id="S1.p1.1.2.w12">the</span><span> </span><span class="gd_word" id="S1.p1.1.2.w13">compositional</span><span> </span><span class="gd_word" id="S1.p1.1.2.w14">grammar</span><span> </span><span class="gd_word" id="S1.p1.1.2.w15">and</span><span> </span><span class="gd_word" id="S1.p1.1.2.w16">meaning</span><span> </span><span class="gd_word" id="S1.p1.1.2.w17">of</span><span> </span><span class="gd_word" id="S1.p1.1.2.w18">a</span><span> </span><span class="gd_word" id="S1.p1.1.2.w19">text,</span><span> </span><span class="gd_word" id="S1.p1.1.2.w20">such</span><span> </span><span class="gd_word" id="S1.p1.1.2.w21">as</span><span> </span><span class="gd_word" id="S1.p1.1.2.w22">constituency</span><span> </span><span class="gd_word" id="S1.p1.1.2.w23">and</span><span> </span><span class="gd_word" id="S1.p1.1.2.w24">dependency</span><span> </span><span class="gd_word" id="S1.p1.1.2.w25">trees.</span><span> </span><span class="gd_word" id="S1.p1.1.2.w26">Leveraging</span><span> </span><span class="gd_word" id="S1.p1.1.2.w27">the</span><span> </span><span class="gd_word" id="S1.p1.1.2.w28">hierarchical</span><span> </span><span class="gd_word" id="S1.p1.1.2.w29">structures</span><span> </span><span class="gd_word" id="S1.p1.1.2.w30">of</span><span> </span><span class="gd_word" id="S1.p1.1.2.w31">language</span><span> </span><span class="gd_word" id="S1.p1.1.2.w32">gives</span><span> </span><span class="gd_word" id="S1.p1.1.2.w33">models</span><span> </span><span class="gd_word" id="S1.p1.1.2.w34">more</span><span> </span><span class="gd_word" id="S1.p1.1.2.w35">structural</span><span> </span><span class="gd_word" id="S1.p1.1.2.w36">information</span><span> </span><span class="gd_word" id="S1.p1.1.2.w37">about</span><span> </span><span class="gd_word" id="S1.p1.1.2.w38">the</span><span> </span><span class="gd_word" id="S1.p1.1.2.w39">data</span><span> </span><span class="gd_word" id="S1.p1.1.2.w40">and</span><span> </span><span class="gd_word" id="S1.p1.1.2.w41">improves</span><span> </span><span class="gd_word" id="S1.p1.1.2.w42">performance</span><span> </span><span class="gd_word" id="S1.p1.1.2.w43">on</span><span> </span><span class="gd_word" id="S1.p1.1.2.w44">the</span><span> </span><span class="gd_word" id="S1.p1.1.2.w45">downstream</span><span> </span><span class="gd_word" id="S1.p1.1.2.w46">tasks</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Tai et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>; Eriguchi et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>)</cite><span class="gd_word" id="S1.p1.1.3.w1">.</span><span> </span><span class="gd_word" id="S1.p1.1.3.w2">Despite</span><span> </span><span class="gd_word" id="S1.p1.1.3.w3">that,</span><span> </span><span class="gd_word" id="S1.p1.1.3.w4">state-of-the-art</span><span> </span><span class="gd_word" id="S1.p1.1.3.w5">neural</span><span> </span><span class="gd_word" id="S1.p1.1.3.w6">models</span><span> </span><span class="gd_word" id="S1.p1.1.3.w7">like</span><span> </span><span class="gd_word" id="S1.p1.1.3.w8">the</span><span> </span><span class="gd_word" id="S1.p1.1.3.w9">Transformer</span><span> </span><span class="gd_word" id="S1.p1.1.3.w10">still</span><span> </span><span class="gd_word" id="S1.p1.1.3.w11">prefer</span><span> </span><span class="gd_word" id="S1.p1.1.3.w12">the</span><span> </span><span class="gd_word" id="S1.p1.1.3.w13">linear</span><span> </span><span class="gd_word" id="S1.p1.1.3.w14">(sequential)</span><span> </span><span class="gd_word" id="S1.p1.1.3.w15">form</span><span> </span><span class="gd_word" id="S1.p1.1.3.w16">of</span><span> </span><span class="gd_word" id="S1.p1.1.3.w17">natural</span><span> </span><span class="gd_word" id="S1.p1.1.3.w18">language</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Ott et al., <a href="#bib.bib14" title="" class="ltx_ref">2018</a>; Devlin et al., <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S1.p1.1.4.w1">.</span><span> </span><span class="gd_word" id="S1.p1.1.4.w2">This</span><span> </span><span class="gd_word" id="S1.p1.1.4.w3">is</span><span> </span><span class="gd_word" id="S1.p1.1.4.w4">because</span><span> </span><span class="gd_word" id="S1.p1.1.4.w5">the</span><span> </span><span class="gd_word" id="S1.p1.1.4.w6">linear</span><span> </span><span class="gd_word" id="S1.p1.1.4.w7">form</span><span> </span><span class="gd_word" id="S1.p1.1.4.w8">allows</span><span> </span><span class="gd_word" id="S1.p1.1.4.w9">us</span><span> </span><span class="gd_word" id="S1.p1.1.4.w10">to</span><span> </span><span class="gd_word" id="S1.p1.1.4.w11">develop</span><span> </span><span class="gd_word" id="S1.p1.1.4.w12">simple</span><span> </span><span class="gd_word" id="S1.p1.1.4.w13">but</span><span> </span><span class="gd_word" id="S1.p1.1.4.w14">efficient</span><span> </span><span class="gd_word" id="S1.p1.1.4.w15">and</span><span> </span><span class="gd_word" id="S1.p1.1.4.w16">scalable</span><span> </span><span class="gd_word" id="S1.p1.1.4.w17">techniques</span><span> </span><span class="gd_word" id="S1.p1.1.4.w18">(like</span><span> </span><em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">self-attention</em><span class="gd_word" id="S1.p1.1.5.w1"/><span> </span><span class="gd_word" id="S1.p1.1.5.w2">which</span><span> </span><span class="gd_word" id="S1.p1.1.5.w3">operates</span><span> </span><span class="gd_word" id="S1.p1.1.5.w4">at</span><span> </span><span class="gd_word" id="S1.p1.1.5.w5">constant</span><span> </span><span class="gd_word" id="S1.p1.1.5.w6">parallel</span><span> </span><span class="gd_word" id="S1.p1.1.5.w7">time</span><span> </span><span class="gd_word" id="S1.p1.1.5.w8">complexity</span><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="gd_word" id="footnote1.3.w1">Given</span><span> </span><span class="gd_word" id="footnote1.3.w2">GPUs,</span><span> </span><span class="gd_word" id="footnote1.3.w3">a</span><span> </span><span class="gd_word" id="footnote1.3.w4">“constant</span><span> </span><span class="gd_word" id="footnote1.3.w5">parallel</span><span> </span><span class="gd_word" id="footnote1.3.w6">time”</span><span> </span><span class="gd_word" id="footnote1.3.w7">process</span><span> </span><span class="gd_word" id="footnote1.3.w8">can</span><span> </span><span class="gd_word" id="footnote1.3.w9">perform</span><span> </span><span class="gd_word" id="footnote1.3.w10">all</span><span> </span><span class="gd_word" id="footnote1.3.w11">its</span><span> </span><span class="gd_word" id="footnote1.3.w12">computations</span><span> </span><span class="gd_word" id="footnote1.3.w13">at</span><span> </span><span class="gd_word" id="footnote1.3.w14">once</span><span> </span><span class="gd_word" id="footnote1.3.w15">algorithmically.</span></span></span></span><span class="gd_word" id="S1.p1.1.6.w1">)</span><span> </span><span class="gd_word" id="S1.p1.1.6.w2">to</span><span> </span><span class="gd_word" id="S1.p1.1.6.w3">train</span><span> </span><span class="gd_word" id="S1.p1.1.6.w4">models</span><span> </span><span class="gd_word" id="S1.p1.1.6.w5">at</span><span> </span><span class="gd_word" id="S1.p1.1.6.w6">a</span><span> </span><span class="gd_word" id="S1.p1.1.6.w7">large</span><span> </span><span class="gd_word" id="S1.p1.1.6.w8">scale.</span><span> </span><span class="gd_word" id="S1.p1.1.6.w9">Yet,</span><span> </span><span class="gd_word" id="S1.p1.1.6.w10">there</span><span> </span><span class="gd_word" id="S1.p1.1.6.w11">is</span><span> </span><span class="gd_word" id="S1.p1.1.6.w12">still</span><span> </span><span class="gd_word" id="S1.p1.1.6.w13">no</span><span> </span><span class="gd_word" id="S1.p1.1.6.w14">concrete</span><span> </span><span class="gd_word" id="S1.p1.1.6.w15">evidence</span><span> </span><span class="gd_word" id="S1.p1.1.6.w16">that</span><span> </span><span class="gd_word" id="S1.p1.1.6.w17">these</span><span> </span><span class="gd_word" id="S1.p1.1.6.w18">models</span><span> </span><span class="gd_word" id="S1.p1.1.6.w19">learn</span><span> </span><span class="gd_word" id="S1.p1.1.6.w20">grammatical</span><span> </span><span class="gd_word" id="S1.p1.1.6.w21">and</span><span> </span><span class="gd_word" id="S1.p1.1.6.w22">constituency</span><span> </span><span class="gd_word" id="S1.p1.1.6.w23">structures</span><span> </span><span class="gd_word" id="S1.p1.1.6.w24">implicitly.</span><span> </span><span class="gd_word" id="S1.p1.1.6.w25">However,</span><span> </span><span class="gd_word" id="S1.p1.1.6.w26">ad</span><span> </span><span class="gd_word" id="S1.p1.1.6.w27">hoc</span><span> </span><span class="gd_word" id="S1.p1.1.6.w28">tree-structured</span><span> </span><span class="gd_word" id="S1.p1.1.6.w29">models</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Socher et al., <a href="#bib.bib21" title="" class="ltx_ref">2013</a>; Tai et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>; Shi et al., <a href="#bib.bib20" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S1.p1.1.7.w1"/><span> </span><span class="gd_word" id="S1.p1.1.7.w2">often</span><span> </span><span class="gd_word" id="S1.p1.1.7.w3">operate</span><span> </span><span class="gd_word" id="S1.p1.1.7.w4">on</span><span> </span><span class="gd_word" id="S1.p1.1.7.w5">recursive</span><span> </span><span class="gd_word" id="S1.p1.1.7.w6">or</span><span> </span><span class="gd_word" id="S1.p1.1.7.w7">recurrent</span><span> </span><span class="gd_word" id="S1.p1.1.7.w8">mechanisms,</span><span> </span><span class="gd_word" id="S1.p1.1.7.w9">which</span><span> </span><span class="gd_word" id="S1.p1.1.7.w10">are</span><span> </span><span class="gd_word" id="S1.p1.1.7.w11">not</span><span> </span><span class="gd_word" id="S1.p1.1.7.w12">parallelizable,</span><span> </span><span class="gd_word" id="S1.p1.1.7.w13">thus</span><span> </span><span class="gd_word" id="S1.p1.1.7.w14">hindering</span><span> </span><span class="gd_word" id="S1.p1.1.7.w15">their</span><span> </span><span class="gd_word" id="S1.p1.1.7.w16">application</span><span> </span><span class="gd_word" id="S1.p1.1.7.w17">in</span><span> </span><span class="gd_word" id="S1.p1.1.7.w18">larger-scale</span><span> </span><span class="gd_word" id="S1.p1.1.7.w19">training.</span><span> </span><span class="gd_word" id="S1.p1.1.7.w20">Besides,</span><span> </span><span class="gd_word" id="S1.p1.1.7.w21">such</span><span> </span><span class="gd_word" id="S1.p1.1.7.w22">models</span><span> </span><span class="gd_word" id="S1.p1.1.7.w23">are</span><span> </span><span class="gd_word" id="S1.p1.1.7.w24">designed</span><span> </span><span class="gd_word" id="S1.p1.1.7.w25">to</span><span> </span><span class="gd_word" id="S1.p1.1.7.w26">only</span><span> </span><span class="gd_word" id="S1.p1.1.7.w27">operate</span><span> </span><span class="gd_word" id="S1.p1.1.7.w28">at</span><span> </span><span class="gd_word" id="S1.p1.1.7.w29">the</span><span> </span><span class="gd_word" id="S1.p1.1.7.w30">sentence-level</span><span> </span><span class="gd_word" id="S1.p1.1.7.w31">(i.e.,</span><span> </span><span class="gd_word" id="S1.p1.1.7.w32">single</span><span> </span><span class="gd_word" id="S1.p1.1.7.w33">tree),</span><span> </span><span class="gd_word" id="S1.p1.1.7.w34">limiting</span><span> </span><span class="gd_word" id="S1.p1.1.7.w35">their</span><span> </span><span class="gd_word" id="S1.p1.1.7.w36">application</span><span> </span><span class="gd_word" id="S1.p1.1.7.w37">to</span><span> </span><span class="gd_word" id="S1.p1.1.7.w38">document-level</span><span> </span><span class="gd_word" id="S1.p1.1.7.w39">processing.</span></p>
</div>
<div id="S1.p2" class="ltx_para ltx_noindent">
<p id="S1.p2.1" class="ltx_p"><span class="gd_word" id="S1.p2.1.1.w1">We</span><span> </span><span class="gd_word" id="S1.p2.1.1.w2">propose</span><span> </span><span class="gd_word" id="S1.p2.1.1.w3">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w4">novel</span><span> </span><span class="gd_word" id="S1.p2.1.1.w5">attention-based</span><span> </span><span class="gd_word" id="S1.p2.1.1.w6">method</span><span> </span><span class="gd_word" id="S1.p2.1.1.w7">that</span><span> </span><span class="gd_word" id="S1.p2.1.1.w8">encodes</span><span> </span><span class="gd_word" id="S1.p2.1.1.w9">trees</span><span> </span><span class="gd_word" id="S1.p2.1.1.w10">in</span><span> </span><span class="gd_word" id="S1.p2.1.1.w11">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w12">bottom-up</span><span> </span><span class="gd_word" id="S1.p2.1.1.w13">manner</span><span> </span><span class="gd_word" id="S1.p2.1.1.w14">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w15">executes</span><span> </span><span class="gd_word" id="S1.p2.1.1.w16">competitively</span><span> </span><span class="gd_word" id="S1.p2.1.1.w17">with</span><span> </span><span class="gd_word" id="S1.p2.1.1.w18">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w19">Transformer</span><span> </span><span class="gd_word" id="S1.p2.1.1.w20">at</span><span> </span><span class="gd_word" id="S1.p2.1.1.w21">constant</span><span> </span><span class="gd_word" id="S1.p2.1.1.w22">parallel</span><span> </span><span class="gd_word" id="S1.p2.1.1.w23">time</span><span> </span><span class="gd_word" id="S1.p2.1.1.w24">complexity.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w25">In</span><span> </span><span class="gd_word" id="S1.p2.1.1.w26">particular,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w27">our</span><span> </span><span class="gd_word" id="S1.p2.1.1.w28">attention</span><span> </span><span class="gd_word" id="S1.p2.1.1.w29">layers</span><span> </span><span class="gd_word" id="S1.p2.1.1.w30">receive</span><span> </span><span class="gd_word" id="S1.p2.1.1.w31">as</span><span> </span><span class="gd_word" id="S1.p2.1.1.w32">input</span><span> </span><span class="gd_word" id="S1.p2.1.1.w33">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w34">constituency</span><span> </span><span class="gd_word" id="S1.p2.1.1.w35">tree</span><span> </span><span class="gd_word" id="S1.p2.1.1.w36">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w37">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w38">piece</span><span> </span><span class="gd_word" id="S1.p2.1.1.w39">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w40">text</span><span> </span><span class="gd_word" id="S1.p2.1.1.w41">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w42">then</span><span> </span><span class="gd_word" id="S1.p2.1.1.w43">model</span><span> </span><span class="gd_word" id="S1.p2.1.1.w44">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w45">hidden</span><span> </span><span class="gd_word" id="S1.p2.1.1.w46">states</span><span> </span><span class="gd_word" id="S1.p2.1.1.w47">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w48">all</span><span> </span><span class="gd_word" id="S1.p2.1.1.w49">nodes</span><span> </span><span class="gd_word" id="S1.p2.1.1.w50">in</span><span> </span><span class="gd_word" id="S1.p2.1.1.w51">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w52">tree</span><span> </span><span class="gd_word" id="S1.p2.1.1.w53">(leaves</span><span> </span><span class="gd_word" id="S1.p2.1.1.w54">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w55">nonterminals)</span><span> </span><span class="gd_word" id="S1.p2.1.1.w56">from</span><span> </span><span class="gd_word" id="S1.p2.1.1.w57">their</span><span> </span><span class="gd_word" id="S1.p2.1.1.w58">lower-layer</span><span> </span><span class="gd_word" id="S1.p2.1.1.w59">representations</span><span> </span><span class="gd_word" id="S1.p2.1.1.w60">according</span><span> </span><span class="gd_word" id="S1.p2.1.1.w61">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w62">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w63">tree</span><span> </span><span class="gd_word" id="S1.p2.1.1.w64">structure.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w65">As</span><span> </span><span class="gd_word" id="S1.p2.1.1.w66">attentions</span><span> </span><span class="gd_word" id="S1.p2.1.1.w67">typically</span><span> </span><span class="gd_word" id="S1.p2.1.1.w68">have</span><span> </span><span class="gd_word" id="S1.p2.1.1.w69">query,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w70">key</span><span> </span><span class="gd_word" id="S1.p2.1.1.w71">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w72">value</span><span> </span><span class="gd_word" id="S1.p2.1.1.w73">components,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w74">our</span><span> </span><span class="gd_word" id="S1.p2.1.1.w75">model</span><span> </span><span class="gd_word" id="S1.p2.1.1.w76">uses</span><span> </span><span class="gd_word" id="S1.p2.1.1.w77">hierarchical</span><span> </span><span class="gd_word" id="S1.p2.1.1.w78">accumulation</span><span> </span><span class="gd_word" id="S1.p2.1.1.w79">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w80">encode</span><span> </span><span class="gd_word" id="S1.p2.1.1.w81">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w82">value</span><span> </span><span class="gd_word" id="S1.p2.1.1.w83">component</span><span> </span><span class="gd_word" id="S1.p2.1.1.w84">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w85">each</span><span> </span><span class="gd_word" id="S1.p2.1.1.w86">nonterminal</span><span> </span><span class="gd_word" id="S1.p2.1.1.w87">node</span><span> </span><span class="gd_word" id="S1.p2.1.1.w88">by</span><span> </span><span class="gd_word" id="S1.p2.1.1.w89">aggregating</span><span> </span><span class="gd_word" id="S1.p2.1.1.w90">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w91">hidden</span><span> </span><span class="gd_word" id="S1.p2.1.1.w92">states</span><span> </span><span class="gd_word" id="S1.p2.1.1.w93">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w94">all</span><span> </span><span class="gd_word" id="S1.p2.1.1.w95">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w96">its</span><span> </span><span class="gd_word" id="S1.p2.1.1.w97">descendants.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w98">The</span><span> </span><span class="gd_word" id="S1.p2.1.1.w99">accumulation</span><span> </span><span class="gd_word" id="S1.p2.1.1.w100">process</span><span> </span><span class="gd_word" id="S1.p2.1.1.w101">is</span><span> </span><span class="gd_word" id="S1.p2.1.1.w102">three-staged.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w103">First,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w104">we</span><span> </span><span class="gd_word" id="S1.p2.1.1.w105">induce</span><span> </span><span class="gd_word" id="S1.p2.1.1.w106">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w107">value</span><span> </span><span class="gd_word" id="S1.p2.1.1.w108">states</span><span> </span><span class="gd_word" id="S1.p2.1.1.w109">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w110">nonterminals</span><span> </span><span class="gd_word" id="S1.p2.1.1.w111">with</span><span> </span><span class="gd_word" id="S1.p2.1.1.w112">hierarchical</span><span> </span><span class="gd_word" id="S1.p2.1.1.w113">embeddings,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w114">which</span><span> </span><span class="gd_word" id="S1.p2.1.1.w115">help</span><span> </span><span class="gd_word" id="S1.p2.1.1.w116">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w117">model</span><span> </span><span class="gd_word" id="S1.p2.1.1.w118">become</span><span> </span><span class="gd_word" id="S1.p2.1.1.w119">aware</span><span> </span><span class="gd_word" id="S1.p2.1.1.w120">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w121">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w122">hierarchical</span><span> </span><span class="gd_word" id="S1.p2.1.1.w123">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w124">sibling</span><span> </span><span class="gd_word" id="S1.p2.1.1.w125">relationships</span><span> </span><span class="gd_word" id="S1.p2.1.1.w126">between</span><span> </span><span class="gd_word" id="S1.p2.1.1.w127">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w128">nodes.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w129">Second,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w130">we</span><span> </span><span class="gd_word" id="S1.p2.1.1.w131">perform</span><span> </span><span class="gd_word" id="S1.p2.1.1.w132">an</span><span> </span><span class="gd_word" id="S1.p2.1.1.w133">upward</span><span> </span><span class="gd_word" id="S1.p2.1.1.w134">cumulative-average</span><span> </span><span class="gd_word" id="S1.p2.1.1.w135">operation</span><span> </span><span class="gd_word" id="S1.p2.1.1.w136">on</span><span> </span><span class="gd_word" id="S1.p2.1.1.w137">each</span><span> </span><span class="gd_word" id="S1.p2.1.1.w138">target</span><span> </span><span class="gd_word" id="S1.p2.1.1.w139">node,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w140">which</span><span> </span><span class="gd_word" id="S1.p2.1.1.w141">accumulates</span><span> </span><span class="gd_word" id="S1.p2.1.1.w142">all</span><span> </span><span class="gd_word" id="S1.p2.1.1.w143">elements</span><span> </span><span class="gd_word" id="S1.p2.1.1.w144">in</span><span> </span><span class="gd_word" id="S1.p2.1.1.w145">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w146">branches</span><span> </span><span class="gd_word" id="S1.p2.1.1.w147">originating</span><span> </span><span class="gd_word" id="S1.p2.1.1.w148">from</span><span> </span><span class="gd_word" id="S1.p2.1.1.w149">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w150">target</span><span> </span><span class="gd_word" id="S1.p2.1.1.w151">node</span><span> </span><span class="gd_word" id="S1.p2.1.1.w152">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w153">its</span><span> </span><span class="gd_word" id="S1.p2.1.1.w154">descendant</span><span> </span><span class="gd_word" id="S1.p2.1.1.w155">leaves.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w156">Third,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w157">these</span><span> </span><span class="gd_word" id="S1.p2.1.1.w158">branch-level</span><span> </span><span class="gd_word" id="S1.p2.1.1.w159">representations</span><span> </span><span class="gd_word" id="S1.p2.1.1.w160">are</span><span> </span><span class="gd_word" id="S1.p2.1.1.w161">combined</span><span> </span><span class="gd_word" id="S1.p2.1.1.w162">into</span><span> </span><span class="gd_word" id="S1.p2.1.1.w163">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w164">new</span><span> </span><span class="gd_word" id="S1.p2.1.1.w165">value</span><span> </span><span class="gd_word" id="S1.p2.1.1.w166">representation</span><span> </span><span class="gd_word" id="S1.p2.1.1.w167">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w168">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w169">target</span><span> </span><span class="gd_word" id="S1.p2.1.1.w170">node</span><span> </span><span class="gd_word" id="S1.p2.1.1.w171">by</span><span> </span><span class="gd_word" id="S1.p2.1.1.w172">using</span><span> </span><span class="gd_word" id="S1.p2.1.1.w173">weighted</span><span> </span><span class="gd_word" id="S1.p2.1.1.w174">aggregation.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w175">Finally,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w176">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w177">model</span><span> </span><span class="gd_word" id="S1.p2.1.1.w178">proceeds</span><span> </span><span class="gd_word" id="S1.p2.1.1.w179">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w180">perform</span><span> </span><span class="gd_word" id="S1.p2.1.1.w181">attention</span><span> </span><span class="gd_word" id="S1.p2.1.1.w182">with</span><span> </span><span class="gd_word" id="S1.p2.1.1.w183">subtree</span><span> </span><span class="gd_word" id="S1.p2.1.1.w184">masking</span><span> </span><span class="gd_word" id="S1.p2.1.1.w185">where</span><span> </span><span class="gd_word" id="S1.p2.1.1.w186">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w187">attention</span><span> </span><span class="gd_word" id="S1.p2.1.1.w188">score</span><span> </span><span class="gd_word" id="S1.p2.1.1.w189">between</span><span> </span><span class="gd_word" id="S1.p2.1.1.w190">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w191">nonterminal</span><span> </span><span class="gd_word" id="S1.p2.1.1.w192">query</span><span> </span><span class="gd_word" id="S1.p2.1.1.w193">and</span><span> </span><span class="gd_word" id="S1.p2.1.1.w194">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w195">key</span><span> </span><span class="gd_word" id="S1.p2.1.1.w196">is</span><span> </span><span class="gd_word" id="S1.p2.1.1.w197">activated</span><span> </span><span class="gd_word" id="S1.p2.1.1.w198">only</span><span> </span><span class="gd_word" id="S1.p2.1.1.w199">if</span><span> </span><span class="gd_word" id="S1.p2.1.1.w200">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w201">key</span><span> </span><span class="gd_word" id="S1.p2.1.1.w202">is</span><span> </span><span class="gd_word" id="S1.p2.1.1.w203">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w204">descendant</span><span> </span><span class="gd_word" id="S1.p2.1.1.w205">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w206">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w207">query.
</span></p>
</div>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p"><span class="gd_word" id="S1.p3.1.1.w1">Our</span><span> </span><span class="gd_word" id="S1.p3.1.1.w2">contributions</span><span> </span><span class="gd_word" id="S1.p3.1.1.w3">are</span><span> </span><span class="gd_word" id="S1.p3.1.1.w4">threefold.</span><span> </span><span class="gd_word" id="S1.p3.1.1.w5">First,</span><span> </span><span class="gd_word" id="S1.p3.1.1.w6">we</span><span> </span><span class="gd_word" id="S1.p3.1.1.w7">present</span><span> </span><span class="gd_word" id="S1.p3.1.1.w8">our</span><span> </span><span class="gd_word" id="S1.p3.1.1.w9">attention-based</span><span> </span><span class="gd_word" id="S1.p3.1.1.w10">hierarchical</span><span> </span><span class="gd_word" id="S1.p3.1.1.w11">encoding</span><span> </span><span class="gd_word" id="S1.p3.1.1.w12">method.</span><span> </span><span class="gd_word" id="S1.p3.1.1.w13">Our</span><span> </span><span class="gd_word" id="S1.p3.1.1.w14">method
overcomes</span><span> </span><span class="gd_word" id="S1.p3.1.1.w15">linear</span><span> </span><span class="gd_word" id="S1.p3.1.1.w16">parallel</span><span> </span><span class="gd_word" id="S1.p3.1.1.w17">time</span><span> </span><span class="gd_word" id="S1.p3.1.1.w18">complexity</span><span> </span><span class="gd_word" id="S1.p3.1.1.w19">of</span><span> </span><span class="gd_word" id="S1.p3.1.1.w20">Tree-LSTM</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Tai et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="S1.p3.1.2.w1"/><span> </span><span class="gd_word" id="S1.p3.1.2.w2">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w3">offers</span><span> </span><span class="gd_word" id="S1.p3.1.2.w4">attractive</span><span> </span><span class="gd_word" id="S1.p3.1.2.w5">scalability.</span><span> </span><span class="gd_word" id="S1.p3.1.2.w6">Second,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w7">we</span><span> </span><span class="gd_word" id="S1.p3.1.2.w8">adopt</span><span> </span><span class="gd_word" id="S1.p3.1.2.w9">our</span><span> </span><span class="gd_word" id="S1.p3.1.2.w10">methods</span><span> </span><span class="gd_word" id="S1.p3.1.2.w11">within</span><span> </span><span class="gd_word" id="S1.p3.1.2.w12">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w13">Transformer</span><span> </span><span class="gd_word" id="S1.p3.1.2.w14">architecture</span><span> </span><span class="gd_word" id="S1.p3.1.2.w15">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w16">show</span><span> </span><span class="gd_word" id="S1.p3.1.2.w17">improvements</span><span> </span><span class="gd_word" id="S1.p3.1.2.w18">across</span><span> </span><span class="gd_word" id="S1.p3.1.2.w19">various</span><span> </span><span class="gd_word" id="S1.p3.1.2.w20">NLP</span><span> </span><span class="gd_word" id="S1.p3.1.2.w21">tasks</span><span> </span><span class="gd_word" id="S1.p3.1.2.w22">over</span><span> </span><span class="gd_word" id="S1.p3.1.2.w23">strong</span><span> </span><span class="gd_word" id="S1.p3.1.2.w24">baselines.
In</span><span> </span><span class="gd_word" id="S1.p3.1.2.w25">particular,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w26">our</span><span> </span><span class="gd_word" id="S1.p3.1.2.w27">model</span><span> </span><span class="gd_word" id="S1.p3.1.2.w28">leverages</span><span> </span><span class="gd_word" id="S1.p3.1.2.w29">tree-based</span><span> </span><span class="gd_word" id="S1.p3.1.2.w30">prior</span><span> </span><span class="gd_word" id="S1.p3.1.2.w31">to</span><span> </span><span class="gd_word" id="S1.p3.1.2.w32">improve</span><span> </span><span class="gd_word" id="S1.p3.1.2.w33">translation</span><span> </span><span class="gd_word" id="S1.p3.1.2.w34">quality</span><span> </span><span class="gd_word" id="S1.p3.1.2.w35">over</span><span> </span><span class="gd_word" id="S1.p3.1.2.w36">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w37">Transformer</span><span> </span><span class="gd_word" id="S1.p3.1.2.w38">baselines</span><span> </span><span class="gd_word" id="S1.p3.1.2.w39">in</span><span> </span><span class="gd_word" id="S1.p3.1.2.w40">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w41">IWSLT’14</span><span> </span><span class="gd_word" id="S1.p3.1.2.w42">English-German</span><span> </span><span class="gd_word" id="S1.p3.1.2.w43">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w44">German-English,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w45">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w46">IWSLT’13</span><span> </span><span class="gd_word" id="S1.p3.1.2.w47">English-French</span><span> </span><span class="gd_word" id="S1.p3.1.2.w48">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w49">French-English,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w50">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w51">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w52">WMT’14</span><span> </span><span class="gd_word" id="S1.p3.1.2.w53">English-German</span><span> </span><span class="gd_word" id="S1.p3.1.2.w54">translation</span><span> </span><span class="gd_word" id="S1.p3.1.2.w55">tasks.</span><span> </span><span class="gd_word" id="S1.p3.1.2.w56">Furthermore,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w57">our</span><span> </span><span class="gd_word" id="S1.p3.1.2.w58">model</span><span> </span><span class="gd_word" id="S1.p3.1.2.w59">also</span><span> </span><span class="gd_word" id="S1.p3.1.2.w60">exhibits</span><span> </span><span class="gd_word" id="S1.p3.1.2.w61">advantages</span><span> </span><span class="gd_word" id="S1.p3.1.2.w62">over</span><span> </span><span class="gd_word" id="S1.p3.1.2.w63">Tree-LSTM</span><span> </span><span class="gd_word" id="S1.p3.1.2.w64">in</span><span> </span><span class="gd_word" id="S1.p3.1.2.w65">classification</span><span> </span><span class="gd_word" id="S1.p3.1.2.w66">tasks</span><span> </span><span class="gd_word" id="S1.p3.1.2.w67">including</span><span> </span><span class="gd_word" id="S1.p3.1.2.w68">Stanford</span><span> </span><span class="gd_word" id="S1.p3.1.2.w69">Sentiment</span><span> </span><span class="gd_word" id="S1.p3.1.2.w70">Analysis</span><span> </span><span class="gd_word" id="S1.p3.1.2.w71">(SST)</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Socher et al., <a href="#bib.bib21" title="" class="ltx_ref">2013</a>)</cite><span class="gd_word" id="S1.p3.1.3.w1">,</span><span> </span><span class="gd_word" id="S1.p3.1.3.w2">IMDB</span><span> </span><span class="gd_word" id="S1.p3.1.3.w3">Sentiment</span><span> </span><span class="gd_word" id="S1.p3.1.3.w4">Analysis</span><span> </span><span class="gd_word" id="S1.p3.1.3.w5">and</span><span> </span><span class="gd_word" id="S1.p3.1.3.w6">Subject-Verb</span><span> </span><span class="gd_word" id="S1.p3.1.3.w7">Agreement</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Linzen et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite><span class="gd_word" id="S1.p3.1.4.w1">.
Finally,</span><span> </span><span class="gd_word" id="S1.p3.1.4.w2">our</span><span> </span><span class="gd_word" id="S1.p3.1.4.w3">analysis</span><span> </span><span class="gd_word" id="S1.p3.1.4.w4">of</span><span> </span><span class="gd_word" id="S1.p3.1.4.w5">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w6">results</span><span> </span><span class="gd_word" id="S1.p3.1.4.w7">suggests</span><span> </span><span class="gd_word" id="S1.p3.1.4.w8">that</span><span> </span><span class="gd_word" id="S1.p3.1.4.w9">incorporating</span><span> </span><span class="gd_word" id="S1.p3.1.4.w10">a</span><span> </span><span class="gd_word" id="S1.p3.1.4.w11">hierarchical</span><span> </span><span class="gd_word" id="S1.p3.1.4.w12">prior</span><span> </span><span class="gd_word" id="S1.p3.1.4.w13">using</span><span> </span><span class="gd_word" id="S1.p3.1.4.w14">our</span><span> </span><span class="gd_word" id="S1.p3.1.4.w15">method</span><span> </span><span class="gd_word" id="S1.p3.1.4.w16">can</span><span> </span><span class="gd_word" id="S1.p3.1.4.w17">compensate</span><span> </span><span class="gd_word" id="S1.p3.1.4.w18">for</span><span> </span><span class="gd_word" id="S1.p3.1.4.w19">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w20">lack</span><span> </span><span class="gd_word" id="S1.p3.1.4.w21">of</span><span> </span><span class="gd_word" id="S1.p3.1.4.w22">data</span><span> </span><span class="gd_word" id="S1.p3.1.4.w23">in</span><span> </span><span class="gd_word" id="S1.p3.1.4.w24">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w25">context</span><span> </span><span class="gd_word" id="S1.p3.1.4.w26">of</span><span> </span><span class="gd_word" id="S1.p3.1.4.w27">machine</span><span> </span><span class="gd_word" id="S1.p3.1.4.w28">translation.</span><span> </span><span class="gd_word" id="S1.p3.1.4.w29">We</span><span> </span><span class="gd_word" id="S1.p3.1.4.w30">also</span><span> </span><span class="gd_word" id="S1.p3.1.4.w31">demonstrate</span><span> </span><span class="gd_word" id="S1.p3.1.4.w32">that</span><span> </span><span class="gd_word" id="S1.p3.1.4.w33">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w34">model</span><span> </span><span class="gd_word" id="S1.p3.1.4.w35">has</span><span> </span><span class="gd_word" id="S1.p3.1.4.w36">natural</span><span> </span><span class="gd_word" id="S1.p3.1.4.w37">and</span><span> </span><span class="gd_word" id="S1.p3.1.4.w38">consistent</span><span> </span><span class="gd_word" id="S1.p3.1.4.w39">preference</span><span> </span><span class="gd_word" id="S1.p3.1.4.w40">for</span><span> </span><span class="gd_word" id="S1.p3.1.4.w41">phrase-level</span><span> </span><span class="gd_word" id="S1.p3.1.4.w42">attention</span><span> </span><span class="gd_word" id="S1.p3.1.4.w43">over</span><span> </span><span class="gd_word" id="S1.p3.1.4.w44">token-level</span><span> </span><span class="gd_word" id="S1.p3.1.4.w45">attention.</span><span> </span><span class="gd_word" id="S1.p3.1.4.w46">Our</span><span> </span><span class="gd_word" id="S1.p3.1.4.w47">source</span><span> </span><span class="gd_word" id="S1.p3.1.4.w48">code</span><span> </span><span class="gd_word" id="S1.p3.1.4.w49">is</span><span> </span><span class="gd_word" id="S1.p3.1.4.w50">available</span><span> </span><span class="gd_word" id="S1.p3.1.4.w51">at</span><span> </span><a href="https://github.com/nxphi47/tree_transformer" title="" class="ltx_ref ltx_href">https://github.com/nxphi47/tree_transformer</a><span class="gd_word" id="S1.p3.1.5.w1">.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span class="gd_word" id="S2.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="S2.p1.1.1.w2">Transformer</span><span> </span><span class="gd_word" id="S2.p1.1.1.w3">framework</span><span> </span><span class="gd_word" id="S2.p1.1.1.w4">has</span><span> </span><span class="gd_word" id="S2.p1.1.1.w5">become</span><span> </span><span class="gd_word" id="S2.p1.1.1.w6">the</span><span> </span><span class="gd_word" id="S2.p1.1.1.w7">driving</span><span> </span><span class="gd_word" id="S2.p1.1.1.w8">force</span><span> </span><span class="gd_word" id="S2.p1.1.1.w9">in</span><span> </span><span class="gd_word" id="S2.p1.1.1.w10">recent</span><span> </span><span class="gd_word" id="S2.p1.1.1.w11">NLP</span><span> </span><span class="gd_word" id="S2.p1.1.1.w12">research.</span><span> </span><span class="gd_word" id="S2.p1.1.1.w13">For</span><span> </span><span class="gd_word" id="S2.p1.1.1.w14">example,</span><span> </span><span class="gd_word" id="S2.p1.1.1.w15">it</span><span> </span><span class="gd_word" id="S2.p1.1.1.w16">has</span><span> </span><span class="gd_word" id="S2.p1.1.1.w17">achieved</span><span> </span><span class="gd_word" id="S2.p1.1.1.w18">state-of-the-art</span><span> </span><span class="gd_word" id="S2.p1.1.1.w19">performance</span><span> </span><span class="gd_word" id="S2.p1.1.1.w20">in</span><span> </span><span class="gd_word" id="S2.p1.1.1.w21">machine</span><span> </span><span class="gd_word" id="S2.p1.1.1.w22">translation</span><span> </span><span class="gd_word" id="S2.p1.1.1.w23">tasks</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Shaw et al., <a href="#bib.bib17" title="" class="ltx_ref">2018</a>; Ott et al., <a href="#bib.bib14" title="" class="ltx_ref">2018</a>; Wu et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.2.w1"/><span> </span><span class="gd_word" id="S2.p1.1.2.w2">and</span><span> </span><span class="gd_word" id="S2.p1.1.2.w3">self-supervised</span><span> </span><span class="gd_word" id="S2.p1.1.2.w4">representational</span><span> </span><span class="gd_word" id="S2.p1.1.2.w5">learning</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Radford et al., <a href="#bib.bib15" title="" class="ltx_ref">2018</a>; Lample &amp; Conneau, <a href="#bib.bib11" title="" class="ltx_ref">2019</a>; Yang et al., <a href="#bib.bib27" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.3.w1">.</span><span> </span><span class="gd_word" id="S2.p1.1.3.w2">The</span><span> </span><span class="gd_word" id="S2.p1.1.3.w3">self-attention</span><span> </span><span class="gd_word" id="S2.p1.1.3.w4">layers</span><span> </span><span class="gd_word" id="S2.p1.1.3.w5">in</span><span> </span><span class="gd_word" id="S2.p1.1.3.w6">the</span><span> </span><span class="gd_word" id="S2.p1.1.3.w7">Transformer</span><span> </span><span class="gd_word" id="S2.p1.1.3.w8">encode</span><span> </span><span class="gd_word" id="S2.p1.1.3.w9">a</span><span> </span><em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">sequence</em><span class="gd_word" id="S2.p1.1.4.w1"/><span> </span><span class="gd_word" id="S2.p1.1.4.w2">at</span><span> </span><span class="gd_word" id="S2.p1.1.4.w3">constant</span><span> </span><span class="gd_word" id="S2.p1.1.4.w4">parallel</span><span> </span><span class="gd_word" id="S2.p1.1.4.w5">time</span><span> </span><span class="gd_word" id="S2.p1.1.4.w6">complexity,</span><span> </span><span class="gd_word" id="S2.p1.1.4.w7">which</span><span> </span><span class="gd_word" id="S2.p1.1.4.w8">makes</span><span> </span><span class="gd_word" id="S2.p1.1.4.w9">it</span><span> </span><span class="gd_word" id="S2.p1.1.4.w10">parallelizeable</span><span> </span><span class="gd_word" id="S2.p1.1.4.w11">and</span><span> </span><span class="gd_word" id="S2.p1.1.4.w12">scalable.
On</span><span> </span><span class="gd_word" id="S2.p1.1.4.w13">the</span><span> </span><span class="gd_word" id="S2.p1.1.4.w14">other</span><span> </span><span class="gd_word" id="S2.p1.1.4.w15">hand,</span><span> </span><span class="gd_word" id="S2.p1.1.4.w16">there</span><span> </span><span class="gd_word" id="S2.p1.1.4.w17">have</span><span> </span><span class="gd_word" id="S2.p1.1.4.w18">been</span><span> </span><span class="gd_word" id="S2.p1.1.4.w19">many</span><span> </span><span class="gd_word" id="S2.p1.1.4.w20">proposals</span><span> </span><span class="gd_word" id="S2.p1.1.4.w21">to</span><span> </span><span class="gd_word" id="S2.p1.1.4.w22">use</span><span> </span><em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">parse trees</em><span class="gd_word" id="S2.p1.1.5.w1"/><span> </span><span class="gd_word" id="S2.p1.1.5.w2">as</span><span> </span><span class="gd_word" id="S2.p1.1.5.w3">an</span><span> </span><span class="gd_word" id="S2.p1.1.5.w4">architectural</span><span> </span><span class="gd_word" id="S2.p1.1.5.w5">prior</span><span> </span><span class="gd_word" id="S2.p1.1.5.w6">to</span><span> </span><span class="gd_word" id="S2.p1.1.5.w7">facilitate</span><span> </span><span class="gd_word" id="S2.p1.1.5.w8">different</span><span> </span><span class="gd_word" id="S2.p1.1.5.w9">downstream</span><span> </span><span class="gd_word" id="S2.p1.1.5.w10">tasks.
</span><cite class="ltx_cite ltx_citemacro_citet">Socher et al. (<a href="#bib.bib21" title="" class="ltx_ref">2013</a>)</cite><span class="gd_word" id="S2.p1.1.6.w1"/><span> </span><span class="gd_word" id="S2.p1.1.6.w2">adopt</span><span> </span><span class="gd_word" id="S2.p1.1.6.w3">a</span><span> </span><span class="gd_word" id="S2.p1.1.6.w4">recursive</span><span> </span><span class="gd_word" id="S2.p1.1.6.w5">compositional</span><span> </span><span class="gd_word" id="S2.p1.1.6.w6">method</span><span> </span><span class="gd_word" id="S2.p1.1.6.w7">over</span><span> </span><span class="gd_word" id="S2.p1.1.6.w8">constituency</span><span> </span><span class="gd_word" id="S2.p1.1.6.w9">trees</span><span> </span><span class="gd_word" id="S2.p1.1.6.w10">to</span><span> </span><span class="gd_word" id="S2.p1.1.6.w11">solve</span><span> </span><span class="gd_word" id="S2.p1.1.6.w12">sentiment</span><span> </span><span class="gd_word" id="S2.p1.1.6.w13">analysis</span><span> </span><span class="gd_word" id="S2.p1.1.6.w14">in</span><span> </span><span class="gd_word" id="S2.p1.1.6.w15">a</span><span> </span><span class="gd_word" id="S2.p1.1.6.w16">bottom-up</span><span> </span><span class="gd_word" id="S2.p1.1.6.w17">manner.
Tree-LSTM</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Tai et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="S2.p1.1.7.w1"/><span> </span><span class="gd_word" id="S2.p1.1.7.w2">improves</span><span> </span><span class="gd_word" id="S2.p1.1.7.w3">the</span><span> </span><span class="gd_word" id="S2.p1.1.7.w4">task</span><span> </span><span class="gd_word" id="S2.p1.1.7.w5">performance</span><span> </span><span class="gd_word" id="S2.p1.1.7.w6">by</span><span> </span><span class="gd_word" id="S2.p1.1.7.w7">using</span><span> </span><span class="gd_word" id="S2.p1.1.7.w8">an</span><span> </span><span class="gd_word" id="S2.p1.1.7.w9">LSTM</span><span> </span><span class="gd_word" id="S2.p1.1.7.w10">structure</span><span> </span><span class="gd_word" id="S2.p1.1.7.w11">to</span><span> </span><span class="gd_word" id="S2.p1.1.7.w12">encode</span><span> </span><span class="gd_word" id="S2.p1.1.7.w13">trees</span><span> </span><span class="gd_word" id="S2.p1.1.7.w14">recurrently.</span><span> </span><span class="gd_word" id="S2.p1.1.7.w15">Both</span><span> </span><span class="gd_word" id="S2.p1.1.7.w16">of</span><span> </span><span class="gd_word" id="S2.p1.1.7.w17">the</span><span> </span><span class="gd_word" id="S2.p1.1.7.w18">proposed</span><span> </span><span class="gd_word" id="S2.p1.1.7.w19">methods,</span><span> </span><span class="gd_word" id="S2.p1.1.7.w20">while</span><span> </span><span class="gd_word" id="S2.p1.1.7.w21">effective,</span><span> </span><span class="gd_word" id="S2.p1.1.7.w22">operate</span><span> </span><span class="gd_word" id="S2.p1.1.7.w23">sequentially</span><span> </span><span class="gd_word" id="S2.p1.1.7.w24">in</span><span> </span><span class="gd_word" id="S2.p1.1.7.w25">parallel</span><span> </span><span class="gd_word" id="S2.p1.1.7.w26">time</span><span> </span><span class="gd_word" id="S2.p1.1.7.w27">complexity.</span><span> </span><span class="gd_word" id="S2.p1.1.7.w28">Tree</span><span> </span><span class="gd_word" id="S2.p1.1.7.w29">structures</span><span> </span><span class="gd_word" id="S2.p1.1.7.w30">have</span><span> </span><span class="gd_word" id="S2.p1.1.7.w31">also</span><span> </span><span class="gd_word" id="S2.p1.1.7.w32">been</span><span> </span><span class="gd_word" id="S2.p1.1.7.w33">used</span><span> </span><span class="gd_word" id="S2.p1.1.7.w34">as</span><span> </span><span class="gd_word" id="S2.p1.1.7.w35">an</span><span> </span><span class="gd_word" id="S2.p1.1.7.w36">architectural</span><span> </span><span class="gd_word" id="S2.p1.1.7.w37">bias</span><span> </span><span class="gd_word" id="S2.p1.1.7.w38">to</span><span> </span><span class="gd_word" id="S2.p1.1.7.w39">improve</span><span> </span><span class="gd_word" id="S2.p1.1.7.w40">machine</span><span> </span><span class="gd_word" id="S2.p1.1.7.w41">translation</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Eriguchi et al., <a href="#bib.bib3" title="" class="ltx_ref">2016</a>; Shi et al., <a href="#bib.bib20" title="" class="ltx_ref">2018</a>; Yang et al., <a href="#bib.bib26" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S2.p1.1.8.w1">.</span><span> </span><span class="gd_word" id="S2.p1.1.8.w2">Constituency</span><span> </span><span class="gd_word" id="S2.p1.1.8.w3">trees</span><span> </span><span class="gd_word" id="S2.p1.1.8.w4">can</span><span> </span><span class="gd_word" id="S2.p1.1.8.w5">also</span><span> </span><span class="gd_word" id="S2.p1.1.8.w6">be</span><span> </span><span class="gd_word" id="S2.p1.1.8.w7">decoded</span><span> </span><span class="gd_word" id="S2.p1.1.8.w8">in</span><span> </span><span class="gd_word" id="S2.p1.1.8.w9">a</span><span> </span><span class="gd_word" id="S2.p1.1.8.w10">top-down</span><span> </span><span class="gd_word" id="S2.p1.1.8.w11">manner,</span><span> </span><span class="gd_word" id="S2.p1.1.8.w12">as</span><span> </span><span class="gd_word" id="S2.p1.1.8.w13">proposed</span><span> </span><span class="gd_word" id="S2.p1.1.8.w14">in</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Alvarez-Melis &amp; Jaakkola, <a href="#bib.bib1" title="" class="ltx_ref">2017</a>; Gū et al., <a href="#bib.bib6" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S2.p1.1.9.w1">.</span><span> </span><span class="gd_word" id="S2.p1.1.9.w2">Besides,</span><span> </span><span class="gd_word" id="S2.p1.1.9.w3">they</span><span> </span><span class="gd_word" id="S2.p1.1.9.w4">can</span><span> </span><span class="gd_word" id="S2.p1.1.9.w5">also</span><span> </span><span class="gd_word" id="S2.p1.1.9.w6">be</span><span> </span><span class="gd_word" id="S2.p1.1.9.w7">learned</span><span> </span><span class="gd_word" id="S2.p1.1.9.w8">in</span><span> </span><span class="gd_word" id="S2.p1.1.9.w9">an</span><span> </span><span class="gd_word" id="S2.p1.1.9.w10">unsupervised</span><span> </span><span class="gd_word" id="S2.p1.1.9.w11">way</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Kim et al., <a href="#bib.bib10" title="" class="ltx_ref">2019</a>; Shen et al., <a href="#bib.bib18" title="" class="ltx_ref">2018</a>; <a href="#bib.bib19" title="" class="ltx_ref">2019</a>; Yaushian Wang &amp; Chen, <a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.10.w1">.</span><span> </span><span class="gd_word" id="S2.p1.1.10.w2">Meanwhile,</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Strubell et al. (<a href="#bib.bib22" title="" class="ltx_ref">2018</a>); Hao et al. (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>); Harer et al. (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.11.w1"/><span> </span><span class="gd_word" id="S2.p1.1.11.w2">attempted</span><span> </span><span class="gd_word" id="S2.p1.1.11.w3">to</span><span> </span><span class="gd_word" id="S2.p1.1.11.w4">incorporate</span><span> </span><span class="gd_word" id="S2.p1.1.11.w5">trees</span><span> </span><span class="gd_word" id="S2.p1.1.11.w6">into</span><span> </span><span class="gd_word" id="S2.p1.1.11.w7">self-attention.</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">Hewitt &amp; Manning (<a href="#bib.bib9" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.12.w1"/><span> </span><span class="gd_word" id="S2.p1.1.12.w2">showed</span><span> </span><span class="gd_word" id="S2.p1.1.12.w3">that</span><span> </span><span class="gd_word" id="S2.p1.1.12.w4">dependency</span><span> </span><span class="gd_word" id="S2.p1.1.12.w5">semantics</span><span> </span><span class="gd_word" id="S2.p1.1.12.w6">are</span><span> </span><span class="gd_word" id="S2.p1.1.12.w7">already</span><span> </span><span class="gd_word" id="S2.p1.1.12.w8">intrinsically</span><span> </span><span class="gd_word" id="S2.p1.1.12.w9">embedded</span><span> </span><span class="gd_word" id="S2.p1.1.12.w10">in</span><span> </span><span class="gd_word" id="S2.p1.1.12.w11">BERT</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib2" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S2.p1.1.13.w1">.</span><span> </span><span class="gd_word" id="S2.p1.1.13.w2">Concurrently,</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Yaushian Wang &amp; Chen (<a href="#bib.bib28" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p1.1.14.w1"/><span> </span><span class="gd_word" id="S2.p1.1.14.w2">suggested</span><span> </span><span class="gd_word" id="S2.p1.1.14.w3">that</span><span> </span><span class="gd_word" id="S2.p1.1.14.w4">BERT</span><span> </span><span class="gd_word" id="S2.p1.1.14.w5">may</span><span> </span><span class="gd_word" id="S2.p1.1.14.w6">not</span><span> </span><span class="gd_word" id="S2.p1.1.14.w7">naturally</span><span> </span><span class="gd_word" id="S2.p1.1.14.w8">embed</span><span> </span><span class="gd_word" id="S2.p1.1.14.w9">constituency</span><span> </span><span class="gd_word" id="S2.p1.1.14.w10">semantics.</span></p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span class="gd_word" id="S2.p2.1.1.w1">Our</span><span> </span><span class="gd_word" id="S2.p2.1.1.w2">approach</span><span> </span><span class="gd_word" id="S2.p2.1.1.w3">encodes</span><span> </span><span class="gd_word" id="S2.p2.1.1.w4">trees</span><span> </span><span class="gd_word" id="S2.p2.1.1.w5">in</span><span> </span><span class="gd_word" id="S2.p2.1.1.w6">a</span><span> </span><span class="gd_word" id="S2.p2.1.1.w7">bottom-up</span><span> </span><span class="gd_word" id="S2.p2.1.1.w8">manner</span><span> </span><span class="gd_word" id="S2.p2.1.1.w9">as</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">Tai et al. (<a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="S2.p2.1.2.w1"/><span> </span><span class="gd_word" id="S2.p2.1.2.w2">and</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">Socher et al. (<a href="#bib.bib21" title="" class="ltx_ref">2013</a>)</cite><span class="gd_word" id="S2.p2.1.3.w1">.</span><span> </span><span class="gd_word" id="S2.p2.1.3.w2">But</span><span> </span><span class="gd_word" id="S2.p2.1.3.w3">it</span><span> </span><span class="gd_word" id="S2.p2.1.3.w4">differs</span><span> </span><span class="gd_word" id="S2.p2.1.3.w5">from</span><span> </span><span class="gd_word" id="S2.p2.1.3.w6">them</span><span> </span><span class="gd_word" id="S2.p2.1.3.w7">in</span><span> </span><span class="gd_word" id="S2.p2.1.3.w8">that</span><span> </span><span class="gd_word" id="S2.p2.1.3.w9">it</span><span> </span><span class="gd_word" id="S2.p2.1.3.w10">leverages</span><span> </span><span class="gd_word" id="S2.p2.1.3.w11">the</span><span> </span><span class="gd_word" id="S2.p2.1.3.w12">attention</span><span> </span><span class="gd_word" id="S2.p2.1.3.w13">mechanism</span><span> </span><span class="gd_word" id="S2.p2.1.3.w14">to</span><span> </span><span class="gd_word" id="S2.p2.1.3.w15">achieve</span><span> </span><span class="gd_word" id="S2.p2.1.3.w16">high</span><span> </span><span class="gd_word" id="S2.p2.1.3.w17">efficiency</span><span> </span><span class="gd_word" id="S2.p2.1.3.w18">and</span><span> </span><span class="gd_word" id="S2.p2.1.3.w19">performance.</span><span> </span><span class="gd_word" id="S2.p2.1.3.w20">Plus,</span><span> </span><span class="gd_word" id="S2.p2.1.3.w21">it</span><span> </span><span class="gd_word" id="S2.p2.1.3.w22">is</span><span> </span><span class="gd_word" id="S2.p2.1.3.w23">applicable</span><span> </span><span class="gd_word" id="S2.p2.1.3.w24">to</span><span> </span><span class="gd_word" id="S2.p2.1.3.w25">self-</span><span> </span><span class="gd_word" id="S2.p2.1.3.w26">and</span><span> </span><span class="gd_word" id="S2.p2.1.3.w27">cross-attention</span><span> </span><span class="gd_word" id="S2.p2.1.3.w28">layers</span><span> </span><span class="gd_word" id="S2.p2.1.3.w29">in</span><span> </span><span class="gd_word" id="S2.p2.1.3.w30">the</span><span> </span><span class="gd_word" id="S2.p2.1.3.w31">Transformer</span><span> </span><span class="gd_word" id="S2.p2.1.3.w32">sequence-to-sequence</span><span> </span><span class="gd_word" id="S2.p2.1.3.w33">(Seq2Seq)</span><span> </span><span class="gd_word" id="S2.p2.1.3.w34">skeleton.</span><span> </span><span class="gd_word" id="S2.p2.1.3.w35">Unlike</span><span> </span><span class="gd_word" id="S2.p2.1.3.w36">previous</span><span> </span><span class="gd_word" id="S2.p2.1.3.w37">methods,</span><span> </span><span class="gd_word" id="S2.p2.1.3.w38">our</span><span> </span><span class="gd_word" id="S2.p2.1.3.w39">model</span><span> </span><span class="gd_word" id="S2.p2.1.3.w40">works</span><span> </span><span class="gd_word" id="S2.p2.1.3.w41">with</span><span> </span><span class="gd_word" id="S2.p2.1.3.w42">multi-sentence</span><span> </span><span class="gd_word" id="S2.p2.1.3.w43">documents</span><span> </span><span class="gd_word" id="S2.p2.1.3.w44">(multi-tree)</span><span> </span><span class="gd_word" id="S2.p2.1.3.w45">seamlessly.</span><span> </span><span class="gd_word" id="S2.p2.1.3.w46">Our</span><span> </span><span class="gd_word" id="S2.p2.1.3.w47">model</span><span> </span><span class="gd_word" id="S2.p2.1.3.w48">also</span><span> </span><span class="gd_word" id="S2.p2.1.3.w49">differs</span><span> </span><span class="gd_word" id="S2.p2.1.3.w50">from</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Strubell et al. (<a href="#bib.bib22" title="" class="ltx_ref">2018</a>); Hao et al. (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>); Harer et al. (<a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p2.1.4.w1"/><span> </span><span class="gd_word" id="S2.p2.1.4.w2">in</span><span> </span><span class="gd_word" id="S2.p2.1.4.w3">that</span><span> </span><span class="gd_word" id="S2.p2.1.4.w4">their</span><span> </span><span class="gd_word" id="S2.p2.1.4.w5">methods</span><span> </span><span class="gd_word" id="S2.p2.1.4.w6">only</span><span> </span><span class="gd_word" id="S2.p2.1.4.w7">use</span><span> </span><span class="gd_word" id="S2.p2.1.4.w8">tree</span><span> </span><span class="gd_word" id="S2.p2.1.4.w9">structures</span><span> </span><span class="gd_word" id="S2.p2.1.4.w10">to</span><span> </span><span class="gd_word" id="S2.p2.1.4.w11">guide</span><span> </span><span class="gd_word" id="S2.p2.1.4.w12">and</span><span> </span><span class="gd_word" id="S2.p2.1.4.w13">mask</span><span> </span><span class="gd_word" id="S2.p2.1.4.w14">token-level</span><span> </span><span class="gd_word" id="S2.p2.1.4.w15">attentions,</span><span> </span><span class="gd_word" id="S2.p2.1.4.w16">while</span><span> </span><span class="gd_word" id="S2.p2.1.4.w17">ours</span><span> </span><span class="gd_word" id="S2.p2.1.4.w18">processes</span><span> </span><span class="gd_word" id="S2.p2.1.4.w19">all</span><span> </span><span class="gd_word" id="S2.p2.1.4.w20">the</span><span> </span><span class="gd_word" id="S2.p2.1.4.w21">nodes</span><span> </span><span class="gd_word" id="S2.p2.1.4.w22">of</span><span> </span><span class="gd_word" id="S2.p2.1.4.w23">the</span><span> </span><span class="gd_word" id="S2.p2.1.4.w24">tree</span><span> </span><span class="gd_word" id="S2.p2.1.4.w25">hierarchically.</span><span> </span><span class="gd_word" id="S2.p2.1.4.w26">In</span><span> </span><span class="gd_word" id="S2.p2.1.4.w27">this</span><span> </span><span class="gd_word" id="S2.p2.1.4.w28">paper,</span><span> </span><span class="gd_word" id="S2.p2.1.4.w29">while</span><span> </span><span class="gd_word" id="S2.p2.1.4.w30">applicable</span><span> </span><span class="gd_word" id="S2.p2.1.4.w31">to</span><span> </span><span class="gd_word" id="S2.p2.1.4.w32">dependency</span><span> </span><span class="gd_word" id="S2.p2.1.4.w33">trees,</span><span> </span><span class="gd_word" id="S2.p2.1.4.w34">our</span><span> </span><span class="gd_word" id="S2.p2.1.4.w35">approach</span><span> </span><span class="gd_word" id="S2.p2.1.4.w36">focused</span><span> </span><span class="gd_word" id="S2.p2.1.4.w37">primarily</span><span> </span><span class="gd_word" id="S2.p2.1.4.w38">on</span><span> </span><em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">constituency</em><span class="gd_word" id="S2.p2.1.5.w1"/><span> </span><span class="gd_word" id="S2.p2.1.5.w2">trees</span><span> </span><span class="gd_word" id="S2.p2.1.5.w3">because</span><span> </span><span class="gd_word" id="S2.p2.1.5.w4">(1)</span><span> </span><span class="gd_word" id="S2.p2.1.5.w5">constituency</span><span> </span><span class="gd_word" id="S2.p2.1.5.w6">trees</span><span> </span><span class="gd_word" id="S2.p2.1.5.w7">contain</span><span> </span><span class="gd_word" id="S2.p2.1.5.w8">richer</span><span> </span><span class="gd_word" id="S2.p2.1.5.w9">grammatical</span><span> </span><span class="gd_word" id="S2.p2.1.5.w10">information</span><span> </span><span class="gd_word" id="S2.p2.1.5.w11">in</span><span> </span><span class="gd_word" id="S2.p2.1.5.w12">terms</span><span> </span><span class="gd_word" id="S2.p2.1.5.w13">of</span><span> </span><span class="gd_word" id="S2.p2.1.5.w14">phrase</span><span> </span><span class="gd_word" id="S2.p2.1.5.w15">structure,</span><span> </span><span class="gd_word" id="S2.p2.1.5.w16">and</span><span> </span><span class="gd_word" id="S2.p2.1.5.w17">(2)</span><span> </span><span class="gd_word" id="S2.p2.1.5.w18">there</span><span> </span><span class="gd_word" id="S2.p2.1.5.w19">is</span><span> </span><span class="gd_word" id="S2.p2.1.5.w20">as</span><span> </span><span class="gd_word" id="S2.p2.1.5.w21">yet</span><span> </span><span class="gd_word" id="S2.p2.1.5.w22">no</span><span> </span><span class="gd_word" id="S2.p2.1.5.w23">evidence,</span><span> </span><span class="gd_word" id="S2.p2.1.5.w24">to</span><span> </span><span class="gd_word" id="S2.p2.1.5.w25">the</span><span> </span><span class="gd_word" id="S2.p2.1.5.w26">best</span><span> </span><span class="gd_word" id="S2.p2.1.5.w27">of</span><span> </span><span class="gd_word" id="S2.p2.1.5.w28">our</span><span> </span><span class="gd_word" id="S2.p2.1.5.w29">knowledge,</span><span> </span><span class="gd_word" id="S2.p2.1.5.w30">that</span><span> </span><span class="gd_word" id="S2.p2.1.5.w31">constituency</span><span> </span><span class="gd_word" id="S2.p2.1.5.w32">structures</span><span> </span><span class="gd_word" id="S2.p2.1.5.w33">are</span><span> </span><span class="gd_word" id="S2.p2.1.5.w34">learned</span><span> </span><span class="gd_word" id="S2.p2.1.5.w35">implicitly</span><span> </span><span class="gd_word" id="S2.p2.1.5.w36">in</span><span> </span><span class="gd_word" id="S2.p2.1.5.w37">the</span><span> </span><span class="gd_word" id="S2.p2.1.5.w38">standard</span><span> </span><span class="gd_word" id="S2.p2.1.5.w39">self-supervised</span><span> </span><span class="gd_word" id="S2.p2.1.5.w40">models.</span></p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Background - Transformer Framework</h2>

<div id="S3.p1" class="ltx_para ltx_noindent">
<p id="S3.p1.1" class="ltx_p"><span class="gd_word" id="S3.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="S3.p1.1.1.w2">Transformer</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S3.p1.1.2.w1"/><span> </span><span class="gd_word" id="S3.p1.1.2.w2">is</span><span> </span><span class="gd_word" id="S3.p1.1.2.w3">a</span><span> </span><span class="gd_word" id="S3.p1.1.2.w4">Seq2Seq</span><span> </span><span class="gd_word" id="S3.p1.1.2.w5">network</span><span> </span><span class="gd_word" id="S3.p1.1.2.w6">that</span><span> </span><span class="gd_word" id="S3.p1.1.2.w7">models</span><span> </span><span class="gd_word" id="S3.p1.1.2.w8">sequential</span><span> </span><span class="gd_word" id="S3.p1.1.2.w9">information</span><span> </span><span class="gd_word" id="S3.p1.1.2.w10">using</span><span> </span><span class="gd_word" id="S3.p1.1.2.w11">stacked</span><span> </span><span class="gd_word" id="S3.p1.1.2.w12">self-</span><span> </span><span class="gd_word" id="S3.p1.1.2.w13">and</span><span> </span><span class="gd_word" id="S3.p1.1.2.w14">cross-attention</span><span> </span><span class="gd_word" id="S3.p1.1.2.w15">layers.</span><span> </span><span class="gd_word" id="S3.p1.1.2.w16">The</span><span> </span><span class="gd_word" id="S3.p1.1.2.w17">output</span><span> </span><math id="S3.p1.1.m1.1" class="ltx_Math" alttext="{\bm{O}}" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">𝑶</mi></semantics></math><span class="gd_word" id="S3.p1.1.3.w1"/><span> </span><span class="gd_word" id="S3.p1.1.3.w2">of</span><span> </span><span class="gd_word" id="S3.p1.1.3.w3">each</span><span> </span><span class="gd_word" id="S3.p1.1.3.w4">attention</span><span> </span><span class="gd_word" id="S3.p1.1.3.w5">sub-layer</span><span> </span><span class="gd_word" id="S3.p1.1.3.w6">is</span><span> </span><span class="gd_word" id="S3.p1.1.3.w7">computed</span><span> </span><span class="gd_word" id="S3.p1.1.3.w8">via</span><span> </span><span class="gd_word" id="S3.p1.1.3.w9">scaled</span><span> </span><span class="gd_word" id="S3.p1.1.3.w10">multiplicative</span><span> </span><span class="gd_word" id="S3.p1.1.3.w11">formulations</span><span> </span><span class="gd_word" id="S3.p1.1.3.w12">defined</span><span> </span><span class="gd_word" id="S3.p1.1.3.w13">as:</span></p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.6" class="ltx_Math" alttext="{\bm{A}}=({\bm{Q}}{\bm{W}}^{Q})({\bm{K}}{\bm{W}}^{K})^{T}/\sqrt{d};\hskip 20.0%&#10;pt\text{Att}({\bm{Q}},{\bm{K}},{\bm{V}})=\mathrm{softmax}({\bm{A}})({\bm{V}}{%&#10;\bm{W}}^{V})" display="block"><semantics id="S3.E1.m1.6a"><mrow id="S3.E1.m1.6.6.2" xref="S3.E1.m1.6.6.3.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.4" xref="S3.E1.m1.5.5.1.1.4.cmml">𝑨</mi><mo id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.2.cmml">𝑸</mi><mo id="S3.E1.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.1.1.1.1.3" xref="S3.E1.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S3.E1.m1.5.5.1.1.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.3.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.2.2.1.1" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.2.2.1.1.2" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.2" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.2.cmml">𝑲</mi><mo id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.1" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3.2" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3.3" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.2.2.1.1.3" xref="S3.E1.m1.5.5.1.1.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.5.5.1.1.2.2.2.3" xref="S3.E1.m1.5.5.1.1.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S3.E1.m1.5.5.1.1.2.3" xref="S3.E1.m1.5.5.1.1.2.3.cmml">/</mo><msqrt id="S3.E1.m1.5.5.1.1.2.4" xref="S3.E1.m1.5.5.1.1.2.4.cmml"><mi id="S3.E1.m1.5.5.1.1.2.4.2" xref="S3.E1.m1.5.5.1.1.2.4.2.cmml">d</mi></msqrt></mrow></mrow><mo rspace="22.5pt" id="S3.E1.m1.6.6.2.3" xref="S3.E1.m1.6.6.3a.cmml">;</mo><mrow id="S3.E1.m1.6.6.2.2" xref="S3.E1.m1.6.6.2.2.cmml"><mrow id="S3.E1.m1.6.6.2.2.3" xref="S3.E1.m1.6.6.2.2.3.cmml"><mi id="S3.E1.m1.6.6.2.2.3.2" xref="S3.E1.m1.6.6.2.2.3.2a.cmml">Att</mi><mo id="S3.E1.m1.6.6.2.2.3.1" xref="S3.E1.m1.6.6.2.2.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.2.2.3.3.2" xref="S3.E1.m1.6.6.2.2.3.3.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.3.3.2.1" xref="S3.E1.m1.6.6.2.2.3.3.1.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝑸</mi><mo id="S3.E1.m1.6.6.2.2.3.3.2.2" xref="S3.E1.m1.6.6.2.2.3.3.1.cmml">,</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝑲</mi><mo id="S3.E1.m1.6.6.2.2.3.3.2.3" xref="S3.E1.m1.6.6.2.2.3.3.1.cmml">,</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">𝑽</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.3.3.2.4" xref="S3.E1.m1.6.6.2.2.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.6.6.2.2.2" xref="S3.E1.m1.6.6.2.2.2.cmml">=</mo><mrow id="S3.E1.m1.6.6.2.2.1" xref="S3.E1.m1.6.6.2.2.1.cmml"><mi id="S3.E1.m1.6.6.2.2.1.3" xref="S3.E1.m1.6.6.2.2.1.3.cmml">softmax</mi><mo id="S3.E1.m1.6.6.2.2.1.2" xref="S3.E1.m1.6.6.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.2.2.1.4.2" xref="S3.E1.m1.6.6.2.2.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.1" xref="S3.E1.m1.6.6.2.2.1.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">𝑨</mi><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.4.2.2" xref="S3.E1.m1.6.6.2.2.1.cmml">)</mo></mrow><mo id="S3.E1.m1.6.6.2.2.1.2a" xref="S3.E1.m1.6.6.2.2.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.6.6.2.2.1.1.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.6.6.2.2.1.1.1.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.cmml"><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.2.cmml">𝑽</mi><mo id="S3.E1.m1.6.6.2.2.1.1.1.1.1" xref="S3.E1.m1.6.6.2.2.1.1.1.1.1.cmml">⁢</mo><msup id="S3.E1.m1.6.6.2.2.1.1.1.1.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.cmml"><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.3.2" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S3.E1.m1.6.6.2.2.1.1.1.1.3.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.3.3.cmml">V</mi></msup></mrow><mo stretchy="false" id="S3.E1.m1.6.6.2.2.1.1.1.3" xref="S3.E1.m1.6.6.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr>
</table>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.3" class="ltx_Math" alttext="{\bm{O}}=\text{Att}({\bm{Q}},{\bm{K}},{\bm{V}}){\bm{W}}^{O}" display="block"><semantics id="S3.E2.m1.3a"><mrow id="S3.E2.m1.3.4" xref="S3.E2.m1.3.4.cmml"><mi id="S3.E2.m1.3.4.2" xref="S3.E2.m1.3.4.2.cmml">𝑶</mi><mo id="S3.E2.m1.3.4.1" xref="S3.E2.m1.3.4.1.cmml">=</mo><mrow id="S3.E2.m1.3.4.3" xref="S3.E2.m1.3.4.3.cmml"><mi id="S3.E2.m1.3.4.3.2" xref="S3.E2.m1.3.4.3.2a.cmml">Att</mi><mo id="S3.E2.m1.3.4.3.1" xref="S3.E2.m1.3.4.3.1.cmml">⁢</mo><mrow id="S3.E2.m1.3.4.3.3.2" xref="S3.E2.m1.3.4.3.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.3.4.3.3.2.1" xref="S3.E2.m1.3.4.3.3.1.cmml">(</mo><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">𝑸</mi><mo id="S3.E2.m1.3.4.3.3.2.2" xref="S3.E2.m1.3.4.3.3.1.cmml">,</mo><mi id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml">𝑲</mi><mo id="S3.E2.m1.3.4.3.3.2.3" xref="S3.E2.m1.3.4.3.3.1.cmml">,</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">𝑽</mi><mo stretchy="false" id="S3.E2.m1.3.4.3.3.2.4" xref="S3.E2.m1.3.4.3.3.1.cmml">)</mo></mrow><mo id="S3.E2.m1.3.4.3.1a" xref="S3.E2.m1.3.4.3.1.cmml">⁢</mo><msup id="S3.E2.m1.3.4.3.4" xref="S3.E2.m1.3.4.3.4.cmml"><mi id="S3.E2.m1.3.4.3.4.2" xref="S3.E2.m1.3.4.3.4.2.cmml">𝑾</mi><mi id="S3.E2.m1.3.4.3.4.3" xref="S3.E2.m1.3.4.3.4.3.cmml">O</mi></msup></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr>
</table>
<p id="S3.p1.8" class="ltx_p"><span class="gd_word" id="S3.p1.8.1.w1">where</span><span> </span><math id="S3.p1.2.m1.1" class="ltx_Math" alttext="\mathrm{softmax}" display="inline"><semantics id="S3.p1.2.m1.1a"><mi id="S3.p1.2.m1.1.1" xref="S3.p1.2.m1.1.1.cmml">softmax</mi></semantics></math><span class="gd_word" id="S3.p1.8.2.w1"/><span> </span><span class="gd_word" id="S3.p1.8.2.w2">is</span><span> </span><span class="gd_word" id="S3.p1.8.2.w3">the</span><span> </span><span class="gd_word" id="S3.p1.8.2.w4">softmax</span><span> </span><span class="gd_word" id="S3.p1.8.2.w5">function,</span><span> </span><math id="S3.p1.3.m2.3" class="ltx_Math" alttext="{\bm{Q}}=({\bm{q}}_{1},...,{\bm{q}}_{l_{q}})\in{\mathbb{R}}^{l_{q}\times d}" display="inline"><semantics id="S3.p1.3.m2.3a"><mrow id="S3.p1.3.m2.3.3" xref="S3.p1.3.m2.3.3.cmml"><mi id="S3.p1.3.m2.3.3.4" xref="S3.p1.3.m2.3.3.4.cmml">𝑸</mi><mo id="S3.p1.3.m2.3.3.5" xref="S3.p1.3.m2.3.3.5.cmml">=</mo><mrow id="S3.p1.3.m2.3.3.2.2" xref="S3.p1.3.m2.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.3.m2.3.3.2.2.3" xref="S3.p1.3.m2.3.3.2.3.cmml">(</mo><msub id="S3.p1.3.m2.2.2.1.1.1" xref="S3.p1.3.m2.2.2.1.1.1.cmml"><mi id="S3.p1.3.m2.2.2.1.1.1.2" xref="S3.p1.3.m2.2.2.1.1.1.2.cmml">𝒒</mi><mn id="S3.p1.3.m2.2.2.1.1.1.3" xref="S3.p1.3.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.3.m2.3.3.2.2.4" xref="S3.p1.3.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.3.m2.1.1" xref="S3.p1.3.m2.1.1.cmml">…</mi><mo id="S3.p1.3.m2.3.3.2.2.5" xref="S3.p1.3.m2.3.3.2.3.cmml">,</mo><msub id="S3.p1.3.m2.3.3.2.2.2" xref="S3.p1.3.m2.3.3.2.2.2.cmml"><mi id="S3.p1.3.m2.3.3.2.2.2.2" xref="S3.p1.3.m2.3.3.2.2.2.2.cmml">𝒒</mi><msub id="S3.p1.3.m2.3.3.2.2.2.3" xref="S3.p1.3.m2.3.3.2.2.2.3.cmml"><mi id="S3.p1.3.m2.3.3.2.2.2.3.2" xref="S3.p1.3.m2.3.3.2.2.2.3.2.cmml">l</mi><mi id="S3.p1.3.m2.3.3.2.2.2.3.3" xref="S3.p1.3.m2.3.3.2.2.2.3.3.cmml">q</mi></msub></msub><mo stretchy="false" id="S3.p1.3.m2.3.3.2.2.6" xref="S3.p1.3.m2.3.3.2.3.cmml">)</mo></mrow><mo id="S3.p1.3.m2.3.3.6" xref="S3.p1.3.m2.3.3.6.cmml">∈</mo><msup id="S3.p1.3.m2.3.3.7" xref="S3.p1.3.m2.3.3.7.cmml"><mi id="S3.p1.3.m2.3.3.7.2" xref="S3.p1.3.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p1.3.m2.3.3.7.3" xref="S3.p1.3.m2.3.3.7.3.cmml"><msub id="S3.p1.3.m2.3.3.7.3.2" xref="S3.p1.3.m2.3.3.7.3.2.cmml"><mi id="S3.p1.3.m2.3.3.7.3.2.2" xref="S3.p1.3.m2.3.3.7.3.2.2.cmml">l</mi><mi id="S3.p1.3.m2.3.3.7.3.2.3" xref="S3.p1.3.m2.3.3.7.3.2.3.cmml">q</mi></msub><mo id="S3.p1.3.m2.3.3.7.3.1" xref="S3.p1.3.m2.3.3.7.3.1.cmml">×</mo><mi id="S3.p1.3.m2.3.3.7.3.3" xref="S3.p1.3.m2.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S3.p1.8.3.w1">,</span><span> </span><math id="S3.p1.4.m3.3" class="ltx_Math" alttext="{\bm{K}}=({\bm{k}}_{1},...,{\bm{k}}_{l_{k}})\in{\mathbb{R}}^{l_{k}\times d}" display="inline"><semantics id="S3.p1.4.m3.3a"><mrow id="S3.p1.4.m3.3.3" xref="S3.p1.4.m3.3.3.cmml"><mi id="S3.p1.4.m3.3.3.4" xref="S3.p1.4.m3.3.3.4.cmml">𝑲</mi><mo id="S3.p1.4.m3.3.3.5" xref="S3.p1.4.m3.3.3.5.cmml">=</mo><mrow id="S3.p1.4.m3.3.3.2.2" xref="S3.p1.4.m3.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.4.m3.3.3.2.2.3" xref="S3.p1.4.m3.3.3.2.3.cmml">(</mo><msub id="S3.p1.4.m3.2.2.1.1.1" xref="S3.p1.4.m3.2.2.1.1.1.cmml"><mi id="S3.p1.4.m3.2.2.1.1.1.2" xref="S3.p1.4.m3.2.2.1.1.1.2.cmml">𝒌</mi><mn id="S3.p1.4.m3.2.2.1.1.1.3" xref="S3.p1.4.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.4.m3.3.3.2.2.4" xref="S3.p1.4.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.4.m3.1.1" xref="S3.p1.4.m3.1.1.cmml">…</mi><mo id="S3.p1.4.m3.3.3.2.2.5" xref="S3.p1.4.m3.3.3.2.3.cmml">,</mo><msub id="S3.p1.4.m3.3.3.2.2.2" xref="S3.p1.4.m3.3.3.2.2.2.cmml"><mi id="S3.p1.4.m3.3.3.2.2.2.2" xref="S3.p1.4.m3.3.3.2.2.2.2.cmml">𝒌</mi><msub id="S3.p1.4.m3.3.3.2.2.2.3" xref="S3.p1.4.m3.3.3.2.2.2.3.cmml"><mi id="S3.p1.4.m3.3.3.2.2.2.3.2" xref="S3.p1.4.m3.3.3.2.2.2.3.2.cmml">l</mi><mi id="S3.p1.4.m3.3.3.2.2.2.3.3" xref="S3.p1.4.m3.3.3.2.2.2.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.p1.4.m3.3.3.2.2.6" xref="S3.p1.4.m3.3.3.2.3.cmml">)</mo></mrow><mo id="S3.p1.4.m3.3.3.6" xref="S3.p1.4.m3.3.3.6.cmml">∈</mo><msup id="S3.p1.4.m3.3.3.7" xref="S3.p1.4.m3.3.3.7.cmml"><mi id="S3.p1.4.m3.3.3.7.2" xref="S3.p1.4.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p1.4.m3.3.3.7.3" xref="S3.p1.4.m3.3.3.7.3.cmml"><msub id="S3.p1.4.m3.3.3.7.3.2" xref="S3.p1.4.m3.3.3.7.3.2.cmml"><mi id="S3.p1.4.m3.3.3.7.3.2.2" xref="S3.p1.4.m3.3.3.7.3.2.2.cmml">l</mi><mi id="S3.p1.4.m3.3.3.7.3.2.3" xref="S3.p1.4.m3.3.3.7.3.2.3.cmml">k</mi></msub><mo id="S3.p1.4.m3.3.3.7.3.1" xref="S3.p1.4.m3.3.3.7.3.1.cmml">×</mo><mi id="S3.p1.4.m3.3.3.7.3.3" xref="S3.p1.4.m3.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S3.p1.8.4.w1">,</span><span> </span><math id="S3.p1.5.m4.3" class="ltx_Math" alttext="{\bm{V}}=({\bm{v}}_{1},...,{\bm{v}}_{l_{k}})\in{\mathbb{R}}^{l_{k}\times d}" display="inline"><semantics id="S3.p1.5.m4.3a"><mrow id="S3.p1.5.m4.3.3" xref="S3.p1.5.m4.3.3.cmml"><mi id="S3.p1.5.m4.3.3.4" xref="S3.p1.5.m4.3.3.4.cmml">𝑽</mi><mo id="S3.p1.5.m4.3.3.5" xref="S3.p1.5.m4.3.3.5.cmml">=</mo><mrow id="S3.p1.5.m4.3.3.2.2" xref="S3.p1.5.m4.3.3.2.3.cmml"><mo stretchy="false" id="S3.p1.5.m4.3.3.2.2.3" xref="S3.p1.5.m4.3.3.2.3.cmml">(</mo><msub id="S3.p1.5.m4.2.2.1.1.1" xref="S3.p1.5.m4.2.2.1.1.1.cmml"><mi id="S3.p1.5.m4.2.2.1.1.1.2" xref="S3.p1.5.m4.2.2.1.1.1.2.cmml">𝒗</mi><mn id="S3.p1.5.m4.2.2.1.1.1.3" xref="S3.p1.5.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p1.5.m4.3.3.2.2.4" xref="S3.p1.5.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.p1.5.m4.1.1" xref="S3.p1.5.m4.1.1.cmml">…</mi><mo id="S3.p1.5.m4.3.3.2.2.5" xref="S3.p1.5.m4.3.3.2.3.cmml">,</mo><msub id="S3.p1.5.m4.3.3.2.2.2" xref="S3.p1.5.m4.3.3.2.2.2.cmml"><mi id="S3.p1.5.m4.3.3.2.2.2.2" xref="S3.p1.5.m4.3.3.2.2.2.2.cmml">𝒗</mi><msub id="S3.p1.5.m4.3.3.2.2.2.3" xref="S3.p1.5.m4.3.3.2.2.2.3.cmml"><mi id="S3.p1.5.m4.3.3.2.2.2.3.2" xref="S3.p1.5.m4.3.3.2.2.2.3.2.cmml">l</mi><mi id="S3.p1.5.m4.3.3.2.2.2.3.3" xref="S3.p1.5.m4.3.3.2.2.2.3.3.cmml">k</mi></msub></msub><mo stretchy="false" id="S3.p1.5.m4.3.3.2.2.6" xref="S3.p1.5.m4.3.3.2.3.cmml">)</mo></mrow><mo id="S3.p1.5.m4.3.3.6" xref="S3.p1.5.m4.3.3.6.cmml">∈</mo><msup id="S3.p1.5.m4.3.3.7" xref="S3.p1.5.m4.3.3.7.cmml"><mi id="S3.p1.5.m4.3.3.7.2" xref="S3.p1.5.m4.3.3.7.2.cmml">ℝ</mi><mrow id="S3.p1.5.m4.3.3.7.3" xref="S3.p1.5.m4.3.3.7.3.cmml"><msub id="S3.p1.5.m4.3.3.7.3.2" xref="S3.p1.5.m4.3.3.7.3.2.cmml"><mi id="S3.p1.5.m4.3.3.7.3.2.2" xref="S3.p1.5.m4.3.3.7.3.2.2.cmml">l</mi><mi id="S3.p1.5.m4.3.3.7.3.2.3" xref="S3.p1.5.m4.3.3.7.3.2.3.cmml">k</mi></msub><mo id="S3.p1.5.m4.3.3.7.3.1" xref="S3.p1.5.m4.3.3.7.3.1.cmml">×</mo><mi id="S3.p1.5.m4.3.3.7.3.3" xref="S3.p1.5.m4.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S3.p1.8.5.w1"/><span> </span><span class="gd_word" id="S3.p1.8.5.w2">are</span><span> </span><span class="gd_word" id="S3.p1.8.5.w3">matrices</span><span> </span><span class="gd_word" id="S3.p1.8.5.w4">of</span><span> </span><span class="gd_word" id="S3.p1.8.5.w5">query,</span><span> </span><span class="gd_word" id="S3.p1.8.5.w6">key</span><span> </span><span class="gd_word" id="S3.p1.8.5.w7">and</span><span> </span><span class="gd_word" id="S3.p1.8.5.w8">value</span><span> </span><span class="gd_word" id="S3.p1.8.5.w9">vectors</span><span> </span><span class="gd_word" id="S3.p1.8.5.w10">respectively,</span><span> </span><span class="gd_word" id="S3.p1.8.5.w11">and</span><span> </span><math id="S3.p1.6.m5.4" class="ltx_Math" alttext="{\bm{W}}^{Q},{\bm{W}}^{K},{\bm{W}}^{V},{\bm{W}}^{O}\in{\mathbb{R}}^{d\times d}" display="inline"><semantics id="S3.p1.6.m5.4a"><mrow id="S3.p1.6.m5.4.4" xref="S3.p1.6.m5.4.4.cmml"><mrow id="S3.p1.6.m5.4.4.4.4" xref="S3.p1.6.m5.4.4.4.5.cmml"><msup id="S3.p1.6.m5.1.1.1.1.1" xref="S3.p1.6.m5.1.1.1.1.1.cmml"><mi id="S3.p1.6.m5.1.1.1.1.1.2" xref="S3.p1.6.m5.1.1.1.1.1.2.cmml">𝑾</mi><mi id="S3.p1.6.m5.1.1.1.1.1.3" xref="S3.p1.6.m5.1.1.1.1.1.3.cmml">Q</mi></msup><mo id="S3.p1.6.m5.4.4.4.4.5" xref="S3.p1.6.m5.4.4.4.5.cmml">,</mo><msup id="S3.p1.6.m5.2.2.2.2.2" xref="S3.p1.6.m5.2.2.2.2.2.cmml"><mi id="S3.p1.6.m5.2.2.2.2.2.2" xref="S3.p1.6.m5.2.2.2.2.2.2.cmml">𝑾</mi><mi id="S3.p1.6.m5.2.2.2.2.2.3" xref="S3.p1.6.m5.2.2.2.2.2.3.cmml">K</mi></msup><mo id="S3.p1.6.m5.4.4.4.4.6" xref="S3.p1.6.m5.4.4.4.5.cmml">,</mo><msup id="S3.p1.6.m5.3.3.3.3.3" xref="S3.p1.6.m5.3.3.3.3.3.cmml"><mi id="S3.p1.6.m5.3.3.3.3.3.2" xref="S3.p1.6.m5.3.3.3.3.3.2.cmml">𝑾</mi><mi id="S3.p1.6.m5.3.3.3.3.3.3" xref="S3.p1.6.m5.3.3.3.3.3.3.cmml">V</mi></msup><mo id="S3.p1.6.m5.4.4.4.4.7" xref="S3.p1.6.m5.4.4.4.5.cmml">,</mo><msup id="S3.p1.6.m5.4.4.4.4.4" xref="S3.p1.6.m5.4.4.4.4.4.cmml"><mi id="S3.p1.6.m5.4.4.4.4.4.2" xref="S3.p1.6.m5.4.4.4.4.4.2.cmml">𝑾</mi><mi id="S3.p1.6.m5.4.4.4.4.4.3" xref="S3.p1.6.m5.4.4.4.4.4.3.cmml">O</mi></msup></mrow><mo id="S3.p1.6.m5.4.4.5" xref="S3.p1.6.m5.4.4.5.cmml">∈</mo><msup id="S3.p1.6.m5.4.4.6" xref="S3.p1.6.m5.4.4.6.cmml"><mi id="S3.p1.6.m5.4.4.6.2" xref="S3.p1.6.m5.4.4.6.2.cmml">ℝ</mi><mrow id="S3.p1.6.m5.4.4.6.3" xref="S3.p1.6.m5.4.4.6.3.cmml"><mi id="S3.p1.6.m5.4.4.6.3.2" xref="S3.p1.6.m5.4.4.6.3.2.cmml">d</mi><mo id="S3.p1.6.m5.4.4.6.3.1" xref="S3.p1.6.m5.4.4.6.3.1.cmml">×</mo><mi id="S3.p1.6.m5.4.4.6.3.3" xref="S3.p1.6.m5.4.4.6.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S3.p1.8.6.w1"/><span> </span><span class="gd_word" id="S3.p1.8.6.w2">are</span><span> </span><span class="gd_word" id="S3.p1.8.6.w3">the</span><span> </span><span class="gd_word" id="S3.p1.8.6.w4">associated</span><span> </span><span class="gd_word" id="S3.p1.8.6.w5">trainable</span><span> </span><span class="gd_word" id="S3.p1.8.6.w6">weight</span><span> </span><span class="gd_word" id="S3.p1.8.6.w7">matrices.</span><span> </span><math id="S3.p1.7.m6.1" class="ltx_Math" alttext="{\bm{A}}" display="inline"><semantics id="S3.p1.7.m6.1a"><mi id="S3.p1.7.m6.1.1" xref="S3.p1.7.m6.1.1.cmml">𝑨</mi></semantics></math><span class="gd_word" id="S3.p1.8.7.w1"/><span> </span><span class="gd_word" id="S3.p1.8.7.w2">denotes</span><span> </span><span class="gd_word" id="S3.p1.8.7.w3">the</span><span> </span><span class="gd_word" id="S3.p1.8.7.w4">affinity</span><span> </span><span class="gd_word" id="S3.p1.8.7.w5">scores</span><span> </span><span class="gd_word" id="S3.p1.8.7.w6">(attention</span><span> </span><span class="gd_word" id="S3.p1.8.7.w7">scores)</span><span> </span><span class="gd_word" id="S3.p1.8.7.w8">between</span><span> </span><span class="gd_word" id="S3.p1.8.7.w9">queries</span><span> </span><span class="gd_word" id="S3.p1.8.7.w10">and</span><span> </span><span class="gd_word" id="S3.p1.8.7.w11">keys,</span><span> </span><span class="gd_word" id="S3.p1.8.7.w12">while</span><span> </span><math id="S3.p1.8.m7.3" class="ltx_Math" alttext="\text{Att}({\bm{Q}},{\bm{K}},{\bm{V}})" display="inline"><semantics id="S3.p1.8.m7.3a"><mrow id="S3.p1.8.m7.3.4" xref="S3.p1.8.m7.3.4.cmml"><mi id="S3.p1.8.m7.3.4.2" xref="S3.p1.8.m7.3.4.2a.cmml">Att</mi><mo id="S3.p1.8.m7.3.4.1" xref="S3.p1.8.m7.3.4.1.cmml">⁢</mo><mrow id="S3.p1.8.m7.3.4.3.2" xref="S3.p1.8.m7.3.4.3.1.cmml"><mo stretchy="false" id="S3.p1.8.m7.3.4.3.2.1" xref="S3.p1.8.m7.3.4.3.1.cmml">(</mo><mi id="S3.p1.8.m7.1.1" xref="S3.p1.8.m7.1.1.cmml">𝑸</mi><mo id="S3.p1.8.m7.3.4.3.2.2" xref="S3.p1.8.m7.3.4.3.1.cmml">,</mo><mi id="S3.p1.8.m7.2.2" xref="S3.p1.8.m7.2.2.cmml">𝑲</mi><mo id="S3.p1.8.m7.3.4.3.2.3" xref="S3.p1.8.m7.3.4.3.1.cmml">,</mo><mi id="S3.p1.8.m7.3.3" xref="S3.p1.8.m7.3.3.cmml">𝑽</mi><mo stretchy="false" id="S3.p1.8.m7.3.4.3.2.4" xref="S3.p1.8.m7.3.4.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S3.p1.8.8.w1"/><span> </span><span class="gd_word" id="S3.p1.8.8.w2">are</span><span> </span><span class="gd_word" id="S3.p1.8.8.w3">the</span><span> </span><span class="gd_word" id="S3.p1.8.8.w4">attention</span><span> </span><span class="gd_word" id="S3.p1.8.8.w5">vectors.</span><span> </span><span class="gd_word" id="S3.p1.8.8.w6">Then,</span><span> </span><span class="gd_word" id="S3.p1.8.8.w7">the</span><span> </span><span class="gd_word" id="S3.p1.8.8.w8">final</span><span> </span><span class="gd_word" id="S3.p1.8.8.w9">output</span><span> </span><span class="gd_word" id="S3.p1.8.8.w10">of</span><span> </span><span class="gd_word" id="S3.p1.8.8.w11">a</span><span> </span><span class="gd_word" id="S3.p1.8.8.w12">Transformer</span><span> </span><span class="gd_word" id="S3.p1.8.8.w13">layer</span><span> </span><span class="gd_word" id="S3.p1.8.8.w14">is</span><span> </span><span class="gd_word" id="S3.p1.8.8.w15">computed</span><span> </span><span class="gd_word" id="S3.p1.8.8.w16">as:</span></p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.3" class="ltx_Math" alttext="\phi({\bm{A}},{\bm{Q}})=\text{LN}(\text{FFN}(\text{LN}({\bm{O}}+{\bm{Q}}))+%&#10;\text{LN}({\bm{O}}+{\bm{Q}}))" display="block"><semantics id="S3.E3.m1.3a"><mrow id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml"><mrow id="S3.E3.m1.3.3.3" xref="S3.E3.m1.3.3.3.cmml"><mi id="S3.E3.m1.3.3.3.2" xref="S3.E3.m1.3.3.3.2.cmml">ϕ</mi><mo id="S3.E3.m1.3.3.3.1" xref="S3.E3.m1.3.3.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.3.3.2" xref="S3.E3.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.3.3.2.1" xref="S3.E3.m1.3.3.3.3.1.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">𝑨</mi><mo id="S3.E3.m1.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.1.cmml">,</mo><mi id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml">𝑸</mi><mo stretchy="false" id="S3.E3.m1.3.3.3.3.2.3" xref="S3.E3.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.2" xref="S3.E3.m1.3.3.2.cmml">=</mo><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.cmml"><mi id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.3.3.1.3a.cmml">LN</mi><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3a.cmml">FFN</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.3a.cmml">LN</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑶</mi><mo id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝑸</mi></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.3.cmml">+</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.2.3" xref="S3.E3.m1.3.3.1.1.1.1.2.3a.cmml">LN</mi><mo id="S3.E3.m1.3.3.1.1.1.1.2.2" xref="S3.E3.m1.3.3.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.2.1.1" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.2.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.3.3.1.1.1.1.2.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.2.cmml">𝑶</mi><mo id="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.1.cmml">+</mo><mi id="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.3.cmml">𝑸</mi></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.1.2.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E3.m1.3.3.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr>
</table>
<p id="S3.p1.11" class="ltx_p"><span class="gd_word" id="S3.p1.11.1.w1">where</span><span> </span><math id="S3.p1.9.m1.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S3.p1.9.m1.1a"><mi id="S3.p1.9.m1.1.1" xref="S3.p1.9.m1.1.1.cmml">ϕ</mi></semantics></math><span class="gd_word" id="S3.p1.11.2.w1"/><span> </span><span class="gd_word" id="S3.p1.11.2.w2">represents</span><span> </span><span class="gd_word" id="S3.p1.11.2.w3">the</span><span> </span><span class="gd_word" id="S3.p1.11.2.w4">typical</span><span> </span><span class="gd_word" id="S3.p1.11.2.w5">serial</span><span> </span><span class="gd_word" id="S3.p1.11.2.w6">computations</span><span> </span><span class="gd_word" id="S3.p1.11.2.w7">of</span><span> </span><span class="gd_word" id="S3.p1.11.2.w8">a</span><span> </span><span class="gd_word" id="S3.p1.11.2.w9">Transformer</span><span> </span><span class="gd_word" id="S3.p1.11.2.w10">layer</span><span> </span><span class="gd_word" id="S3.p1.11.2.w11">with</span><span> </span><span class="gd_word" id="S3.p1.11.2.w12">layer</span><span> </span><span class="gd_word" id="S3.p1.11.2.w13">normalization</span><span> </span><span class="gd_word" id="S3.p1.11.2.w14">(LN)</span><span> </span><span class="gd_word" id="S3.p1.11.2.w15">and</span><span> </span><span class="gd_word" id="S3.p1.11.2.w16">feed-forward</span><span> </span><span class="gd_word" id="S3.p1.11.2.w17">(FFN)</span><span> </span><span class="gd_word" id="S3.p1.11.2.w18">layers.
For</span><span> </span><span class="gd_word" id="S3.p1.11.2.w19">simplicity,</span><span> </span><span class="gd_word" id="S3.p1.11.2.w20">we</span><span> </span><span class="gd_word" id="S3.p1.11.2.w21">omit</span><span> </span><span class="gd_word" id="S3.p1.11.2.w22">the</span><span> </span><span class="gd_word" id="S3.p1.11.2.w23">multi-head</span><span> </span><span class="gd_word" id="S3.p1.11.2.w24">structure</span><span> </span><span class="gd_word" id="S3.p1.11.2.w25">and</span><span> </span><span class="gd_word" id="S3.p1.11.2.w26">other</span><span> </span><span class="gd_word" id="S3.p1.11.2.w27">details</span><span> </span><span class="gd_word" id="S3.p1.11.2.w28">and</span><span> </span><span class="gd_word" id="S3.p1.11.2.w29">refer</span><span> </span><span class="gd_word" id="S3.p1.11.2.w30">the</span><span> </span><span class="gd_word" id="S3.p1.11.2.w31">reader</span><span> </span><span class="gd_word" id="S3.p1.11.2.w32">to</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">Vaswani et al. (<a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S3.p1.11.3.w1"/><span> </span><span class="gd_word" id="S3.p1.11.3.w2">for</span><span> </span><span class="gd_word" id="S3.p1.11.3.w3">a</span><span> </span><span class="gd_word" id="S3.p1.11.3.w4">complete</span><span> </span><span class="gd_word" id="S3.p1.11.3.w5">description.</span></p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Tree-based Attention</h2>

<figure id="S4.F1" class="ltx_figure"><img src="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/accum-symbol.png" id="S4.F1.g1" class="ltx_graphics ltx_centering" width="" height="" alt="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/accum-symbol.png"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="gd_word" id="S4.F1.2.w1">The</span><span> </span><span class="gd_word" id="S4.F1.2.w2">hierarchical</span><span> </span><span class="gd_word" id="S4.F1.2.w3">accumulation</span><span> </span><span class="gd_word" id="S4.F1.2.w4">process</span><span> </span><span class="gd_word" id="S4.F1.2.w5">of</span><span> </span><span class="gd_word" id="S4.F1.2.w6">tree</span><span> </span><span class="gd_word" id="S4.F1.2.w7">structures</span><span> </span><span class="gd_word" id="S4.F1.2.w8">(best</span><span> </span><span class="gd_word" id="S4.F1.2.w9">seen</span><span> </span><span class="gd_word" id="S4.F1.2.w10">in</span><span> </span><span class="gd_word" id="S4.F1.2.w11">colors).</span><span> </span><span class="gd_word" id="S4.F1.2.w12">Given</span><span> </span><span class="gd_word" id="S4.F1.2.w13">a</span><span> </span><span class="gd_word" id="S4.F1.2.w14">parse</span><span> </span><span class="gd_word" id="S4.F1.2.w15">tree,</span><span> </span><span class="gd_word" id="S4.F1.2.w16">it</span><span> </span><span class="gd_word" id="S4.F1.2.w17">is</span><span> </span><span class="gd_word" id="S4.F1.2.w18">interpolated</span><span> </span><span class="gd_word" id="S4.F1.2.w19">into</span><span> </span><span class="gd_word" id="S4.F1.2.w20">a</span><span> </span><span class="gd_word" id="S4.F1.2.w21">tensor</span><span> </span><math id="S4.F1.5.m1.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.F1.5.m1.1b"><mi id="S4.F1.5.m1.1.1" xref="S4.F1.5.m1.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.F1.3.w1">,</span><span> </span><span class="gd_word" id="S4.F1.3.w2">which</span><span> </span><span class="gd_word" id="S4.F1.3.w3">is</span><span> </span><span class="gd_word" id="S4.F1.3.w4">then</span><span> </span><span class="gd_word" id="S4.F1.3.w5">accumulated</span><span> </span><span class="gd_word" id="S4.F1.3.w6">vertically</span><span> </span><span class="gd_word" id="S4.F1.3.w7">from</span><span> </span><span class="gd_word" id="S4.F1.3.w8">bottom</span><span> </span><span class="gd_word" id="S4.F1.3.w9">to</span><span> </span><span class="gd_word" id="S4.F1.3.w10">top</span><span> </span><span class="gd_word" id="S4.F1.3.w11">to</span><span> </span><span class="gd_word" id="S4.F1.3.w12">produce</span><span> </span><math id="S4.F1.6.m2.1" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}" display="inline"><semantics id="S4.F1.6.m2.1b"><mover accent="true" id="S4.F1.6.m2.1.1" xref="S4.F1.6.m2.1.1.cmml"><mi id="S4.F1.6.m2.1.1.2" xref="S4.F1.6.m2.1.1.2.cmml">𝑺</mi><mo stretchy="false" id="S4.F1.6.m2.1.1.1" xref="S4.F1.6.m2.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.F1.4.w1">.</span><span> </span><span class="gd_word" id="S4.F1.4.w2">Next,</span><span> </span><span class="gd_word" id="S4.F1.4.w3">the</span><span> </span><span class="gd_word" id="S4.F1.4.w4">(branch-level)</span><span> </span><span class="gd_word" id="S4.F1.4.w5">component</span><span> </span><span class="gd_word" id="S4.F1.4.w6">representations</span><span> </span><span class="gd_word" id="S4.F1.4.w7">of</span><span> </span><span class="gd_word" id="S4.F1.4.w8">the</span><span> </span><span class="gd_word" id="S4.F1.4.w9">nonterminal</span><span> </span><span class="gd_word" id="S4.F1.4.w10">nodes</span><span> </span><span class="gd_word" id="S4.F1.4.w11">are</span><span> </span><span class="gd_word" id="S4.F1.4.w12">combined</span><span> </span><span class="gd_word" id="S4.F1.4.w13">into</span><span> </span><span class="gd_word" id="S4.F1.4.w14">one</span><span> </span><span class="gd_word" id="S4.F1.4.w15">representation</span><span> </span><span class="gd_word" id="S4.F1.4.w16">as</span><span> </span><math id="S4.F1.7.m3.1" class="ltx_Math" alttext="\overline{{\bm{N}}}" display="inline"><semantics id="S4.F1.7.m3.1b"><mover accent="true" id="S4.F1.7.m3.1.1" xref="S4.F1.7.m3.1.1.cmml"><mi id="S4.F1.7.m3.1.1.2" xref="S4.F1.7.m3.1.1.2.cmml">𝑵</mi><mo id="S4.F1.7.m3.1.1.1" xref="S4.F1.7.m3.1.1.1.cmml">¯</mo></mover></semantics></math><span class="gd_word" id="S4.F1.5.w1"/><span> </span><span class="gd_word" id="S4.F1.5.w2">by</span><span> </span><span class="gd_word" id="S4.F1.5.w3">weighted</span><span> </span><span class="gd_word" id="S4.F1.5.w4">aggregation.</span><span> </span><span class="gd_word" id="S4.F1.5.w5">Multi-colored</span><span> </span><span class="gd_word" id="S4.F1.5.w6">blocks</span><span> </span><span class="gd_word" id="S4.F1.5.w7">indicate</span><span> </span><span class="gd_word" id="S4.F1.5.w8">accumulation</span><span> </span><span class="gd_word" id="S4.F1.5.w9">of</span><span> </span><span class="gd_word" id="S4.F1.5.w10">nodes</span><span> </span><span class="gd_word" id="S4.F1.5.w11">of</span><span> </span><span class="gd_word" id="S4.F1.5.w12">respective</span><span> </span><span class="gd_word" id="S4.F1.5.w13">colors.</span><span> </span><span class="gd_word" id="S4.F1.5.w14">The</span><span> </span><span class="gd_word" id="S4.F1.5.w15">rows</span><span> </span><span class="gd_word" id="S4.F1.5.w16">of</span><span> </span><math id="S4.F1.8.m4.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.F1.8.m4.1b"><mi id="S4.F1.8.m4.1.1" xref="S4.F1.8.m4.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.F1.6.w1"/><span> </span><span class="gd_word" id="S4.F1.6.w2">in</span><span> </span><span class="gd_word" id="S4.F1.6.w3">Eq.</span><span> </span><a href="#S4.E5" title="(5) ‣ 4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">5</a><span class="gd_word" id="S4.F1.7.w1"/><span> </span><span class="gd_word" id="S4.F1.7.w2">are</span><span> </span><span class="gd_word" id="S4.F1.7.w3">counted</span><span> </span><span class="gd_word" id="S4.F1.7.w4">from</span><span> </span><span class="gd_word" id="S4.F1.7.w5">the</span><span> </span><span class="gd_word" id="S4.F1.7.w6">bottom.</span></figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Encoding Trees with Hierarchical Accumulations</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.20" class="ltx_p"><span class="gd_word" id="S4.SS1.p1.20.1.w1">To</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w2">encode</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w3">hierarchical</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w4">structures</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w5">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w6">parallel,</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w7">we</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w8">need</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w9">to</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w10">represent</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w11">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w12">tree</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w13">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w14">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w15">data</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w16">structure</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w17">that</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w18">can</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w19">be</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w20">parallellized.</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w21">Given</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w22">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.1.w23">sentence</span><span> </span><math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.2.w2">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.2.w3">length</span><span> </span><math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><mi id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.3.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.3.w2">let</span><span> </span><math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><mrow id="S4.SS1.p1.3.m3.1.2" xref="S4.SS1.p1.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.3.m3.1.2.2" xref="S4.SS1.p1.3.m3.1.2.2.cmml">𝒢</mi><mo id="S4.SS1.p1.3.m3.1.2.1" xref="S4.SS1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.3.m3.1.2.3.2" xref="S4.SS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.3.m3.1.2.3.2.1" xref="S4.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p1.3.m3.1.2.3.2.2" xref="S4.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w2">be</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w4">directed</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w5">spanning</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w6">tree</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w7">which</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w8">represents</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w9">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w10">parse</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w11">tree</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.4.w12">of</span><span> </span><math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.5.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w2">produced</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w3">by</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w4">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w5">parser.
We</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w6">define</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w7">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.5.w8">transformation</span><span> </span><math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">ℋ</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.6.w2">such</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.6.w3">that</span><span> </span><math id="S4.SS1.p1.6.m6.6" class="ltx_Math" alttext="\mathcal{H}(\mathcal{G}(X))=\mathcal{T}(X)\overset{\Delta}{=}(\mathcal{L},%&#10;\mathcal{N},\mathcal{R})" display="inline"><semantics id="S4.SS1.p1.6.m6.6a"><mrow id="S4.SS1.p1.6.m6.6.6" xref="S4.SS1.p1.6.m6.6.6.cmml"><mrow id="S4.SS1.p1.6.m6.6.6.1" xref="S4.SS1.p1.6.m6.6.6.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.6.6.1.3" xref="S4.SS1.p1.6.m6.6.6.1.3.cmml">ℋ</mi><mo id="S4.SS1.p1.6.m6.6.6.1.2" xref="S4.SS1.p1.6.m6.6.6.1.2.cmml">⁢</mo><mrow id="S4.SS1.p1.6.m6.6.6.1.1.1" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.1.1.1.2" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p1.6.m6.6.6.1.1.1.1" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.6.6.1.1.1.1.2" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.2.cmml">𝒢</mi><mo id="S4.SS1.p1.6.m6.6.6.1.1.1.1.1" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS1.p1.6.m6.6.6.1.1.1.1.3.2" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.1.1.1.1.3.2.1" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml">(</mo><mi id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.1.1.1.1.3.2.2" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.1.1.1.3" xref="S4.SS1.p1.6.m6.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.6.m6.6.6.2" xref="S4.SS1.p1.6.m6.6.6.2.cmml">=</mo><mrow id="S4.SS1.p1.6.m6.6.6.3" xref="S4.SS1.p1.6.m6.6.6.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.6.6.3.2" xref="S4.SS1.p1.6.m6.6.6.3.2.cmml">𝒯</mi><mo id="S4.SS1.p1.6.m6.6.6.3.1" xref="S4.SS1.p1.6.m6.6.6.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.6.m6.6.6.3.3.2" xref="S4.SS1.p1.6.m6.6.6.3.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.3.3.2.1" xref="S4.SS1.p1.6.m6.6.6.3.cmml">(</mo><mi id="S4.SS1.p1.6.m6.2.2" xref="S4.SS1.p1.6.m6.2.2.cmml">X</mi><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.3.3.2.2" xref="S4.SS1.p1.6.m6.6.6.3.cmml">)</mo></mrow><mo id="S4.SS1.p1.6.m6.6.6.3.1a" xref="S4.SS1.p1.6.m6.6.6.3.1.cmml">⁢</mo><mover accent="true" id="S4.SS1.p1.6.m6.6.6.3.4" xref="S4.SS1.p1.6.m6.6.6.3.4.cmml"><mo id="S4.SS1.p1.6.m6.6.6.3.4.2" xref="S4.SS1.p1.6.m6.6.6.3.4.2.cmml">=</mo><mo id="S4.SS1.p1.6.m6.6.6.3.4.1" xref="S4.SS1.p1.6.m6.6.6.3.4.1.cmml">Δ</mo></mover><mo id="S4.SS1.p1.6.m6.6.6.3.1b" xref="S4.SS1.p1.6.m6.6.6.3.1.cmml">⁢</mo><mrow id="S4.SS1.p1.6.m6.6.6.3.5.2" xref="S4.SS1.p1.6.m6.6.6.3.5.1.cmml"><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.3.5.2.1" xref="S4.SS1.p1.6.m6.6.6.3.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.3.3" xref="S4.SS1.p1.6.m6.3.3.cmml">ℒ</mi><mo id="S4.SS1.p1.6.m6.6.6.3.5.2.2" xref="S4.SS1.p1.6.m6.6.6.3.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.4.4" xref="S4.SS1.p1.6.m6.4.4.cmml">𝒩</mi><mo id="S4.SS1.p1.6.m6.6.6.3.5.2.3" xref="S4.SS1.p1.6.m6.6.6.3.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.6.m6.5.5" xref="S4.SS1.p1.6.m6.5.5.cmml">ℛ</mi><mo stretchy="false" id="S4.SS1.p1.6.m6.6.6.3.5.2.4" xref="S4.SS1.p1.6.m6.6.6.3.5.1.cmml">)</mo></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.7.w1">.
In</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.7.w2">this</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.7.w3">formulation,</span><span> </span><math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">ℒ</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.8.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.8.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.8.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.8.w4">ordered</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.8.w5">sequence</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.8.w6">of</span><span> </span><math id="S4.SS1.p1.8.m8.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS1.p1.8.m8.1a"><mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.9.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w2">terminal</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w3">nodes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w4">(or</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w5">leaves)</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w6">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w8">tree</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.9.w9">(i.e.,</span><span> </span><math id="S4.SS1.p1.9.m9.1" class="ltx_Math" alttext="\mathcal{L}=X" display="inline"><semantics id="S4.SS1.p1.9.m9.1a"><mrow id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.9.m9.1.1.2" xref="S4.SS1.p1.9.m9.1.1.2.cmml">ℒ</mi><mo id="S4.SS1.p1.9.m9.1.1.1" xref="S4.SS1.p1.9.m9.1.1.1.cmml">=</mo><mi id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">X</mi></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.10.w1">),</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.10.w2">and</span><span> </span><math id="S4.SS1.p1.10.m10.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S4.SS1.p1.10.m10.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m10.1.1" xref="S4.SS1.p1.10.m10.1.1.cmml">𝒩</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.11.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.11.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.11.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.11.w4">set</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.11.w5">of</span><span> </span><math id="S4.SS1.p1.11.m11.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.SS1.p1.11.m11.1a"><mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">m</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.12.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w2">nonterminal</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w3">nodes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w4">(or</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w5">simply</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w6">nodes),</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w7">each</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w8">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w9">which</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w10">has</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w11">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w12">phrase</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w13">label</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w14">(e.g.,</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w15">NP,</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w16">VP)</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w17">and</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w18">spans</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w19">over</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w20">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w21">sequence</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w22">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w23">terminal</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.12.w24">nodes.</span><span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="gd_word" id="footnote2.3.w1">We</span><span> </span><span class="gd_word" id="footnote2.3.w2">omit</span><span> </span><span class="gd_word" id="footnote2.3.w3">the</span><span> </span><span class="gd_word" id="footnote2.3.w4">part-of-speech</span><span> </span><span class="gd_word" id="footnote2.3.w5">tags</span><span> </span><span class="gd_word" id="footnote2.3.w6">of</span><span> </span><span class="gd_word" id="footnote2.3.w7">the</span><span> </span><span class="gd_word" id="footnote2.3.w8">words</span><span> </span><span class="gd_word" id="footnote2.3.w9">which</span><span> </span><span class="gd_word" id="footnote2.3.w10">constitute</span><span> </span><span class="gd_word" id="footnote2.3.w11">the</span><span> </span><span class="gd_word" id="footnote2.3.w12">preterminal</span><span> </span><span class="gd_word" id="footnote2.3.w13">nodes</span><span> </span><span class="gd_word" id="footnote2.3.w14">in</span><span> </span><span class="gd_word" id="footnote2.3.w15">a</span><span> </span><span class="gd_word" id="footnote2.3.w16">constituency</span><span> </span><span class="gd_word" id="footnote2.3.w17">tree.</span></span></span></span><span class="gd_word" id="S4.SS1.p1.20.13.w1">
</span><math id="S4.SS1.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS1.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">ℛ</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.14.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w2">contains</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w4">set</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w5">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w6">rules</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w7">indexed</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w8">by</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w9">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w10">nonterminal</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w11">nodes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.14.w12">in</span><span> </span><math id="S4.SS1.p1.13.m13.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S4.SS1.p1.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">𝒩</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.15.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.15.w2">such</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.15.w3">that</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.15.w4">for</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.15.w5">each</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.15.w6">node</span><span> </span><math id="S4.SS1.p1.14.m14.1" class="ltx_Math" alttext="x\in\mathcal{N}" display="inline"><semantics id="S4.SS1.p1.14.m14.1a"><mrow id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml"><mi id="S4.SS1.p1.14.m14.1.1.2" xref="S4.SS1.p1.14.m14.1.1.2.cmml">x</mi><mo id="S4.SS1.p1.14.m14.1.1.1" xref="S4.SS1.p1.14.m14.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.14.m14.1.1.3" xref="S4.SS1.p1.14.m14.1.1.3.cmml">𝒩</mi></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.16.w1">,</span><span> </span><math id="S4.SS1.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{R}(x)" display="inline"><semantics id="S4.SS1.p1.15.m15.1a"><mrow id="S4.SS1.p1.15.m15.1.2" xref="S4.SS1.p1.15.m15.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.15.m15.1.2.2" xref="S4.SS1.p1.15.m15.1.2.2.cmml">ℛ</mi><mo id="S4.SS1.p1.15.m15.1.2.1" xref="S4.SS1.p1.15.m15.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.15.m15.1.2.3.2" xref="S4.SS1.p1.15.m15.1.2.cmml"><mo stretchy="false" id="S4.SS1.p1.15.m15.1.2.3.2.1" xref="S4.SS1.p1.15.m15.1.2.cmml">(</mo><mi id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.p1.15.m15.1.2.3.2.2" xref="S4.SS1.p1.15.m15.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.17.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w4">set</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w5">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w6">all</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w7">nodes</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w8">that</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w9">belong</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w10">to</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w11">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w12">subtree</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w13">rooted</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.17.w14">at</span><span> </span><math id="S4.SS1.p1.16.m16.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.SS1.p1.16.m16.1a"><mi id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.18.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.18.w2">For</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.18.w3">example,</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.18.w4">for</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.18.w5">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.18.w6">nonterminals</span><span> </span><math id="S4.SS1.p1.17.m17.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS1.p1.17.m17.1a"><mi id="S4.SS1.p1.17.m17.1.1" xref="S4.SS1.p1.17.m17.1.1.cmml">g</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.19.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.19.w2">and</span><span> </span><math id="S4.SS1.p1.18.m18.1" class="ltx_Math" alttext="h" display="inline"><semantics id="S4.SS1.p1.18.m18.1a"><mi id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">h</mi></semantics></math><span class="gd_word" id="S4.SS1.p1.20.20.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.20.w2">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.20.20.w3">Figure</span><span> </span><a href="#S4.F1" title="Figure 1 ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S4.SS1.p1.20.21.w1">,</span><span> </span><math id="S4.SS1.p1.19.m19.6" class="ltx_Math" alttext="\mathcal{R}(g)=\{g,c,h,d,e\}" display="inline"><semantics id="S4.SS1.p1.19.m19.6a"><mrow id="S4.SS1.p1.19.m19.6.7" xref="S4.SS1.p1.19.m19.6.7.cmml"><mrow id="S4.SS1.p1.19.m19.6.7.2" xref="S4.SS1.p1.19.m19.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.19.m19.6.7.2.2" xref="S4.SS1.p1.19.m19.6.7.2.2.cmml">ℛ</mi><mo id="S4.SS1.p1.19.m19.6.7.2.1" xref="S4.SS1.p1.19.m19.6.7.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.19.m19.6.7.2.3.2" xref="S4.SS1.p1.19.m19.6.7.2.cmml"><mo stretchy="false" id="S4.SS1.p1.19.m19.6.7.2.3.2.1" xref="S4.SS1.p1.19.m19.6.7.2.cmml">(</mo><mi id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml">g</mi><mo stretchy="false" id="S4.SS1.p1.19.m19.6.7.2.3.2.2" xref="S4.SS1.p1.19.m19.6.7.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.19.m19.6.7.1" xref="S4.SS1.p1.19.m19.6.7.1.cmml">=</mo><mrow id="S4.SS1.p1.19.m19.6.7.3.2" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.19.m19.6.7.3.2.1" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">{</mo><mi id="S4.SS1.p1.19.m19.2.2" xref="S4.SS1.p1.19.m19.2.2.cmml">g</mi><mo id="S4.SS1.p1.19.m19.6.7.3.2.2" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">,</mo><mi id="S4.SS1.p1.19.m19.3.3" xref="S4.SS1.p1.19.m19.3.3.cmml">c</mi><mo id="S4.SS1.p1.19.m19.6.7.3.2.3" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">,</mo><mi id="S4.SS1.p1.19.m19.4.4" xref="S4.SS1.p1.19.m19.4.4.cmml">h</mi><mo id="S4.SS1.p1.19.m19.6.7.3.2.4" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">,</mo><mi id="S4.SS1.p1.19.m19.5.5" xref="S4.SS1.p1.19.m19.5.5.cmml">d</mi><mo id="S4.SS1.p1.19.m19.6.7.3.2.5" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">,</mo><mi id="S4.SS1.p1.19.m19.6.6" xref="S4.SS1.p1.19.m19.6.6.cmml">e</mi><mo stretchy="false" id="S4.SS1.p1.19.m19.6.7.3.2.6" xref="S4.SS1.p1.19.m19.6.7.3.1.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.22.w1"/><span> </span><span class="gd_word" id="S4.SS1.p1.20.22.w2">and</span><span> </span><math id="S4.SS1.p1.20.m20.4" class="ltx_Math" alttext="\mathcal{R}(h)=\{h,d,e\}" display="inline"><semantics id="S4.SS1.p1.20.m20.4a"><mrow id="S4.SS1.p1.20.m20.4.5" xref="S4.SS1.p1.20.m20.4.5.cmml"><mrow id="S4.SS1.p1.20.m20.4.5.2" xref="S4.SS1.p1.20.m20.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.20.m20.4.5.2.2" xref="S4.SS1.p1.20.m20.4.5.2.2.cmml">ℛ</mi><mo id="S4.SS1.p1.20.m20.4.5.2.1" xref="S4.SS1.p1.20.m20.4.5.2.1.cmml">⁢</mo><mrow id="S4.SS1.p1.20.m20.4.5.2.3.2" xref="S4.SS1.p1.20.m20.4.5.2.cmml"><mo stretchy="false" id="S4.SS1.p1.20.m20.4.5.2.3.2.1" xref="S4.SS1.p1.20.m20.4.5.2.cmml">(</mo><mi id="S4.SS1.p1.20.m20.1.1" xref="S4.SS1.p1.20.m20.1.1.cmml">h</mi><mo stretchy="false" id="S4.SS1.p1.20.m20.4.5.2.3.2.2" xref="S4.SS1.p1.20.m20.4.5.2.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.20.m20.4.5.1" xref="S4.SS1.p1.20.m20.4.5.1.cmml">=</mo><mrow id="S4.SS1.p1.20.m20.4.5.3.2" xref="S4.SS1.p1.20.m20.4.5.3.1.cmml"><mo stretchy="false" id="S4.SS1.p1.20.m20.4.5.3.2.1" xref="S4.SS1.p1.20.m20.4.5.3.1.cmml">{</mo><mi id="S4.SS1.p1.20.m20.2.2" xref="S4.SS1.p1.20.m20.2.2.cmml">h</mi><mo id="S4.SS1.p1.20.m20.4.5.3.2.2" xref="S4.SS1.p1.20.m20.4.5.3.1.cmml">,</mo><mi id="S4.SS1.p1.20.m20.3.3" xref="S4.SS1.p1.20.m20.3.3.cmml">d</mi><mo id="S4.SS1.p1.20.m20.4.5.3.2.3" xref="S4.SS1.p1.20.m20.4.5.3.1.cmml">,</mo><mi id="S4.SS1.p1.20.m20.4.4" xref="S4.SS1.p1.20.m20.4.4.cmml">e</mi><mo stretchy="false" id="S4.SS1.p1.20.m20.4.5.3.2.4" xref="S4.SS1.p1.20.m20.4.5.3.1.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p1.20.23.w1">.</span></p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.4" class="ltx_p"><span class="gd_word" id="S4.SS1.p2.4.1.w1">There</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w2">might</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w3">be</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w4">various</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w5">ways</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w6">to</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w7">transform</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.1.w9">tree</span><span> </span><math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.1.m1.1.2.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml">𝒢</mi><mo id="S4.SS1.p2.1.m1.1.2.1" xref="S4.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.1.m1.1.2.3.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.1.2.3.2.1" xref="S4.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p2.1.m1.1.2.3.2.2" xref="S4.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p2.4.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w2">For</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w4">tree-encoding</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w5">process,</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w6">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w7">particular</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w8">transformation</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w9">is</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w10">legitimate</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w11">only</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w12">if</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w13">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w14">resulting</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w15">data</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w16">structure</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w17">represents</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.2.w18">only</span><span> </span><math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mrow id="S4.SS1.p2.2.m2.1.2" xref="S4.SS1.p2.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.2.m2.1.2.2" xref="S4.SS1.p2.2.m2.1.2.2.cmml">𝒢</mi><mo id="S4.SS1.p2.2.m2.1.2.1" xref="S4.SS1.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.2.m2.1.2.3.2" xref="S4.SS1.p2.2.m2.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.2.m2.1.2.3.2.1" xref="S4.SS1.p2.2.m2.1.2.cmml">(</mo><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p2.2.m2.1.2.3.2.2" xref="S4.SS1.p2.2.m2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p2.4.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w3">not</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w4">any</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w5">other</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w6">structures.</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w7">Otherwise,</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w9">encoding</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w10">process</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w11">may</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.3.w12">confuse</span><span> </span><math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><mrow id="S4.SS1.p2.3.m3.1.2" xref="S4.SS1.p2.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.3.m3.1.2.2" xref="S4.SS1.p2.3.m3.1.2.2.cmml">𝒢</mi><mo id="S4.SS1.p2.3.m3.1.2.1" xref="S4.SS1.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p2.3.m3.1.2.3.2" xref="S4.SS1.p2.3.m3.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.1.2.3.2.1" xref="S4.SS1.p2.3.m3.1.2.cmml">(</mo><mi id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p2.3.m3.1.2.3.2.2" xref="S4.SS1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p2.4.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w2">with</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w3">another</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w4">structure.</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w5">In</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w6">other</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w7">words,</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w9">transformation</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w10">should</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w11">be</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w12">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w13">one-to-one</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w14">mapping.</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w15">Our</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.4.w16">transformation</span><span> </span><math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml">ℋ</mi></semantics></math><span class="gd_word" id="S4.SS1.p2.4.5.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w2">satisfies</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w3">this</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w4">requirement</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w5">as</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w6">shown</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w7">in</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w9">following</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w10">proposition</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w11">(see</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.5.w12">Appendix</span><span> </span><a href="#S7.SS1" title="7.1 Proof for proposition 1 ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.1</a><span class="gd_word" id="S4.SS1.p2.4.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.4.6.w2">for</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.6.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.4.6.w4">proof).</span></p>
</div>
<div id="Thmprop1" class="ltx_theorem ltx_theorem_prop">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem">Proposition 1</span></h6>
<div id="Thmprop1.p1" class="ltx_para">
<p id="Thmprop1.p1.7" class="ltx_p"><span class="gd_word" id="Thmprop1.p1.7.1.w1">Suppose</span><span> </span><math id="Thmprop1.p1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="Thmprop1.p1.1.1.m1.1a"><mrow id="Thmprop1.p1.1.1.m1.1.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.1.1.m1.1.2.2" xref="Thmprop1.p1.1.1.m1.1.2.2.cmml">𝒢</mi><mo mathvariant="italic" id="Thmprop1.p1.1.1.m1.1.2.1" xref="Thmprop1.p1.1.1.m1.1.2.1.cmml">⁢</mo><mrow id="Thmprop1.p1.1.1.m1.1.2.3.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.1.1.m1.1.2.3.2.1" xref="Thmprop1.p1.1.1.m1.1.2.cmml">(</mo><mi id="Thmprop1.p1.1.1.m1.1.1" xref="Thmprop1.p1.1.1.m1.1.1.cmml">X</mi><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.1.1.m1.1.2.3.2.2" xref="Thmprop1.p1.1.1.m1.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmprop1.p1.7.2.w1"/><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w2">is</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w3">a</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w4">parse</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w5">tree</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w6">and</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w7">there</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w8">exists</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w9">a</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.2.w10">inverse-transformation</span><span> </span><math id="Thmprop1.p1.2.2.m2.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="Thmprop1.p1.2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.2.2.m2.1.1" xref="Thmprop1.p1.2.2.m2.1.1.cmml">ℐ</mi></semantics></math><span class="gd_word" id="Thmprop1.p1.7.3.w1"/><span> </span><span class="gd_word" id="Thmprop1.p1.7.3.w2">that</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.3.w3">converts</span><span> </span><math id="Thmprop1.p1.3.3.m3.1" class="ltx_Math" alttext="\mathcal{T}(X)" display="inline"><semantics id="Thmprop1.p1.3.3.m3.1a"><mrow id="Thmprop1.p1.3.3.m3.1.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.3.3.m3.1.2.2" xref="Thmprop1.p1.3.3.m3.1.2.2.cmml">𝒯</mi><mo mathvariant="italic" id="Thmprop1.p1.3.3.m3.1.2.1" xref="Thmprop1.p1.3.3.m3.1.2.1.cmml">⁢</mo><mrow id="Thmprop1.p1.3.3.m3.1.2.3.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.3.3.m3.1.2.3.2.1" xref="Thmprop1.p1.3.3.m3.1.2.cmml">(</mo><mi id="Thmprop1.p1.3.3.m3.1.1" xref="Thmprop1.p1.3.3.m3.1.1.cmml">X</mi><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.3.3.m3.1.2.3.2.2" xref="Thmprop1.p1.3.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmprop1.p1.7.4.w1"/><span> </span><span class="gd_word" id="Thmprop1.p1.7.4.w2">to</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.4.w3">a</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.4.w4">graph</span><span> </span><math id="Thmprop1.p1.4.4.m4.2" class="ltx_Math" alttext="\mathcal{I}(\mathcal{T}(X))" display="inline"><semantics id="Thmprop1.p1.4.4.m4.2a"><mrow id="Thmprop1.p1.4.4.m4.2.2" xref="Thmprop1.p1.4.4.m4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.4.4.m4.2.2.3" xref="Thmprop1.p1.4.4.m4.2.2.3.cmml">ℐ</mi><mo mathvariant="italic" id="Thmprop1.p1.4.4.m4.2.2.2" xref="Thmprop1.p1.4.4.m4.2.2.2.cmml">⁢</mo><mrow id="Thmprop1.p1.4.4.m4.2.2.1.1" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.4.4.m4.2.2.1.1.2" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml">(</mo><mrow id="Thmprop1.p1.4.4.m4.2.2.1.1.1" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.4.4.m4.2.2.1.1.1.2" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.2.cmml">𝒯</mi><mo mathvariant="italic" id="Thmprop1.p1.4.4.m4.2.2.1.1.1.1" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.1.cmml">⁢</mo><mrow id="Thmprop1.p1.4.4.m4.2.2.1.1.1.3.2" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.4.4.m4.2.2.1.1.1.3.2.1" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml">(</mo><mi id="Thmprop1.p1.4.4.m4.1.1" xref="Thmprop1.p1.4.4.m4.1.1.cmml">X</mi><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.4.4.m4.2.2.1.1.1.3.2.2" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.4.4.m4.2.2.1.1.3" xref="Thmprop1.p1.4.4.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmprop1.p1.7.5.w1">,</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.5.w2">then</span><span> </span><math id="Thmprop1.p1.5.5.m5.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="Thmprop1.p1.5.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.5.5.m5.1.1" xref="Thmprop1.p1.5.5.m5.1.1.cmml">ℐ</mi></semantics></math><span class="gd_word" id="Thmprop1.p1.7.6.w1"/><span> </span><span class="gd_word" id="Thmprop1.p1.7.6.w2">can</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.6.w3">only</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.6.w4">transform</span><span> </span><math id="Thmprop1.p1.6.6.m6.1" class="ltx_Math" alttext="\mathcal{T}(X)" display="inline"><semantics id="Thmprop1.p1.6.6.m6.1a"><mrow id="Thmprop1.p1.6.6.m6.1.2" xref="Thmprop1.p1.6.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.6.6.m6.1.2.2" xref="Thmprop1.p1.6.6.m6.1.2.2.cmml">𝒯</mi><mo mathvariant="italic" id="Thmprop1.p1.6.6.m6.1.2.1" xref="Thmprop1.p1.6.6.m6.1.2.1.cmml">⁢</mo><mrow id="Thmprop1.p1.6.6.m6.1.2.3.2" xref="Thmprop1.p1.6.6.m6.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.6.6.m6.1.2.3.2.1" xref="Thmprop1.p1.6.6.m6.1.2.cmml">(</mo><mi id="Thmprop1.p1.6.6.m6.1.1" xref="Thmprop1.p1.6.6.m6.1.1.cmml">X</mi><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.6.6.m6.1.2.3.2.2" xref="Thmprop1.p1.6.6.m6.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmprop1.p1.7.7.w1"/><span> </span><span class="gd_word" id="Thmprop1.p1.7.7.w2">back</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.7.w3">to</span><span> </span><math id="Thmprop1.p1.7.7.m7.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="Thmprop1.p1.7.7.m7.1a"><mrow id="Thmprop1.p1.7.7.m7.1.2" xref="Thmprop1.p1.7.7.m7.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmprop1.p1.7.7.m7.1.2.2" xref="Thmprop1.p1.7.7.m7.1.2.2.cmml">𝒢</mi><mo mathvariant="italic" id="Thmprop1.p1.7.7.m7.1.2.1" xref="Thmprop1.p1.7.7.m7.1.2.1.cmml">⁢</mo><mrow id="Thmprop1.p1.7.7.m7.1.2.3.2" xref="Thmprop1.p1.7.7.m7.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.7.7.m7.1.2.3.2.1" xref="Thmprop1.p1.7.7.m7.1.2.cmml">(</mo><mi id="Thmprop1.p1.7.7.m7.1.1" xref="Thmprop1.p1.7.7.m7.1.1.cmml">X</mi><mo mathvariant="normal" stretchy="false" id="Thmprop1.p1.7.7.m7.1.2.3.2.2" xref="Thmprop1.p1.7.7.m7.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmprop1.p1.7.8.w1">,</span><span> </span><span class="gd_word" id="Thmprop1.p1.7.8.w2">or:
</span></p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.5" class="ltx_Math" alttext="\mathcal{I}(\mathcal{H}(\mathcal{G}(X)))=\mathcal{G}(X)\hskip 10.0pt\text{or}%&#10;\hskip 10.0pt\mathcal{I}=\mathcal{H}^{-1}" display="block"><semantics id="S4.E4.m1.5a"><mrow id="S4.E4.m1.5.5.2" xref="S4.E4.m1.5.5.3.cmml"><mrow id="S4.E4.m1.4.4.1.1" xref="S4.E4.m1.4.4.1.1.cmml"><mrow id="S4.E4.m1.4.4.1.1.1" xref="S4.E4.m1.4.4.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.3.cmml">ℐ</mi><mo id="S4.E4.m1.4.4.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.3.cmml">ℋ</mi><mo id="S4.E4.m1.4.4.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml">𝒢</mi><mo id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">X</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E4.m1.4.4.1.1.1.1.1.3" xref="S4.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E4.m1.4.4.1.1.3" xref="S4.E4.m1.4.4.1.1.3.cmml">=</mo><mrow id="S4.E4.m1.4.4.1.1.2.1" xref="S4.E4.m1.4.4.1.1.2.2.cmml"><mrow id="S4.E4.m1.4.4.1.1.2.1.1" xref="S4.E4.m1.4.4.1.1.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.4.4.1.1.2.1.1.2" xref="S4.E4.m1.4.4.1.1.2.1.1.2.cmml">𝒢</mi><mo id="S4.E4.m1.4.4.1.1.2.1.1.1" xref="S4.E4.m1.4.4.1.1.2.1.1.1.cmml">⁢</mo><mrow id="S4.E4.m1.4.4.1.1.2.1.1.3.2" xref="S4.E4.m1.4.4.1.1.2.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.4.4.1.1.2.1.1.3.2.1" xref="S4.E4.m1.4.4.1.1.2.1.1.cmml">(</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">X</mi><mo stretchy="false" id="S4.E4.m1.4.4.1.1.2.1.1.3.2.2" xref="S4.E4.m1.4.4.1.1.2.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="italic" separator="true" id="S4.E4.m1.4.4.1.1.2.1.2" xref="S4.E4.m1.4.4.1.1.2.2.cmml"> </mo><mtext id="S4.E4.m1.3.3" xref="S4.E4.m1.3.3a.cmml">𝑜𝑟</mtext></mrow></mrow><mo mathvariant="italic" separator="true" id="S4.E4.m1.5.5.2.3" xref="S4.E4.m1.5.5.3a.cmml"> </mo><mrow id="S4.E4.m1.5.5.2.2" xref="S4.E4.m1.5.5.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.5.5.2.2.2" xref="S4.E4.m1.5.5.2.2.2.cmml">ℐ</mi><mo id="S4.E4.m1.5.5.2.2.1" xref="S4.E4.m1.5.5.2.2.1.cmml">=</mo><msup id="S4.E4.m1.5.5.2.2.3" xref="S4.E4.m1.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.5.5.2.2.3.2" xref="S4.E4.m1.5.5.2.2.3.2.cmml">ℋ</mi><mrow id="S4.E4.m1.5.5.2.2.3.3" xref="S4.E4.m1.5.5.2.2.3.3.cmml"><mo id="S4.E4.m1.5.5.2.2.3.3.1" xref="S4.E4.m1.5.5.2.2.3.3.1.cmml">-</mo><mn id="S4.E4.m1.5.5.2.2.3.3.2" xref="S4.E4.m1.5.5.2.2.3.3.2.cmml">1</mn></mrow></msup></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr>
</table>
</div>
</div>
<div id="S4.SS1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS1.p3.14" class="ltx_p"><span class="gd_word" id="S4.SS1.p3.14.1.w1">We</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w2">now</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w3">describe</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w5">tree</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w6">accumulation</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w7">method</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.1.w8">using</span><span> </span><math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{T}(X)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.2" xref="S4.SS1.p3.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.1.m1.1.2.2" xref="S4.SS1.p3.1.m1.1.2.2.cmml">𝒯</mi><mo id="S4.SS1.p3.1.m1.1.2.1" xref="S4.SS1.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.p3.1.m1.1.2.3.2" xref="S4.SS1.p3.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.2.1" xref="S4.SS1.p3.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.3.2.2" xref="S4.SS1.p3.1.m1.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.2.w2">Figure</span><span> </span><a href="#S4.F1" title="Figure 1 ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S4.SS1.p3.14.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.3.w2">shows</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.3.w4">overall</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.3.w5">process.
Let</span><span> </span><math id="S4.SS1.p3.2.m2.3" class="ltx_Math" alttext="{\bm{L}}=({\bm{l}}_{1},...,{\bm{l}}_{n})\in{\mathbb{R}}^{n\times d}" display="inline"><semantics id="S4.SS1.p3.2.m2.3a"><mrow id="S4.SS1.p3.2.m2.3.3" xref="S4.SS1.p3.2.m2.3.3.cmml"><mi id="S4.SS1.p3.2.m2.3.3.4" xref="S4.SS1.p3.2.m2.3.3.4.cmml">𝑳</mi><mo id="S4.SS1.p3.2.m2.3.3.5" xref="S4.SS1.p3.2.m2.3.3.5.cmml">=</mo><mrow id="S4.SS1.p3.2.m2.3.3.2.2" xref="S4.SS1.p3.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.2.m2.3.3.2.2.3" xref="S4.SS1.p3.2.m2.3.3.2.3.cmml">(</mo><msub id="S4.SS1.p3.2.m2.2.2.1.1.1" xref="S4.SS1.p3.2.m2.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.2.m2.2.2.1.1.1.2" xref="S4.SS1.p3.2.m2.2.2.1.1.1.2.cmml">𝒍</mi><mn id="S4.SS1.p3.2.m2.2.2.1.1.1.3" xref="S4.SS1.p3.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p3.2.m2.3.3.2.2.4" xref="S4.SS1.p3.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">…</mi><mo id="S4.SS1.p3.2.m2.3.3.2.2.5" xref="S4.SS1.p3.2.m2.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p3.2.m2.3.3.2.2.2" xref="S4.SS1.p3.2.m2.3.3.2.2.2.cmml"><mi id="S4.SS1.p3.2.m2.3.3.2.2.2.2" xref="S4.SS1.p3.2.m2.3.3.2.2.2.2.cmml">𝒍</mi><mi id="S4.SS1.p3.2.m2.3.3.2.2.2.3" xref="S4.SS1.p3.2.m2.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S4.SS1.p3.2.m2.3.3.2.2.6" xref="S4.SS1.p3.2.m2.3.3.2.3.cmml">)</mo></mrow><mo id="S4.SS1.p3.2.m2.3.3.6" xref="S4.SS1.p3.2.m2.3.3.6.cmml">∈</mo><msup id="S4.SS1.p3.2.m2.3.3.7" xref="S4.SS1.p3.2.m2.3.3.7.cmml"><mi id="S4.SS1.p3.2.m2.3.3.7.2" xref="S4.SS1.p3.2.m2.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.2.m2.3.3.7.3" xref="S4.SS1.p3.2.m2.3.3.7.3.cmml"><mi id="S4.SS1.p3.2.m2.3.3.7.3.2" xref="S4.SS1.p3.2.m2.3.3.7.3.2.cmml">n</mi><mo id="S4.SS1.p3.2.m2.3.3.7.3.1" xref="S4.SS1.p3.2.m2.3.3.7.3.1.cmml">×</mo><mi id="S4.SS1.p3.2.m2.3.3.7.3.3" xref="S4.SS1.p3.2.m2.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.4.w2">and</span><span> </span><math id="S4.SS1.p3.3.m3.3" class="ltx_Math" alttext="{\bm{N}}=({\bm{n}}_{1},...,{\bm{n}}_{m})\in{\mathbb{R}}^{m\times d}" display="inline"><semantics id="S4.SS1.p3.3.m3.3a"><mrow id="S4.SS1.p3.3.m3.3.3" xref="S4.SS1.p3.3.m3.3.3.cmml"><mi id="S4.SS1.p3.3.m3.3.3.4" xref="S4.SS1.p3.3.m3.3.3.4.cmml">𝑵</mi><mo id="S4.SS1.p3.3.m3.3.3.5" xref="S4.SS1.p3.3.m3.3.3.5.cmml">=</mo><mrow id="S4.SS1.p3.3.m3.3.3.2.2" xref="S4.SS1.p3.3.m3.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.3.m3.3.3.2.2.3" xref="S4.SS1.p3.3.m3.3.3.2.3.cmml">(</mo><msub id="S4.SS1.p3.3.m3.2.2.1.1.1" xref="S4.SS1.p3.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.3.m3.2.2.1.1.1.2" xref="S4.SS1.p3.3.m3.2.2.1.1.1.2.cmml">𝒏</mi><mn id="S4.SS1.p3.3.m3.2.2.1.1.1.3" xref="S4.SS1.p3.3.m3.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p3.3.m3.3.3.2.2.4" xref="S4.SS1.p3.3.m3.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml">…</mi><mo id="S4.SS1.p3.3.m3.3.3.2.2.5" xref="S4.SS1.p3.3.m3.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p3.3.m3.3.3.2.2.2" xref="S4.SS1.p3.3.m3.3.3.2.2.2.cmml"><mi id="S4.SS1.p3.3.m3.3.3.2.2.2.2" xref="S4.SS1.p3.3.m3.3.3.2.2.2.2.cmml">𝒏</mi><mi id="S4.SS1.p3.3.m3.3.3.2.2.2.3" xref="S4.SS1.p3.3.m3.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S4.SS1.p3.3.m3.3.3.2.2.6" xref="S4.SS1.p3.3.m3.3.3.2.3.cmml">)</mo></mrow><mo id="S4.SS1.p3.3.m3.3.3.6" xref="S4.SS1.p3.3.m3.3.3.6.cmml">∈</mo><msup id="S4.SS1.p3.3.m3.3.3.7" xref="S4.SS1.p3.3.m3.3.3.7.cmml"><mi id="S4.SS1.p3.3.m3.3.3.7.2" xref="S4.SS1.p3.3.m3.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.3.m3.3.3.7.3" xref="S4.SS1.p3.3.m3.3.3.7.3.cmml"><mi id="S4.SS1.p3.3.m3.3.3.7.3.2" xref="S4.SS1.p3.3.m3.3.3.7.3.2.cmml">m</mi><mo id="S4.SS1.p3.3.m3.3.3.7.3.1" xref="S4.SS1.p3.3.m3.3.3.7.3.1.cmml">×</mo><mi id="S4.SS1.p3.3.m3.3.3.7.3.3" xref="S4.SS1.p3.3.m3.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.5.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w2">be</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w4">hidden</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w5">representations</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w6">of</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.5.w8">leaves</span><span> </span><math id="S4.SS1.p3.4.m4.3" class="ltx_Math" alttext="\mathcal{L}=(x^{\mathcal{L}}_{1},...,x^{\mathcal{L}}_{n})" display="inline"><semantics id="S4.SS1.p3.4.m4.3a"><mrow id="S4.SS1.p3.4.m4.3.3" xref="S4.SS1.p3.4.m4.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.4.m4.3.3.4" xref="S4.SS1.p3.4.m4.3.3.4.cmml">ℒ</mi><mo id="S4.SS1.p3.4.m4.3.3.3" xref="S4.SS1.p3.4.m4.3.3.3.cmml">=</mo><mrow id="S4.SS1.p3.4.m4.3.3.2.2" xref="S4.SS1.p3.4.m4.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.4.m4.3.3.2.2.3" xref="S4.SS1.p3.4.m4.3.3.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.4.m4.2.2.1.1.1" xref="S4.SS1.p3.4.m4.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.4.m4.2.2.1.1.1.2.2" xref="S4.SS1.p3.4.m4.2.2.1.1.1.2.2.cmml">x</mi><mn id="S4.SS1.p3.4.m4.2.2.1.1.1.3" xref="S4.SS1.p3.4.m4.2.2.1.1.1.3.cmml">1</mn><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.4.m4.2.2.1.1.1.2.3" xref="S4.SS1.p3.4.m4.2.2.1.1.1.2.3.cmml">ℒ</mi></msubsup><mo id="S4.SS1.p3.4.m4.3.3.2.2.4" xref="S4.SS1.p3.4.m4.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p3.4.m4.1.1" xref="S4.SS1.p3.4.m4.1.1.cmml">…</mi><mo id="S4.SS1.p3.4.m4.3.3.2.2.5" xref="S4.SS1.p3.4.m4.3.3.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.4.m4.3.3.2.2.2" xref="S4.SS1.p3.4.m4.3.3.2.2.2.cmml"><mi id="S4.SS1.p3.4.m4.3.3.2.2.2.2.2" xref="S4.SS1.p3.4.m4.3.3.2.2.2.2.2.cmml">x</mi><mi id="S4.SS1.p3.4.m4.3.3.2.2.2.3" xref="S4.SS1.p3.4.m4.3.3.2.2.2.3.cmml">n</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.4.m4.3.3.2.2.2.2.3" xref="S4.SS1.p3.4.m4.3.3.2.2.2.2.3.cmml">ℒ</mi></msubsup><mo stretchy="false" id="S4.SS1.p3.4.m4.3.3.2.2.6" xref="S4.SS1.p3.4.m4.3.3.2.3.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.6.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.6.w3">nodes</span><span> </span><math id="S4.SS1.p3.5.m5.3" class="ltx_Math" alttext="\mathcal{N}=(x^{\mathcal{N}}_{1},...,x^{\mathcal{N}}_{m})" display="inline"><semantics id="S4.SS1.p3.5.m5.3a"><mrow id="S4.SS1.p3.5.m5.3.3" xref="S4.SS1.p3.5.m5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.5.m5.3.3.4" xref="S4.SS1.p3.5.m5.3.3.4.cmml">𝒩</mi><mo id="S4.SS1.p3.5.m5.3.3.3" xref="S4.SS1.p3.5.m5.3.3.3.cmml">=</mo><mrow id="S4.SS1.p3.5.m5.3.3.2.2" xref="S4.SS1.p3.5.m5.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.5.m5.3.3.2.2.3" xref="S4.SS1.p3.5.m5.3.3.2.3.cmml">(</mo><msubsup id="S4.SS1.p3.5.m5.2.2.1.1.1" xref="S4.SS1.p3.5.m5.2.2.1.1.1.cmml"><mi id="S4.SS1.p3.5.m5.2.2.1.1.1.2.2" xref="S4.SS1.p3.5.m5.2.2.1.1.1.2.2.cmml">x</mi><mn id="S4.SS1.p3.5.m5.2.2.1.1.1.3" xref="S4.SS1.p3.5.m5.2.2.1.1.1.3.cmml">1</mn><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.5.m5.2.2.1.1.1.2.3" xref="S4.SS1.p3.5.m5.2.2.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo id="S4.SS1.p3.5.m5.3.3.2.2.4" xref="S4.SS1.p3.5.m5.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">…</mi><mo id="S4.SS1.p3.5.m5.3.3.2.2.5" xref="S4.SS1.p3.5.m5.3.3.2.3.cmml">,</mo><msubsup id="S4.SS1.p3.5.m5.3.3.2.2.2" xref="S4.SS1.p3.5.m5.3.3.2.2.2.cmml"><mi id="S4.SS1.p3.5.m5.3.3.2.2.2.2.2" xref="S4.SS1.p3.5.m5.3.3.2.2.2.2.2.cmml">x</mi><mi id="S4.SS1.p3.5.m5.3.3.2.2.2.3" xref="S4.SS1.p3.5.m5.3.3.2.2.2.3.cmml">m</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.5.m5.3.3.2.2.2.2.3" xref="S4.SS1.p3.5.m5.3.3.2.2.2.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS1.p3.5.m5.3.3.2.2.6" xref="S4.SS1.p3.5.m5.3.3.2.3.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.7.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w2">respectively.</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w3">We</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w4">define</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w5">an</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w6">interpolation</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.7.w7">function</span><span> </span><math id="S4.SS1.p3.6.m6.3" class="ltx_Math" alttext="\mathcal{F}:({\mathbb{R}}^{n\times d},{\mathbb{R}}^{m\times d})\rightarrow{%&#10;\mathbb{R}}^{(m+1)\times n\times d}" display="inline"><semantics id="S4.SS1.p3.6.m6.3a"><mrow id="S4.SS1.p3.6.m6.3.3" xref="S4.SS1.p3.6.m6.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.6.m6.3.3.4" xref="S4.SS1.p3.6.m6.3.3.4.cmml">ℱ</mi><mo id="S4.SS1.p3.6.m6.3.3.3" xref="S4.SS1.p3.6.m6.3.3.3.cmml">:</mo><mrow id="S4.SS1.p3.6.m6.3.3.2" xref="S4.SS1.p3.6.m6.3.3.2.cmml"><mrow id="S4.SS1.p3.6.m6.3.3.2.2.2" xref="S4.SS1.p3.6.m6.3.3.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p3.6.m6.3.3.2.2.2.3" xref="S4.SS1.p3.6.m6.3.3.2.2.3.cmml">(</mo><msup id="S4.SS1.p3.6.m6.2.2.1.1.1.1" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p3.6.m6.2.2.1.1.1.1.2" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.6.m6.2.2.1.1.1.1.3" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.cmml"><mi id="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.2" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.2.cmml">n</mi><mo id="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.1" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.1.cmml">×</mo><mi id="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.3" xref="S4.SS1.p3.6.m6.2.2.1.1.1.1.3.3.cmml">d</mi></mrow></msup><mo id="S4.SS1.p3.6.m6.3.3.2.2.2.4" xref="S4.SS1.p3.6.m6.3.3.2.2.3.cmml">,</mo><msup id="S4.SS1.p3.6.m6.3.3.2.2.2.2" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.cmml"><mi id="S4.SS1.p3.6.m6.3.3.2.2.2.2.2" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.6.m6.3.3.2.2.2.2.3" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.cmml"><mi id="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.2" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.2.cmml">m</mi><mo id="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.1" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.1.cmml">×</mo><mi id="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.3" xref="S4.SS1.p3.6.m6.3.3.2.2.2.2.3.3.cmml">d</mi></mrow></msup><mo stretchy="false" id="S4.SS1.p3.6.m6.3.3.2.2.2.5" xref="S4.SS1.p3.6.m6.3.3.2.2.3.cmml">)</mo></mrow><mo id="S4.SS1.p3.6.m6.3.3.2.3" xref="S4.SS1.p3.6.m6.3.3.2.3.cmml">→</mo><msup id="S4.SS1.p3.6.m6.3.3.2.4" xref="S4.SS1.p3.6.m6.3.3.2.4.cmml"><mi id="S4.SS1.p3.6.m6.3.3.2.4.2" xref="S4.SS1.p3.6.m6.3.3.2.4.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.6.m6.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.cmml"><mrow id="S4.SS1.p3.6.m6.1.1.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.6.m6.1.1.1.1.1.2" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.6.m6.1.1.1.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.6.m6.1.1.1.1.1.1.2" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS1.p3.6.m6.1.1.1.1.1.1.1" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS1.p3.6.m6.1.1.1.1.1.1.3" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p3.6.m6.1.1.1.1.1.3" xref="S4.SS1.p3.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p3.6.m6.1.1.1.2" xref="S4.SS1.p3.6.m6.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p3.6.m6.1.1.1.3" xref="S4.SS1.p3.6.m6.1.1.1.3.cmml">n</mi><mo id="S4.SS1.p3.6.m6.1.1.1.2a" xref="S4.SS1.p3.6.m6.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p3.6.m6.1.1.1.4" xref="S4.SS1.p3.6.m6.1.1.1.4.cmml">d</mi></mrow></msup></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.8.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.8.w2">which</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.8.w3">takes</span><span> </span><math id="S4.SS1.p3.7.m7.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="S4.SS1.p3.7.m7.1a"><mi id="S4.SS1.p3.7.m7.1.1" xref="S4.SS1.p3.7.m7.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.9.w1">,</span><span> </span><math id="S4.SS1.p3.8.m8.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="S4.SS1.p3.8.m8.1a"><mi id="S4.SS1.p3.8.m8.1.1" xref="S4.SS1.p3.8.m8.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.10.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.10.w2">and</span><span> </span><math id="S4.SS1.p3.9.m9.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS1.p3.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.9.m9.1.1" xref="S4.SS1.p3.9.m9.1.1.cmml">ℛ</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.11.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w2">as</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w3">inputs</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w4">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w5">returns</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w6">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.11.w7">tensor</span><span> </span><math id="S4.SS1.p3.10.m10.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}\in{\mathbb{R}}^{(m+1)\times n\times d}" display="inline"><semantics id="S4.SS1.p3.10.m10.1a"><mrow id="S4.SS1.p3.10.m10.1.2" xref="S4.SS1.p3.10.m10.1.2.cmml"><mi id="S4.SS1.p3.10.m10.1.2.2" xref="S4.SS1.p3.10.m10.1.2.2.cmml">𝑺</mi><mo id="S4.SS1.p3.10.m10.1.2.1" xref="S4.SS1.p3.10.m10.1.2.1.cmml">∈</mo><msup id="S4.SS1.p3.10.m10.1.2.3" xref="S4.SS1.p3.10.m10.1.2.3.cmml"><mi id="S4.SS1.p3.10.m10.1.2.3.2" xref="S4.SS1.p3.10.m10.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.10.m10.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.cmml"><mrow id="S4.SS1.p3.10.m10.1.1.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.10.m10.1.1.1.1.1.2" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p3.10.m10.1.1.1.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.10.m10.1.1.1.1.1.1.2" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS1.p3.10.m10.1.1.1.1.1.1.1" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS1.p3.10.m10.1.1.1.1.1.1.3" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS1.p3.10.m10.1.1.1.1.1.3" xref="S4.SS1.p3.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS1.p3.10.m10.1.1.1.2" xref="S4.SS1.p3.10.m10.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p3.10.m10.1.1.1.3" xref="S4.SS1.p3.10.m10.1.1.1.3.cmml">n</mi><mo id="S4.SS1.p3.10.m10.1.1.1.2a" xref="S4.SS1.p3.10.m10.1.1.1.2.cmml">×</mo><mi id="S4.SS1.p3.10.m10.1.1.1.4" xref="S4.SS1.p3.10.m10.1.1.1.4.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.12.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.12.w2">The</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.12.w3">row</span><span> </span><math id="S4.SS1.p3.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p3.11.m11.1a"><mi id="S4.SS1.p3.11.m11.1.1" xref="S4.SS1.p3.11.m11.1.1.cmml">i</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.13.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.13.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.13.w3">column</span><span> </span><math id="S4.SS1.p3.12.m12.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.SS1.p3.12.m12.1a"><mi id="S4.SS1.p3.12.m12.1.1" xref="S4.SS1.p3.12.m12.1.1.cmml">j</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.14.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.14.14.w2">vector</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.14.w3">of</span><span> </span><math id="S4.SS1.p3.13.m13.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.SS1.p3.13.m13.1a"><mi id="S4.SS1.p3.13.m13.1.1" xref="S4.SS1.p3.13.m13.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.14.15.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.15.w2">or</span><span> </span><math id="S4.SS1.p3.14.m14.2" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}_{i,j}\in{\mathbb{R}}^{d}" display="inline"><semantics id="S4.SS1.p3.14.m14.2a"><mrow id="S4.SS1.p3.14.m14.2.3" xref="S4.SS1.p3.14.m14.2.3.cmml"><msub id="S4.SS1.p3.14.m14.2.3.2" xref="S4.SS1.p3.14.m14.2.3.2.cmml"><mi id="S4.SS1.p3.14.m14.2.3.2.2" xref="S4.SS1.p3.14.m14.2.3.2.2.cmml">𝑺</mi><mrow id="S4.SS1.p3.14.m14.2.2.2.4" xref="S4.SS1.p3.14.m14.2.2.2.3.cmml"><mi id="S4.SS1.p3.14.m14.1.1.1.1" xref="S4.SS1.p3.14.m14.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.14.m14.2.2.2.4.1" xref="S4.SS1.p3.14.m14.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.14.m14.2.2.2.2" xref="S4.SS1.p3.14.m14.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.SS1.p3.14.m14.2.3.1" xref="S4.SS1.p3.14.m14.2.3.1.cmml">∈</mo><msup id="S4.SS1.p3.14.m14.2.3.3" xref="S4.SS1.p3.14.m14.2.3.3.cmml"><mi id="S4.SS1.p3.14.m14.2.3.3.2" xref="S4.SS1.p3.14.m14.2.3.3.2.cmml">ℝ</mi><mi id="S4.SS1.p3.14.m14.2.3.3.3" xref="S4.SS1.p3.14.m14.2.3.3.3.cmml">d</mi></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.14.16.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.16.w2">is</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.16.w3">defined</span><span> </span><span class="gd_word" id="S4.SS1.p3.14.16.w4">as:</span></p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.8" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}_{i,j}=\mathcal{F}({\bm{L}},{\bm{N}},\mathcal{R})_{i,j}=%&#10;\left\{\begin{array}[]{ll}{\bm{l}}_{j}&amp;\mbox{if }i=1\\&#10;{\bm{n}}_{i-1}&amp;\mbox{else if }x^{\mathcal{L}}_{j}\in\mathcal{R}(x^{\mathcal{N}%&#10;}_{i-1})\\&#10;{\bm{0}}&amp;\mbox{otherwise. }\end{array}\right." display="block"><semantics id="S4.E5.m1.8a"><mrow id="S4.E5.m1.8.9" xref="S4.E5.m1.8.9.cmml"><msub id="S4.E5.m1.8.9.2" xref="S4.E5.m1.8.9.2.cmml"><mi id="S4.E5.m1.8.9.2.2" xref="S4.E5.m1.8.9.2.2.cmml">𝑺</mi><mrow id="S4.E5.m1.2.2.2.4" xref="S4.E5.m1.2.2.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml">i</mi><mo id="S4.E5.m1.2.2.2.4.1" xref="S4.E5.m1.2.2.2.3.cmml">,</mo><mi id="S4.E5.m1.2.2.2.2" xref="S4.E5.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.E5.m1.8.9.3" xref="S4.E5.m1.8.9.3.cmml">=</mo><mrow id="S4.E5.m1.8.9.4" xref="S4.E5.m1.8.9.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.8.9.4.2" xref="S4.E5.m1.8.9.4.2.cmml">ℱ</mi><mo id="S4.E5.m1.8.9.4.1" xref="S4.E5.m1.8.9.4.1.cmml">⁢</mo><msub id="S4.E5.m1.8.9.4.3" xref="S4.E5.m1.8.9.4.3.cmml"><mrow id="S4.E5.m1.8.9.4.3.2.2" xref="S4.E5.m1.8.9.4.3.2.1.cmml"><mo stretchy="false" id="S4.E5.m1.8.9.4.3.2.2.1" xref="S4.E5.m1.8.9.4.3.2.1.cmml">(</mo><mi id="S4.E5.m1.6.6" xref="S4.E5.m1.6.6.cmml">𝑳</mi><mo id="S4.E5.m1.8.9.4.3.2.2.2" xref="S4.E5.m1.8.9.4.3.2.1.cmml">,</mo><mi id="S4.E5.m1.7.7" xref="S4.E5.m1.7.7.cmml">𝑵</mi><mo id="S4.E5.m1.8.9.4.3.2.2.3" xref="S4.E5.m1.8.9.4.3.2.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.8.8" xref="S4.E5.m1.8.8.cmml">ℛ</mi><mo stretchy="false" id="S4.E5.m1.8.9.4.3.2.2.4" xref="S4.E5.m1.8.9.4.3.2.1.cmml">)</mo></mrow><mrow id="S4.E5.m1.4.4.2.4" xref="S4.E5.m1.4.4.2.3.cmml"><mi id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.1.cmml">i</mi><mo id="S4.E5.m1.4.4.2.4.1" xref="S4.E5.m1.4.4.2.3.cmml">,</mo><mi id="S4.E5.m1.4.4.2.2" xref="S4.E5.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S4.E5.m1.8.9.5" xref="S4.E5.m1.8.9.5.cmml">=</mo><mrow id="S4.E5.m1.8.9.6.2" xref="S4.E5.m1.8.9.6.1.cmml"><mo id="S4.E5.m1.8.9.6.2.1" xref="S4.E5.m1.8.9.6.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E5.m1.5.5" xref="S4.E5.m1.5.5.cmml"><mtr id="S4.E5.m1.5.5a" xref="S4.E5.m1.5.5.cmml"><mtd columnalign="left" id="S4.E5.m1.5.5b" xref="S4.E5.m1.5.5.cmml"><msub id="S4.E5.m1.5.5.2.1.1" xref="S4.E5.m1.5.5.2.1.1.cmml"><mi id="S4.E5.m1.5.5.2.1.1.2" xref="S4.E5.m1.5.5.2.1.1.2.cmml">𝒍</mi><mi id="S4.E5.m1.5.5.2.1.1.3" xref="S4.E5.m1.5.5.2.1.1.3.cmml">j</mi></msub></mtd><mtd columnalign="left" id="S4.E5.m1.5.5c" xref="S4.E5.m1.5.5.cmml"><mrow id="S4.E5.m1.5.5.2.2.1" xref="S4.E5.m1.5.5.2.2.1.cmml"><mrow id="S4.E5.m1.5.5.2.2.1.2" xref="S4.E5.m1.5.5.2.2.1.2.cmml"><mtext id="S4.E5.m1.5.5.2.2.1.2.2" xref="S4.E5.m1.5.5.2.2.1.2.2a.cmml">if </mtext><mo id="S4.E5.m1.5.5.2.2.1.2.1" xref="S4.E5.m1.5.5.2.2.1.2.1.cmml">⁢</mo><mi id="S4.E5.m1.5.5.2.2.1.2.3" xref="S4.E5.m1.5.5.2.2.1.2.3.cmml">i</mi></mrow><mo id="S4.E5.m1.5.5.2.2.1.1" xref="S4.E5.m1.5.5.2.2.1.1.cmml">=</mo><mn id="S4.E5.m1.5.5.2.2.1.3" xref="S4.E5.m1.5.5.2.2.1.3.cmml">1</mn></mrow></mtd></mtr><mtr id="S4.E5.m1.5.5d" xref="S4.E5.m1.5.5.cmml"><mtd columnalign="left" id="S4.E5.m1.5.5e" xref="S4.E5.m1.5.5.cmml"><msub id="S4.E5.m1.5.5.1.2.1" xref="S4.E5.m1.5.5.1.2.1.cmml"><mi id="S4.E5.m1.5.5.1.2.1.2" xref="S4.E5.m1.5.5.1.2.1.2.cmml">𝒏</mi><mrow id="S4.E5.m1.5.5.1.2.1.3" xref="S4.E5.m1.5.5.1.2.1.3.cmml"><mi id="S4.E5.m1.5.5.1.2.1.3.2" xref="S4.E5.m1.5.5.1.2.1.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.2.1.3.1" xref="S4.E5.m1.5.5.1.2.1.3.1.cmml">-</mo><mn id="S4.E5.m1.5.5.1.2.1.3.3" xref="S4.E5.m1.5.5.1.2.1.3.3.cmml">1</mn></mrow></msub></mtd><mtd columnalign="left" id="S4.E5.m1.5.5f" xref="S4.E5.m1.5.5.cmml"><mrow id="S4.E5.m1.5.5.1.1.1" xref="S4.E5.m1.5.5.1.1.1.cmml"><mrow id="S4.E5.m1.5.5.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.3.cmml"><mtext id="S4.E5.m1.5.5.1.1.1.3.2" xref="S4.E5.m1.5.5.1.1.1.3.2a.cmml">else if </mtext><mo id="S4.E5.m1.5.5.1.1.1.3.1" xref="S4.E5.m1.5.5.1.1.1.3.1.cmml">⁢</mo><msubsup id="S4.E5.m1.5.5.1.1.1.3.3" xref="S4.E5.m1.5.5.1.1.1.3.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.3.3.2.2" xref="S4.E5.m1.5.5.1.1.1.3.3.2.2.cmml">x</mi><mi id="S4.E5.m1.5.5.1.1.1.3.3.3" xref="S4.E5.m1.5.5.1.1.1.3.3.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.5.5.1.1.1.3.3.2.3" xref="S4.E5.m1.5.5.1.1.1.3.3.2.3.cmml">ℒ</mi></msubsup></mrow><mo id="S4.E5.m1.5.5.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.2.cmml">∈</mo><mrow id="S4.E5.m1.5.5.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.5.5.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.3.cmml">ℛ</mi><mo id="S4.E5.m1.5.5.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E5.m1.5.5.1.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.5.5.1.1.1.1.1.1.2" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E5.m1.5.5.1.1.1.1.1.1.1" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.2.2.cmml">x</mi><mrow id="S4.E5.m1.5.5.1.1.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.1" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.1.cmml">-</mo><mn id="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.3" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.5.5.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.E5.m1.5.5.1.1.1.1.1.1.3" xref="S4.E5.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E5.m1.5.5g" xref="S4.E5.m1.5.5.cmml"><mtd columnalign="left" id="S4.E5.m1.5.5h" xref="S4.E5.m1.5.5.cmml"><mn id="S4.E5.m1.5.5.3.1.1" xref="S4.E5.m1.5.5.3.1.1.cmml">𝟎</mn></mtd><mtd columnalign="left" id="S4.E5.m1.5.5i" xref="S4.E5.m1.5.5.cmml"><mtext id="S4.E5.m1.5.5.3.2.1" xref="S4.E5.m1.5.5.3.2.1a.cmml">otherwise. </mtext></mtd></mtr></mtable><mi id="S4.E5.m1.8.9.6.2.2" xref="S4.E5.m1.8.9.6.1.1.cmml"/></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr>
</table>
<p id="S4.SS1.p3.20" class="ltx_p"><span class="gd_word" id="S4.SS1.p3.20.1.w1">where</span><span> </span><math id="S4.SS1.p3.15.m1.1" class="ltx_Math" alttext="{\bm{0}}" display="inline"><semantics id="S4.SS1.p3.15.m1.1a"><mn id="S4.SS1.p3.15.m1.1.1" xref="S4.SS1.p3.15.m1.1.1.cmml">𝟎</mn></semantics></math><span class="gd_word" id="S4.SS1.p3.20.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w4">zero</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w5">vector</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w6">of</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.2.w7">length</span><span> </span><math id="S4.SS1.p3.16.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="S4.SS1.p3.16.m2.1a"><mi id="S4.SS1.p3.16.m2.1.1" xref="S4.SS1.p3.16.m2.1.1.cmml">d</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.20.3.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w2">Note</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w3">that</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w5">row</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w6">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w7">column</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w8">arrangements</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.3.w9">in</span><span> </span><math id="S4.SS1.p3.17.m3.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.SS1.p3.17.m3.1a"><mi id="S4.SS1.p3.17.m3.1.1" xref="S4.SS1.p3.17.m3.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.20.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w2">reflect</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w4">tree</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w5">structure</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w6">(see</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.4.w7">Figure</span><span> </span><a href="#S4.F1" title="Figure 1 ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S4.SS1.p3.20.5.w1">).</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w2">Next,</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w3">we</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w4">perform</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w5">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w6">upward</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w7">cumulative-average</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w8">(upward-CA)</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.5.w9">operation</span><span> </span><math id="S4.SS1.p3.18.m4.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S4.SS1.p3.18.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.18.m4.1.1" xref="S4.SS1.p3.18.m4.1.1.cmml">𝒰</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.20.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.20.6.w2">on</span><span> </span><math id="S4.SS1.p3.19.m5.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.SS1.p3.19.m5.1a"><mi id="S4.SS1.p3.19.m5.1.1" xref="S4.SS1.p3.19.m5.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.20.7.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w2">to</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w3">compose</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w5">node</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w6">representations</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w7">in</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w8">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w9">bottom-up</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w10">fashion</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w11">over</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w12">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w13">induced</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w14">tree</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w15">structure.</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w16">The</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w17">result</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w18">of</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w19">this</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w20">operation</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w21">is</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w22">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.7.w23">tensor</span><span> </span><math id="S4.SS1.p3.20.m6.1" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}\in{\mathbb{R}}^{m\times n\times d}" display="inline"><semantics id="S4.SS1.p3.20.m6.1a"><mrow id="S4.SS1.p3.20.m6.1.1" xref="S4.SS1.p3.20.m6.1.1.cmml"><mover accent="true" id="S4.SS1.p3.20.m6.1.1.2" xref="S4.SS1.p3.20.m6.1.1.2.cmml"><mi id="S4.SS1.p3.20.m6.1.1.2.2" xref="S4.SS1.p3.20.m6.1.1.2.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS1.p3.20.m6.1.1.2.1" xref="S4.SS1.p3.20.m6.1.1.2.1.cmml">^</mo></mover><mo id="S4.SS1.p3.20.m6.1.1.1" xref="S4.SS1.p3.20.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p3.20.m6.1.1.3" xref="S4.SS1.p3.20.m6.1.1.3.cmml"><mi id="S4.SS1.p3.20.m6.1.1.3.2" xref="S4.SS1.p3.20.m6.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS1.p3.20.m6.1.1.3.3" xref="S4.SS1.p3.20.m6.1.1.3.3.cmml"><mi id="S4.SS1.p3.20.m6.1.1.3.3.2" xref="S4.SS1.p3.20.m6.1.1.3.3.2.cmml">m</mi><mo id="S4.SS1.p3.20.m6.1.1.3.3.1" xref="S4.SS1.p3.20.m6.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.20.m6.1.1.3.3.3" xref="S4.SS1.p3.20.m6.1.1.3.3.3.cmml">n</mi><mo id="S4.SS1.p3.20.m6.1.1.3.3.1a" xref="S4.SS1.p3.20.m6.1.1.3.3.1.cmml">×</mo><mi id="S4.SS1.p3.20.m6.1.1.3.3.4" xref="S4.SS1.p3.20.m6.1.1.3.3.4.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.20.8.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w2">in</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w3">which</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w4">each</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w5">nonterminal</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w6">node</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w7">representation</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w8">is</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w9">averaged</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w10">along</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w11">with</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w12">all</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w13">of</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w14">its</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w15">descendants</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w16">in</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w17">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w18">particular</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w19">branch.</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w20">More</span><span> </span><span class="gd_word" id="S4.SS1.p3.20.8.w21">formally,
</span></p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.12" class="ltx_Math" alttext="\mathcal{U}({\bm{\mathsfit{S}}})_{i,j}=\hat{{\bm{\mathsfit{S}}}}_{i,j}=\left\{%&#10;\begin{array}[]{ll}{\bm{0}}&amp;\mbox{if }{\bm{\mathsfit{S}}}_{i+1,j}={\bm{0}}\\&#10;\sum_{{\bm{\mathsfit{S}}}_{t,j}\in C_{j}^{i}}{\bm{\mathsfit{S}}}_{t,j}/{|C_{j}%&#10;^{i}|}&amp;\mbox{otherwise.}\\&#10;\end{array}\right." display="block"><semantics id="S4.E6.m1.12a"><mrow id="S4.E6.m1.12.13" xref="S4.E6.m1.12.13.cmml"><mrow id="S4.E6.m1.12.13.2" xref="S4.E6.m1.12.13.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E6.m1.12.13.2.2" xref="S4.E6.m1.12.13.2.2.cmml">𝒰</mi><mo id="S4.E6.m1.12.13.2.1" xref="S4.E6.m1.12.13.2.1.cmml">⁢</mo><msub id="S4.E6.m1.12.13.2.3" xref="S4.E6.m1.12.13.2.3.cmml"><mrow id="S4.E6.m1.12.13.2.3.2.2" xref="S4.E6.m1.12.13.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.12.13.2.3.2.2.1" xref="S4.E6.m1.12.13.2.3.cmml">(</mo><mi id="S4.E6.m1.12.12" xref="S4.E6.m1.12.12.cmml">𝑺</mi><mo stretchy="false" id="S4.E6.m1.12.13.2.3.2.2.2" xref="S4.E6.m1.12.13.2.3.cmml">)</mo></mrow><mrow id="S4.E6.m1.2.2.2.4" xref="S4.E6.m1.2.2.2.3.cmml"><mi id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml">i</mi><mo id="S4.E6.m1.2.2.2.4.1" xref="S4.E6.m1.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.2.2.2.2" xref="S4.E6.m1.2.2.2.2.cmml">j</mi></mrow></msub></mrow><mo id="S4.E6.m1.12.13.3" xref="S4.E6.m1.12.13.3.cmml">=</mo><msub id="S4.E6.m1.12.13.4" xref="S4.E6.m1.12.13.4.cmml"><mover accent="true" id="S4.E6.m1.12.13.4.2" xref="S4.E6.m1.12.13.4.2.cmml"><mi id="S4.E6.m1.12.13.4.2.2" xref="S4.E6.m1.12.13.4.2.2.cmml">𝑺</mi><mo stretchy="false" id="S4.E6.m1.12.13.4.2.1" xref="S4.E6.m1.12.13.4.2.1.cmml">^</mo></mover><mrow id="S4.E6.m1.4.4.2.4" xref="S4.E6.m1.4.4.2.3.cmml"><mi id="S4.E6.m1.3.3.1.1" xref="S4.E6.m1.3.3.1.1.cmml">i</mi><mo id="S4.E6.m1.4.4.2.4.1" xref="S4.E6.m1.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.4.4.2.2" xref="S4.E6.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S4.E6.m1.12.13.5" xref="S4.E6.m1.12.13.5.cmml">=</mo><mrow id="S4.E6.m1.12.13.6.2" xref="S4.E6.m1.12.13.6.1.cmml"><mo id="S4.E6.m1.12.13.6.2.1" xref="S4.E6.m1.12.13.6.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E6.m1.11.11" xref="S4.E6.m1.11.11.cmml"><mtr id="S4.E6.m1.11.11a" xref="S4.E6.m1.11.11.cmml"><mtd columnalign="left" id="S4.E6.m1.11.11b" xref="S4.E6.m1.11.11.cmml"><mn id="S4.E6.m1.6.6.2.3.1" xref="S4.E6.m1.6.6.2.3.1.cmml">𝟎</mn></mtd><mtd columnalign="left" id="S4.E6.m1.11.11c" xref="S4.E6.m1.11.11.cmml"><mrow id="S4.E6.m1.6.6.2.2.2" xref="S4.E6.m1.6.6.2.2.2.cmml"><mrow id="S4.E6.m1.6.6.2.2.2.4" xref="S4.E6.m1.6.6.2.2.2.4.cmml"><mtext id="S4.E6.m1.6.6.2.2.2.4.2" xref="S4.E6.m1.6.6.2.2.2.4.2a.cmml">if </mtext><mo id="S4.E6.m1.6.6.2.2.2.4.1" xref="S4.E6.m1.6.6.2.2.2.4.1.cmml">⁢</mo><msub id="S4.E6.m1.6.6.2.2.2.4.3" xref="S4.E6.m1.6.6.2.2.2.4.3.cmml"><mi id="S4.E6.m1.6.6.2.2.2.4.3.2" xref="S4.E6.m1.6.6.2.2.2.4.3.2.cmml">𝑺</mi><mrow id="S4.E6.m1.6.6.2.2.2.2.2.2" xref="S4.E6.m1.6.6.2.2.2.2.2.3.cmml"><mrow id="S4.E6.m1.6.6.2.2.2.2.2.2.1" xref="S4.E6.m1.6.6.2.2.2.2.2.2.1.cmml"><mi id="S4.E6.m1.6.6.2.2.2.2.2.2.1.2" xref="S4.E6.m1.6.6.2.2.2.2.2.2.1.2.cmml">i</mi><mo id="S4.E6.m1.6.6.2.2.2.2.2.2.1.1" xref="S4.E6.m1.6.6.2.2.2.2.2.2.1.1.cmml">+</mo><mn id="S4.E6.m1.6.6.2.2.2.2.2.2.1.3" xref="S4.E6.m1.6.6.2.2.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S4.E6.m1.6.6.2.2.2.2.2.2.2" xref="S4.E6.m1.6.6.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.5.5.1.1.1.1.1.1" xref="S4.E6.m1.5.5.1.1.1.1.1.1.cmml">j</mi></mrow></msub></mrow><mo id="S4.E6.m1.6.6.2.2.2.3" xref="S4.E6.m1.6.6.2.2.2.3.cmml">=</mo><mn id="S4.E6.m1.6.6.2.2.2.5" xref="S4.E6.m1.6.6.2.2.2.5.cmml">𝟎</mn></mrow></mtd></mtr><mtr id="S4.E6.m1.11.11d" xref="S4.E6.m1.11.11.cmml"><mtd columnalign="left" id="S4.E6.m1.11.11e" xref="S4.E6.m1.11.11.cmml"><mrow id="S4.E6.m1.11.11.7.5.5" xref="S4.E6.m1.11.11.7.5.5.cmml"><mstyle displaystyle="false" id="S4.E6.m1.11.11.7.5.5.6" xref="S4.E6.m1.11.11.7.5.5.6.cmml"><msub id="S4.E6.m1.11.11.7.5.5.6a" xref="S4.E6.m1.11.11.7.5.5.6.cmml"><mo largeop="true" symmetric="true" id="S4.E6.m1.11.11.7.5.5.6.2" xref="S4.E6.m1.11.11.7.5.5.6.2.cmml">∑</mo><mrow id="S4.E6.m1.8.8.4.2.2.2.2" xref="S4.E6.m1.8.8.4.2.2.2.2.cmml"><msub id="S4.E6.m1.8.8.4.2.2.2.2.4" xref="S4.E6.m1.8.8.4.2.2.2.2.4.cmml"><mi id="S4.E6.m1.8.8.4.2.2.2.2.4.2" xref="S4.E6.m1.8.8.4.2.2.2.2.4.2.cmml">𝑺</mi><mrow id="S4.E6.m1.8.8.4.2.2.2.2.2.2.4" xref="S4.E6.m1.8.8.4.2.2.2.2.2.2.3.cmml"><mi id="S4.E6.m1.7.7.3.1.1.1.1.1.1.1" xref="S4.E6.m1.7.7.3.1.1.1.1.1.1.1.cmml">t</mi><mo id="S4.E6.m1.8.8.4.2.2.2.2.2.2.4.1" xref="S4.E6.m1.8.8.4.2.2.2.2.2.2.3.cmml">,</mo><mi id="S4.E6.m1.8.8.4.2.2.2.2.2.2.2" xref="S4.E6.m1.8.8.4.2.2.2.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.E6.m1.8.8.4.2.2.2.2.3" xref="S4.E6.m1.8.8.4.2.2.2.2.3.cmml">∈</mo><msubsup id="S4.E6.m1.8.8.4.2.2.2.2.5" xref="S4.E6.m1.8.8.4.2.2.2.2.5.cmml"><mi id="S4.E6.m1.8.8.4.2.2.2.2.5.2.2" xref="S4.E6.m1.8.8.4.2.2.2.2.5.2.2.cmml">C</mi><mi id="S4.E6.m1.8.8.4.2.2.2.2.5.2.3" xref="S4.E6.m1.8.8.4.2.2.2.2.5.2.3.cmml">j</mi><mi id="S4.E6.m1.8.8.4.2.2.2.2.5.3" xref="S4.E6.m1.8.8.4.2.2.2.2.5.3.cmml">i</mi></msubsup></mrow></msub></mstyle><mrow id="S4.E6.m1.11.11.7.5.5.5" xref="S4.E6.m1.11.11.7.5.5.5.cmml"><msub id="S4.E6.m1.11.11.7.5.5.5.3" xref="S4.E6.m1.11.11.7.5.5.5.3.cmml"><mi id="S4.E6.m1.11.11.7.5.5.5.3.2" xref="S4.E6.m1.11.11.7.5.5.5.3.2.cmml">𝑺</mi><mrow id="S4.E6.m1.10.10.6.4.4.4.2.4" xref="S4.E6.m1.10.10.6.4.4.4.2.3.cmml"><mi id="S4.E6.m1.9.9.5.3.3.3.1.1" xref="S4.E6.m1.9.9.5.3.3.3.1.1.cmml">t</mi><mo id="S4.E6.m1.10.10.6.4.4.4.2.4.1" xref="S4.E6.m1.10.10.6.4.4.4.2.3.cmml">,</mo><mi id="S4.E6.m1.10.10.6.4.4.4.2.2" xref="S4.E6.m1.10.10.6.4.4.4.2.2.cmml">j</mi></mrow></msub><mo id="S4.E6.m1.11.11.7.5.5.5.2" xref="S4.E6.m1.11.11.7.5.5.5.2.cmml">/</mo><mrow id="S4.E6.m1.11.11.7.5.5.5.1.1" xref="S4.E6.m1.11.11.7.5.5.5.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.11.11.7.5.5.5.1.1.2" xref="S4.E6.m1.11.11.7.5.5.5.1.2.1.cmml">|</mo><msubsup id="S4.E6.m1.11.11.7.5.5.5.1.1.1" xref="S4.E6.m1.11.11.7.5.5.5.1.1.1.cmml"><mi id="S4.E6.m1.11.11.7.5.5.5.1.1.1.2.2" xref="S4.E6.m1.11.11.7.5.5.5.1.1.1.2.2.cmml">C</mi><mi id="S4.E6.m1.11.11.7.5.5.5.1.1.1.2.3" xref="S4.E6.m1.11.11.7.5.5.5.1.1.1.2.3.cmml">j</mi><mi id="S4.E6.m1.11.11.7.5.5.5.1.1.1.3" xref="S4.E6.m1.11.11.7.5.5.5.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.E6.m1.11.11.7.5.5.5.1.1.3" xref="S4.E6.m1.11.11.7.5.5.5.1.2.1.cmml">|</mo></mrow></mrow></mrow></mtd><mtd columnalign="left" id="S4.E6.m1.11.11f" xref="S4.E6.m1.11.11.cmml"><mtext id="S4.E6.m1.11.11.7.6.1" xref="S4.E6.m1.11.11.7.6.1a.cmml">otherwise.</mtext></mtd></mtr></mtable><mi id="S4.E6.m1.12.13.6.2.2" xref="S4.E6.m1.12.13.6.1.1.cmml"/></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr>
</table>
<p id="S4.SS1.p3.34" class="ltx_p"><span class="gd_word" id="S4.SS1.p3.34.1.w1">where</span><span> </span><math id="S4.SS1.p3.21.m1.7" class="ltx_Math" alttext="C_{j}^{i}=\{{\bm{\mathsfit{S}}}_{1,j}\}\cup\{{\bm{\mathsfit{S}}}_{t,j}|x^{%&#10;\mathcal{N}}_{t}\in\mathcal{R}(x^{\mathcal{N}}_{i})\}" display="inline"><semantics id="S4.SS1.p3.21.m1.7a"><mrow id="S4.SS1.p3.21.m1.7.7" xref="S4.SS1.p3.21.m1.7.7.cmml"><msubsup id="S4.SS1.p3.21.m1.7.7.5" xref="S4.SS1.p3.21.m1.7.7.5.cmml"><mi id="S4.SS1.p3.21.m1.7.7.5.2.2" xref="S4.SS1.p3.21.m1.7.7.5.2.2.cmml">C</mi><mi id="S4.SS1.p3.21.m1.7.7.5.2.3" xref="S4.SS1.p3.21.m1.7.7.5.2.3.cmml">j</mi><mi id="S4.SS1.p3.21.m1.7.7.5.3" xref="S4.SS1.p3.21.m1.7.7.5.3.cmml">i</mi></msubsup><mo id="S4.SS1.p3.21.m1.7.7.4" xref="S4.SS1.p3.21.m1.7.7.4.cmml">=</mo><mrow id="S4.SS1.p3.21.m1.7.7.3" xref="S4.SS1.p3.21.m1.7.7.3.cmml"><mrow id="S4.SS1.p3.21.m1.5.5.1.1.1" xref="S4.SS1.p3.21.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.21.m1.5.5.1.1.1.2" xref="S4.SS1.p3.21.m1.5.5.1.1.2.cmml">{</mo><msub id="S4.SS1.p3.21.m1.5.5.1.1.1.1" xref="S4.SS1.p3.21.m1.5.5.1.1.1.1.cmml"><mi id="S4.SS1.p3.21.m1.5.5.1.1.1.1.2" xref="S4.SS1.p3.21.m1.5.5.1.1.1.1.2.cmml">𝑺</mi><mrow id="S4.SS1.p3.21.m1.2.2.2.4" xref="S4.SS1.p3.21.m1.2.2.2.3.cmml"><mn id="S4.SS1.p3.21.m1.1.1.1.1" xref="S4.SS1.p3.21.m1.1.1.1.1.cmml">1</mn><mo id="S4.SS1.p3.21.m1.2.2.2.4.1" xref="S4.SS1.p3.21.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.21.m1.2.2.2.2" xref="S4.SS1.p3.21.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S4.SS1.p3.21.m1.5.5.1.1.1.3" xref="S4.SS1.p3.21.m1.5.5.1.1.2.cmml">}</mo></mrow><mo id="S4.SS1.p3.21.m1.7.7.3.4" xref="S4.SS1.p3.21.m1.7.7.3.4.cmml">∪</mo><mrow id="S4.SS1.p3.21.m1.7.7.3.3.2" xref="S4.SS1.p3.21.m1.7.7.3.3.3.cmml"><mo stretchy="false" id="S4.SS1.p3.21.m1.7.7.3.3.2.3" xref="S4.SS1.p3.21.m1.7.7.3.3.3.1.cmml">{</mo><msub id="S4.SS1.p3.21.m1.6.6.2.2.1.1" xref="S4.SS1.p3.21.m1.6.6.2.2.1.1.cmml"><mi id="S4.SS1.p3.21.m1.6.6.2.2.1.1.2" xref="S4.SS1.p3.21.m1.6.6.2.2.1.1.2.cmml">𝑺</mi><mrow id="S4.SS1.p3.21.m1.4.4.2.4" xref="S4.SS1.p3.21.m1.4.4.2.3.cmml"><mi id="S4.SS1.p3.21.m1.3.3.1.1" xref="S4.SS1.p3.21.m1.3.3.1.1.cmml">t</mi><mo id="S4.SS1.p3.21.m1.4.4.2.4.1" xref="S4.SS1.p3.21.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS1.p3.21.m1.4.4.2.2" xref="S4.SS1.p3.21.m1.4.4.2.2.cmml">j</mi></mrow></msub><mo stretchy="false" id="S4.SS1.p3.21.m1.7.7.3.3.2.4" xref="S4.SS1.p3.21.m1.7.7.3.3.3.1.cmml">|</mo><mrow id="S4.SS1.p3.21.m1.7.7.3.3.2.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.cmml"><msubsup id="S4.SS1.p3.21.m1.7.7.3.3.2.2.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.cmml"><mi id="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.2.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.2.2.cmml">x</mi><mi id="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.2.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.3.2.3.cmml">𝒩</mi></msubsup><mo id="S4.SS1.p3.21.m1.7.7.3.3.2.2.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.2.cmml">∈</mo><mrow id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.3.cmml">ℛ</mi><mo id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.cmml"><mi id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.2.2" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.2.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.3" xref="S4.SS1.p3.21.m1.7.7.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.p3.21.m1.7.7.3.3.2.5" xref="S4.SS1.p3.21.m1.7.7.3.3.3.1.cmml">}</mo></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.34.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w2">is</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w4">set</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w5">of</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w6">vectors</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.2.w7">in</span><span> </span><math id="S4.SS1.p3.22.m2.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.SS1.p3.22.m2.1a"><mi id="S4.SS1.p3.22.m2.1.1" xref="S4.SS1.p3.22.m2.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.34.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w2">representing</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w4">leaves</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w5">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w6">nodes</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w7">in</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w9">branch</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w10">that</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w11">starts</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.3.w12">with</span><span> </span><math id="S4.SS1.p3.23.m3.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p3.23.m3.1a"><msubsup id="S4.SS1.p3.23.m3.1.1" xref="S4.SS1.p3.23.m3.1.1.cmml"><mi id="S4.SS1.p3.23.m3.1.1.2.2" xref="S4.SS1.p3.23.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.23.m3.1.1.2.3" xref="S4.SS1.p3.23.m3.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.23.m3.1.1.3" xref="S4.SS1.p3.23.m3.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.4.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.4.w3">ends</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.4.w4">with</span><span> </span><math id="S4.SS1.p3.24.m4.1" class="ltx_Math" alttext="x_{j}^{\mathcal{L}}" display="inline"><semantics id="S4.SS1.p3.24.m4.1a"><msubsup id="S4.SS1.p3.24.m4.1.1" xref="S4.SS1.p3.24.m4.1.1.cmml"><mi id="S4.SS1.p3.24.m4.1.1.2.2" xref="S4.SS1.p3.24.m4.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.24.m4.1.1.2.3" xref="S4.SS1.p3.24.m4.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.24.m4.1.1.3" xref="S4.SS1.p3.24.m4.1.1.3.cmml">ℒ</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.5.w1">.
Note</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w2">that</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w3">we</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w4">discard</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w5">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w6">leaves</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.5.w7">in</span><span> </span><math id="S4.SS1.p3.25.m5.1" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}" display="inline"><semantics id="S4.SS1.p3.25.m5.1a"><mover accent="true" id="S4.SS1.p3.25.m5.1.1" xref="S4.SS1.p3.25.m5.1.1.cmml"><mi id="S4.SS1.p3.25.m5.1.1.2" xref="S4.SS1.p3.25.m5.1.1.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS1.p3.25.m5.1.1.1" xref="S4.SS1.p3.25.m5.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS1.p3.34.6.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.6.w2">As</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.6.w3">demonstrated</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.6.w4">in</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.6.w5">Figure</span><span> </span><a href="#S4.F1" title="Figure 1 ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S4.SS1.p3.34.7.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.7.w2">each</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.7.w3">row</span><span> </span><math id="S4.SS1.p3.26.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS1.p3.26.m6.1a"><mi id="S4.SS1.p3.26.m6.1.1" xref="S4.SS1.p3.26.m6.1.1.cmml">i</mi></semantics></math><span class="gd_word" id="S4.SS1.p3.34.8.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.8.w2">of</span><span> </span><math id="S4.SS1.p3.27.m7.1" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}" display="inline"><semantics id="S4.SS1.p3.27.m7.1a"><mover accent="true" id="S4.SS1.p3.27.m7.1.1" xref="S4.SS1.p3.27.m7.1.1.cmml"><mi id="S4.SS1.p3.27.m7.1.1.2" xref="S4.SS1.p3.27.m7.1.1.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS1.p3.27.m7.1.1.1" xref="S4.SS1.p3.27.m7.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS1.p3.34.9.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.9.w2">represents</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.9.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.9.w4">nonterminal</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.9.w5">node</span><span> </span><math id="S4.SS1.p3.28.m8.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p3.28.m8.1a"><msubsup id="S4.SS1.p3.28.m8.1.1" xref="S4.SS1.p3.28.m8.1.1.cmml"><mi id="S4.SS1.p3.28.m8.1.1.2.2" xref="S4.SS1.p3.28.m8.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.28.m8.1.1.2.3" xref="S4.SS1.p3.28.m8.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.28.m8.1.1.3" xref="S4.SS1.p3.28.m8.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.10.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.10.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.10.w3">each</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.10.w4">entry</span><span> </span><math id="S4.SS1.p3.29.m9.2" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}_{i,j}" display="inline"><semantics id="S4.SS1.p3.29.m9.2a"><msub id="S4.SS1.p3.29.m9.2.3" xref="S4.SS1.p3.29.m9.2.3.cmml"><mover accent="true" id="S4.SS1.p3.29.m9.2.3.2" xref="S4.SS1.p3.29.m9.2.3.2.cmml"><mi id="S4.SS1.p3.29.m9.2.3.2.2" xref="S4.SS1.p3.29.m9.2.3.2.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS1.p3.29.m9.2.3.2.1" xref="S4.SS1.p3.29.m9.2.3.2.1.cmml">^</mo></mover><mrow id="S4.SS1.p3.29.m9.2.2.2.4" xref="S4.SS1.p3.29.m9.2.2.2.3.cmml"><mi id="S4.SS1.p3.29.m9.1.1.1.1" xref="S4.SS1.p3.29.m9.1.1.1.1.cmml">i</mi><mo id="S4.SS1.p3.29.m9.2.2.2.4.1" xref="S4.SS1.p3.29.m9.2.2.2.3.cmml">,</mo><mi id="S4.SS1.p3.29.m9.2.2.2.2" xref="S4.SS1.p3.29.m9.2.2.2.2.cmml">j</mi></mrow></msub></semantics></math><span class="gd_word" id="S4.SS1.p3.34.11.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w2">represents</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w3">its</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w4">vector</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w5">representation</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w6">reflecting</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w8">tree</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w9">branch</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.11.w10">from</span><span> </span><math id="S4.SS1.p3.30.m10.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p3.30.m10.1a"><msubsup id="S4.SS1.p3.30.m10.1.1" xref="S4.SS1.p3.30.m10.1.1.cmml"><mi id="S4.SS1.p3.30.m10.1.1.2.2" xref="S4.SS1.p3.30.m10.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.30.m10.1.1.2.3" xref="S4.SS1.p3.30.m10.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.30.m10.1.1.3" xref="S4.SS1.p3.30.m10.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.12.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.12.w2">to</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.12.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.12.w4">leaf</span><span> </span><math id="S4.SS1.p3.31.m11.1" class="ltx_Math" alttext="x_{j}^{\mathcal{L}}" display="inline"><semantics id="S4.SS1.p3.31.m11.1a"><msubsup id="S4.SS1.p3.31.m11.1.1" xref="S4.SS1.p3.31.m11.1.1.cmml"><mi id="S4.SS1.p3.31.m11.1.1.2.2" xref="S4.SS1.p3.31.m11.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.31.m11.1.1.2.3" xref="S4.SS1.p3.31.m11.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.31.m11.1.1.3" xref="S4.SS1.p3.31.m11.1.1.3.cmml">ℒ</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.13.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.13.w2">This</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.13.w3">gives</span><span> </span><math id="S4.SS1.p3.32.m12.1" class="ltx_Math" alttext="|\mathcal{R}(x_{i}^{\mathcal{N}})\cap\mathcal{L}|" display="inline"><semantics id="S4.SS1.p3.32.m12.1a"><mrow id="S4.SS1.p3.32.m12.1.1.1" xref="S4.SS1.p3.32.m12.1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p3.32.m12.1.1.1.2" xref="S4.SS1.p3.32.m12.1.1.2.1.cmml">|</mo><mrow id="S4.SS1.p3.32.m12.1.1.1.1" xref="S4.SS1.p3.32.m12.1.1.1.1.cmml"><mrow id="S4.SS1.p3.32.m12.1.1.1.1.1" xref="S4.SS1.p3.32.m12.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.32.m12.1.1.1.1.1.3" xref="S4.SS1.p3.32.m12.1.1.1.1.1.3.cmml">ℛ</mi><mo id="S4.SS1.p3.32.m12.1.1.1.1.1.2" xref="S4.SS1.p3.32.m12.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.32.m12.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p3.32.m12.1.1.1.1.2" xref="S4.SS1.p3.32.m12.1.1.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.32.m12.1.1.1.1.3" xref="S4.SS1.p3.32.m12.1.1.1.1.3.cmml">ℒ</mi></mrow><mo stretchy="false" id="S4.SS1.p3.32.m12.1.1.1.3" xref="S4.SS1.p3.32.m12.1.1.2.1.cmml">|</mo></mrow></semantics></math><span class="gd_word" id="S4.SS1.p3.34.14.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.14.w2">different</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.14.w3">constituents</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.14.w4">of</span><span> </span><math id="S4.SS1.p3.33.m13.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p3.33.m13.1a"><msubsup id="S4.SS1.p3.33.m13.1.1" xref="S4.SS1.p3.33.m13.1.1.cmml"><mi id="S4.SS1.p3.33.m13.1.1.2.2" xref="S4.SS1.p3.33.m13.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.33.m13.1.1.2.3" xref="S4.SS1.p3.33.m13.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.33.m13.1.1.3" xref="S4.SS1.p3.33.m13.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.15.w1"/><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w2">that</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w3">represent</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w5">branches</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w6">rooted</span><span> </span><span class="gd_word" id="S4.SS1.p3.34.15.w7">at</span><span> </span><math id="S4.SS1.p3.34.m14.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p3.34.m14.1a"><msubsup id="S4.SS1.p3.34.m14.1.1" xref="S4.SS1.p3.34.m14.1.1.cmml"><mi id="S4.SS1.p3.34.m14.1.1.2.2" xref="S4.SS1.p3.34.m14.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p3.34.m14.1.1.2.3" xref="S4.SS1.p3.34.m14.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p3.34.m14.1.1.3" xref="S4.SS1.p3.34.m14.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p3.34.16.w1">.</span></p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.9" class="ltx_p"><span class="gd_word" id="S4.SS1.p4.9.1.w1">The</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w2">next</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w3">task</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w5">to</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w6">combine</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w8">branch-level</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w9">accumulated</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w10">representations</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w11">of</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w12">a</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.1.w13">nonterminal</span><span> </span><math id="S4.SS1.p4.1.m1.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p4.1.m1.1a"><msubsup id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.2.2" xref="S4.SS1.p4.1.m1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p4.1.m1.1.1.2.3" xref="S4.SS1.p4.1.m1.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p4.9.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.2.w2">into</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.2.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.2.w4">single</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.2.w5">vector</span><span> </span><math id="S4.SS1.p4.2.m2.1" class="ltx_Math" alttext="\overline{{\bm{n}}}_{i}" display="inline"><semantics id="S4.SS1.p4.2.m2.1a"><msub id="S4.SS1.p4.2.m2.1.1" xref="S4.SS1.p4.2.m2.1.1.cmml"><mover accent="true" id="S4.SS1.p4.2.m2.1.1.2" xref="S4.SS1.p4.2.m2.1.1.2.cmml"><mi id="S4.SS1.p4.2.m2.1.1.2.2" xref="S4.SS1.p4.2.m2.1.1.2.2.cmml">𝒏</mi><mo id="S4.SS1.p4.2.m2.1.1.2.1" xref="S4.SS1.p4.2.m2.1.1.2.1.cmml">¯</mo></mover><mi id="S4.SS1.p4.2.m2.1.1.3" xref="S4.SS1.p4.2.m2.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S4.SS1.p4.9.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w2">that</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w3">encapsulates</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w4">all</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w5">the</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w6">elements</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w7">in</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w9">subtree</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w10">rooted</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.3.w11">by</span><span> </span><math id="S4.SS1.p4.3.m3.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS1.p4.3.m3.1a"><msubsup id="S4.SS1.p4.3.m3.1.1" xref="S4.SS1.p4.3.m3.1.1.cmml"><mi id="S4.SS1.p4.3.m3.1.1.2.2" xref="S4.SS1.p4.3.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p4.3.m3.1.1.2.3" xref="S4.SS1.p4.3.m3.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.3.m3.1.1.3" xref="S4.SS1.p4.3.m3.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p4.9.4.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w2">Our</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w3">method</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w4">does</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w5">so</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w6">with</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w7">a</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w8">weighted</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w9">aggregation</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w10">operation.</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w11">The</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w12">aggregation</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.4.w13">function</span><span> </span><math id="S4.SS1.p4.4.m4.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S4.SS1.p4.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p4.4.m4.1.1" xref="S4.SS1.p4.4.m4.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S4.SS1.p4.9.5.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.5.w2">takes</span><span> </span><math id="S4.SS1.p4.5.m5.1" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}" display="inline"><semantics id="S4.SS1.p4.5.m5.1a"><mover accent="true" id="S4.SS1.p4.5.m5.1.1" xref="S4.SS1.p4.5.m5.1.1.cmml"><mi id="S4.SS1.p4.5.m5.1.1.2" xref="S4.SS1.p4.5.m5.1.1.2.cmml">𝑺</mi><mo stretchy="false" id="S4.SS1.p4.5.m5.1.1.1" xref="S4.SS1.p4.5.m5.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS1.p4.9.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w2">as</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w3">input</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w4">and</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w5">a</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w6">weighting</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.6.w7">vector</span><span> </span><math id="S4.SS1.p4.6.m6.1" class="ltx_Math" alttext="{\bm{w}}\in{\mathbb{R}}^{n}" display="inline"><semantics id="S4.SS1.p4.6.m6.1a"><mrow id="S4.SS1.p4.6.m6.1.1" xref="S4.SS1.p4.6.m6.1.1.cmml"><mi id="S4.SS1.p4.6.m6.1.1.2" xref="S4.SS1.p4.6.m6.1.1.2.cmml">𝒘</mi><mo id="S4.SS1.p4.6.m6.1.1.1" xref="S4.SS1.p4.6.m6.1.1.1.cmml">∈</mo><msup id="S4.SS1.p4.6.m6.1.1.3" xref="S4.SS1.p4.6.m6.1.1.3.cmml"><mi id="S4.SS1.p4.6.m6.1.1.3.2" xref="S4.SS1.p4.6.m6.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS1.p4.6.m6.1.1.3.3" xref="S4.SS1.p4.6.m6.1.1.3.3.cmml">n</mi></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p4.9.7.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w3">computes</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w5">final</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w6">node</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.7.w7">representations</span><span> </span><math id="S4.SS1.p4.7.m7.3" class="ltx_Math" alttext="\overline{{\bm{N}}}=(\overline{{\bm{n}}}_{1},...,\overline{{\bm{n}}}_{m})\in{%&#10;\mathbb{R}}^{m\times d}" display="inline"><semantics id="S4.SS1.p4.7.m7.3a"><mrow id="S4.SS1.p4.7.m7.3.3" xref="S4.SS1.p4.7.m7.3.3.cmml"><mover accent="true" id="S4.SS1.p4.7.m7.3.3.4" xref="S4.SS1.p4.7.m7.3.3.4.cmml"><mi id="S4.SS1.p4.7.m7.3.3.4.2" xref="S4.SS1.p4.7.m7.3.3.4.2.cmml">𝑵</mi><mo id="S4.SS1.p4.7.m7.3.3.4.1" xref="S4.SS1.p4.7.m7.3.3.4.1.cmml">¯</mo></mover><mo id="S4.SS1.p4.7.m7.3.3.5" xref="S4.SS1.p4.7.m7.3.3.5.cmml">=</mo><mrow id="S4.SS1.p4.7.m7.3.3.2.2" xref="S4.SS1.p4.7.m7.3.3.2.3.cmml"><mo stretchy="false" id="S4.SS1.p4.7.m7.3.3.2.2.3" xref="S4.SS1.p4.7.m7.3.3.2.3.cmml">(</mo><msub id="S4.SS1.p4.7.m7.2.2.1.1.1" xref="S4.SS1.p4.7.m7.2.2.1.1.1.cmml"><mover accent="true" id="S4.SS1.p4.7.m7.2.2.1.1.1.2" xref="S4.SS1.p4.7.m7.2.2.1.1.1.2.cmml"><mi id="S4.SS1.p4.7.m7.2.2.1.1.1.2.2" xref="S4.SS1.p4.7.m7.2.2.1.1.1.2.2.cmml">𝒏</mi><mo id="S4.SS1.p4.7.m7.2.2.1.1.1.2.1" xref="S4.SS1.p4.7.m7.2.2.1.1.1.2.1.cmml">¯</mo></mover><mn id="S4.SS1.p4.7.m7.2.2.1.1.1.3" xref="S4.SS1.p4.7.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.p4.7.m7.3.3.2.2.4" xref="S4.SS1.p4.7.m7.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS1.p4.7.m7.1.1" xref="S4.SS1.p4.7.m7.1.1.cmml">…</mi><mo id="S4.SS1.p4.7.m7.3.3.2.2.5" xref="S4.SS1.p4.7.m7.3.3.2.3.cmml">,</mo><msub id="S4.SS1.p4.7.m7.3.3.2.2.2" xref="S4.SS1.p4.7.m7.3.3.2.2.2.cmml"><mover accent="true" id="S4.SS1.p4.7.m7.3.3.2.2.2.2" xref="S4.SS1.p4.7.m7.3.3.2.2.2.2.cmml"><mi id="S4.SS1.p4.7.m7.3.3.2.2.2.2.2" xref="S4.SS1.p4.7.m7.3.3.2.2.2.2.2.cmml">𝒏</mi><mo id="S4.SS1.p4.7.m7.3.3.2.2.2.2.1" xref="S4.SS1.p4.7.m7.3.3.2.2.2.2.1.cmml">¯</mo></mover><mi id="S4.SS1.p4.7.m7.3.3.2.2.2.3" xref="S4.SS1.p4.7.m7.3.3.2.2.2.3.cmml">m</mi></msub><mo stretchy="false" id="S4.SS1.p4.7.m7.3.3.2.2.6" xref="S4.SS1.p4.7.m7.3.3.2.3.cmml">)</mo></mrow><mo id="S4.SS1.p4.7.m7.3.3.6" xref="S4.SS1.p4.7.m7.3.3.6.cmml">∈</mo><msup id="S4.SS1.p4.7.m7.3.3.7" xref="S4.SS1.p4.7.m7.3.3.7.cmml"><mi id="S4.SS1.p4.7.m7.3.3.7.2" xref="S4.SS1.p4.7.m7.3.3.7.2.cmml">ℝ</mi><mrow id="S4.SS1.p4.7.m7.3.3.7.3" xref="S4.SS1.p4.7.m7.3.3.7.3.cmml"><mi id="S4.SS1.p4.7.m7.3.3.7.3.2" xref="S4.SS1.p4.7.m7.3.3.7.3.2.cmml">m</mi><mo id="S4.SS1.p4.7.m7.3.3.7.3.1" xref="S4.SS1.p4.7.m7.3.3.7.3.1.cmml">×</mo><mi id="S4.SS1.p4.7.m7.3.3.7.3.3" xref="S4.SS1.p4.7.m7.3.3.7.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.p4.9.8.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.8.w2">where</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.8.w3">each</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.8.w4">row-vector</span><span> </span><math id="S4.SS1.p4.8.m8.1" class="ltx_Math" alttext="\overline{{\bm{n}}}_{i}" display="inline"><semantics id="S4.SS1.p4.8.m8.1a"><msub id="S4.SS1.p4.8.m8.1.1" xref="S4.SS1.p4.8.m8.1.1.cmml"><mover accent="true" id="S4.SS1.p4.8.m8.1.1.2" xref="S4.SS1.p4.8.m8.1.1.2.cmml"><mi id="S4.SS1.p4.8.m8.1.1.2.2" xref="S4.SS1.p4.8.m8.1.1.2.2.cmml">𝒏</mi><mo id="S4.SS1.p4.8.m8.1.1.2.1" xref="S4.SS1.p4.8.m8.1.1.2.1.cmml">¯</mo></mover><mi id="S4.SS1.p4.8.m8.1.1.3" xref="S4.SS1.p4.8.m8.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S4.SS1.p4.9.9.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.9.w2">in</span><span> </span><math id="S4.SS1.p4.9.m9.1" class="ltx_Math" alttext="\overline{{\bm{N}}}" display="inline"><semantics id="S4.SS1.p4.9.m9.1a"><mover accent="true" id="S4.SS1.p4.9.m9.1.1" xref="S4.SS1.p4.9.m9.1.1.cmml"><mi id="S4.SS1.p4.9.m9.1.1.2" xref="S4.SS1.p4.9.m9.1.1.2.cmml">𝑵</mi><mo id="S4.SS1.p4.9.m9.1.1.1" xref="S4.SS1.p4.9.m9.1.1.1.cmml">¯</mo></mover></semantics></math><span class="gd_word" id="S4.SS1.p4.9.10.w1"/><span> </span><span class="gd_word" id="S4.SS1.p4.9.10.w2">is</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.10.w3">computed</span><span> </span><span class="gd_word" id="S4.SS1.p4.9.10.w4">as:</span></p>
</div>
<div id="S4.SS1.p5" class="ltx_para ltx_noindent">
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.6" class="ltx_Math" alttext="\mathcal{V}(\hat{{\bm{\mathsfit{S}}}},{\bm{w}})_{i}=\overline{{\bm{n}}}_{i}=%&#10;\frac{1}{|\mathcal{L}\cap\mathcal{R}(x^{\mathcal{N}}_{i})|}\sum_{j:x^{\mathcal%&#10;{L}}_{j}\in\mathcal{R}(x^{\mathcal{N}}_{i})}{w}_{j}\odot\hat{{\bm{\mathsfit{S}%&#10;}}}_{i,j}" display="block"><semantics id="S4.E7.m1.6a"><mrow id="S4.E7.m1.6.7" xref="S4.E7.m1.6.7.cmml"><mrow id="S4.E7.m1.6.7.2" xref="S4.E7.m1.6.7.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.6.7.2.2" xref="S4.E7.m1.6.7.2.2.cmml">𝒱</mi><mo id="S4.E7.m1.6.7.2.1" xref="S4.E7.m1.6.7.2.1.cmml">⁢</mo><msub id="S4.E7.m1.6.7.2.3" xref="S4.E7.m1.6.7.2.3.cmml"><mrow id="S4.E7.m1.6.7.2.3.2.2" xref="S4.E7.m1.6.7.2.3.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.6.7.2.3.2.2.1" xref="S4.E7.m1.6.7.2.3.2.1.cmml">(</mo><mover accent="true" id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml"><mi id="S4.E7.m1.5.5.2" xref="S4.E7.m1.5.5.2.cmml">𝑺</mi><mo stretchy="false" id="S4.E7.m1.5.5.1" xref="S4.E7.m1.5.5.1.cmml">^</mo></mover><mo id="S4.E7.m1.6.7.2.3.2.2.2" xref="S4.E7.m1.6.7.2.3.2.1.cmml">,</mo><mi id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml">𝒘</mi><mo stretchy="false" id="S4.E7.m1.6.7.2.3.2.2.3" xref="S4.E7.m1.6.7.2.3.2.1.cmml">)</mo></mrow><mi id="S4.E7.m1.6.7.2.3.3" xref="S4.E7.m1.6.7.2.3.3.cmml">i</mi></msub></mrow><mo id="S4.E7.m1.6.7.3" xref="S4.E7.m1.6.7.3.cmml">=</mo><msub id="S4.E7.m1.6.7.4" xref="S4.E7.m1.6.7.4.cmml"><mover accent="true" id="S4.E7.m1.6.7.4.2" xref="S4.E7.m1.6.7.4.2.cmml"><mi id="S4.E7.m1.6.7.4.2.2" xref="S4.E7.m1.6.7.4.2.2.cmml">𝒏</mi><mo id="S4.E7.m1.6.7.4.2.1" xref="S4.E7.m1.6.7.4.2.1.cmml">¯</mo></mover><mi id="S4.E7.m1.6.7.4.3" xref="S4.E7.m1.6.7.4.3.cmml">i</mi></msub><mo id="S4.E7.m1.6.7.5" xref="S4.E7.m1.6.7.5.cmml">=</mo><mrow id="S4.E7.m1.6.7.6" xref="S4.E7.m1.6.7.6.cmml"><mfrac id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml"><mn id="S4.E7.m1.1.1.3" xref="S4.E7.m1.1.1.3.cmml">1</mn><mrow id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo><mrow id="S4.E7.m1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.3.cmml">ℒ</mi><mo id="S4.E7.m1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.2.cmml">∩</mo><mrow id="S4.E7.m1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.3.cmml">ℛ</mi><mo id="S4.E7.m1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.1.1.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E7.m1.1.1.1.1.1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E7.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.E7.m1.1.1.1.1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.E7.m1.1.1.1.1.3" xref="S4.E7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S4.E7.m1.6.7.6.1" xref="S4.E7.m1.6.7.6.1.cmml">⁢</mo><mrow id="S4.E7.m1.6.7.6.2" xref="S4.E7.m1.6.7.6.2.cmml"><munder id="S4.E7.m1.6.7.6.2.1" xref="S4.E7.m1.6.7.6.2.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S4.E7.m1.6.7.6.2.1.2" xref="S4.E7.m1.6.7.6.2.1.2.cmml">∑</mo><mrow id="S4.E7.m1.2.2.1" xref="S4.E7.m1.2.2.1.cmml"><mi id="S4.E7.m1.2.2.1.3" xref="S4.E7.m1.2.2.1.3.cmml">j</mi><mo id="S4.E7.m1.2.2.1.2" xref="S4.E7.m1.2.2.1.2.cmml">:</mo><mrow id="S4.E7.m1.2.2.1.1" xref="S4.E7.m1.2.2.1.1.cmml"><msubsup id="S4.E7.m1.2.2.1.1.3" xref="S4.E7.m1.2.2.1.1.3.cmml"><mi id="S4.E7.m1.2.2.1.1.3.2.2" xref="S4.E7.m1.2.2.1.1.3.2.2.cmml">x</mi><mi id="S4.E7.m1.2.2.1.1.3.3" xref="S4.E7.m1.2.2.1.1.3.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.1.1.3.2.3" xref="S4.E7.m1.2.2.1.1.3.2.3.cmml">ℒ</mi></msubsup><mo id="S4.E7.m1.2.2.1.1.2" xref="S4.E7.m1.2.2.1.1.2.cmml">∈</mo><mrow id="S4.E7.m1.2.2.1.1.1" xref="S4.E7.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.3.cmml">ℛ</mi><mo id="S4.E7.m1.2.2.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E7.m1.2.2.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E7.m1.2.2.1.1.1.1.1.1" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.2.2" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E7.m1.2.2.1.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.2.2.1.1.1.1.1.1.2.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.E7.m1.2.2.1.1.1.1.1.3" xref="S4.E7.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></munder><mrow id="S4.E7.m1.6.7.6.2.2" xref="S4.E7.m1.6.7.6.2.2.cmml"><msub id="S4.E7.m1.6.7.6.2.2.2" xref="S4.E7.m1.6.7.6.2.2.2.cmml"><mi id="S4.E7.m1.6.7.6.2.2.2.2" xref="S4.E7.m1.6.7.6.2.2.2.2.cmml">w</mi><mi id="S4.E7.m1.6.7.6.2.2.2.3" xref="S4.E7.m1.6.7.6.2.2.2.3.cmml">j</mi></msub><mo id="S4.E7.m1.6.7.6.2.2.1" xref="S4.E7.m1.6.7.6.2.2.1.cmml">⊙</mo><msub id="S4.E7.m1.6.7.6.2.2.3" xref="S4.E7.m1.6.7.6.2.2.3.cmml"><mover accent="true" id="S4.E7.m1.6.7.6.2.2.3.2" xref="S4.E7.m1.6.7.6.2.2.3.2.cmml"><mi id="S4.E7.m1.6.7.6.2.2.3.2.2" xref="S4.E7.m1.6.7.6.2.2.3.2.2.cmml">𝑺</mi><mo stretchy="false" id="S4.E7.m1.6.7.6.2.2.3.2.1" xref="S4.E7.m1.6.7.6.2.2.3.2.1.cmml">^</mo></mover><mrow id="S4.E7.m1.4.4.2.4" xref="S4.E7.m1.4.4.2.3.cmml"><mi id="S4.E7.m1.3.3.1.1" xref="S4.E7.m1.3.3.1.1.cmml">i</mi><mo id="S4.E7.m1.4.4.2.4.1" xref="S4.E7.m1.4.4.2.3.cmml">,</mo><mi id="S4.E7.m1.4.4.2.2" xref="S4.E7.m1.4.4.2.2.cmml">j</mi></mrow></msub></mrow></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr>
</table>
</div>
<div id="S4.SS1.p6" class="ltx_para ltx_noindent">
<p id="S4.SS1.p6.2" class="ltx_p"><span class="gd_word" id="S4.SS1.p6.2.1.w1">where</span><span> </span><math id="S4.SS1.p6.1.m1.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.SS1.p6.1.m1.1a"><mo id="S4.SS1.p6.1.m1.1.1" xref="S4.SS1.p6.1.m1.1.1.cmml">⊙</mo></semantics></math><span class="gd_word" id="S4.SS1.p6.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w4">element-wise</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w5">multiplication.</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w6">Specifically,</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w8">aggregation</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.2.w9">function</span><span> </span><math id="S4.SS1.p6.2.m2.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S4.SS1.p6.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p6.2.m2.1.1" xref="S4.SS1.p6.2.m2.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S4.SS1.p6.2.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w2">computes</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w3">a</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w4">weighted</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w5">average</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w6">of</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w8">branch-level</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w9">representations.</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w10">In</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w11">summary,</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w12">the</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w13">hierarchical</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w14">accumulation</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w15">process</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w16">can</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w17">be</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w18">expressed</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w19">as</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w20">the</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w21">following</span><span> </span><span class="gd_word" id="S4.SS1.p6.2.3.w22">equation:</span></p>
</div>
<div id="S4.SS1.p7" class="ltx_para ltx_noindent">
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.8" class="ltx_Math" alttext="\overline{{\bm{N}}}=\mathcal{V}(\mathcal{U}({\bm{\mathsfit{S}}}),{\bm{w}})=%&#10;\mathcal{V}(\mathcal{U}(\mathcal{F}({\bm{L}},{\bm{N}},\mathcal{R})),{\bm{w}})" display="block"><semantics id="S4.E8.m1.8a"><mrow id="S4.E8.m1.8.8" xref="S4.E8.m1.8.8.cmml"><mover accent="true" id="S4.E8.m1.8.8.4" xref="S4.E8.m1.8.8.4.cmml"><mi id="S4.E8.m1.8.8.4.2" xref="S4.E8.m1.8.8.4.2.cmml">𝑵</mi><mo id="S4.E8.m1.8.8.4.1" xref="S4.E8.m1.8.8.4.1.cmml">¯</mo></mover><mo id="S4.E8.m1.8.8.5" xref="S4.E8.m1.8.8.5.cmml">=</mo><mrow id="S4.E8.m1.7.7.1" xref="S4.E8.m1.7.7.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.7.7.1.3" xref="S4.E8.m1.7.7.1.3.cmml">𝒱</mi><mo id="S4.E8.m1.7.7.1.2" xref="S4.E8.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.1" xref="S4.E8.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.7.7.1.1.1.2" xref="S4.E8.m1.7.7.1.1.2.cmml">(</mo><mrow id="S4.E8.m1.7.7.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.7.7.1.1.1.1.2" xref="S4.E8.m1.7.7.1.1.1.1.2.cmml">𝒰</mi><mo id="S4.E8.m1.7.7.1.1.1.1.1" xref="S4.E8.m1.7.7.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.7.7.1.1.1.1.3.2" xref="S4.E8.m1.7.7.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.7.7.1.1.1.1.3.2.1" xref="S4.E8.m1.7.7.1.1.1.1.cmml">(</mo><mi id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml">𝑺</mi><mo stretchy="false" id="S4.E8.m1.7.7.1.1.1.1.3.2.2" xref="S4.E8.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.7.7.1.1.1.3" xref="S4.E8.m1.7.7.1.1.2.cmml">,</mo><mi id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml">𝒘</mi><mo stretchy="false" id="S4.E8.m1.7.7.1.1.1.4" xref="S4.E8.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.8.8.6" xref="S4.E8.m1.8.8.6.cmml">=</mo><mrow id="S4.E8.m1.8.8.2" xref="S4.E8.m1.8.8.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.8.8.2.3" xref="S4.E8.m1.8.8.2.3.cmml">𝒱</mi><mo id="S4.E8.m1.8.8.2.2" xref="S4.E8.m1.8.8.2.2.cmml">⁢</mo><mrow id="S4.E8.m1.8.8.2.1.1" xref="S4.E8.m1.8.8.2.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.2" xref="S4.E8.m1.8.8.2.1.2.cmml">(</mo><mrow id="S4.E8.m1.8.8.2.1.1.1" xref="S4.E8.m1.8.8.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.8.8.2.1.1.1.3" xref="S4.E8.m1.8.8.2.1.1.1.3.cmml">𝒰</mi><mo id="S4.E8.m1.8.8.2.1.1.1.2" xref="S4.E8.m1.8.8.2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E8.m1.8.8.2.1.1.1.1.1" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.1.1.1.2" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.8.8.2.1.1.1.1.1.1" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.8.8.2.1.1.1.1.1.1.2" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.2.cmml">ℱ</mi><mo id="S4.E8.m1.8.8.2.1.1.1.1.1.1.1" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.2" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.2.1" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml">𝑳</mi><mo id="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.2.2" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml">𝑵</mi><mo id="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.2.3" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml">ℛ</mi><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.2.4" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.1.1.1.3" xref="S4.E8.m1.8.8.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.8.8.2.1.1.3" xref="S4.E8.m1.8.8.2.1.2.cmml">,</mo><mi id="S4.E8.m1.6.6" xref="S4.E8.m1.6.6.cmml">𝒘</mi><mo stretchy="false" id="S4.E8.m1.8.8.2.1.1.4" xref="S4.E8.m1.8.8.2.1.2.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr>
</table>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Hierarchical Embeddings</h3>

<figure id="S4.F2" class="ltx_figure ltx_align_floatright"><img src="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/hierembed-diffcolor-zero.png" id="S4.F2.g1" class="ltx_graphics" width="" height="" alt="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/hierembed-diffcolor-zero.png"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="gd_word" id="S4.F2.2.w1">Hierarchical</span><span> </span><span class="gd_word" id="S4.F2.2.w2">Embeddings.
Each</span><span> </span><span class="gd_word" id="S4.F2.2.w3">block</span><span> </span><math id="S4.F2.8.m1.2" class="ltx_Math" alttext="{\bm{\mathsfit{E}}}_{i,j}" display="inline"><semantics id="S4.F2.8.m1.2b"><msub id="S4.F2.8.m1.2.3" xref="S4.F2.8.m1.2.3.cmml"><mi id="S4.F2.8.m1.2.3.2" xref="S4.F2.8.m1.2.3.2.cmml">𝑬</mi><mrow id="S4.F2.8.m1.2.2.2.4" xref="S4.F2.8.m1.2.2.2.3.cmml"><mi id="S4.F2.8.m1.1.1.1.1" xref="S4.F2.8.m1.1.1.1.1.cmml">i</mi><mo id="S4.F2.8.m1.2.2.2.4.1" xref="S4.F2.8.m1.2.2.2.3.cmml">,</mo><mi id="S4.F2.8.m1.2.2.2.2" xref="S4.F2.8.m1.2.2.2.2.cmml">j</mi></mrow></msub></semantics></math><span class="gd_word" id="S4.F2.3.w1"/><span> </span><span class="gd_word" id="S4.F2.3.w2">is</span><span> </span><span class="gd_word" id="S4.F2.3.w3">an</span><span> </span><span class="gd_word" id="S4.F2.3.w4">embedding</span><span> </span><span class="gd_word" id="S4.F2.3.w5">vector</span><span> </span><math id="S4.F2.9.m2.2" class="ltx_Math" alttext="[{\bm{e}}^{v}_{x};{\bm{e}}^{h}_{y}]" display="inline"><semantics id="S4.F2.9.m2.2b"><mrow id="S4.F2.9.m2.2.2.2" xref="S4.F2.9.m2.2.2.3.cmml"><mo stretchy="false" id="S4.F2.9.m2.2.2.2.3" xref="S4.F2.9.m2.2.2.3.cmml">[</mo><msubsup id="S4.F2.9.m2.1.1.1.1" xref="S4.F2.9.m2.1.1.1.1.cmml"><mi id="S4.F2.9.m2.1.1.1.1.2.2" xref="S4.F2.9.m2.1.1.1.1.2.2.cmml">𝒆</mi><mi id="S4.F2.9.m2.1.1.1.1.3" xref="S4.F2.9.m2.1.1.1.1.3.cmml">x</mi><mi id="S4.F2.9.m2.1.1.1.1.2.3" xref="S4.F2.9.m2.1.1.1.1.2.3.cmml">v</mi></msubsup><mo id="S4.F2.9.m2.2.2.2.4" xref="S4.F2.9.m2.2.2.3.cmml">;</mo><msubsup id="S4.F2.9.m2.2.2.2.2" xref="S4.F2.9.m2.2.2.2.2.cmml"><mi id="S4.F2.9.m2.2.2.2.2.2.2" xref="S4.F2.9.m2.2.2.2.2.2.2.cmml">𝒆</mi><mi id="S4.F2.9.m2.2.2.2.2.3" xref="S4.F2.9.m2.2.2.2.2.3.cmml">y</mi><mi id="S4.F2.9.m2.2.2.2.2.2.3" xref="S4.F2.9.m2.2.2.2.2.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S4.F2.9.m2.2.2.2.5" xref="S4.F2.9.m2.2.2.3.cmml">]</mo></mrow></semantics></math><span class="gd_word" id="S4.F2.4.w1"/><span> </span><span class="gd_word" id="S4.F2.4.w2">with</span><span> </span><span class="gd_word" id="S4.F2.4.w3">indices</span><span> </span><math id="S4.F2.10.m3.2" class="ltx_Math" alttext="x,y" display="inline"><semantics id="S4.F2.10.m3.2b"><mrow id="S4.F2.10.m3.2.3.2" xref="S4.F2.10.m3.2.3.1.cmml"><mi id="S4.F2.10.m3.1.1" xref="S4.F2.10.m3.1.1.cmml">x</mi><mo id="S4.F2.10.m3.2.3.2.1" xref="S4.F2.10.m3.2.3.1.cmml">,</mo><mi id="S4.F2.10.m3.2.2" xref="S4.F2.10.m3.2.2.cmml">y</mi></mrow></semantics></math><span class="gd_word" id="S4.F2.5.w1"/><span> </span><span class="gd_word" id="S4.F2.5.w2">following</span><span> </span><span class="gd_word" id="S4.F2.5.w3">the</span><span> </span><span class="gd_word" id="S4.F2.5.w4">syntax</span><span> </span><span class="gd_word" id="S4.F2.5.w5">“</span><math id="S4.F2.11.m4.2" class="ltx_Math" alttext="x;y" display="inline"><semantics id="S4.F2.11.m4.2b"><mrow id="S4.F2.11.m4.2.3.2" xref="S4.F2.11.m4.2.3.1.cmml"><mi id="S4.F2.11.m4.1.1" xref="S4.F2.11.m4.1.1.cmml">x</mi><mo id="S4.F2.11.m4.2.3.2.1" xref="S4.F2.11.m4.2.3.1.cmml">;</mo><mi id="S4.F2.11.m4.2.2" xref="S4.F2.11.m4.2.2.cmml">y</mi></mrow></semantics></math><span class="gd_word" id="S4.F2.6.w1">”,</span><span> </span><span class="gd_word" id="S4.F2.6.w2">where</span><span> </span><math id="S4.F2.12.m5.1" class="ltx_Math" alttext="x=|V_{j}^{i}|" display="inline"><semantics id="S4.F2.12.m5.1b"><mrow id="S4.F2.12.m5.1.1" xref="S4.F2.12.m5.1.1.cmml"><mi id="S4.F2.12.m5.1.1.3" xref="S4.F2.12.m5.1.1.3.cmml">x</mi><mo id="S4.F2.12.m5.1.1.2" xref="S4.F2.12.m5.1.1.2.cmml">=</mo><mrow id="S4.F2.12.m5.1.1.1.1" xref="S4.F2.12.m5.1.1.1.2.cmml"><mo stretchy="false" id="S4.F2.12.m5.1.1.1.1.2" xref="S4.F2.12.m5.1.1.1.2.1.cmml">|</mo><msubsup id="S4.F2.12.m5.1.1.1.1.1" xref="S4.F2.12.m5.1.1.1.1.1.cmml"><mi id="S4.F2.12.m5.1.1.1.1.1.2.2" xref="S4.F2.12.m5.1.1.1.1.1.2.2.cmml">V</mi><mi id="S4.F2.12.m5.1.1.1.1.1.2.3" xref="S4.F2.12.m5.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.F2.12.m5.1.1.1.1.1.3" xref="S4.F2.12.m5.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.F2.12.m5.1.1.1.1.3" xref="S4.F2.12.m5.1.1.1.2.1.cmml">|</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.F2.7.w1"/><span> </span><span class="gd_word" id="S4.F2.7.w2">and</span><span> </span><math id="S4.F2.13.m6.1" class="ltx_Math" alttext="y=|H_{j}^{i}|" display="inline"><semantics id="S4.F2.13.m6.1b"><mrow id="S4.F2.13.m6.1.1" xref="S4.F2.13.m6.1.1.cmml"><mi id="S4.F2.13.m6.1.1.3" xref="S4.F2.13.m6.1.1.3.cmml">y</mi><mo id="S4.F2.13.m6.1.1.2" xref="S4.F2.13.m6.1.1.2.cmml">=</mo><mrow id="S4.F2.13.m6.1.1.1.1" xref="S4.F2.13.m6.1.1.1.2.cmml"><mo stretchy="false" id="S4.F2.13.m6.1.1.1.1.2" xref="S4.F2.13.m6.1.1.1.2.1.cmml">|</mo><msubsup id="S4.F2.13.m6.1.1.1.1.1" xref="S4.F2.13.m6.1.1.1.1.1.cmml"><mi id="S4.F2.13.m6.1.1.1.1.1.2.2" xref="S4.F2.13.m6.1.1.1.1.1.2.2.cmml">H</mi><mi id="S4.F2.13.m6.1.1.1.1.1.2.3" xref="S4.F2.13.m6.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.F2.13.m6.1.1.1.1.1.3" xref="S4.F2.13.m6.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.F2.13.m6.1.1.1.1.3" xref="S4.F2.13.m6.1.1.1.2.1.cmml">|</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.F2.8.w1">.</span><span> </span><span class="gd_word" id="S4.F2.8.w2">“</span><math id="S4.F2.14.m7.1" class="ltx_Math" alttext="{\bm{0}}" display="inline"><semantics id="S4.F2.14.m7.1b"><mn id="S4.F2.14.m7.1.1" xref="S4.F2.14.m7.1.1.cmml">𝟎</mn></semantics></math><span class="gd_word" id="S4.F2.9.w1">”</span><span> </span><span class="gd_word" id="S4.F2.9.w2">indicates</span><span> </span><span class="gd_word" id="S4.F2.9.w3">no</span><span> </span><span class="gd_word" id="S4.F2.9.w4">embedding.</span></figcaption>
</figure>
<div id="S4.SS2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS2.p1.7" class="ltx_p"><span class="gd_word" id="S4.SS2.p1.7.1.w1">While</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w2">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w3">above</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w4">technique</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w5">is</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w6">able</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w7">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w8">model</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w9">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w10">states</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w11">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w12">nonterminal</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w13">nodes</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w14">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w15">an</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w16">encapsulation</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w17">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w18">their</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w19">respective</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w20">descendants,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w21">those</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w22">descendants</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w23">are</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w24">equally</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w25">treated</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w26">since</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w27">no</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w28">biases</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w29">are</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w30">imposed</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w31">on</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w32">them.
In</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w33">other</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w34">words,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w35">although</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w36">each</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w37">branch</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w38">from</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w39">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w40">node</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w41">comprises</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w42">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w43">distinctive</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w44">set</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w45">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w46">descendants,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w47">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w48">hierarchy</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w49">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w50">elements</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w51">within</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w52">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w53">branch</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w54">and</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w55">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w56">sibling</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w57">relationship</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w58">among</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w59">branches</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w60">are</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w61">not</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w62">explicitly</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w63">represented.
Thus,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w64">it</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w65">may</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w66">be</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w67">beneficial</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w68">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w69">introduce</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w70">biases</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w71">that</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w72">reflect</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w73">such</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w74">underlying</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w75">subtree-level</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w76">hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w77">structures.</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w78">We</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w79">propose</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w80">Hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w81">Embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w82">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w83">induce</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w84">distinguishable</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w85">tree</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w86">structures</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w87">into</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w88">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.1.w89">tensor</span><span> </span><math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="{\bm{\mathsfit{S}}}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝑺</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.2.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.2.w2">before</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.2.w3">being</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.2.w4">accumulated</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.2.w5">by</span><span> </span><math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">𝒰</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.3.w2">and</span><span> </span><math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.4.w1">.</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w2">We</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w3">also</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w4">demonstrate</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w5">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w6">effectiveness</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w7">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w8">these</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w9">embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w10">with</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w11">experiments</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w12">in</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w13">Section</span><span> </span><a href="#S5" title="5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">5</a><span class="gd_word" id="S4.SS2.p1.7.5.w1">.
Figure</span><span> </span><a href="#S4.F2" title="Figure 2 ‣ 4.2 Hierarchical Embeddings ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">2</a><span class="gd_word" id="S4.SS2.p1.7.6.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w2">illustrates</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w4">hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w5">embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w6">for</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w7">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w8">nodes</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w9">in</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w10">Figure</span><span> </span><a href="#S4.F1" title="Figure 1 ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S4.SS2.p1.7.7.w1">.</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.7.w2">Given</span><span> </span><math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><mi id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.8.w1">,</span><span> </span><math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mi id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.9.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.9.w2">and</span><span> </span><math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{R}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml">ℛ</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.10.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.10.w2">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.10.w3">defined</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.10.w4">in</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.10.w5">Section</span><span> </span><a href="#S4.SS1" title="4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4.1</a><span class="gd_word" id="S4.SS2.p1.7.11.w1">,
we</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w2">construct</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w3">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w4">tensor</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w5">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w6">hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.11.w7">embeddings</span><span> </span><math id="S4.SS2.p1.7.m7.1" class="ltx_Math" alttext="{\bm{\mathsfit{E}}}\in{\mathbb{R}}^{(m+1)\times n\times d}" display="inline"><semantics id="S4.SS2.p1.7.m7.1a"><mrow id="S4.SS2.p1.7.m7.1.2" xref="S4.SS2.p1.7.m7.1.2.cmml"><mi id="S4.SS2.p1.7.m7.1.2.2" xref="S4.SS2.p1.7.m7.1.2.2.cmml">𝑬</mi><mo id="S4.SS2.p1.7.m7.1.2.1" xref="S4.SS2.p1.7.m7.1.2.1.cmml">∈</mo><msup id="S4.SS2.p1.7.m7.1.2.3" xref="S4.SS2.p1.7.m7.1.2.3.cmml"><mi id="S4.SS2.p1.7.m7.1.2.3.2" xref="S4.SS2.p1.7.m7.1.2.3.2.cmml">ℝ</mi><mrow id="S4.SS2.p1.7.m7.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.cmml"><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.p1.7.m7.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.7.m7.1.1.1.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.2.cmml">m</mi><mo id="S4.SS2.p1.7.m7.1.1.1.1.1.1.1" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.1.cmml">+</mo><mn id="S4.SS2.p1.7.m7.1.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.SS2.p1.7.m7.1.1.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p1.7.m7.1.1.1.2" xref="S4.SS2.p1.7.m7.1.1.1.2.cmml">×</mo><mi id="S4.SS2.p1.7.m7.1.1.1.3" xref="S4.SS2.p1.7.m7.1.1.1.3.cmml">n</mi><mo id="S4.SS2.p1.7.m7.1.1.1.2a" xref="S4.SS2.p1.7.m7.1.1.1.2.cmml">×</mo><mi id="S4.SS2.p1.7.m7.1.1.1.4" xref="S4.SS2.p1.7.m7.1.1.1.4.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS2.p1.7.12.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.12.w2">with</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.12.w3">entries</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.12.w4">defined</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.12.w5">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.12.w6">follows:</span></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.7" class="ltx_Math" alttext="{\bm{\mathsfit{E}}}_{i,j}=\left\{\begin{array}[]{ll}[{\bm{e}}^{v}_{|V_{j}^{i}|%&#10;};{\bm{e}}^{h}_{|H_{j}^{i}|}]&amp;\mbox{if }i&gt;1\mbox{ and }x^{\mathcal{L}}_{j}\in%&#10;\mathcal{R}(x^{\mathcal{N}}_{i})\\&#10;{\bm{0}}&amp;\mbox{otherwise. }\\&#10;\end{array}\right." display="block"><semantics id="S4.E9.m1.7a"><mrow id="S4.E9.m1.7.8" xref="S4.E9.m1.7.8.cmml"><msub id="S4.E9.m1.7.8.2" xref="S4.E9.m1.7.8.2.cmml"><mi id="S4.E9.m1.7.8.2.2" xref="S4.E9.m1.7.8.2.2.cmml">𝑬</mi><mrow id="S4.E9.m1.2.2.2.4" xref="S4.E9.m1.2.2.2.3.cmml"><mi id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml">i</mi><mo id="S4.E9.m1.2.2.2.4.1" xref="S4.E9.m1.2.2.2.3.cmml">,</mo><mi id="S4.E9.m1.2.2.2.2" xref="S4.E9.m1.2.2.2.2.cmml">j</mi></mrow></msub><mo id="S4.E9.m1.7.8.1" xref="S4.E9.m1.7.8.1.cmml">=</mo><mrow id="S4.E9.m1.7.8.3.2" xref="S4.E9.m1.7.8.3.1.cmml"><mo id="S4.E9.m1.7.8.3.2.1" xref="S4.E9.m1.7.8.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E9.m1.7.7" xref="S4.E9.m1.7.7.cmml"><mtr id="S4.E9.m1.7.7a" xref="S4.E9.m1.7.7.cmml"><mtd columnalign="left" id="S4.E9.m1.7.7b" xref="S4.E9.m1.7.7.cmml"><mrow id="S4.E9.m1.6.6.4.4.4.4" xref="S4.E9.m1.6.6.4.4.4.5.cmml"><mo stretchy="false" id="S4.E9.m1.6.6.4.4.4.4.3" xref="S4.E9.m1.6.6.4.4.4.5.cmml">[</mo><msubsup id="S4.E9.m1.5.5.3.3.3.3.1" xref="S4.E9.m1.5.5.3.3.3.3.1.cmml"><mi id="S4.E9.m1.5.5.3.3.3.3.1.2.2" xref="S4.E9.m1.5.5.3.3.3.3.1.2.2.cmml">𝒆</mi><mrow id="S4.E9.m1.3.3.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.3.3.1.1.1.1.1.1.2" xref="S4.E9.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo><msubsup id="S4.E9.m1.3.3.1.1.1.1.1.1.1" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.2.2" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S4.E9.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.E9.m1.3.3.1.1.1.1.1.1.3" xref="S4.E9.m1.3.3.1.1.1.1.1.2.1.cmml">|</mo></mrow><mi id="S4.E9.m1.5.5.3.3.3.3.1.2.3" xref="S4.E9.m1.5.5.3.3.3.3.1.2.3.cmml">v</mi></msubsup><mo id="S4.E9.m1.6.6.4.4.4.4.4" xref="S4.E9.m1.6.6.4.4.4.5.cmml">;</mo><msubsup id="S4.E9.m1.6.6.4.4.4.4.2" xref="S4.E9.m1.6.6.4.4.4.4.2.cmml"><mi id="S4.E9.m1.6.6.4.4.4.4.2.2.2" xref="S4.E9.m1.6.6.4.4.4.4.2.2.2.cmml">𝒆</mi><mrow id="S4.E9.m1.4.4.2.2.2.2.1.1" xref="S4.E9.m1.4.4.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.E9.m1.4.4.2.2.2.2.1.1.2" xref="S4.E9.m1.4.4.2.2.2.2.1.2.1.cmml">|</mo><msubsup id="S4.E9.m1.4.4.2.2.2.2.1.1.1" xref="S4.E9.m1.4.4.2.2.2.2.1.1.1.cmml"><mi id="S4.E9.m1.4.4.2.2.2.2.1.1.1.2.2" xref="S4.E9.m1.4.4.2.2.2.2.1.1.1.2.2.cmml">H</mi><mi id="S4.E9.m1.4.4.2.2.2.2.1.1.1.2.3" xref="S4.E9.m1.4.4.2.2.2.2.1.1.1.2.3.cmml">j</mi><mi id="S4.E9.m1.4.4.2.2.2.2.1.1.1.3" xref="S4.E9.m1.4.4.2.2.2.2.1.1.1.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.E9.m1.4.4.2.2.2.2.1.1.3" xref="S4.E9.m1.4.4.2.2.2.2.1.2.1.cmml">|</mo></mrow><mi id="S4.E9.m1.6.6.4.4.4.4.2.2.3" xref="S4.E9.m1.6.6.4.4.4.4.2.2.3.cmml">h</mi></msubsup><mo stretchy="false" id="S4.E9.m1.6.6.4.4.4.4.5" xref="S4.E9.m1.6.6.4.4.4.5.cmml">]</mo></mrow></mtd><mtd columnalign="left" id="S4.E9.m1.7.7c" xref="S4.E9.m1.7.7.cmml"><mrow id="S4.E9.m1.7.7.5.5.1" xref="S4.E9.m1.7.7.5.5.1.cmml"><mrow id="S4.E9.m1.7.7.5.5.1.3" xref="S4.E9.m1.7.7.5.5.1.3.cmml"><mtext id="S4.E9.m1.7.7.5.5.1.3.2" xref="S4.E9.m1.7.7.5.5.1.3.2a.cmml">if </mtext><mo id="S4.E9.m1.7.7.5.5.1.3.1" xref="S4.E9.m1.7.7.5.5.1.3.1.cmml">⁢</mo><mi id="S4.E9.m1.7.7.5.5.1.3.3" xref="S4.E9.m1.7.7.5.5.1.3.3.cmml">i</mi></mrow><mo id="S4.E9.m1.7.7.5.5.1.4" xref="S4.E9.m1.7.7.5.5.1.4.cmml">&gt;</mo><mrow id="S4.E9.m1.7.7.5.5.1.5" xref="S4.E9.m1.7.7.5.5.1.5.cmml"><mn id="S4.E9.m1.7.7.5.5.1.5.2" xref="S4.E9.m1.7.7.5.5.1.5.2.cmml">1</mn><mo id="S4.E9.m1.7.7.5.5.1.5.1" xref="S4.E9.m1.7.7.5.5.1.5.1.cmml">⁢</mo><mtext id="S4.E9.m1.7.7.5.5.1.5.3" xref="S4.E9.m1.7.7.5.5.1.5.3a.cmml"> and </mtext><mo id="S4.E9.m1.7.7.5.5.1.5.1a" xref="S4.E9.m1.7.7.5.5.1.5.1.cmml">⁢</mo><msubsup id="S4.E9.m1.7.7.5.5.1.5.4" xref="S4.E9.m1.7.7.5.5.1.5.4.cmml"><mi id="S4.E9.m1.7.7.5.5.1.5.4.2.2" xref="S4.E9.m1.7.7.5.5.1.5.4.2.2.cmml">x</mi><mi id="S4.E9.m1.7.7.5.5.1.5.4.3" xref="S4.E9.m1.7.7.5.5.1.5.4.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.7.7.5.5.1.5.4.2.3" xref="S4.E9.m1.7.7.5.5.1.5.4.2.3.cmml">ℒ</mi></msubsup></mrow><mo id="S4.E9.m1.7.7.5.5.1.6" xref="S4.E9.m1.7.7.5.5.1.6.cmml">∈</mo><mrow id="S4.E9.m1.7.7.5.5.1.1" xref="S4.E9.m1.7.7.5.5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.7.7.5.5.1.1.3" xref="S4.E9.m1.7.7.5.5.1.1.3.cmml">ℛ</mi><mo id="S4.E9.m1.7.7.5.5.1.1.2" xref="S4.E9.m1.7.7.5.5.1.1.2.cmml">⁢</mo><mrow id="S4.E9.m1.7.7.5.5.1.1.1.1" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.7.7.5.5.1.1.1.1.2" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E9.m1.7.7.5.5.1.1.1.1.1" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.cmml"><mi id="S4.E9.m1.7.7.5.5.1.1.1.1.1.2.2" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E9.m1.7.7.5.5.1.1.1.1.1.3" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.7.7.5.5.1.1.1.1.1.2.3" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.2.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.E9.m1.7.7.5.5.1.1.1.1.3" xref="S4.E9.m1.7.7.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mtd></mtr><mtr id="S4.E9.m1.7.7d" xref="S4.E9.m1.7.7.cmml"><mtd columnalign="left" id="S4.E9.m1.7.7e" xref="S4.E9.m1.7.7.cmml"><mn id="S4.E9.m1.7.7.6.1.1" xref="S4.E9.m1.7.7.6.1.1.cmml">𝟎</mn></mtd><mtd columnalign="left" id="S4.E9.m1.7.7f" xref="S4.E9.m1.7.7.cmml"><mtext id="S4.E9.m1.7.7.6.2.1" xref="S4.E9.m1.7.7.6.2.1a.cmml">otherwise. </mtext></mtd></mtr></mtable><mi id="S4.E9.m1.7.8.3.2.2" xref="S4.E9.m1.7.8.3.1.1.cmml"/></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr>
</table>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.10" class="ltx_p"><span class="gd_word" id="S4.SS2.p3.10.1.w1">where</span><span> </span><math id="S4.SS2.p3.1.m1.2" class="ltx_Math" alttext="V_{j}^{i}=\{x_{t}^{\mathcal{N}}|x_{t}^{\mathcal{N}}\in\mathcal{R}(x_{i}^{%&#10;\mathcal{N}})\mbox{ and }x_{j}^{\mathcal{L}}\in\mathcal{R}(x_{t}^{\mathcal{N}})\}" display="inline"><semantics id="S4.SS2.p3.1.m1.2a"><mrow id="S4.SS2.p3.1.m1.2.2" xref="S4.SS2.p3.1.m1.2.2.cmml"><msubsup id="S4.SS2.p3.1.m1.2.2.4" xref="S4.SS2.p3.1.m1.2.2.4.cmml"><mi id="S4.SS2.p3.1.m1.2.2.4.2.2" xref="S4.SS2.p3.1.m1.2.2.4.2.2.cmml">V</mi><mi id="S4.SS2.p3.1.m1.2.2.4.2.3" xref="S4.SS2.p3.1.m1.2.2.4.2.3.cmml">j</mi><mi id="S4.SS2.p3.1.m1.2.2.4.3" xref="S4.SS2.p3.1.m1.2.2.4.3.cmml">i</mi></msubsup><mo id="S4.SS2.p3.1.m1.2.2.3" xref="S4.SS2.p3.1.m1.2.2.3.cmml">=</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.3" xref="S4.SS2.p3.1.m1.2.2.2.3.1.cmml">{</mo><msubsup id="S4.SS2.p3.1.m1.1.1.1.1.1" xref="S4.SS2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.2.2" xref="S4.SS2.p3.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.1.m1.1.1.1.1.1.2.3" xref="S4.SS2.p3.1.m1.1.1.1.1.1.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.1.1.1.1.1.3" xref="S4.SS2.p3.1.m1.1.1.1.1.1.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.4" xref="S4.SS2.p3.1.m1.2.2.2.3.1.cmml">|</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.cmml"><msubsup id="S4.SS2.p3.1.m1.2.2.2.2.2.4" xref="S4.SS2.p3.1.m1.2.2.2.2.2.4.cmml"><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.4.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.4.2.2.cmml">x</mi><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.4.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.4.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.4.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.4.3.cmml">𝒩</mi></msubsup><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.5" xref="S4.SS2.p3.1.m1.2.2.2.2.2.5.cmml">∈</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2.2.1" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.1.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.3.cmml">ℛ</mi><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.1.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.1.2a" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.2.cmml">⁢</mo><mtext id="S4.SS2.p3.1.m1.2.2.2.2.2.1.4" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.4a.cmml"> and </mtext><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.1.2b" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.2.cmml">⁢</mo><msubsup id="S4.SS2.p3.1.m1.2.2.2.2.2.1.5" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.cmml"><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.2.2.cmml">x</mi><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.1.5.3.cmml">ℒ</mi></msubsup></mrow><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.6" xref="S4.SS2.p3.1.m1.2.2.2.2.2.6.cmml">∈</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.3.cmml">ℛ</mi><mo id="S4.SS2.p3.1.m1.2.2.2.2.2.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.2.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.2.2" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.2.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.3" xref="S4.SS2.p3.1.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS2.p3.1.m1.2.2.2.2.5" xref="S4.SS2.p3.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS2.p3.10.2.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.2.w2">is</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.2.w4">set</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.2.w5">of</span><span> </span><math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="x_{j}^{\mathcal{L}}" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><msubsup id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml"><mi id="S4.SS2.p3.2.m2.1.1.2.2" xref="S4.SS2.p3.2.m2.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.2.m2.1.1.2.3" xref="S4.SS2.p3.2.m2.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.2.m2.1.1.3" xref="S4.SS2.p3.2.m2.1.1.3.cmml">ℒ</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.3.w1">’s</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.3.w2">ancestors</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.3.w3">up</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.3.w4">to</span><span> </span><math id="S4.SS2.p3.3.m3.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS2.p3.3.m3.1a"><msubsup id="S4.SS2.p3.3.m3.1.1" xref="S4.SS2.p3.3.m3.1.1.cmml"><mi id="S4.SS2.p3.3.m3.1.1.2.2" xref="S4.SS2.p3.3.m3.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.3.m3.1.1.2.3" xref="S4.SS2.p3.3.m3.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.3.m3.1.1.3" xref="S4.SS2.p3.3.m3.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.4.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.4.w2">and</span><span> </span><math id="S4.SS2.p3.4.m4.2" class="ltx_Math" alttext="H_{j}^{i}=\{x_{t}^{\mathcal{L}}|t\leq j\mbox{ and }x_{t}^{\mathcal{L}}\in%&#10;\mathcal{L}\cap\mathcal{R}(x_{i}^{\mathcal{N}})\}" display="inline"><semantics id="S4.SS2.p3.4.m4.2a"><mrow id="S4.SS2.p3.4.m4.2.2" xref="S4.SS2.p3.4.m4.2.2.cmml"><msubsup id="S4.SS2.p3.4.m4.2.2.4" xref="S4.SS2.p3.4.m4.2.2.4.cmml"><mi id="S4.SS2.p3.4.m4.2.2.4.2.2" xref="S4.SS2.p3.4.m4.2.2.4.2.2.cmml">H</mi><mi id="S4.SS2.p3.4.m4.2.2.4.2.3" xref="S4.SS2.p3.4.m4.2.2.4.2.3.cmml">j</mi><mi id="S4.SS2.p3.4.m4.2.2.4.3" xref="S4.SS2.p3.4.m4.2.2.4.3.cmml">i</mi></msubsup><mo id="S4.SS2.p3.4.m4.2.2.3" xref="S4.SS2.p3.4.m4.2.2.3.cmml">=</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2" xref="S4.SS2.p3.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p3.4.m4.2.2.2.2.3" xref="S4.SS2.p3.4.m4.2.2.2.3.1.cmml">{</mo><msubsup id="S4.SS2.p3.4.m4.1.1.1.1.1" xref="S4.SS2.p3.4.m4.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.4.m4.1.1.1.1.1.2.2" xref="S4.SS2.p3.4.m4.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.4.m4.1.1.1.1.1.2.3" xref="S4.SS2.p3.4.m4.1.1.1.1.1.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.1.1.1.1.1.3" xref="S4.SS2.p3.4.m4.1.1.1.1.1.3.cmml">ℒ</mi></msubsup><mo stretchy="false" id="S4.SS2.p3.4.m4.2.2.2.2.4" xref="S4.SS2.p3.4.m4.2.2.2.3.1.cmml">|</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.cmml"><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.3.cmml">t</mi><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.4" xref="S4.SS2.p3.4.m4.2.2.2.2.2.4.cmml">≤</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2.2.5" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.cmml"><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.5.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.2.cmml">j</mi><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.5.1" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.1.cmml">⁢</mo><mtext id="S4.SS2.p3.4.m4.2.2.2.2.2.5.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.3a.cmml"> and </mtext><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.5.1a" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.1.cmml">⁢</mo><msubsup id="S4.SS2.p3.4.m4.2.2.2.2.2.5.4" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.cmml"><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.2.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.2.2.cmml">x</mi><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.2.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.2.3.cmml">t</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.5.4.3.cmml">ℒ</mi></msubsup></mrow><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.6" xref="S4.SS2.p3.4.m4.2.2.2.2.2.6.cmml">∈</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2.2.1" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.2.2.2.2.2.1.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.3.cmml">ℒ</mi><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.1.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.2.cmml">∩</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.3.cmml">ℛ</mi><mo id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.2.cmml">⁢</mo><mrow id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.cmml"><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.2.2" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.2.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.3.cmml">𝒩</mi></msubsup><mo stretchy="false" id="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.3" xref="S4.SS2.p3.4.m4.2.2.2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="S4.SS2.p3.4.m4.2.2.2.2.5" xref="S4.SS2.p3.4.m4.2.2.2.3.1.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS2.p3.10.5.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w2">is</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w4">set</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w5">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w6">leaves</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w7">from</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w8">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w9">leftmost</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w10">leaf</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w11">up</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.5.w12">to</span><span> </span><math id="S4.SS2.p3.5.m5.1" class="ltx_Math" alttext="x_{j}^{\mathcal{L}}" display="inline"><semantics id="S4.SS2.p3.5.m5.1a"><msubsup id="S4.SS2.p3.5.m5.1.1" xref="S4.SS2.p3.5.m5.1.1.cmml"><mi id="S4.SS2.p3.5.m5.1.1.2.2" xref="S4.SS2.p3.5.m5.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.5.m5.1.1.2.3" xref="S4.SS2.p3.5.m5.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.5.m5.1.1.3" xref="S4.SS2.p3.5.m5.1.1.3.cmml">ℒ</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.6.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.6.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.6.w3">the</span><span> </span><math id="S4.SS2.p3.6.m6.1" class="ltx_Math" alttext="x_{i}^{\mathcal{N}}" display="inline"><semantics id="S4.SS2.p3.6.m6.1a"><msubsup id="S4.SS2.p3.6.m6.1.1" xref="S4.SS2.p3.6.m6.1.1.cmml"><mi id="S4.SS2.p3.6.m6.1.1.2.2" xref="S4.SS2.p3.6.m6.1.1.2.2.cmml">x</mi><mi id="S4.SS2.p3.6.m6.1.1.2.3" xref="S4.SS2.p3.6.m6.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p3.6.m6.1.1.3" xref="S4.SS2.p3.6.m6.1.1.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.7.w1">-rooted</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.7.w2">subtree;</span><span> </span><math id="S4.SS2.p3.7.m7.1" class="ltx_Math" alttext="{\bm{e}}^{v}_{i}" display="inline"><semantics id="S4.SS2.p3.7.m7.1a"><msubsup id="S4.SS2.p3.7.m7.1.1" xref="S4.SS2.p3.7.m7.1.1.cmml"><mi id="S4.SS2.p3.7.m7.1.1.2.2" xref="S4.SS2.p3.7.m7.1.1.2.2.cmml">𝒆</mi><mi id="S4.SS2.p3.7.m7.1.1.3" xref="S4.SS2.p3.7.m7.1.1.3.cmml">i</mi><mi id="S4.SS2.p3.7.m7.1.1.2.3" xref="S4.SS2.p3.7.m7.1.1.2.3.cmml">v</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.8.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.8.w2">and</span><span> </span><math id="S4.SS2.p3.8.m8.1" class="ltx_Math" alttext="{\bm{e}}^{h}_{i}" display="inline"><semantics id="S4.SS2.p3.8.m8.1a"><msubsup id="S4.SS2.p3.8.m8.1.1" xref="S4.SS2.p3.8.m8.1.1.cmml"><mi id="S4.SS2.p3.8.m8.1.1.2.2" xref="S4.SS2.p3.8.m8.1.1.2.2.cmml">𝒆</mi><mi id="S4.SS2.p3.8.m8.1.1.3" xref="S4.SS2.p3.8.m8.1.1.3.cmml">i</mi><mi id="S4.SS2.p3.8.m8.1.1.2.3" xref="S4.SS2.p3.8.m8.1.1.2.3.cmml">h</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS2.p3.10.9.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w2">are</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w3">embedding</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w4">row-vectors</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w5">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w6">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w7">respective</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w8">trainable</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w9">vertical</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w10">and</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w11">horizontal</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w12">embedding</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.9.w13">matrices</span><span> </span><math id="S4.SS2.p3.9.m9.3" class="ltx_Math" alttext="{\bm{E}}^{v},{\bm{E}}^{h}\in{\mathbb{R}}^{|E|\times\frac{d}{2}}" display="inline"><semantics id="S4.SS2.p3.9.m9.3a"><mrow id="S4.SS2.p3.9.m9.3.3" xref="S4.SS2.p3.9.m9.3.3.cmml"><mrow id="S4.SS2.p3.9.m9.3.3.2.2" xref="S4.SS2.p3.9.m9.3.3.2.3.cmml"><msup id="S4.SS2.p3.9.m9.2.2.1.1.1" xref="S4.SS2.p3.9.m9.2.2.1.1.1.cmml"><mi id="S4.SS2.p3.9.m9.2.2.1.1.1.2" xref="S4.SS2.p3.9.m9.2.2.1.1.1.2.cmml">𝑬</mi><mi id="S4.SS2.p3.9.m9.2.2.1.1.1.3" xref="S4.SS2.p3.9.m9.2.2.1.1.1.3.cmml">v</mi></msup><mo id="S4.SS2.p3.9.m9.3.3.2.2.3" xref="S4.SS2.p3.9.m9.3.3.2.3.cmml">,</mo><msup id="S4.SS2.p3.9.m9.3.3.2.2.2" xref="S4.SS2.p3.9.m9.3.3.2.2.2.cmml"><mi id="S4.SS2.p3.9.m9.3.3.2.2.2.2" xref="S4.SS2.p3.9.m9.3.3.2.2.2.2.cmml">𝑬</mi><mi id="S4.SS2.p3.9.m9.3.3.2.2.2.3" xref="S4.SS2.p3.9.m9.3.3.2.2.2.3.cmml">h</mi></msup></mrow><mo id="S4.SS2.p3.9.m9.3.3.3" xref="S4.SS2.p3.9.m9.3.3.3.cmml">∈</mo><msup id="S4.SS2.p3.9.m9.3.3.4" xref="S4.SS2.p3.9.m9.3.3.4.cmml"><mi id="S4.SS2.p3.9.m9.3.3.4.2" xref="S4.SS2.p3.9.m9.3.3.4.2.cmml">ℝ</mi><mrow id="S4.SS2.p3.9.m9.1.1.1" xref="S4.SS2.p3.9.m9.1.1.1.cmml"><mrow id="S4.SS2.p3.9.m9.1.1.1.3.2" xref="S4.SS2.p3.9.m9.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.9.m9.1.1.1.3.2.1" xref="S4.SS2.p3.9.m9.1.1.1.3.1.1.cmml">|</mo><mi id="S4.SS2.p3.9.m9.1.1.1.1" xref="S4.SS2.p3.9.m9.1.1.1.1.cmml">E</mi><mo stretchy="false" id="S4.SS2.p3.9.m9.1.1.1.3.2.2" xref="S4.SS2.p3.9.m9.1.1.1.3.1.1.cmml">|</mo></mrow><mo id="S4.SS2.p3.9.m9.1.1.1.2" xref="S4.SS2.p3.9.m9.1.1.1.2.cmml">×</mo><mfrac id="S4.SS2.p3.9.m9.1.1.1.4" xref="S4.SS2.p3.9.m9.1.1.1.4.cmml"><mi id="S4.SS2.p3.9.m9.1.1.1.4.2" xref="S4.SS2.p3.9.m9.1.1.1.4.2.cmml">d</mi><mn id="S4.SS2.p3.9.m9.1.1.1.4.3" xref="S4.SS2.p3.9.m9.1.1.1.4.3.cmml">2</mn></mfrac></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS2.p3.10.10.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.10.w2">and</span><span> </span><math id="S4.SS2.p3.10.m10.2" class="ltx_Math" alttext="[\bullet;\bullet]" display="inline"><semantics id="S4.SS2.p3.10.m10.2a"><mrow id="S4.SS2.p3.10.m10.2.3.2" xref="S4.SS2.p3.10.m10.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p3.10.m10.2.3.2.1" xref="S4.SS2.p3.10.m10.2.3.1.cmml">[</mo><mo id="S4.SS2.p3.10.m10.1.1" xref="S4.SS2.p3.10.m10.1.1.cmml">∙</mo><mo id="S4.SS2.p3.10.m10.2.3.2.2" xref="S4.SS2.p3.10.m10.2.3.1.cmml">;</mo><mo id="S4.SS2.p3.10.m10.2.2" xref="S4.SS2.p3.10.m10.2.2.cmml">∙</mo><mo stretchy="false" id="S4.SS2.p3.10.m10.2.3.2.3" xref="S4.SS2.p3.10.m10.2.3.1.cmml">]</mo></mrow></semantics></math><span class="gd_word" id="S4.SS2.p3.10.11.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w2">denotes</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w4">concatenation</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w5">operation</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w6">in</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w7">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w8">hidden</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w9">dimension.</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w10">The</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w11">vertical</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w12">embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w13">represent</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w14">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w15">path</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w16">length</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w17">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w18">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w19">node</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w20">to</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w21">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w22">leaf</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w23">which</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w24">expresses</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w25">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w26">hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w27">order</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w28">within</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w29">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w30">branch,</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w31">whereas</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w32">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w33">horizontal</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w34">embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w35">exhibit</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w36">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w37">relationship</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w38">among</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w39">branch</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w40">siblings</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w41">in</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w42">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w43">subtree.
The</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w44">resulting</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w45">node</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w46">representations</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w47">after</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w48">hierarchical</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w49">encoding</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w50">are</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w51">defined</span><span> </span><span class="gd_word" id="S4.SS2.p3.10.11.w52">as:
</span></p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.2" class="ltx_Math" alttext="\overline{{\bm{N}}}^{\prime}=\mathcal{V}(\mathcal{U}({\bm{\mathsfit{S}}}+{\bm{%&#10;\mathsfit{E}}}),{\bm{w}})" display="block"><semantics id="S4.E10.m1.2a"><mrow id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml"><msup id="S4.E10.m1.2.2.3" xref="S4.E10.m1.2.2.3.cmml"><mover accent="true" id="S4.E10.m1.2.2.3.2" xref="S4.E10.m1.2.2.3.2.cmml"><mi id="S4.E10.m1.2.2.3.2.2" xref="S4.E10.m1.2.2.3.2.2.cmml">𝑵</mi><mo id="S4.E10.m1.2.2.3.2.1" xref="S4.E10.m1.2.2.3.2.1.cmml">¯</mo></mover><mo id="S4.E10.m1.2.2.3.3" xref="S4.E10.m1.2.2.3.3.cmml">′</mo></msup><mo id="S4.E10.m1.2.2.2" xref="S4.E10.m1.2.2.2.cmml">=</mo><mrow id="S4.E10.m1.2.2.1" xref="S4.E10.m1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.1.3" xref="S4.E10.m1.2.2.1.3.cmml">𝒱</mi><mo id="S4.E10.m1.2.2.1.2" xref="S4.E10.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.1.1.1" xref="S4.E10.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.2" xref="S4.E10.m1.2.2.1.1.2.cmml">(</mo><mrow id="S4.E10.m1.2.2.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E10.m1.2.2.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.3.cmml">𝒰</mi><mo id="S4.E10.m1.2.2.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E10.m1.2.2.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.2.2.1.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝑺</mi><mo id="S4.E10.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S4.E10.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝑬</mi></mrow><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.1.1.1.3" xref="S4.E10.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E10.m1.2.2.1.1.1.3" xref="S4.E10.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml">𝒘</mi><mo stretchy="false" id="S4.E10.m1.2.2.1.1.1.4" xref="S4.E10.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr>
</table>
<p id="S4.SS2.p3.11" class="ltx_p"><span class="gd_word" id="S4.SS2.p3.11.1.w1">Note</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w2">that</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w3">we</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w4">share</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w5">such</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w6">embeddings</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w7">across</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w8">attention</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w9">heads,</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w10">making</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w11">them</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w12">account</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w13">for</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.1.w14">only</span><span> </span><math id="S4.SS2.p3.11.m1.1" class="ltx_Math" alttext="0.1\%" display="inline"><semantics id="S4.SS2.p3.11.m1.1a"><mrow id="S4.SS2.p3.11.m1.1.1" xref="S4.SS2.p3.11.m1.1.1.cmml"><mn id="S4.SS2.p3.11.m1.1.1.2" xref="S4.SS2.p3.11.m1.1.1.2.cmml">0.1</mn><mo id="S4.SS2.p3.11.m1.1.1.1" xref="S4.SS2.p3.11.m1.1.1.1.cmml">%</mo></mrow></semantics></math><span class="gd_word" id="S4.SS2.p3.11.2.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w4">total</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w5">parameters</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w6">(see</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.2.w7">Appendix</span><span> </span><a href="#S7.SS3" title="7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.3</a><span class="gd_word" id="S4.SS2.p3.11.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.11.3.w2">for</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.3.w3">more</span><span> </span><span class="gd_word" id="S4.SS2.p3.11.3.w4">information).</span></p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Subtree Masking</h3>

<figure id="S4.F3" class="ltx_figure ltx_align_floatright"><img src="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/tree.png" id="S4.F3.g1" class="ltx_graphics" width="" height="" alt="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/tree.png"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="gd_word" id="S4.F3.2.w1">Subtree</span><span> </span><span class="gd_word" id="S4.F3.2.w2">masking.</span><span> </span><span class="gd_word" id="S4.F3.2.w3">Given</span><span> </span><span class="gd_word" id="S4.F3.2.w4">the</span><span> </span><span class="gd_word" id="S4.F3.2.w5">query</span><span> </span><span class="gd_word" id="S4.F3.2.w6">at</span><span> </span><span class="gd_word" id="S4.F3.2.w7">position</span><span> </span><math id="S4.F3.3.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.F3.3.m1.1b"><mi id="S4.F3.3.m1.1.1" xref="S4.F3.3.m1.1.1.cmml">g</mi></semantics></math><span class="gd_word" id="S4.F3.3.w1">,</span><span> </span><span class="gd_word" id="S4.F3.3.w2">attentions</span><span> </span><span class="gd_word" id="S4.F3.3.w3">are</span><span> </span><span class="gd_word" id="S4.F3.3.w4">only</span><span> </span><span class="gd_word" id="S4.F3.3.w5">included</span><span> </span><span class="gd_word" id="S4.F3.3.w6">within</span><span> </span><span class="gd_word" id="S4.F3.3.w7">the</span><span> </span><math id="S4.F3.4.m2.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.F3.4.m2.1b"><mi id="S4.F3.4.m2.1.1" xref="S4.F3.4.m2.1.1.cmml">g</mi></semantics></math><span class="gd_word" id="S4.F3.4.w1">-rooted</span><span> </span><span class="gd_word" id="S4.F3.4.w2">subtree,</span><span> </span><span class="gd_word" id="S4.F3.4.w3">while</span><span> </span><span class="gd_word" id="S4.F3.4.w4">the</span><span> </span><span class="gd_word" id="S4.F3.4.w5">remaining</span><span> </span><span class="gd_word" id="S4.F3.4.w6">elements</span><span> </span><span class="gd_word" id="S4.F3.4.w7">are</span><span> </span><span class="gd_word" id="S4.F3.4.w8">masked</span><span> </span><span class="gd_word" id="S4.F3.4.w9">out</span><span> </span><span class="gd_word" id="S4.F3.4.w10">(shaded).</span></figcaption>
</figure>
<div id="S4.SS3.p1" class="ltx_para ltx_noindent">
<p id="S4.SS3.p1.5" class="ltx_p"><span class="gd_word" id="S4.SS3.p1.5.1.w1">Masking</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w2">attentions</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w4">a</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w5">common</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w6">practice</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w7">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w8">filter</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w9">out</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w10">irrelevant</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w11">signals.</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w12">For</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w13">example,</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w14">in</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w15">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w16">decoder</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w17">self-attention</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w18">layers</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w19">of</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w21">Transformer,</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w22">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w23">affinity</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w24">values</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w25">between</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.1.w26">query</span><span> </span><math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="{\bm{q}}_{i}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msub id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml"><mi id="S4.SS3.p1.1.m1.1.1.2" xref="S4.SS3.p1.1.m1.1.1.2.cmml">𝒒</mi><mi id="S4.SS3.p1.1.m1.1.1.3" xref="S4.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S4.SS3.p1.5.2.w1"/><span> </span><span class="gd_word" id="S4.SS3.p1.5.2.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.2.w3">key</span><span> </span><math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="{\bm{k}}_{j}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><msub id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">𝒌</mi><mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">j</mi></msub></semantics></math><span class="gd_word" id="S4.SS3.p1.5.3.w1"/><span> </span><span class="gd_word" id="S4.SS3.p1.5.3.w2">are</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.3.w3">turned</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.3.w4">off</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.3.w5">for</span><span> </span><math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="j&gt;i" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><mrow id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">j</mi><mo id="S4.SS3.p1.3.m3.1.1.1" xref="S4.SS3.p1.3.m3.1.1.1.cmml">&gt;</mo><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">i</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p1.5.4.w1"/><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w2">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w3">avoid</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w4">future</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w5">keys</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w6">being</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w7">attended</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w8">since</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w9">they</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w10">are</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w11">not</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w12">available</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w13">during</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w14">inference.</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w15">This</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w16">can</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w17">be</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w18">done</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w19">by</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w20">adding</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w21">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w22">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.4.w23">affinity</span><span> </span><math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="{\bm{q}}_{i}^{T}{\bm{k}}_{j}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><mrow id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><msubsup id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2.cmml"><mi id="S4.SS3.p1.4.m4.1.1.2.2.2" xref="S4.SS3.p1.4.m4.1.1.2.2.2.cmml">𝒒</mi><mi id="S4.SS3.p1.4.m4.1.1.2.2.3" xref="S4.SS3.p1.4.m4.1.1.2.2.3.cmml">i</mi><mi id="S4.SS3.p1.4.m4.1.1.2.3" xref="S4.SS3.p1.4.m4.1.1.2.3.cmml">T</mi></msubsup><mo id="S4.SS3.p1.4.m4.1.1.1" xref="S4.SS3.p1.4.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml"><mi id="S4.SS3.p1.4.m4.1.1.3.2" xref="S4.SS3.p1.4.m4.1.1.3.2.cmml">𝒌</mi><mi id="S4.SS3.p1.4.m4.1.1.3.3" xref="S4.SS3.p1.4.m4.1.1.3.3.cmml">j</mi></msub></mrow></semantics></math><span class="gd_word" id="S4.SS3.p1.5.5.w1"/><span> </span><span class="gd_word" id="S4.SS3.p1.5.5.w2">an</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.5.w3">infinitely</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.5.w4">negative</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.5.w5">value</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.5.w6">(</span><math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="-\infty" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mrow id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml"><mo id="S4.SS3.p1.5.m5.1.1.1" xref="S4.SS3.p1.5.m5.1.1.1.cmml">-</mo><mi mathvariant="normal" id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">∞</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p1.5.6.w1">)</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w2">so</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w3">that</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w4">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w5">resulting</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w6">attention</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w7">weight</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w8">(after</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w9">softmax)</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w10">becomes</span><span> </span><span class="gd_word" id="S4.SS3.p1.5.6.w11">zero.</span></p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.9" class="ltx_p"><span class="gd_word" id="S4.SS3.p2.9.1.w1">In</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w2">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w3">context</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w4">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w5">tree-based</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w6">attentions</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w7">(to</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w8">be</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w9">described</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w10">next),</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w11">we</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w12">promote</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w13">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w14">bottom-up</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w15">structure</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w16">by</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w17">introducing</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w18">subtree</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w19">masking</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w20">for</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w21">encoder</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.1.w22">self-attention.</span><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="gd_word" id="footnote3.3.w1">It</span><span> </span><span class="gd_word" id="footnote3.3.w2">can</span><span> </span><span class="gd_word" id="footnote3.3.w3">only</span><span> </span><span class="gd_word" id="footnote3.3.w4">be</span><span> </span><span class="gd_word" id="footnote3.3.w5">done</span><span> </span><span class="gd_word" id="footnote3.3.w6">in</span><span> </span><span class="gd_word" id="footnote3.3.w7">the</span><span> </span><span class="gd_word" id="footnote3.3.w8">encoder</span><span> </span><span class="gd_word" id="footnote3.3.w9">self-attention.</span></span></span></span><span class="gd_word" id="S4.SS3.p2.9.2.w1">
That</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.2.w2">is,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.2.w3">if</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.2.w4">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.2.w5">node-query</span><span> </span><math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="q^{\mathcal{N}}_{i}\in\mathcal{N}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mrow id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml"><msubsup id="S4.SS3.p2.1.m1.1.1.2" xref="S4.SS3.p2.1.m1.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.1.1.2.2.2" xref="S4.SS3.p2.1.m1.1.1.2.2.2.cmml">q</mi><mi id="S4.SS3.p2.1.m1.1.1.2.3" xref="S4.SS3.p2.1.m1.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.1.m1.1.1.2.2.3" xref="S4.SS3.p2.1.m1.1.1.2.2.3.cmml">𝒩</mi></msubsup><mo id="S4.SS3.p2.1.m1.1.1.1" xref="S4.SS3.p2.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.1.m1.1.1.3" xref="S4.SS3.p2.1.m1.1.1.3.cmml">𝒩</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.3.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w2">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w3">attending</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w4">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w5">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w6">set</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w7">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.3.w8">node-keys</span><span> </span><math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="k^{\mathcal{N}}_{j}\in\mathcal{N}" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mrow id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml"><msubsup id="S4.SS3.p2.2.m2.1.1.2" xref="S4.SS3.p2.2.m2.1.1.2.cmml"><mi id="S4.SS3.p2.2.m2.1.1.2.2.2" xref="S4.SS3.p2.2.m2.1.1.2.2.2.cmml">k</mi><mi id="S4.SS3.p2.2.m2.1.1.2.3" xref="S4.SS3.p2.2.m2.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m2.1.1.2.2.3" xref="S4.SS3.p2.2.m2.1.1.2.2.3.cmml">𝒩</mi></msubsup><mo id="S4.SS3.p2.2.m2.1.1.1" xref="S4.SS3.p2.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.2.m2.1.1.3" xref="S4.SS3.p2.2.m2.1.1.3.cmml">𝒩</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.4.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.4.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.4.w3">leaf-keys</span><span> </span><math id="S4.SS3.p2.3.m3.1" class="ltx_Math" alttext="k^{\mathcal{L}}_{j}\in\mathcal{L}" display="inline"><semantics id="S4.SS3.p2.3.m3.1a"><mrow id="S4.SS3.p2.3.m3.1.1" xref="S4.SS3.p2.3.m3.1.1.cmml"><msubsup id="S4.SS3.p2.3.m3.1.1.2" xref="S4.SS3.p2.3.m3.1.1.2.cmml"><mi id="S4.SS3.p2.3.m3.1.1.2.2.2" xref="S4.SS3.p2.3.m3.1.1.2.2.2.cmml">k</mi><mi id="S4.SS3.p2.3.m3.1.1.2.3" xref="S4.SS3.p2.3.m3.1.1.2.3.cmml">j</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.3.m3.1.1.2.2.3" xref="S4.SS3.p2.3.m3.1.1.2.2.3.cmml">ℒ</mi></msubsup><mo id="S4.SS3.p2.3.m3.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.3.m3.1.1.3" xref="S4.SS3.p2.3.m3.1.1.3.cmml">ℒ</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.5.w1">,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w2">attentions</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w3">are</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w4">turned</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w5">on</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w6">only</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w7">for</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w8">affinity</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w9">pairs</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w10">whose</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w11">key</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w12">belongs</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w13">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w14">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w15">subtree</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w16">rooted</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.5.w17">at</span><span> </span><math id="S4.SS3.p2.4.m4.1" class="ltx_Math" alttext="q^{\mathcal{N}}_{i}" display="inline"><semantics id="S4.SS3.p2.4.m4.1a"><msubsup id="S4.SS3.p2.4.m4.1.1" xref="S4.SS3.p2.4.m4.1.1.cmml"><mi id="S4.SS3.p2.4.m4.1.1.2.2" xref="S4.SS3.p2.4.m4.1.1.2.2.cmml">q</mi><mi id="S4.SS3.p2.4.m4.1.1.3" xref="S4.SS3.p2.4.m4.1.1.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.4.m4.1.1.2.3" xref="S4.SS3.p2.4.m4.1.1.2.3.cmml">𝒩</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS3.p2.9.6.w1">.</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w2">In</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w3">other</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w4">words,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w5">each</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w6">node-query</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w7">has</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w8">access</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w9">only</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w10">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w11">its</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w12">own</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w13">subtree</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w14">descendants,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w15">but</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w16">not</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w17">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w18">its</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w19">ancestors</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w20">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w21">siblings.</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w22">On</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w23">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w24">other</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w25">hand,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w26">if</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w27">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.6.w28">leaf-query</span><span> </span><math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="q^{\mathcal{L}}_{i}\in\mathcal{L}" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><msubsup id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2.2.2" xref="S4.SS3.p2.5.m5.1.1.2.2.2.cmml">q</mi><mi id="S4.SS3.p2.5.m5.1.1.2.3" xref="S4.SS3.p2.5.m5.1.1.2.3.cmml">i</mi><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.5.m5.1.1.2.2.3" xref="S4.SS3.p2.5.m5.1.1.2.2.3.cmml">ℒ</mi></msubsup><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">ℒ</mi></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.7.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w2">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w3">attending,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w4">only</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w5">leaf-keys</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w6">are</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w7">turned</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w8">on,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w9">like</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w10">in</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w11">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w12">Transformer.</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.7.w13">Figure</span><span> </span><a href="#S4.F3" title="Figure 3 ‣ 4.3 Subtree Masking ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3</a><span class="gd_word" id="S4.SS3.p2.9.8.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w2">illustrates</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w3">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w4">subtree</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w5">masking</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w6">with</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w7">an</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w8">example.</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w9">More</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w10">formally,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.8.w11">given</span><span> </span><math id="S4.SS3.p2.6.m6.1" class="ltx_Math" alttext="a_{ij}" display="inline"><semantics id="S4.SS3.p2.6.m6.1a"><msub id="S4.SS3.p2.6.m6.1.1" xref="S4.SS3.p2.6.m6.1.1.cmml"><mi id="S4.SS3.p2.6.m6.1.1.2" xref="S4.SS3.p2.6.m6.1.1.2.cmml">a</mi><mrow id="S4.SS3.p2.6.m6.1.1.3" xref="S4.SS3.p2.6.m6.1.1.3.cmml"><mi id="S4.SS3.p2.6.m6.1.1.3.2" xref="S4.SS3.p2.6.m6.1.1.3.2.cmml">i</mi><mo id="S4.SS3.p2.6.m6.1.1.3.1" xref="S4.SS3.p2.6.m6.1.1.3.1.cmml">⁢</mo><mi id="S4.SS3.p2.6.m6.1.1.3.3" xref="S4.SS3.p2.6.m6.1.1.3.3.cmml">j</mi></mrow></msub></semantics></math><span class="gd_word" id="S4.SS3.p2.9.9.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w2">as</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w3">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w4">affinity</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w5">value</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w6">between</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w7">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.9.w8">node/leaf-query</span><span> </span><math id="S4.SS3.p2.7.m7.1" class="ltx_Math" alttext="q_{i}\in\mathcal{N}\cup\mathcal{L}" display="inline"><semantics id="S4.SS3.p2.7.m7.1a"><mrow id="S4.SS3.p2.7.m7.1.1" xref="S4.SS3.p2.7.m7.1.1.cmml"><msub id="S4.SS3.p2.7.m7.1.1.2" xref="S4.SS3.p2.7.m7.1.1.2.cmml"><mi id="S4.SS3.p2.7.m7.1.1.2.2" xref="S4.SS3.p2.7.m7.1.1.2.2.cmml">q</mi><mi id="S4.SS3.p2.7.m7.1.1.2.3" xref="S4.SS3.p2.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S4.SS3.p2.7.m7.1.1.1" xref="S4.SS3.p2.7.m7.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p2.7.m7.1.1.3" xref="S4.SS3.p2.7.m7.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.7.m7.1.1.3.2" xref="S4.SS3.p2.7.m7.1.1.3.2.cmml">𝒩</mi><mo id="S4.SS3.p2.7.m7.1.1.3.1" xref="S4.SS3.p2.7.m7.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.7.m7.1.1.3.3" xref="S4.SS3.p2.7.m7.1.1.3.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.10.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.10.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.10.w3">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.10.w4">node/leaf-key</span><span> </span><math id="S4.SS3.p2.8.m8.1" class="ltx_Math" alttext="k_{j}\in\mathcal{N}\cup\mathcal{L}" display="inline"><semantics id="S4.SS3.p2.8.m8.1a"><mrow id="S4.SS3.p2.8.m8.1.1" xref="S4.SS3.p2.8.m8.1.1.cmml"><msub id="S4.SS3.p2.8.m8.1.1.2" xref="S4.SS3.p2.8.m8.1.1.2.cmml"><mi id="S4.SS3.p2.8.m8.1.1.2.2" xref="S4.SS3.p2.8.m8.1.1.2.2.cmml">k</mi><mi id="S4.SS3.p2.8.m8.1.1.2.3" xref="S4.SS3.p2.8.m8.1.1.2.3.cmml">j</mi></msub><mo id="S4.SS3.p2.8.m8.1.1.1" xref="S4.SS3.p2.8.m8.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p2.8.m8.1.1.3" xref="S4.SS3.p2.8.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.8.m8.1.1.3.2" xref="S4.SS3.p2.8.m8.1.1.3.2.cmml">𝒩</mi><mo id="S4.SS3.p2.8.m8.1.1.3.1" xref="S4.SS3.p2.8.m8.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.8.m8.1.1.3.3" xref="S4.SS3.p2.8.m8.1.1.3.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.9.11.w1">,</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.11.w2">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.11.w3">masking</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.11.w4">function</span><span> </span><math id="S4.SS3.p2.9.m9.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S4.SS3.p2.9.m9.1a"><mi id="S4.SS3.p2.9.m9.1.1" xref="S4.SS3.p2.9.m9.1.1.cmml">μ</mi></semantics></math><span class="gd_word" id="S4.SS3.p2.9.12.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.9.12.w2">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.12.w3">defined</span><span> </span><span class="gd_word" id="S4.SS3.p2.9.12.w4">as:</span></p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.4" class="ltx_Math" alttext="\mu(a_{ij})=\left\{\begin{array}[]{ll}a_{ij}&amp;\mbox{if ($q_{i}\in\mathcal{N}$ %&#10;and $k_{j}\in\mathcal{R}(q_{i})$) or ($q_{i},k_{j}\in\mathcal{L}$) }\\&#10;a_{ij}-\infty&amp;\mbox{otherwise.}\\&#10;\end{array}\right." display="block"><semantics id="S4.E11.m1.4a"><mrow id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><mrow id="S4.E11.m1.4.4.1" xref="S4.E11.m1.4.4.1.cmml"><mi id="S4.E11.m1.4.4.1.3" xref="S4.E11.m1.4.4.1.3.cmml">μ</mi><mo id="S4.E11.m1.4.4.1.2" xref="S4.E11.m1.4.4.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.4.4.1.1.1" xref="S4.E11.m1.4.4.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.1.1.1.2" xref="S4.E11.m1.4.4.1.1.1.1.cmml">(</mo><msub id="S4.E11.m1.4.4.1.1.1.1" xref="S4.E11.m1.4.4.1.1.1.1.cmml"><mi id="S4.E11.m1.4.4.1.1.1.1.2" xref="S4.E11.m1.4.4.1.1.1.1.2.cmml">a</mi><mrow id="S4.E11.m1.4.4.1.1.1.1.3" xref="S4.E11.m1.4.4.1.1.1.1.3.cmml"><mi id="S4.E11.m1.4.4.1.1.1.1.3.2" xref="S4.E11.m1.4.4.1.1.1.1.3.2.cmml">i</mi><mo id="S4.E11.m1.4.4.1.1.1.1.3.1" xref="S4.E11.m1.4.4.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.4.4.1.1.1.1.3.3" xref="S4.E11.m1.4.4.1.1.1.1.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="S4.E11.m1.4.4.1.1.1.3" xref="S4.E11.m1.4.4.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.4.4.2" xref="S4.E11.m1.4.4.2.cmml">=</mo><mrow id="S4.E11.m1.4.4.3.2" xref="S4.E11.m1.4.4.3.1.cmml"><mo id="S4.E11.m1.4.4.3.2.1" xref="S4.E11.m1.4.4.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S4.E11.m1.3.3" xref="S4.E11.m1.3.3.cmml"><mtr id="S4.E11.m1.3.3a" xref="S4.E11.m1.3.3.cmml"><mtd columnalign="left" id="S4.E11.m1.3.3b" xref="S4.E11.m1.3.3.cmml"><msub id="S4.E11.m1.3.3.3.4.1" xref="S4.E11.m1.3.3.3.4.1.cmml"><mi id="S4.E11.m1.3.3.3.4.1.2" xref="S4.E11.m1.3.3.3.4.1.2.cmml">a</mi><mrow id="S4.E11.m1.3.3.3.4.1.3" xref="S4.E11.m1.3.3.3.4.1.3.cmml"><mi id="S4.E11.m1.3.3.3.4.1.3.2" xref="S4.E11.m1.3.3.3.4.1.3.2.cmml">i</mi><mo id="S4.E11.m1.3.3.3.4.1.3.1" xref="S4.E11.m1.3.3.3.4.1.3.1.cmml">⁢</mo><mi id="S4.E11.m1.3.3.3.4.1.3.3" xref="S4.E11.m1.3.3.3.4.1.3.3.cmml">j</mi></mrow></msub></mtd><mtd columnalign="left" id="S4.E11.m1.3.3c" xref="S4.E11.m1.3.3.cmml"><mrow id="S4.E11.m1.3.3.3.3.3" xref="S4.E11.m1.3.3.3.3.3e.cmml"><mtext id="S4.E11.m1.3.3.3.3.3a" xref="S4.E11.m1.3.3.3.3.3e.cmml">if (</mtext><mrow id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.cmml"><msub id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">q</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.m1.1.1.3.cmml">𝒩</mi></mrow><mtext id="S4.E11.m1.3.3.3.3.3b" xref="S4.E11.m1.3.3.3.3.3e.cmml"> and </mtext><mrow id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.cmml"><msub id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3.2" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3.2.cmml">k</mi><mi id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3.3" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.3.3.cmml">j</mi></msub><mo id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.2" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.2.cmml">∈</mo><mrow id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.3.cmml">ℛ</mi><mo id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.2" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.2.cmml">⁢</mo><mrow id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.1" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.cmml">(</mo><msub id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.1.1" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.1.1.2" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.1.1.2.cmml">q</mi><mi id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.1.1.3" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.2" xref="S4.E11.m1.2.2.2.2.2.2.2.m2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mtext id="S4.E11.m1.3.3.3.3.3c" xref="S4.E11.m1.3.3.3.3.3e.cmml">) or (</mtext><mrow id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.cmml"><mrow id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.4" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.4.cmml"><msub id="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1.2" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1.2.cmml">q</mi><mi id="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1.3" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.4.1" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.4.cmml">,</mo><msub id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2.cmml"><mi id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2.2" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2.2.cmml">k</mi><mi id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2.3" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.2.2.2.3.cmml">j</mi></msub></mrow><mo id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.3" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.4" xref="S4.E11.m1.3.3.3.3.3.3.3.m3.2.2.4.cmml">ℒ</mi></mrow><mtext id="S4.E11.m1.3.3.3.3.3d" xref="S4.E11.m1.3.3.3.3.3e.cmml">) </mtext></mrow></mtd></mtr><mtr id="S4.E11.m1.3.3d" xref="S4.E11.m1.3.3.cmml"><mtd columnalign="left" id="S4.E11.m1.3.3e" xref="S4.E11.m1.3.3.cmml"><mrow id="S4.E11.m1.3.3.4.1.1" xref="S4.E11.m1.3.3.4.1.1.cmml"><msub id="S4.E11.m1.3.3.4.1.1.2" xref="S4.E11.m1.3.3.4.1.1.2.cmml"><mi id="S4.E11.m1.3.3.4.1.1.2.2" xref="S4.E11.m1.3.3.4.1.1.2.2.cmml">a</mi><mrow id="S4.E11.m1.3.3.4.1.1.2.3" xref="S4.E11.m1.3.3.4.1.1.2.3.cmml"><mi id="S4.E11.m1.3.3.4.1.1.2.3.2" xref="S4.E11.m1.3.3.4.1.1.2.3.2.cmml">i</mi><mo id="S4.E11.m1.3.3.4.1.1.2.3.1" xref="S4.E11.m1.3.3.4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.E11.m1.3.3.4.1.1.2.3.3" xref="S4.E11.m1.3.3.4.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S4.E11.m1.3.3.4.1.1.1" xref="S4.E11.m1.3.3.4.1.1.1.cmml">-</mo><mi mathvariant="normal" id="S4.E11.m1.3.3.4.1.1.3" xref="S4.E11.m1.3.3.4.1.1.3.cmml">∞</mi></mrow></mtd><mtd columnalign="left" id="S4.E11.m1.3.3f" xref="S4.E11.m1.3.3.cmml"><mtext id="S4.E11.m1.3.3.4.2.1" xref="S4.E11.m1.3.3.4.2.1a.cmml">otherwise.</mtext></mtd></mtr></mtable><mi id="S4.E11.m1.4.4.3.2.2" xref="S4.E11.m1.4.4.3.1.1.cmml"/></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr>
</table>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Integrating into Transformer Framework</h3>

<div id="S4.SS4.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS4.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w2">this</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w3">section,</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w5">describe</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w6">how</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w7">the</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w8">above</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w9">proposed</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w10">methods</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w11">fit</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w12">into</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w13">self-</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w14">and</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w15">cross-attentions</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w16">of</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w17">the</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w18">Transformer</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w19">framework,</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w20">which</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w21">enable</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w22">them</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w23">to</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w24">efficiently</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w25">encode</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w26">parse</span><span> </span><span class="gd_word" id="S4.SS4.p1.1.1.w27">trees.
</span></p>
</div>
<section id="S4.SS4.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Encoder Self-attention.</h4>

<div id="S4.SS4.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px1.p1.11" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.1.w1">Figure</span><span> </span><a href="#S4.F3.sf1" title="(a) ‣ Figure 4 ‣ Encoder Self-attention. ‣ 4.4 Integrating into Transformer Framework ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3(a)</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w2">visualizes</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w4">encoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w5">self-attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w6">process.
Without</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w7">loss</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w8">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w9">generality,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.2.w10">let</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="{\bm{L}}\in{\mathbb{R}}^{n\times d}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝑳</mi><mo id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.2.cmml">n</mi><mo id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.3.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="{\bm{N}}\in{\mathbb{R}}^{m\times d}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.2.m2.1a"><mrow id="S4.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.2" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝑵</mi><mo id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.1" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.2.cmml">m</mi><mo id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.2.m2.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w2">respectively</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w3">denote</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w4">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w5">leaf</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w6">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w7">node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w8">representations</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w9">that</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w10">a</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w11">Transformer</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w12">encoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w13">layer</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w14">receives</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w15">from</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w16">its</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w17">previous</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w18">layer</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w19">along</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w20">with</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w21">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w22">parse</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w23">tree</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w24">represented</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.4.w25">as</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{T}(X)=(\mathcal{L}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.3.m3.1a"><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.1b"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p1.3.m3.1.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.2.cmml">𝒯</mi><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.1.3" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.3.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.3.m3.1.3.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.3.1.cmml">(</mo><mi id="S4.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.1.cmml">X</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.3.m3.1.3.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.3.2.cmml">)</mo></mrow><mo id="S4.SS4.SSS0.Px1.p1.3.m3.1.4" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.4.cmml">=</mo><mrow id="S4.SS4.SSS0.Px1.p1.3.m3.1.5" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.5.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.3.m3.1.5.1" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p1.3.m3.1.5.2" xref="S4.SS4.SSS0.Px1.p1.3.m3.1.5.2.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.5.w1">,</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p1.4.m4.1.1.cmml">𝒩</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.6.w1">,</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{R})" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.5.m5.1a"><mrow id="S4.SS4.SSS0.Px1.p1.5.m5.1b"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px1.p1.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p1.5.m5.1.1.cmml">ℛ</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.5.m5.1.2" xref="S4.SS4.SSS0.Px1.p1.5.m5.1.2.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.7.w1">.</span><span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><span class="gd_word" id="footnote4.3.w1">For</span><span> </span><span class="gd_word" id="footnote4.3.w2">the</span><span> </span><span class="gd_word" id="footnote4.3.w3">first</span><span> </span><span class="gd_word" id="footnote4.3.w4">layer,</span><span> </span><math id="footnote4.m1.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="footnote4.m1.1b"><mi id="footnote4.m1.1.1" xref="footnote4.m1.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="footnote4.4.w1"/><span> </span><span class="gd_word" id="footnote4.4.w2">and</span><span> </span><math id="footnote4.m2.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="footnote4.m2.1b"><mi id="footnote4.m2.1.1" xref="footnote4.m2.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="footnote4.5.w1"/><span> </span><span class="gd_word" id="footnote4.5.w2">are</span><span> </span><span class="gd_word" id="footnote4.5.w3">token</span><span> </span><span class="gd_word" id="footnote4.5.w4">embeddings;</span><span> </span><math id="footnote4.m3.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="footnote4.m3.1b"><mi id="footnote4.m3.1.1" xref="footnote4.m3.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="footnote4.6.w1"/><span> </span><span class="gd_word" id="footnote4.6.w2">also</span><span> </span><span class="gd_word" id="footnote4.6.w3">has</span><span> </span><span class="gd_word" id="footnote4.6.w4">positional</span><span> </span><span class="gd_word" id="footnote4.6.w5">encodings.</span></span></span></span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w2">The</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w3">tree-based</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w4">self-attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w5">layer</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w6">then</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w7">computes</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w8">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w9">respective</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w10">output</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.8.w11">representations</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.6.m6.1" class="ltx_Math" alttext="\hat{{\bm{L}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.6.m6.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p1.6.m6.1.1" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.2.cmml">𝑳</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1" xref="S4.SS4.SSS0.Px1.p1.6.m6.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.9.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.9.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.7.m7.1" class="ltx_Math" alttext="\hat{{\bm{N}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.7.m7.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p1.7.m7.1.1" xref="S4.SS4.SSS0.Px1.p1.7.m7.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p1.7.m7.1.1.2" xref="S4.SS4.SSS0.Px1.p1.7.m7.1.1.2.cmml">𝑵</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p1.7.m7.1.1.1" xref="S4.SS4.SSS0.Px1.p1.7.m7.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w1">.
Specifically,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w2">first,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w3">we</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w4">compare</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w5">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w6">node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w7">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w8">leaf</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w9">representations</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w10">against</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w11">each</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w12">other</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w13">to</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w14">produce</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w15">query-key</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w16">affinity</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.10.w17">matrices
</span><math id="S4.SS4.SSS0.Px1.p1.8.m8.1" class="ltx_Math" alttext="{\bm{A}}_{NL}\in{\mathbb{R}}^{m\times n}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.8.m8.1a"><mrow id="S4.SS4.SSS0.Px1.p1.8.m8.1.1" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.2" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.2.cmml">N</mi><mo id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.2.3.3.cmml">L</mi></mrow></msub><mo id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.1" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.2.cmml">m</mi><mo id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.8.m8.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.11.w1">,</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.9.m9.1" class="ltx_Math" alttext="{\bm{A}}_{NN}\in{\mathbb{R}}^{m\times m}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.9.m9.1a"><mrow id="S4.SS4.SSS0.Px1.p1.9.m9.1.1" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.2" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.2.cmml">N</mi><mo id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.1" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.2.cmml">m</mi><mo id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.9.m9.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.12.w1">,
</span><math id="S4.SS4.SSS0.Px1.p1.10.m10.1" class="ltx_Math" alttext="{\bm{A}}_{LL}\in{\mathbb{R}}^{n\times n}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.10.m10.1a"><mrow id="S4.SS4.SSS0.Px1.p1.10.m10.1.1" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.2" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.2.cmml">L</mi><mo id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.2.3.3.cmml">L</mi></mrow></msub><mo id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.1" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.2.cmml">n</mi><mo id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.10.m10.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.13.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.13.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p1.11.m11.1" class="ltx_Math" alttext="{\bm{A}}_{LN}\in{\mathbb{R}}^{n\times m}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p1.11.m11.1a"><mrow id="S4.SS4.SSS0.Px1.p1.11.m11.1.1" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.2" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.2" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.2.cmml">L</mi><mo id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.1" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.3" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.1" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.2" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.2.cmml">n</mi><mo id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.1" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p1.11.m11.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w2">for</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w3">node-leaf</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w4">(i.e.,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w5">node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w6">representation</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w7">as</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w8">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w9">query</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w10">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w11">leaf</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w12">representation</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w13">as</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w14">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w15">key),</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w16">node-node,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w17">leaf-leaf,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w18">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w19">leaf-node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w20">pairs,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w21">respectively,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w22">as</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p1.11.14.w23">follows:</span></p>
</div>
<div id="S4.SS4.SSS0.Px1.p2" class="ltx_para ltx_noindent">
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.2" class="ltx_Math" alttext="{\bm{A}}_{NL}=({\bm{N}}{\bm{W}}^{Q})({\bm{L}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E12.m1.2a"><mrow id="S4.E12.m1.2.2" xref="S4.E12.m1.2.2.cmml"><msub id="S4.E12.m1.2.2.4" xref="S4.E12.m1.2.2.4.cmml"><mi id="S4.E12.m1.2.2.4.2" xref="S4.E12.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E12.m1.2.2.4.3" xref="S4.E12.m1.2.2.4.3.cmml"><mi id="S4.E12.m1.2.2.4.3.2" xref="S4.E12.m1.2.2.4.3.2.cmml">N</mi><mo id="S4.E12.m1.2.2.4.3.1" xref="S4.E12.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E12.m1.2.2.4.3.3" xref="S4.E12.m1.2.2.4.3.3.cmml">L</mi></mrow></msub><mo id="S4.E12.m1.2.2.3" xref="S4.E12.m1.2.2.3.cmml">=</mo><mrow id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.2.cmml"><mrow id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml"><mrow id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">𝑵</mi><mo id="S4.E12.m1.1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E12.m1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.3.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E12.m1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E12.m1.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E12.m1.2.2.2.2.2" xref="S4.E12.m1.2.2.2.2.2.cmml"><mrow id="S4.E12.m1.2.2.2.2.2.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.2.2.2.1.1.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E12.m1.2.2.2.2.2.1.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.2.cmml">𝑳</mi><mo id="S4.E12.m1.2.2.2.2.2.1.1.1.1" xref="S4.E12.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E12.m1.2.2.2.2.2.1.1.1.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E12.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E12.m1.2.2.2.2.2.1.1.3" xref="S4.E12.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E12.m1.2.2.2.2.2.3" xref="S4.E12.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E12.m1.2.2.2.3" xref="S4.E12.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E12.m1.2.2.2.4" xref="S4.E12.m1.2.2.2.4.cmml"><mi id="S4.E12.m1.2.2.2.4.2" xref="S4.E12.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr>
</table>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.2" class="ltx_Math" alttext="{\bm{A}}_{LL}=({\bm{L}}{\bm{W}}^{Q})({\bm{L}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E13.m1.2a"><mrow id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml"><msub id="S4.E13.m1.2.2.4" xref="S4.E13.m1.2.2.4.cmml"><mi id="S4.E13.m1.2.2.4.2" xref="S4.E13.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E13.m1.2.2.4.3" xref="S4.E13.m1.2.2.4.3.cmml"><mi id="S4.E13.m1.2.2.4.3.2" xref="S4.E13.m1.2.2.4.3.2.cmml">L</mi><mo id="S4.E13.m1.2.2.4.3.1" xref="S4.E13.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E13.m1.2.2.4.3.3" xref="S4.E13.m1.2.2.4.3.3.cmml">L</mi></mrow></msub><mo id="S4.E13.m1.2.2.3" xref="S4.E13.m1.2.2.3.cmml">=</mo><mrow id="S4.E13.m1.2.2.2" xref="S4.E13.m1.2.2.2.cmml"><mrow id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml"><mrow id="S4.E13.m1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.2" xref="S4.E13.m1.1.1.1.1.1.1.1.2.cmml">𝑳</mi><mo id="S4.E13.m1.1.1.1.1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E13.m1.1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.1.1.1.1.1.1.1.3.2" xref="S4.E13.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E13.m1.1.1.1.1.1.1.1.3.3" xref="S4.E13.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E13.m1.1.1.1.1.1.1.3" xref="S4.E13.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E13.m1.2.2.2.2.3" xref="S4.E13.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E13.m1.2.2.2.2.2" xref="S4.E13.m1.2.2.2.2.2.cmml"><mrow id="S4.E13.m1.2.2.2.2.2.1.1" xref="S4.E13.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.2.2.2.2.2.1.1.2" xref="S4.E13.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.2.2.2.2.2.1.1.1" xref="S4.E13.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.1.1.2" xref="S4.E13.m1.2.2.2.2.2.1.1.1.2.cmml">𝑳</mi><mo id="S4.E13.m1.2.2.2.2.2.1.1.1.1" xref="S4.E13.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E13.m1.2.2.2.2.2.1.1.1.3" xref="S4.E13.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E13.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E13.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E13.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E13.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E13.m1.2.2.2.2.2.1.1.3" xref="S4.E13.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E13.m1.2.2.2.2.2.3" xref="S4.E13.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E13.m1.2.2.2.3" xref="S4.E13.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E13.m1.2.2.2.4" xref="S4.E13.m1.2.2.2.4.cmml"><mi id="S4.E13.m1.2.2.2.4.2" xref="S4.E13.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr>
</table>
<table id="S4.E14" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.2" class="ltx_Math" alttext="{\bm{A}}_{NN}=({\bm{N}}{\bm{W}}^{Q})({\bm{N}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E14.m1.2a"><mrow id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml"><msub id="S4.E14.m1.2.2.4" xref="S4.E14.m1.2.2.4.cmml"><mi id="S4.E14.m1.2.2.4.2" xref="S4.E14.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E14.m1.2.2.4.3" xref="S4.E14.m1.2.2.4.3.cmml"><mi id="S4.E14.m1.2.2.4.3.2" xref="S4.E14.m1.2.2.4.3.2.cmml">N</mi><mo id="S4.E14.m1.2.2.4.3.1" xref="S4.E14.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.4.3.3" xref="S4.E14.m1.2.2.4.3.3.cmml">N</mi></mrow></msub><mo id="S4.E14.m1.2.2.3" xref="S4.E14.m1.2.2.3.cmml">=</mo><mrow id="S4.E14.m1.2.2.2" xref="S4.E14.m1.2.2.2.cmml"><mrow id="S4.E14.m1.2.2.2.2" xref="S4.E14.m1.2.2.2.2.cmml"><mrow id="S4.E14.m1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E14.m1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.1.2.cmml">𝑵</mi><mo id="S4.E14.m1.1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E14.m1.1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E14.m1.1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E14.m1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E14.m1.2.2.2.2.3" xref="S4.E14.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E14.m1.2.2.2.2.2" xref="S4.E14.m1.2.2.2.2.2.cmml"><mrow id="S4.E14.m1.2.2.2.2.2.1.1" xref="S4.E14.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E14.m1.2.2.2.2.2.1.1.2" xref="S4.E14.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.2.2.2.2.2.1.1.1" xref="S4.E14.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E14.m1.2.2.2.2.2.1.1.1.2" xref="S4.E14.m1.2.2.2.2.2.1.1.1.2.cmml">𝑵</mi><mo id="S4.E14.m1.2.2.2.2.2.1.1.1.1" xref="S4.E14.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E14.m1.2.2.2.2.2.1.1.1.3" xref="S4.E14.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E14.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E14.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E14.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E14.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E14.m1.2.2.2.2.2.1.1.3" xref="S4.E14.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E14.m1.2.2.2.2.2.3" xref="S4.E14.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E14.m1.2.2.2.3" xref="S4.E14.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E14.m1.2.2.2.4" xref="S4.E14.m1.2.2.2.4.cmml"><mi id="S4.E14.m1.2.2.2.4.2" xref="S4.E14.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr>
</table>
<table id="S4.E15" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E15.m1.2" class="ltx_Math" alttext="{\bm{A}}_{LN}=({\bm{L}}{\bm{W}}^{Q})({\bm{N}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E15.m1.2a"><mrow id="S4.E15.m1.2.2" xref="S4.E15.m1.2.2.cmml"><msub id="S4.E15.m1.2.2.4" xref="S4.E15.m1.2.2.4.cmml"><mi id="S4.E15.m1.2.2.4.2" xref="S4.E15.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E15.m1.2.2.4.3" xref="S4.E15.m1.2.2.4.3.cmml"><mi id="S4.E15.m1.2.2.4.3.2" xref="S4.E15.m1.2.2.4.3.2.cmml">L</mi><mo id="S4.E15.m1.2.2.4.3.1" xref="S4.E15.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E15.m1.2.2.4.3.3" xref="S4.E15.m1.2.2.4.3.3.cmml">N</mi></mrow></msub><mo id="S4.E15.m1.2.2.3" xref="S4.E15.m1.2.2.3.cmml">=</mo><mrow id="S4.E15.m1.2.2.2" xref="S4.E15.m1.2.2.2.cmml"><mrow id="S4.E15.m1.2.2.2.2" xref="S4.E15.m1.2.2.2.2.cmml"><mrow id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.2.cmml">𝑳</mi><mo id="S4.E15.m1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E15.m1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E15.m1.1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E15.m1.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E15.m1.2.2.2.2.2" xref="S4.E15.m1.2.2.2.2.2.cmml"><mrow id="S4.E15.m1.2.2.2.2.2.1.1" xref="S4.E15.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m1.2.2.2.2.2.1.1.2" xref="S4.E15.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.2.2.2.2.2.1.1.1" xref="S4.E15.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E15.m1.2.2.2.2.2.1.1.1.2" xref="S4.E15.m1.2.2.2.2.2.1.1.1.2.cmml">𝑵</mi><mo id="S4.E15.m1.2.2.2.2.2.1.1.1.1" xref="S4.E15.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E15.m1.2.2.2.2.2.1.1.1.3" xref="S4.E15.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E15.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E15.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E15.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E15.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E15.m1.2.2.2.2.2.1.1.3" xref="S4.E15.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E15.m1.2.2.2.2.2.3" xref="S4.E15.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E15.m1.2.2.2.3" xref="S4.E15.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E15.m1.2.2.2.4" xref="S4.E15.m1.2.2.2.4.cmml"><mi id="S4.E15.m1.2.2.2.4.2" xref="S4.E15.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr>
</table>
</div>
<figure id="S4.F4" class="ltx_figure">
<img src="/static/img/2002.08046/S4_F4.png" alt="/static/img/2002.08046/S4_F4.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="gd_word" id="S4.F4.2.w1">Illustration</span><span> </span><span class="gd_word" id="S4.F4.2.w2">of</span><span> </span><span class="gd_word" id="S4.F4.2.w3">the</span><span> </span><span class="gd_word" id="S4.F4.2.w4">proposed</span><span> </span><span class="gd_word" id="S4.F4.2.w5">Tree-based</span><span> </span><span class="gd_word" id="S4.F4.2.w6">Attentions:</span><span> </span><span class="gd_word" id="S4.F4.2.w7">(a)</span><span> </span><span class="gd_word" id="S4.F4.2.w8">Encoder</span><span> </span><span class="gd_word" id="S4.F4.2.w9">self-attention,</span><span> </span><span class="gd_word" id="S4.F4.2.w10">(b)</span><span> </span><span class="gd_word" id="S4.F4.2.w11">Decoder</span><span> </span><span class="gd_word" id="S4.F4.2.w12">cross-attention.
Circle-ended</span><span> </span><span class="gd_word" id="S4.F4.2.w13">arrows</span><span> </span><span class="gd_word" id="S4.F4.2.w14">indicate</span><span> </span><span class="gd_word" id="S4.F4.2.w15">where</span><span> </span><span class="gd_word" id="S4.F4.2.w16">hierarchical</span><span> </span><span class="gd_word" id="S4.F4.2.w17">accumulations</span><span> </span><span class="gd_word" id="S4.F4.2.w18">take</span><span> </span><span class="gd_word" id="S4.F4.2.w19">place.</span><span> </span><span class="gd_word" id="S4.F4.2.w20">The</span><span> </span><span class="gd_word" id="S4.F4.2.w21">overall</span><span> </span><span class="gd_word" id="S4.F4.2.w22">Transformer</span><span> </span><span class="gd_word" id="S4.F4.2.w23">architecture</span><span> </span><span class="gd_word" id="S4.F4.2.w24">is</span><span> </span><span class="gd_word" id="S4.F4.2.w25">provided</span><span> </span><span class="gd_word" id="S4.F4.2.w26">in</span><span> </span><span class="gd_word" id="S4.F4.2.w27">Figure</span><span> </span><a href="#S7.F6" title="Figure 6 ‣ 7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">6</a><span class="gd_word" id="S4.F4.3.w1"/><span> </span><span class="gd_word" id="S4.F4.3.w2">(Appendix</span><span> </span><a href="#S7.SS3" title="7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.3</a><span class="gd_word" id="S4.F4.4.w1">).</span></figcaption>
</figure>
<div id="S4.SS4.SSS0.Px1.p3" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px1.p3.4" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.1.w1">Then,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.1.w2">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.1.w3">value</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.1.w4">representation</span><span> </span><math id="S4.SS4.SSS0.Px1.p3.1.m1.1" class="ltx_Math" alttext="\overline{{\bm{L}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.1.m1.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p3.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p3.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p3.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p3.1.m1.1.1.2.cmml">𝑳</mi><mo id="S4.SS4.SSS0.Px1.p3.1.m1.1.1.1" xref="S4.SS4.SSS0.Px1.p3.1.m1.1.1.1.cmml">¯</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.2.w2">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.2.w4">leaves</span><span> </span><math id="S4.SS4.SSS0.Px1.p3.2.m2.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.2.m2.1a"><mi id="S4.SS4.SSS0.Px1.p3.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p3.2.m2.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w2">is</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w3">computed</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w4">by</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w5">a</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w6">linear</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w7">layer,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w8">while</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w9">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w10">value</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.3.w11">representation</span><span> </span><math id="S4.SS4.SSS0.Px1.p3.3.m3.1" class="ltx_Math" alttext="\overline{{\bm{N}}}^{\prime}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.3.m3.1a"><msup id="S4.SS4.SSS0.Px1.p3.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p3.3.m3.1.1.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2" xref="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2.2" xref="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2.2.cmml">𝑵</mi><mo id="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2.1" xref="S4.SS4.SSS0.Px1.p3.3.m3.1.1.2.1.cmml">¯</mo></mover><mo id="S4.SS4.SSS0.Px1.p3.3.m3.1.1.3" xref="S4.SS4.SSS0.Px1.p3.3.m3.1.1.3.cmml">′</mo></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.4.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.4.w2">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.4.w3">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.4.w4">nodes</span><span> </span><math id="S4.SS4.SSS0.Px1.p3.4.m4.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p3.4.m4.1a"><mi id="S4.SS4.SSS0.Px1.p3.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p3.4.m4.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w2">is</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w3">encoded</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w4">with</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w5">tree</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w6">structure</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w7">using</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w8">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w9">hierarchical</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w10">accumulation</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w11">process</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.5.w12">(Section</span><span> </span><a href="#S4.SS1" title="4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4.1</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.6.w1">-</span><a href="#S4.SS2" title="4.2 Hierarchical Embeddings ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4.2</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.7.w1">)</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p3.4.7.w2">as:</span></p>
</div>
<div id="S4.SS4.SSS0.Px1.p4" class="ltx_para ltx_noindent">
<table id="S4.E16" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E16.m1.2" class="ltx_Math" alttext="\overline{{\bm{N}}}^{\prime}=\mathcal{V}(\mathcal{U}(\mathcal{F}({\bm{L}}{\bm{%&#10;W}}^{V},{\bm{N}}{\bm{W}}^{V},\mathcal{R})+{\bm{\mathsfit{E}}}),{\bm{w}})\hskip&#10;1%&#10;0.0pt;\hskip 10.0pt\overline{{\bm{L}}}={\bm{L}}{\bm{W}}^{V}" display="block"><semantics id="S4.E16.m1.2a"><mrow id="S4.E16.m1.2b"><msup id="S4.E16.m1.2.3" xref="S4.E16.m1.2.3.cmml"><mover accent="true" id="S4.E16.m1.2.3.2" xref="S4.E16.m1.2.3.2.cmml"><mi id="S4.E16.m1.2.3.2.2" xref="S4.E16.m1.2.3.2.2.cmml">𝑵</mi><mo id="S4.E16.m1.2.3.2.1" xref="S4.E16.m1.2.3.2.1.cmml">¯</mo></mover><mo id="S4.E16.m1.2.3.3" xref="S4.E16.m1.2.3.3.cmml">′</mo></msup><mo id="S4.E16.m1.2.4" xref="S4.E16.m1.2.4.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.2.5" xref="S4.E16.m1.2.5.cmml">𝒱</mi><mrow id="S4.E16.m1.2.6" xref="S4.E16.m1.2.6.cmml"><mo stretchy="false" id="S4.E16.m1.2.6.1" xref="S4.E16.m1.2.6.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.2.6.2" xref="S4.E16.m1.2.6.2.cmml">𝒰</mi><mrow id="S4.E16.m1.2.6.3" xref="S4.E16.m1.2.6.3.cmml"><mo stretchy="false" id="S4.E16.m1.2.6.3.1" xref="S4.E16.m1.2.6.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.2.6.3.2" xref="S4.E16.m1.2.6.3.2.cmml">ℱ</mi><mrow id="S4.E16.m1.2.6.3.3" xref="S4.E16.m1.2.6.3.3.cmml"><mo stretchy="false" id="S4.E16.m1.2.6.3.3.1" xref="S4.E16.m1.2.6.3.3.1.cmml">(</mo><mi id="S4.E16.m1.2.6.3.3.2" xref="S4.E16.m1.2.6.3.3.2.cmml">𝑳</mi><msup id="S4.E16.m1.2.6.3.3.3" xref="S4.E16.m1.2.6.3.3.3.cmml"><mi id="S4.E16.m1.2.6.3.3.3.2" xref="S4.E16.m1.2.6.3.3.3.2.cmml">𝑾</mi><mi id="S4.E16.m1.2.6.3.3.3.3" xref="S4.E16.m1.2.6.3.3.3.3.cmml">V</mi></msup><mo id="S4.E16.m1.2.6.3.3.4" xref="S4.E16.m1.2.6.3.3.4.cmml">,</mo><mi id="S4.E16.m1.2.6.3.3.5" xref="S4.E16.m1.2.6.3.3.5.cmml">𝑵</mi><msup id="S4.E16.m1.2.6.3.3.6" xref="S4.E16.m1.2.6.3.3.6.cmml"><mi id="S4.E16.m1.2.6.3.3.6.2" xref="S4.E16.m1.2.6.3.3.6.2.cmml">𝑾</mi><mi id="S4.E16.m1.2.6.3.3.6.3" xref="S4.E16.m1.2.6.3.3.6.3.cmml">V</mi></msup><mo id="S4.E16.m1.2.6.3.3.7" xref="S4.E16.m1.2.6.3.3.7.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E16.m1.1.1" xref="S4.E16.m1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S4.E16.m1.2.6.3.3.8" xref="S4.E16.m1.2.6.3.3.8.cmml">)</mo></mrow><mo id="S4.E16.m1.2.6.3.4" xref="S4.E16.m1.2.6.3.4.cmml">+</mo><mi id="S4.E16.m1.2.6.3.5" xref="S4.E16.m1.2.6.3.5.cmml">𝑬</mi><mo stretchy="false" id="S4.E16.m1.2.6.3.6" xref="S4.E16.m1.2.6.3.6.cmml">)</mo></mrow><mo id="S4.E16.m1.2.6.4" xref="S4.E16.m1.2.6.4.cmml">,</mo><mi id="S4.E16.m1.2.2" xref="S4.E16.m1.2.2.cmml">𝒘</mi><mo stretchy="false" id="S4.E16.m1.2.6.5" xref="S4.E16.m1.2.6.5.cmml">)</mo></mrow><mo mathvariant="italic" separator="true" id="S4.E16.m1.2.7" xref="S4.E16.m1.2.7.cmml"> </mo><mo rspace="12.5pt" id="S4.E16.m1.2.8" xref="S4.E16.m1.2.8.cmml">;</mo><mover accent="true" id="S4.E16.m1.2.9" xref="S4.E16.m1.2.9.cmml"><mi id="S4.E16.m1.2.9.2" xref="S4.E16.m1.2.9.2.cmml">𝑳</mi><mo id="S4.E16.m1.2.9.1" xref="S4.E16.m1.2.9.1.cmml">¯</mo></mover><mo id="S4.E16.m1.2.10" xref="S4.E16.m1.2.10.cmml">=</mo><mi id="S4.E16.m1.2.11" xref="S4.E16.m1.2.11.cmml">𝑳</mi><msup id="S4.E16.m1.2.12" xref="S4.E16.m1.2.12.cmml"><mi id="S4.E16.m1.2.12.2" xref="S4.E16.m1.2.12.2.cmml">𝑾</mi><mi id="S4.E16.m1.2.12.3" xref="S4.E16.m1.2.12.3.cmml">V</mi></msup></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr>
</table>
</div>
<div id="S4.SS4.SSS0.Px1.p5" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px1.p5.8" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.1.w1">where</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.1.m1.1" class="ltx_Math" alttext="{\bm{w}}={\bm{L}}{\bm{u}}_{s}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.1.m1.1a"><mrow id="S4.SS4.SSS0.Px1.p5.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.2.cmml">𝒘</mi><mo id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.1" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.2.cmml">𝑳</mi><mo id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.1" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3.2.cmml">𝒖</mi><mi id="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3.3" xref="S4.SS4.SSS0.Px1.p5.1.m1.1.1.3.3.3.cmml">s</mi></msub></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.2.w2">with</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.2.m2.1" class="ltx_Math" alttext="{\bm{u}}_{s}\in{\mathbb{R}}^{d}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.2.m2.1a"><mrow id="S4.SS4.SSS0.Px1.p5.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.cmml"><msub id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2.2" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2.2.cmml">𝒖</mi><mi id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2.3" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.2.3.cmml">s</mi></msub><mo id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.1" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px1.p5.2.m2.1.1.3.3.cmml">d</mi></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w2">being</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w3">a</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w4">trainable</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w5">vector,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w6">while</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w7">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w8">weight</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.3.w9">matrices</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.3.m3.1" class="ltx_Math" alttext="{\bm{W}}^{Q}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.3.m3.1a"><msup id="S4.SS4.SSS0.Px1.p5.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p5.3.m3.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.3.m3.1.1.2" xref="S4.SS4.SSS0.Px1.p5.3.m3.1.1.2.cmml">𝑾</mi><mi id="S4.SS4.SSS0.Px1.p5.3.m3.1.1.3" xref="S4.SS4.SSS0.Px1.p5.3.m3.1.1.3.cmml">Q</mi></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.4.w1">,</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.4.m4.1" class="ltx_Math" alttext="{\bm{W}}^{K}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.4.m4.1a"><msup id="S4.SS4.SSS0.Px1.p5.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p5.4.m4.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.4.m4.1.1.2" xref="S4.SS4.SSS0.Px1.p5.4.m4.1.1.2.cmml">𝑾</mi><mi id="S4.SS4.SSS0.Px1.p5.4.m4.1.1.3" xref="S4.SS4.SSS0.Px1.p5.4.m4.1.1.3.cmml">K</mi></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.5.w1">,</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.5.m5.1" class="ltx_Math" alttext="{\bm{W}}^{V}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.5.m5.1a"><msup id="S4.SS4.SSS0.Px1.p5.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p5.5.m5.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.5.m5.1.1.2" xref="S4.SS4.SSS0.Px1.p5.5.m5.1.1.2.cmml">𝑾</mi><mi id="S4.SS4.SSS0.Px1.p5.5.m5.1.1.3" xref="S4.SS4.SSS0.Px1.p5.5.m5.1.1.3.cmml">V</mi></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.6.w1">,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.6.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.6.m6.1" class="ltx_Math" alttext="{\bm{W}}^{O}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.6.m6.1a"><msup id="S4.SS4.SSS0.Px1.p5.6.m6.1.1" xref="S4.SS4.SSS0.Px1.p5.6.m6.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.6.m6.1.1.2" xref="S4.SS4.SSS0.Px1.p5.6.m6.1.1.2.cmml">𝑾</mi><mi id="S4.SS4.SSS0.Px1.p5.6.m6.1.1.3" xref="S4.SS4.SSS0.Px1.p5.6.m6.1.1.3.cmml">O</mi></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w2">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w3">similarly</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w4">defined</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w5">as</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w6">in</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.7.w7">Section</span><span> </span><a href="#S3" title="3 Background - Transformer Framework ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w1">.</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w2">After</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w3">this,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w4">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w5">resulting</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w6">affinity</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w7">scores</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w8">for</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w9">leaves</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w10">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w11">nodes</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w12">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w13">concatenated</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w14">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w15">then</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w16">masked</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w17">by</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w18">subtree</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w19">masking</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.8.w20">(Section</span><span> </span><a href="#S4.SS3" title="4.3 Subtree Masking ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4.3</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w1">)</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w2">to</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w3">promote</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w4">bottom-up</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w5">encoding.</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w6">The</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w7">final</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w8">attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w9">for</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w10">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w11">nodes</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w12">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w13">leaves</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w14">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w15">then</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w16">computed</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w17">by</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w18">taking</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w19">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w20">weighted</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w21">averages</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w22">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w23">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w24">value</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w25">vectors</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.9.w26">in</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.7.m7.1" class="ltx_Math" alttext="\overline{{\bm{N}}}^{\prime}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.7.m7.1a"><msup id="S4.SS4.SSS0.Px1.p5.7.m7.1.1" xref="S4.SS4.SSS0.Px1.p5.7.m7.1.1.cmml"><mover accent="true" id="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2" xref="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2.2" xref="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2.2.cmml">𝑵</mi><mo id="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2.1" xref="S4.SS4.SSS0.Px1.p5.7.m7.1.1.2.1.cmml">¯</mo></mover><mo id="S4.SS4.SSS0.Px1.p5.7.m7.1.1.3" xref="S4.SS4.SSS0.Px1.p5.7.m7.1.1.3.cmml">′</mo></msup></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.10.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.10.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p5.8.m8.1" class="ltx_Math" alttext="\overline{{\bm{L}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p5.8.m8.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p5.8.m8.1.1" xref="S4.SS4.SSS0.Px1.p5.8.m8.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p5.8.m8.1.1.2" xref="S4.SS4.SSS0.Px1.p5.8.m8.1.1.2.cmml">𝑳</mi><mo id="S4.SS4.SSS0.Px1.p5.8.m8.1.1.1" xref="S4.SS4.SSS0.Px1.p5.8.m8.1.1.1.cmml">¯</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p5.8.11.w1">:</span></p>
</div>
<div id="S4.SS4.SSS0.Px1.p6" class="ltx_para ltx_noindent">
<table id="S4.E17" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E17.m1.3" class="ltx_Math" alttext="\text{Att}_{N}=\mathrm{softmax}(\mu([{\bm{A}}_{NN};{\bm{A}}_{NL}]))[\overline{%&#10;{\bm{N}}}^{\prime};\overline{{\bm{L}}}]\vspace{-0.2em}" display="block"><semantics id="S4.E17.m1.3a"><mrow id="S4.E17.m1.3.3" xref="S4.E17.m1.3.3.cmml"><msub id="S4.E17.m1.3.3.4" xref="S4.E17.m1.3.3.4.cmml"><mi id="S4.E17.m1.3.3.4.2" xref="S4.E17.m1.3.3.4.2a.cmml">Att</mi><mi id="S4.E17.m1.3.3.4.3" xref="S4.E17.m1.3.3.4.3.cmml">N</mi></msub><mo id="S4.E17.m1.3.3.3" xref="S4.E17.m1.3.3.3.cmml">=</mo><mrow id="S4.E17.m1.3.3.2" xref="S4.E17.m1.3.3.2.cmml"><mi id="S4.E17.m1.3.3.2.4" xref="S4.E17.m1.3.3.2.4.cmml">softmax</mi><mo id="S4.E17.m1.3.3.2.3" xref="S4.E17.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E17.m1.2.2.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.2.2.1.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.3" xref="S4.E17.m1.2.2.1.1.1.1.3.cmml">μ</mi><mo id="S4.E17.m1.2.2.1.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E17.m1.2.2.1.1.1.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.3.cmml">[</mo><msub id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝑨</mi><mrow id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">N</mi><mo id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.4" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.3.cmml">;</mo><msub id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝑨</mi><mrow id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">N</mi><mo id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">L</mi></mrow></msub><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.1.1.1.1.2.5" xref="S4.E17.m1.2.2.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.1.1.1.3" xref="S4.E17.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E17.m1.2.2.1.1.1.3" xref="S4.E17.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E17.m1.3.3.2.3a" xref="S4.E17.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E17.m1.3.3.2.2.1" xref="S4.E17.m1.3.3.2.2.2.cmml"><mo stretchy="false" id="S4.E17.m1.3.3.2.2.1.2" xref="S4.E17.m1.3.3.2.2.2.cmml">[</mo><msup id="S4.E17.m1.3.3.2.2.1.1" xref="S4.E17.m1.3.3.2.2.1.1.cmml"><mover accent="true" id="S4.E17.m1.3.3.2.2.1.1.2" xref="S4.E17.m1.3.3.2.2.1.1.2.cmml"><mi id="S4.E17.m1.3.3.2.2.1.1.2.2" xref="S4.E17.m1.3.3.2.2.1.1.2.2.cmml">𝑵</mi><mo id="S4.E17.m1.3.3.2.2.1.1.2.1" xref="S4.E17.m1.3.3.2.2.1.1.2.1.cmml">¯</mo></mover><mo id="S4.E17.m1.3.3.2.2.1.1.3" xref="S4.E17.m1.3.3.2.2.1.1.3.cmml">′</mo></msup><mo id="S4.E17.m1.3.3.2.2.1.3" xref="S4.E17.m1.3.3.2.2.2.cmml">;</mo><mover accent="true" id="S4.E17.m1.1.1" xref="S4.E17.m1.1.1.cmml"><mi id="S4.E17.m1.1.1.2" xref="S4.E17.m1.1.1.2.cmml">𝑳</mi><mo id="S4.E17.m1.1.1.1" xref="S4.E17.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S4.E17.m1.3.3.2.2.1.4" xref="S4.E17.m1.3.3.2.2.2.cmml">]</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr>
</table>
<table id="S4.E18" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E18.m1.3" class="ltx_Math" alttext="\text{Att}_{L}=\mathrm{softmax}(\mu([{\bm{A}}_{LN};{\bm{A}}_{LL}]))[\overline{%&#10;{\bm{N}}}^{\prime};\overline{{\bm{L}}}]\vspace{-0.2em}" display="block"><semantics id="S4.E18.m1.3a"><mrow id="S4.E18.m1.3.3" xref="S4.E18.m1.3.3.cmml"><msub id="S4.E18.m1.3.3.4" xref="S4.E18.m1.3.3.4.cmml"><mi id="S4.E18.m1.3.3.4.2" xref="S4.E18.m1.3.3.4.2a.cmml">Att</mi><mi id="S4.E18.m1.3.3.4.3" xref="S4.E18.m1.3.3.4.3.cmml">L</mi></msub><mo id="S4.E18.m1.3.3.3" xref="S4.E18.m1.3.3.3.cmml">=</mo><mrow id="S4.E18.m1.3.3.2" xref="S4.E18.m1.3.3.2.cmml"><mi id="S4.E18.m1.3.3.2.4" xref="S4.E18.m1.3.3.2.4.cmml">softmax</mi><mo id="S4.E18.m1.3.3.2.3" xref="S4.E18.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E18.m1.2.2.1.1.1" xref="S4.E18.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.2" xref="S4.E18.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E18.m1.2.2.1.1.1.1" xref="S4.E18.m1.2.2.1.1.1.1.cmml"><mi id="S4.E18.m1.2.2.1.1.1.1.3" xref="S4.E18.m1.2.2.1.1.1.1.3.cmml">μ</mi><mo id="S4.E18.m1.2.2.1.1.1.1.2" xref="S4.E18.m1.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E18.m1.2.2.1.1.1.1.1.1" xref="S4.E18.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.1.1.1.2" xref="S4.E18.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.3" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.3.cmml">[</mo><msub id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝑨</mi><mrow id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.2.cmml">L</mi><mo id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.1" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.4" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.3.cmml">;</mo><msub id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">𝑨</mi><mrow id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.cmml"><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.2" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.2.cmml">L</mi><mo id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.1" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.3" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.2.3.3.cmml">L</mi></mrow></msub><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.1.1.1.1.2.5" xref="S4.E18.m1.2.2.1.1.1.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.1.1.1.3" xref="S4.E18.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E18.m1.2.2.1.1.1.3" xref="S4.E18.m1.2.2.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E18.m1.3.3.2.3a" xref="S4.E18.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E18.m1.3.3.2.2.1" xref="S4.E18.m1.3.3.2.2.2.cmml"><mo stretchy="false" id="S4.E18.m1.3.3.2.2.1.2" xref="S4.E18.m1.3.3.2.2.2.cmml">[</mo><msup id="S4.E18.m1.3.3.2.2.1.1" xref="S4.E18.m1.3.3.2.2.1.1.cmml"><mover accent="true" id="S4.E18.m1.3.3.2.2.1.1.2" xref="S4.E18.m1.3.3.2.2.1.1.2.cmml"><mi id="S4.E18.m1.3.3.2.2.1.1.2.2" xref="S4.E18.m1.3.3.2.2.1.1.2.2.cmml">𝑵</mi><mo id="S4.E18.m1.3.3.2.2.1.1.2.1" xref="S4.E18.m1.3.3.2.2.1.1.2.1.cmml">¯</mo></mover><mo id="S4.E18.m1.3.3.2.2.1.1.3" xref="S4.E18.m1.3.3.2.2.1.1.3.cmml">′</mo></msup><mo id="S4.E18.m1.3.3.2.2.1.3" xref="S4.E18.m1.3.3.2.2.2.cmml">;</mo><mover accent="true" id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml"><mi id="S4.E18.m1.1.1.2" xref="S4.E18.m1.1.1.2.cmml">𝑳</mi><mo id="S4.E18.m1.1.1.1" xref="S4.E18.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S4.E18.m1.3.3.2.2.1.4" xref="S4.E18.m1.3.3.2.2.2.cmml">]</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr>
</table>
</div>
<div id="S4.SS4.SSS0.Px1.p7" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px1.p7.5" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.1.w1">Both</span><span> </span><math id="S4.SS4.SSS0.Px1.p7.1.m1.1" class="ltx_Math" alttext="\text{Att}_{N}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p7.1.m1.1a"><msub id="S4.SS4.SSS0.Px1.p7.1.m1.1.1" xref="S4.SS4.SSS0.Px1.p7.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p7.1.m1.1.1.2" xref="S4.SS4.SSS0.Px1.p7.1.m1.1.1.2a.cmml">Att</mi><mi id="S4.SS4.SSS0.Px1.p7.1.m1.1.1.3" xref="S4.SS4.SSS0.Px1.p7.1.m1.1.1.3.cmml">N</mi></msub></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.2.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p7.2.m2.1" class="ltx_Math" alttext="\text{Att}_{L}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p7.2.m2.1a"><msub id="S4.SS4.SSS0.Px1.p7.2.m2.1.1" xref="S4.SS4.SSS0.Px1.p7.2.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p7.2.m2.1.1.2" xref="S4.SS4.SSS0.Px1.p7.2.m2.1.1.2a.cmml">Att</mi><mi id="S4.SS4.SSS0.Px1.p7.2.m2.1.1.3" xref="S4.SS4.SSS0.Px1.p7.2.m2.1.1.3.cmml">L</mi></msub></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w2">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w3">then</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w4">passed</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w5">through</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w6">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w7">Transformer’s</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w8">serial</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w9">computations</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w10">by</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.3.w11">function</span><span> </span><math id="S4.SS4.SSS0.Px1.p7.3.m3.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS4.SSS0.Px1.p7.3.m3.1a"><mi id="S4.SS4.SSS0.Px1.p7.3.m3.1.1" xref="S4.SS4.SSS0.Px1.p7.3.m3.1.1.cmml">ϕ</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.4.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.4.w2">(Eq.</span><span> </span><a href="#S3.E3" title="(3) ‣ 3 Background - Transformer Framework ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.5.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.5.w2">in</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.5.w3">Section</span><span> </span><a href="#S3" title="3 Background - Transformer Framework ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3</a><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w1">),</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w2">which</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w3">results</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w4">in</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w5">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w6">final</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w7">output</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.6.w8">representations</span><span> </span><math id="S4.SS4.SSS0.Px1.p7.4.m4.1" class="ltx_Math" alttext="\hat{{\bm{N}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p7.4.m4.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p7.4.m4.1.1" xref="S4.SS4.SSS0.Px1.p7.4.m4.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p7.4.m4.1.1.2" xref="S4.SS4.SSS0.Px1.p7.4.m4.1.1.2.cmml">𝑵</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p7.4.m4.1.1.1" xref="S4.SS4.SSS0.Px1.p7.4.m4.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.7.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.7.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px1.p7.5.m5.1" class="ltx_Math" alttext="\hat{{\bm{L}}}" display="inline"><semantics id="S4.SS4.SSS0.Px1.p7.5.m5.1a"><mover accent="true" id="S4.SS4.SSS0.Px1.p7.5.m5.1.1" xref="S4.SS4.SSS0.Px1.p7.5.m5.1.1.cmml"><mi id="S4.SS4.SSS0.Px1.p7.5.m5.1.1.2" xref="S4.SS4.SSS0.Px1.p7.5.m5.1.1.2.cmml">𝑳</mi><mo stretchy="false" id="S4.SS4.SSS0.Px1.p7.5.m5.1.1.1" xref="S4.SS4.SSS0.Px1.p7.5.m5.1.1.1.cmml">^</mo></mover></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.8.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.8.w2">as</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px1.p7.5.8.w3">follows:</span></p>
<table id="S4.E19" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E19.m1.2" class="ltx_Math" alttext="\hat{{\bm{N}}}=\phi(\text{Att}_{N}{\bm{W}}^{O},{\bm{N}})" display="block"><semantics id="S4.E19.m1.2a"><mrow id="S4.E19.m1.2.2" xref="S4.E19.m1.2.2.cmml"><mover accent="true" id="S4.E19.m1.2.2.3" xref="S4.E19.m1.2.2.3.cmml"><mi id="S4.E19.m1.2.2.3.2" xref="S4.E19.m1.2.2.3.2.cmml">𝑵</mi><mo stretchy="false" id="S4.E19.m1.2.2.3.1" xref="S4.E19.m1.2.2.3.1.cmml">^</mo></mover><mo id="S4.E19.m1.2.2.2" xref="S4.E19.m1.2.2.2.cmml">=</mo><mrow id="S4.E19.m1.2.2.1" xref="S4.E19.m1.2.2.1.cmml"><mi id="S4.E19.m1.2.2.1.3" xref="S4.E19.m1.2.2.1.3.cmml">ϕ</mi><mo id="S4.E19.m1.2.2.1.2" xref="S4.E19.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E19.m1.2.2.1.1.1" xref="S4.E19.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E19.m1.2.2.1.1.1.2" xref="S4.E19.m1.2.2.1.1.2.cmml">(</mo><mrow id="S4.E19.m1.2.2.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.cmml"><msub id="S4.E19.m1.2.2.1.1.1.1.2" xref="S4.E19.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.E19.m1.2.2.1.1.1.1.2.2" xref="S4.E19.m1.2.2.1.1.1.1.2.2a.cmml">Att</mi><mi id="S4.E19.m1.2.2.1.1.1.1.2.3" xref="S4.E19.m1.2.2.1.1.1.1.2.3.cmml">N</mi></msub><mo id="S4.E19.m1.2.2.1.1.1.1.1" xref="S4.E19.m1.2.2.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E19.m1.2.2.1.1.1.1.3" xref="S4.E19.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E19.m1.2.2.1.1.1.1.3.2" xref="S4.E19.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E19.m1.2.2.1.1.1.1.3.3" xref="S4.E19.m1.2.2.1.1.1.1.3.3.cmml">O</mi></msup></mrow><mo id="S4.E19.m1.2.2.1.1.1.3" xref="S4.E19.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E19.m1.1.1" xref="S4.E19.m1.1.1.cmml">𝑵</mi><mo stretchy="false" id="S4.E19.m1.2.2.1.1.1.4" xref="S4.E19.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr>
</table>
<table id="S4.E20" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E20.m1.2" class="ltx_Math" alttext="\hat{{\bm{L}}}=\phi(\text{Att}_{L}{\bm{W}}^{O},{\bm{L}})" display="block"><semantics id="S4.E20.m1.2a"><mrow id="S4.E20.m1.2.2" xref="S4.E20.m1.2.2.cmml"><mover accent="true" id="S4.E20.m1.2.2.3" xref="S4.E20.m1.2.2.3.cmml"><mi id="S4.E20.m1.2.2.3.2" xref="S4.E20.m1.2.2.3.2.cmml">𝑳</mi><mo stretchy="false" id="S4.E20.m1.2.2.3.1" xref="S4.E20.m1.2.2.3.1.cmml">^</mo></mover><mo id="S4.E20.m1.2.2.2" xref="S4.E20.m1.2.2.2.cmml">=</mo><mrow id="S4.E20.m1.2.2.1" xref="S4.E20.m1.2.2.1.cmml"><mi id="S4.E20.m1.2.2.1.3" xref="S4.E20.m1.2.2.1.3.cmml">ϕ</mi><mo id="S4.E20.m1.2.2.1.2" xref="S4.E20.m1.2.2.1.2.cmml">⁢</mo><mrow id="S4.E20.m1.2.2.1.1.1" xref="S4.E20.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E20.m1.2.2.1.1.1.2" xref="S4.E20.m1.2.2.1.1.2.cmml">(</mo><mrow id="S4.E20.m1.2.2.1.1.1.1" xref="S4.E20.m1.2.2.1.1.1.1.cmml"><msub id="S4.E20.m1.2.2.1.1.1.1.2" xref="S4.E20.m1.2.2.1.1.1.1.2.cmml"><mi id="S4.E20.m1.2.2.1.1.1.1.2.2" xref="S4.E20.m1.2.2.1.1.1.1.2.2a.cmml">Att</mi><mi id="S4.E20.m1.2.2.1.1.1.1.2.3" xref="S4.E20.m1.2.2.1.1.1.1.2.3.cmml">L</mi></msub><mo id="S4.E20.m1.2.2.1.1.1.1.1" xref="S4.E20.m1.2.2.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E20.m1.2.2.1.1.1.1.3" xref="S4.E20.m1.2.2.1.1.1.1.3.cmml"><mi id="S4.E20.m1.2.2.1.1.1.1.3.2" xref="S4.E20.m1.2.2.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E20.m1.2.2.1.1.1.1.3.3" xref="S4.E20.m1.2.2.1.1.1.1.3.3.cmml">O</mi></msup></mrow><mo id="S4.E20.m1.2.2.1.1.1.3" xref="S4.E20.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E20.m1.1.1" xref="S4.E20.m1.1.1.cmml">𝑳</mi><mo stretchy="false" id="S4.E20.m1.2.2.1.1.1.4" xref="S4.E20.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr>
</table>
</div>
</section>
<section id="S4.SS4.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Decoder Cross-attention.</h4>

<div id="S4.SS4.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px2.p1.5" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w1">For</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w2">tasks</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w3">involving</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w4">generation</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w5">(e.g.,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w6">NMT),</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w7">we</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w8">also</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w9">use</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w10">tree-based</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w11">encoder-decoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w12">attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w13">(or</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w14">cross-attention)</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w15">in</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w16">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w17">decoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w18">so</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w19">that</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w21">target-side</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w22">queries</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w23">can</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w24">leverage</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w25">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w26">hierarchical</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w27">structures</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w28">in</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w29">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w30">source</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w31">side</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w32">(tree2seq).</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.1.w33">Figure</span><span> </span><a href="#S4.F3.sf2" title="(b) ‣ Figure 4 ‣ Encoder Self-attention. ‣ 4.4 Integrating into Transformer Framework ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3(b)</a><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w2">shows</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w4">cross-attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w5">process.</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w6">Specifically,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w7">given</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w8">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w9">target-side</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w10">query</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.2.w11">matrix</span><span> </span><math id="S4.SS4.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="{\bm{Q}}\in{\mathbb{R}}^{t\times d}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝑸</mi><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">t</mi><mo id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="S4.SS4.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w2">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w4">source-side</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w5">leaf</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w6">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w7">node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.3.w8">matrices</span><span> </span><math id="S4.SS4.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="{\bm{L}}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p1.2.m2.1.1.cmml">𝑳</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.4.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.4.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p1.3.m3.1a"><mi id="S4.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S4.SS4.SSS0.Px2.p1.3.m3.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.5.w1">,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.5.w2">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.5.w3">affinity</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.5.w4">scores</span><span> </span><math id="S4.SS4.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="{\bm{A}}_{QN}\in{\mathbb{R}}^{t\times m}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p1.4.m4.1a"><mrow id="S4.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.2.cmml">Q</mi><mo id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.2.3.3.cmml">N</mi></mrow></msub><mo id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.2.cmml">t</mi><mo id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.1" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.3" xref="S4.SS4.SSS0.Px2.p1.4.m4.1.1.3.3.3.cmml">m</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.6.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.6.w2">and</span><span> </span><math id="S4.SS4.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="{\bm{A}}_{QL}\in{\mathbb{R}}^{t\times n}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p1.5.m5.1a"><mrow id="S4.SS4.SSS0.Px2.p1.5.m5.1.1" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.2" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.2.cmml">𝑨</mi><mrow id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.2" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.2.cmml">Q</mi><mo id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.1" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.3" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.2.3.3.cmml">L</mi></mrow></msub><mo id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.1" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml">t</mi><mo id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.1" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml">×</mo><mi id="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.3" xref="S4.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.3.cmml">n</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.7.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.7.w2">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.7.w3">computed</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p1.5.7.w4">as:
</span></p>
<table id="S4.E21" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E21.m1.2" class="ltx_Math" alttext="{\bm{A}}_{QN}=({\bm{Q}}^{t}{\bm{W}}^{Q})({\bm{N}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E21.m1.2a"><mrow id="S4.E21.m1.2.2" xref="S4.E21.m1.2.2.cmml"><msub id="S4.E21.m1.2.2.4" xref="S4.E21.m1.2.2.4.cmml"><mi id="S4.E21.m1.2.2.4.2" xref="S4.E21.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E21.m1.2.2.4.3" xref="S4.E21.m1.2.2.4.3.cmml"><mi id="S4.E21.m1.2.2.4.3.2" xref="S4.E21.m1.2.2.4.3.2.cmml">Q</mi><mo id="S4.E21.m1.2.2.4.3.1" xref="S4.E21.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E21.m1.2.2.4.3.3" xref="S4.E21.m1.2.2.4.3.3.cmml">N</mi></mrow></msub><mo id="S4.E21.m1.2.2.3" xref="S4.E21.m1.2.2.3.cmml">=</mo><mrow id="S4.E21.m1.2.2.2" xref="S4.E21.m1.2.2.2.cmml"><mrow id="S4.E21.m1.2.2.2.2" xref="S4.E21.m1.2.2.2.2.cmml"><mrow id="S4.E21.m1.1.1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.1.1.1.1.1.1.2" xref="S4.E21.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.1.1.1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.1.1.1.cmml"><msup id="S4.E21.m1.1.1.1.1.1.1.1.2" xref="S4.E21.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E21.m1.1.1.1.1.1.1.1.2.2" xref="S4.E21.m1.1.1.1.1.1.1.1.2.2.cmml">𝑸</mi><mi id="S4.E21.m1.1.1.1.1.1.1.1.2.3" xref="S4.E21.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S4.E21.m1.1.1.1.1.1.1.1.1" xref="S4.E21.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E21.m1.1.1.1.1.1.1.1.3" xref="S4.E21.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E21.m1.1.1.1.1.1.1.1.3.2" xref="S4.E21.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E21.m1.1.1.1.1.1.1.1.3.3" xref="S4.E21.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E21.m1.1.1.1.1.1.1.3" xref="S4.E21.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E21.m1.2.2.2.2.3" xref="S4.E21.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E21.m1.2.2.2.2.2" xref="S4.E21.m1.2.2.2.2.2.cmml"><mrow id="S4.E21.m1.2.2.2.2.2.1.1" xref="S4.E21.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E21.m1.2.2.2.2.2.1.1.2" xref="S4.E21.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E21.m1.2.2.2.2.2.1.1.1" xref="S4.E21.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E21.m1.2.2.2.2.2.1.1.1.2" xref="S4.E21.m1.2.2.2.2.2.1.1.1.2.cmml">𝑵</mi><mo id="S4.E21.m1.2.2.2.2.2.1.1.1.1" xref="S4.E21.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E21.m1.2.2.2.2.2.1.1.1.3" xref="S4.E21.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E21.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E21.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E21.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E21.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E21.m1.2.2.2.2.2.1.1.3" xref="S4.E21.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E21.m1.2.2.2.2.2.3" xref="S4.E21.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E21.m1.2.2.2.3" xref="S4.E21.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E21.m1.2.2.2.4" xref="S4.E21.m1.2.2.2.4.cmml"><mi id="S4.E21.m1.2.2.2.4.2" xref="S4.E21.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr>
</table>
<table id="S4.E22" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E22.m1.2" class="ltx_Math" alttext="{\bm{A}}_{QL}=({\bm{Q}}^{t}{\bm{W}}^{Q})({\bm{L}}{\bm{W}}^{K})^{T}/\sqrt{d}" display="block"><semantics id="S4.E22.m1.2a"><mrow id="S4.E22.m1.2.2" xref="S4.E22.m1.2.2.cmml"><msub id="S4.E22.m1.2.2.4" xref="S4.E22.m1.2.2.4.cmml"><mi id="S4.E22.m1.2.2.4.2" xref="S4.E22.m1.2.2.4.2.cmml">𝑨</mi><mrow id="S4.E22.m1.2.2.4.3" xref="S4.E22.m1.2.2.4.3.cmml"><mi id="S4.E22.m1.2.2.4.3.2" xref="S4.E22.m1.2.2.4.3.2.cmml">Q</mi><mo id="S4.E22.m1.2.2.4.3.1" xref="S4.E22.m1.2.2.4.3.1.cmml">⁢</mo><mi id="S4.E22.m1.2.2.4.3.3" xref="S4.E22.m1.2.2.4.3.3.cmml">L</mi></mrow></msub><mo id="S4.E22.m1.2.2.3" xref="S4.E22.m1.2.2.3.cmml">=</mo><mrow id="S4.E22.m1.2.2.2" xref="S4.E22.m1.2.2.2.cmml"><mrow id="S4.E22.m1.2.2.2.2" xref="S4.E22.m1.2.2.2.2.cmml"><mrow id="S4.E22.m1.1.1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E22.m1.1.1.1.1.1.1.2" xref="S4.E22.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E22.m1.1.1.1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.1.1.cmml"><msup id="S4.E22.m1.1.1.1.1.1.1.1.2" xref="S4.E22.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E22.m1.1.1.1.1.1.1.1.2.2" xref="S4.E22.m1.1.1.1.1.1.1.1.2.2.cmml">𝑸</mi><mi id="S4.E22.m1.1.1.1.1.1.1.1.2.3" xref="S4.E22.m1.1.1.1.1.1.1.1.2.3.cmml">t</mi></msup><mo id="S4.E22.m1.1.1.1.1.1.1.1.1" xref="S4.E22.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E22.m1.1.1.1.1.1.1.1.3" xref="S4.E22.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E22.m1.1.1.1.1.1.1.1.3.2" xref="S4.E22.m1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E22.m1.1.1.1.1.1.1.1.3.3" xref="S4.E22.m1.1.1.1.1.1.1.1.3.3.cmml">Q</mi></msup></mrow><mo stretchy="false" id="S4.E22.m1.1.1.1.1.1.1.3" xref="S4.E22.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E22.m1.2.2.2.2.3" xref="S4.E22.m1.2.2.2.2.3.cmml">⁢</mo><msup id="S4.E22.m1.2.2.2.2.2" xref="S4.E22.m1.2.2.2.2.2.cmml"><mrow id="S4.E22.m1.2.2.2.2.2.1.1" xref="S4.E22.m1.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E22.m1.2.2.2.2.2.1.1.2" xref="S4.E22.m1.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S4.E22.m1.2.2.2.2.2.1.1.1" xref="S4.E22.m1.2.2.2.2.2.1.1.1.cmml"><mi id="S4.E22.m1.2.2.2.2.2.1.1.1.2" xref="S4.E22.m1.2.2.2.2.2.1.1.1.2.cmml">𝑳</mi><mo id="S4.E22.m1.2.2.2.2.2.1.1.1.1" xref="S4.E22.m1.2.2.2.2.2.1.1.1.1.cmml">⁢</mo><msup id="S4.E22.m1.2.2.2.2.2.1.1.1.3" xref="S4.E22.m1.2.2.2.2.2.1.1.1.3.cmml"><mi id="S4.E22.m1.2.2.2.2.2.1.1.1.3.2" xref="S4.E22.m1.2.2.2.2.2.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E22.m1.2.2.2.2.2.1.1.1.3.3" xref="S4.E22.m1.2.2.2.2.2.1.1.1.3.3.cmml">K</mi></msup></mrow><mo stretchy="false" id="S4.E22.m1.2.2.2.2.2.1.1.3" xref="S4.E22.m1.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mi id="S4.E22.m1.2.2.2.2.2.3" xref="S4.E22.m1.2.2.2.2.2.3.cmml">T</mi></msup></mrow><mo id="S4.E22.m1.2.2.2.3" xref="S4.E22.m1.2.2.2.3.cmml">/</mo><msqrt id="S4.E22.m1.2.2.2.4" xref="S4.E22.m1.2.2.2.4.cmml"><mi id="S4.E22.m1.2.2.2.4.2" xref="S4.E22.m1.2.2.2.4.2.cmml">d</mi></msqrt></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr>
</table>
</div>
<div id="S4.SS4.SSS0.Px2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px2.p2.2" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w1">Similar</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w2">to</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w3">encoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w4">self-attention,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w5">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w6">node</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.1.w7">representations</span><span> </span><math id="S4.SS4.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="{\bm{N}}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p2.1.m1.1a"><mi id="S4.SS4.SSS0.Px2.p2.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p2.1.m1.1.1.cmml">𝑵</mi></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w2">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w3">encoded</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w4">with</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w5">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w6">tree</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w7">structure</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w8">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w9">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w10">attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.2.w11">output</span><span> </span><math id="S4.SS4.SSS0.Px2.p2.2.m2.1" class="ltx_Math" alttext="\text{Att}_{Q}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p2.2.m2.1a"><msub id="S4.SS4.SSS0.Px2.p2.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p2.2.m2.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p2.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p2.2.m2.1.1.2a.cmml">Att</mi><mi id="S4.SS4.SSS0.Px2.p2.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p2.2.m2.1.1.3.cmml">Q</mi></msub></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w2">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w3">decoder</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w4">cross-attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w5">is</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w6">computed</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p2.2.3.w7">as:</span></p>
</div>
<div id="S4.SS4.SSS0.Px2.p3" class="ltx_para ltx_noindent">
<table id="S4.E23" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E23.m1.3" class="ltx_Math" alttext="\overline{{\bm{N}}}^{\prime}=\mathcal{V}(\mathcal{U}(\mathcal{F}({\bm{L}}{\bm{%&#10;W}}^{V},{\bm{N}}{\bm{W}}^{V},\mathcal{R})+{\bm{\mathsfit{E}}}),{\bm{w}})\hskip&#10;3%&#10;.0pt;\hskip 3.0pt\overline{{\bm{L}}}={\bm{L}}{\bm{W}}^{V};\hskip 3.0pt" display="block"><semantics id="S4.E23.m1.3a"><mrow id="S4.E23.m1.3.3.1"><mrow id="S4.E23.m1.3.3.1.1.2" xref="S4.E23.m1.3.3.1.1.3.cmml"><mrow id="S4.E23.m1.3.3.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.cmml"><msup id="S4.E23.m1.3.3.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.3.cmml"><mover accent="true" id="S4.E23.m1.3.3.1.1.1.1.3.2" xref="S4.E23.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S4.E23.m1.3.3.1.1.1.1.3.2.2" xref="S4.E23.m1.3.3.1.1.1.1.3.2.2.cmml">𝑵</mi><mo id="S4.E23.m1.3.3.1.1.1.1.3.2.1" xref="S4.E23.m1.3.3.1.1.1.1.3.2.1.cmml">¯</mo></mover><mo id="S4.E23.m1.3.3.1.1.1.1.3.3" xref="S4.E23.m1.3.3.1.1.1.1.3.3.cmml">′</mo></msup><mo id="S4.E23.m1.3.3.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.3.3.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.3.cmml">𝒱</mi><mo id="S4.E23.m1.3.3.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">𝒰</mi><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.4" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.4.cmml">ℱ</mi><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">⁢</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">(</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝑳</mi><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><msup id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝑾</mi><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">V</mi></msup></mrow><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.4" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝑵</mi><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml">⁢</mo><msup id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">𝑾</mi><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">V</mi></msup></mrow><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.5" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S4.E23.m1.1.1" xref="S4.E23.m1.1.1.cmml">ℛ</mi><mo stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.2.6" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">+</mo><mi id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.4" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.4.cmml">𝑬</mi></mrow><mo stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E23.m1.3.3.1.1.1.1.1.1.1.3" xref="S4.E23.m1.3.3.1.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E23.m1.2.2" xref="S4.E23.m1.2.2.cmml">𝒘</mi><mo rspace="5.5pt" stretchy="false" id="S4.E23.m1.3.3.1.1.1.1.1.1.1.4" xref="S4.E23.m1.3.3.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="5.5pt" id="S4.E23.m1.3.3.1.1.2.3" xref="S4.E23.m1.3.3.1.1.3a.cmml">;</mo><mrow id="S4.E23.m1.3.3.1.1.2.2" xref="S4.E23.m1.3.3.1.1.2.2.cmml"><mover accent="true" id="S4.E23.m1.3.3.1.1.2.2.2" xref="S4.E23.m1.3.3.1.1.2.2.2.cmml"><mi id="S4.E23.m1.3.3.1.1.2.2.2.2" xref="S4.E23.m1.3.3.1.1.2.2.2.2.cmml">𝑳</mi><mo id="S4.E23.m1.3.3.1.1.2.2.2.1" xref="S4.E23.m1.3.3.1.1.2.2.2.1.cmml">¯</mo></mover><mo id="S4.E23.m1.3.3.1.1.2.2.1" xref="S4.E23.m1.3.3.1.1.2.2.1.cmml">=</mo><mrow id="S4.E23.m1.3.3.1.1.2.2.3" xref="S4.E23.m1.3.3.1.1.2.2.3.cmml"><mi id="S4.E23.m1.3.3.1.1.2.2.3.2" xref="S4.E23.m1.3.3.1.1.2.2.3.2.cmml">𝑳</mi><mo id="S4.E23.m1.3.3.1.1.2.2.3.1" xref="S4.E23.m1.3.3.1.1.2.2.3.1.cmml">⁢</mo><msup id="S4.E23.m1.3.3.1.1.2.2.3.3" xref="S4.E23.m1.3.3.1.1.2.2.3.3.cmml"><mi id="S4.E23.m1.3.3.1.1.2.2.3.3.2" xref="S4.E23.m1.3.3.1.1.2.2.3.3.2.cmml">𝑾</mi><mi id="S4.E23.m1.3.3.1.1.2.2.3.3.3" xref="S4.E23.m1.3.3.1.1.2.2.3.3.3.cmml">V</mi></msup></mrow></mrow></mrow><mo rspace="5.5pt" id="S4.E23.m1.3.3.1.2">;</mo></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr>
</table>
<table id="S4.E24" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E24.m1.3" class="ltx_Math" alttext="\text{Att}_{Q}=\mathrm{softmax}([{\bm{A}}_{QN};{\bm{A}}_{QL}])[\overline{{\bm{%&#10;N}}}^{\prime};\overline{{\bm{L}}}]" display="block"><semantics id="S4.E24.m1.3a"><mrow id="S4.E24.m1.3.3" xref="S4.E24.m1.3.3.cmml"><msub id="S4.E24.m1.3.3.4" xref="S4.E24.m1.3.3.4.cmml"><mi id="S4.E24.m1.3.3.4.2" xref="S4.E24.m1.3.3.4.2a.cmml">Att</mi><mi id="S4.E24.m1.3.3.4.3" xref="S4.E24.m1.3.3.4.3.cmml">Q</mi></msub><mo id="S4.E24.m1.3.3.3" xref="S4.E24.m1.3.3.3.cmml">=</mo><mrow id="S4.E24.m1.3.3.2" xref="S4.E24.m1.3.3.2.cmml"><mi id="S4.E24.m1.3.3.2.4" xref="S4.E24.m1.3.3.2.4.cmml">softmax</mi><mo id="S4.E24.m1.3.3.2.3" xref="S4.E24.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E24.m1.2.2.1.1.1" xref="S4.E24.m1.3.3.2.cmml"><mo stretchy="false" id="S4.E24.m1.2.2.1.1.1.2" xref="S4.E24.m1.3.3.2.cmml">(</mo><mrow id="S4.E24.m1.2.2.1.1.1.1.2" xref="S4.E24.m1.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.E24.m1.2.2.1.1.1.1.2.3" xref="S4.E24.m1.2.2.1.1.1.1.3.cmml">[</mo><msub id="S4.E24.m1.2.2.1.1.1.1.1.1" xref="S4.E24.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S4.E24.m1.2.2.1.1.1.1.1.1.2" xref="S4.E24.m1.2.2.1.1.1.1.1.1.2.cmml">𝑨</mi><mrow id="S4.E24.m1.2.2.1.1.1.1.1.1.3" xref="S4.E24.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="S4.E24.m1.2.2.1.1.1.1.1.1.3.2" xref="S4.E24.m1.2.2.1.1.1.1.1.1.3.2.cmml">Q</mi><mo id="S4.E24.m1.2.2.1.1.1.1.1.1.3.1" xref="S4.E24.m1.2.2.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E24.m1.2.2.1.1.1.1.1.1.3.3" xref="S4.E24.m1.2.2.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></msub><mo id="S4.E24.m1.2.2.1.1.1.1.2.4" xref="S4.E24.m1.2.2.1.1.1.1.3.cmml">;</mo><msub id="S4.E24.m1.2.2.1.1.1.1.2.2" xref="S4.E24.m1.2.2.1.1.1.1.2.2.cmml"><mi id="S4.E24.m1.2.2.1.1.1.1.2.2.2" xref="S4.E24.m1.2.2.1.1.1.1.2.2.2.cmml">𝑨</mi><mrow id="S4.E24.m1.2.2.1.1.1.1.2.2.3" xref="S4.E24.m1.2.2.1.1.1.1.2.2.3.cmml"><mi id="S4.E24.m1.2.2.1.1.1.1.2.2.3.2" xref="S4.E24.m1.2.2.1.1.1.1.2.2.3.2.cmml">Q</mi><mo id="S4.E24.m1.2.2.1.1.1.1.2.2.3.1" xref="S4.E24.m1.2.2.1.1.1.1.2.2.3.1.cmml">⁢</mo><mi id="S4.E24.m1.2.2.1.1.1.1.2.2.3.3" xref="S4.E24.m1.2.2.1.1.1.1.2.2.3.3.cmml">L</mi></mrow></msub><mo stretchy="false" id="S4.E24.m1.2.2.1.1.1.1.2.5" xref="S4.E24.m1.2.2.1.1.1.1.3.cmml">]</mo></mrow><mo stretchy="false" id="S4.E24.m1.2.2.1.1.1.3" xref="S4.E24.m1.3.3.2.cmml">)</mo></mrow><mo id="S4.E24.m1.3.3.2.3a" xref="S4.E24.m1.3.3.2.3.cmml">⁢</mo><mrow id="S4.E24.m1.3.3.2.2.1" xref="S4.E24.m1.3.3.2.2.2.cmml"><mo stretchy="false" id="S4.E24.m1.3.3.2.2.1.2" xref="S4.E24.m1.3.3.2.2.2.cmml">[</mo><msup id="S4.E24.m1.3.3.2.2.1.1" xref="S4.E24.m1.3.3.2.2.1.1.cmml"><mover accent="true" id="S4.E24.m1.3.3.2.2.1.1.2" xref="S4.E24.m1.3.3.2.2.1.1.2.cmml"><mi id="S4.E24.m1.3.3.2.2.1.1.2.2" xref="S4.E24.m1.3.3.2.2.1.1.2.2.cmml">𝑵</mi><mo id="S4.E24.m1.3.3.2.2.1.1.2.1" xref="S4.E24.m1.3.3.2.2.1.1.2.1.cmml">¯</mo></mover><mo id="S4.E24.m1.3.3.2.2.1.1.3" xref="S4.E24.m1.3.3.2.2.1.1.3.cmml">′</mo></msup><mo id="S4.E24.m1.3.3.2.2.1.3" xref="S4.E24.m1.3.3.2.2.2.cmml">;</mo><mover accent="true" id="S4.E24.m1.1.1" xref="S4.E24.m1.1.1.cmml"><mi id="S4.E24.m1.1.1.2" xref="S4.E24.m1.1.1.2.cmml">𝑳</mi><mo id="S4.E24.m1.1.1.1" xref="S4.E24.m1.1.1.1.cmml">¯</mo></mover><mo stretchy="false" id="S4.E24.m1.3.3.2.2.1.4" xref="S4.E24.m1.3.3.2.2.2.cmml">]</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr>
</table>
</div>
<div id="S4.SS4.SSS0.Px2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px2.p4.2" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.1.w1">where</span><span> </span><math id="S4.SS4.SSS0.Px2.p4.1.m1.1" class="ltx_Math" alttext="{\bm{w}}={\bm{L}}{\bm{u}}_{c}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p4.1.m1.1a"><mrow id="S4.SS4.SSS0.Px2.p4.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.2" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.2.cmml">𝒘</mi><mo id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.1" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.2" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.2.cmml">𝑳</mi><mo id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.1" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.1.cmml">⁢</mo><msub id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3.cmml"><mi id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3.2" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3.2.cmml">𝒖</mi><mi id="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3.3" xref="S4.SS4.SSS0.Px2.p4.1.m1.1.1.3.3.3.cmml">c</mi></msub></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.2.w2">with</span><span> </span><math id="S4.SS4.SSS0.Px2.p4.2.m2.1" class="ltx_Math" alttext="{\bm{u}}_{c}\in{\mathbb{R}}^{d}" display="inline"><semantics id="S4.SS4.SSS0.Px2.p4.2.m2.1a"><mrow id="S4.SS4.SSS0.Px2.p4.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.cmml"><msub id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2.cmml"><mi id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2.2" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2.2.cmml">𝒖</mi><mi id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2.3" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.1" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.1.cmml">∈</mo><msup id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3.cmml"><mi id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3.2" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3.2.cmml">ℝ</mi><mi id="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3.3" xref="S4.SS4.SSS0.Px2.p4.2.m2.1.1.3.3.cmml">d</mi></msup></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w1">.
Note</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w2">that</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w3">cross-attention</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w4">does</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w5">not</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w6">adopt</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w7">subtree</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w8">masking</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w9">because</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w10">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w11">queries</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w12">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w13">from</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w14">another</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w15">domain</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w16">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w17">are</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w18">not</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w19">elements</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w20">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w21">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w22">source</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p4.2.3.w23">tree.</span></p>
</div>
<div id="S4.SS4.SSS0.Px2.p5" class="ltx_para ltx_noindent">
<p id="S4.SS4.SSS0.Px2.p5.2" class="ltx_p"><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w1">Remark</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w2">on</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w3">Speed.</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w4">Our</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w5">model</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w6">runs</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w7">competitively</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w8">with</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w9">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w10">Transformer,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w11">thanks</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w12">to</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w13">its</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w14">constant</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w15">parallel</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w16">time</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w17">complexity.</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w18">In</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w19">terms</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w20">of</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w21">sequential</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w22">(single-CPU)</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w23">computations,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w24">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w25">hierarchical</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w26">accumulation</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w27">process</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.1.w28">takes</span><span> </span><math id="S4.SS4.SSS0.Px2.p5.1.m1.3" class="ltx_Math" alttext="\mathcal{O}(N\log(N))" display="inline"><semantics id="S4.SS4.SSS0.Px2.p5.1.m1.3a"><mrow id="S4.SS4.SSS0.Px2.p5.1.m1.3.3" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.3" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.3.cmml">𝒪</mi><mo id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.2.cmml">N</mi><mo id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S4.SS4.SSS0.Px2.p5.1.m1.1.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.1.1.cmml">log</mi><mo id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.2a" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.1.cmml">⁡</mo><mrow id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.2.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.2.1.1" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.1.cmml">(</mo><mi id="S4.SS4.SSS0.Px2.p5.1.m1.2.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.2.2.cmml">N</mi><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.2.1.2" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.3" xref="S4.SS4.SSS0.Px2.p5.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w2">time</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w3">and</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w4">our</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w5">entire</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w6">model</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w7">maintains</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w8">a</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w9">time</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w10">complexity</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w11">identical</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w12">to</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w13">the</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w14">Transformer,</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w15">which</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.2.w16">is</span><span> </span><math id="S4.SS4.SSS0.Px2.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{O}(N^{2})" display="inline"><semantics id="S4.SS4.SSS0.Px2.p5.2.m2.1a"><mrow id="S4.SS4.SSS0.Px2.p5.2.m2.1.1" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.3" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.3.cmml">𝒪</mi><mo id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.2" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.2" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.cmml"><mi id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.2" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.2.cmml">N</mi><mn id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.3" xref="S4.SS4.SSS0.Px2.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.3.w1">;</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.3.w2">see</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.3.w3">Appendix</span><span> </span><a href="#S7.SS2" title="7.2 Time complexity analysis ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.2</a><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.4.w1"/><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.4.w2">for</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.4.w3">a</span><span> </span><span class="gd_word" id="S4.SS4.SSS0.Px2.p5.2.4.w4">proof.
</span></p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para ltx_noindent">
<p id="S5.p1.1" class="ltx_p"><span class="gd_word" id="S5.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S5.p1.1.1.w2">conduct</span><span> </span><span class="gd_word" id="S5.p1.1.1.w3">our</span><span> </span><span class="gd_word" id="S5.p1.1.1.w4">experiments</span><span> </span><span class="gd_word" id="S5.p1.1.1.w5">on</span><span> </span><span class="gd_word" id="S5.p1.1.1.w6">two</span><span> </span><span class="gd_word" id="S5.p1.1.1.w7">types</span><span> </span><span class="gd_word" id="S5.p1.1.1.w8">of</span><span> </span><span class="gd_word" id="S5.p1.1.1.w9">tasks:</span><span> </span><span class="gd_word" id="S5.p1.1.1.w10">Machine</span><span> </span><span class="gd_word" id="S5.p1.1.1.w11">Translation</span><span> </span><span class="gd_word" id="S5.p1.1.1.w12">and</span><span> </span><span class="gd_word" id="S5.p1.1.1.w13">Text</span><span> </span><span class="gd_word" id="S5.p1.1.1.w14">Classification.</span><span> </span></p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Neural Machine Translation</h3>

<section id="S5.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setup.</h4>

<div id="S5.SS1.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px1.p1.3" class="ltx_p"><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w1">We</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w2">experiment</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w3">with</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w4">five</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w5">translation</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w6">tasks:</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w7">IWSLT’14</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w8">English-German</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w9">(En-De),</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w10">German-English</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w11">(De-En),</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w12">IWSLT’13</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w13">English-French</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w14">(En-Fr),</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w15">French-English</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w16">(Fr-En),</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w17">and</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w18">WMT’14</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w19">English-German.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w20">We</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w21">replicate</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w22">most</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w23">of</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w24">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w25">training</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w26">settings</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.1.w27">from</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Ott et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w1"/><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w2">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w3">our</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w4">models,</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w5">to</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w6">enable</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w7">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w8">fair</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w9">comparison</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w10">with</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w11">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w12">Transformer-based</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.2.w13">methods</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Wu et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w2">For</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w3">IWSLT</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w4">experiments,</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w5">we</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w6">trained</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w7">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w8">base</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w9">models</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.3.w10">with</span><span> </span><math id="S5.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="d=512" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">d</mi><mo id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">512</mn></mrow></semantics></math><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w1"/><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w2">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w3">60K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w4">updates</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w5">with</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w6">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w7">batch</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w8">size</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w9">of</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w10">4K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w11">tokens.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w12">For</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w13">WMT,</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w14">we</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w15">used</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w16">200K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w17">updates</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w18">and</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w19">32K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w20">tokens</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w21">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w22">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w23">base</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w24">models</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.4.w25">(</span><math id="S5.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="d=512" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="S5.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">d</mi><mo id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S5.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">512</mn></mrow></semantics></math><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w1">),</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w2">and</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w3">20K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w4">updates</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w5">and</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w6">512K</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w7">tokens</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w8">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w9">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w10">big</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w11">models</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.5.w12">with</span><span> </span><math id="S5.SS1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="d=1024" display="inline"><semantics id="S5.SS1.SSS0.Px1.p1.3.m3.1a"><mrow id="S5.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">d</mi><mo id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S5.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">1024</mn></mrow></semantics></math><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w2">We</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w3">parsed</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w4">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w5">texts</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w6">with</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w7">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w8">Stanford</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w9">CoreNLP</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.6.w10">parser</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Manning et al., <a href="#bib.bib13" title="" class="ltx_ref">2014</a>)</cite><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w2">We</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w3">used</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w4">Byte</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w5">Pair</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.7.w6">Encoding</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Sennrich et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w1">,</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w2">where</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w3">subwords</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w4">of</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w5">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w6">word</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w7">form</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w8">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w9">subtree.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w10">More</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w11">details</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w12">are</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w13">provided</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w14">in</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.8.w15">Appendix</span><span> </span><a href="#S7.SS4" title="7.4 More detailed training configurations ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.4</a><span class="gd_word" id="S5.SS1.SSS0.Px1.p1.3.9.w1">.</span></p>
</div>
</section>
<section id="S5.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S5.SS1.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS1.SSS0.Px2.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.1.w1">Table</span><span> </span><a href="#S5.T1" title="Table 1 ‣ Results. ‣ 5.1 Neural Machine Translation ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w2">shows</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w3">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w4">BLEU</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w5">scores</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w6">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w7">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w8">translation</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w9">tasks.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w10">Our</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w11">models</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w12">outperform</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w13">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w14">baselines</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w15">consistently</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w16">in</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w17">all</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w18">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w19">tested</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w20">tasks.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w21">The</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w22">results</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w23">demonstrate</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w24">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w25">impact</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w26">of</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w27">using</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w28">parse</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w29">trees</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w30">as</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w31">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w32">prior</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w33">and</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w34">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w35">effectiveness</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w36">of</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w37">our</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w38">methods</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w39">in</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w40">incorporating</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w41">such</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w42">a</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w43">structural</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w44">prior.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w45">Specifically,</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w46">our</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w47">model</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w48">surpasses</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w49">the</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w50">Transformer</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w51">by</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w52">more</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w53">than</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w54">1</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w55">BLEU</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w56">for</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w57">all</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w58">IWSLT</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w59">tasks.</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w60">Our</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w61">big</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w62">model</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w63">also</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w64">outdoes</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w65">dynamic</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.2.w66">convolution</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Wu et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.3.w1"/><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.3.w2">by</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.3.w3">0.25</span><span> </span><span class="gd_word" id="S5.SS1.SSS0.Px2.p1.1.3.w4">BLEU.</span></p>
</div>
<figure id="S5.T1" class="ltx_table">
<img src="/static/img/2002.08046-gpt-3.5-turbo/S5_T1.png" alt="/static/img/2002.08046-gpt-3.5-turbo/S5_T1.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="gd_word" id="S5.T1.2.w1">BLEU</span><span> </span><span class="gd_word" id="S5.T1.2.w2">scores</span><span> </span><span class="gd_word" id="S5.T1.2.w3">for</span><span> </span><span class="gd_word" id="S5.T1.2.w4">the</span><span> </span><span class="gd_word" id="S5.T1.2.w5">base</span><span> </span><span class="gd_word" id="S5.T1.2.w6">models</span><span> </span><span class="gd_word" id="S5.T1.2.w7">on</span><span> </span><span class="gd_word" id="S5.T1.2.w8">IWSLT’14</span><span> </span><span class="gd_word" id="S5.T1.2.w9">English</span><math id="S5.T1.4.m1.1" class="ltx_Math" alttext="\leftrightarrow" display="inline"><semantics id="S5.T1.4.m1.1b"><mo id="S5.T1.4.m1.1.1" xref="S5.T1.4.m1.1.1.cmml">↔</mo></semantics></math><span class="gd_word" id="S5.T1.3.w1">German,</span><span> </span><span class="gd_word" id="S5.T1.3.w2">IWSLT’13</span><span> </span><span class="gd_word" id="S5.T1.3.w3">English</span><math id="S5.T1.5.m2.1" class="ltx_Math" alttext="\leftrightarrow" display="inline"><semantics id="S5.T1.5.m2.1b"><mo id="S5.T1.5.m2.1.1" xref="S5.T1.5.m2.1.1.cmml">↔</mo></semantics></math><span class="gd_word" id="S5.T1.4.w1">French,</span><span> </span><span class="gd_word" id="S5.T1.4.w2">and</span><span> </span><span class="gd_word" id="S5.T1.4.w3">the</span><span> </span><span class="gd_word" id="S5.T1.4.w4">base</span><span> </span><span class="gd_word" id="S5.T1.4.w5">and</span><span> </span><span class="gd_word" id="S5.T1.4.w6">big</span><span> </span><span class="gd_word" id="S5.T1.4.w7">models</span><span> </span><span class="gd_word" id="S5.T1.4.w8">on</span><span> </span><span class="gd_word" id="S5.T1.4.w9">WMT’14</span><span> </span><span class="gd_word" id="S5.T1.4.w10">English</span><math id="S5.T1.6.m3.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="S5.T1.6.m3.1b"><mo id="S5.T1.6.m3.1.1" xref="S5.T1.6.m3.1.1.cmml">→</mo></semantics></math><span class="gd_word" id="S5.T1.5.w1">German</span><span> </span><span class="gd_word" id="S5.T1.5.w2">task.</span><span> </span><span class="gd_word" id="S5.T1.5.w3">Refer</span><span> </span><span class="gd_word" id="S5.T1.5.w4">to</span><span> </span><span class="gd_word" id="S5.T1.5.w5">Table</span><span> </span><a href="#S7.T5" title="Table 5 ‣ 7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">5</a><span class="gd_word" id="S5.T1.6.w1"/><span> </span><span class="gd_word" id="S5.T1.6.w2">in</span><span> </span><span class="gd_word" id="S5.T1.6.w3">the</span><span> </span><span class="gd_word" id="S5.T1.6.w4">Appendix</span><span> </span><span class="gd_word" id="S5.T1.6.w5">for</span><span> </span><span class="gd_word" id="S5.T1.6.w6">parameter</span><span> </span><span class="gd_word" id="S5.T1.6.w7">comparisons.</span></figcaption>
</figure>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Text Classification</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Setup.</h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w2">also</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w3">compare</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w4">our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w5">attention-based</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w6">tree</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w7">encoding</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w8">method</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w9">with</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.1.w10">Tree-LSTM</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Tai et al., <a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w2">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w3">other</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w4">sequence-based</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w5">baselines</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w6">on</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w7">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w8">Stanford</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w9">Sentiment</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w10">Analysis</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.2.w11">(SST)</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Socher et al., <a href="#bib.bib21" title="" class="ltx_ref">2013</a>)</cite><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w1">,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w2">IMDB</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w3">Sentiment</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w4">Analysis</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w5">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w6">Subject-Verb</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w7">Agreement</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.3.w8">(SVA)</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Linzen et al., <a href="#bib.bib12" title="" class="ltx_ref">2016</a>)</cite><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w1"/><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w2">tasks.
We</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w3">adopt</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w4">a</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w5">tiny-sized</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w6">version</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w7">of</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w8">our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w9">tree-based</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w10">models</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w11">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w12">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w13">Transformer</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w14">baseline.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w15">The</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w16">models</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w17">have</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w18">2</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w19">Transformer</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w20">layers,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w21">4</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w22">heads</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w23">in</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w24">each</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w25">layer,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w26">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.4.w27">dimensions</span><span> </span><math id="S5.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="d=64" display="inline"><semantics id="S5.SS2.SSS0.Px1.p1.1.m1.1a"><mrow id="S5.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">d</mi><mo id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.1" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">64</mn></mrow></semantics></math><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w1">.
We</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w2">trained</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w4">models</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w5">for</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w6">15K</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w7">updates,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w8">with</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w9">a</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w10">batch</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w11">size</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w12">of</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w13">2K</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w14">tokens.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w15">Word</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w16">embeddings</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w17">are</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w18">randomly</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w19">initialized.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w20">We</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w21">provide</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w22">further</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w23">details</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w24">of</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w25">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w26">setup</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w27">in</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.5.w28">Appendix</span><span> </span><a href="#S7.SS4" title="7.4 More detailed training configurations ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7.4</a><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w1">.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w2">For</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w4">Stanford</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w5">Sentiment</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w6">Analysis</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w7">task</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w8">(SST),</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w9">we</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w10">tested</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w11">on</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w12">binary</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w13">(SST-2)</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w14">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w15">fine-grained</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w16">(SST-5)</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w17">subtasks,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.6.w18">following</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Tai et al. (<a href="#bib.bib23" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="S5.SS2.SSS0.Px1.p1.1.7.w1">.
</span></p>
</div>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Results.</h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.SSS0.Px2.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.1.w1">Table</span><span> </span><a href="#S5.T2" title="Table 2 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">2</a><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w2">shows</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w4">results</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w5">in</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w6">accuracy</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w7">on</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w8">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w9">classification</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w10">tasks.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w11">Our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w12">Tree</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w13">Transformer</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w14">outperforms</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w15">sequence-based</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w16">Transformer</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w17">and</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w18">BiLSTM</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w19">baselines</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w20">in</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w21">all</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w22">tasks</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w23">by</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w24">a</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w25">wide</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w26">margin.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w27">This</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w28">suggests</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w29">that</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w30">for</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w31">small</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w32">datasets,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w33">our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w34">models</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w35">with</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w36">a</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w37">more</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w38">appropriate</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w39">structural</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w40">bias</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w41">can</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w42">provide</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w43">outstanding</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w44">improvements</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w45">compared</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w46">to</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w47">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w48">vanilla</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w49">Transformer.</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w50">Furthermore,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w51">our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w52">models</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w53">also</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w54">surpass</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w55">Tree-LSTM</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w56">significantly</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w57">in</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w58">all</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w59">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w60">tested</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w61">tasks,</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w62">which</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w63">also</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w64">demonstrates</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w65">our</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w66">method’s</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w67">effectiveness</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w68">compared</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w69">to</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w70">the</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w71">best</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w72">existing</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w73">tree-encoding</span><span> </span><span class="gd_word" id="S5.SS2.SSS0.Px2.p1.1.2.w74">method.</span></p>
</div>
<div id="S5.SS2.SSS0.Px2.p2" class="ltx_para ltx_minipage ltx_align_middle" style="width:397.5pt;">
<span id="S5.SS2.SSS0.Px2.p2.1" class="ltx_inline-para ltx_minipage ltx_align_bottom" style="width:194.8pt;">
<span id="S5.SS2.SSS0.Px2.p2.1.p1" class="ltx_para ltx_align_center">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1" class="ltx_inline-block" style="width:433.6pt;vertical-align:-0.0pt;">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.1.1" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt ltx_rowspan" style="padding-left:2.0pt;padding-right:2.0pt;" rowspan="2">Task</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_rowspan" style="padding-left:2.0pt;padding-right:2.0pt;" rowspan="2">Transformer</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt ltx_rowspan" style="padding-left:2.0pt;padding-right:2.0pt;" rowspan="2">BiLSTM</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;" colspan="2">Tree-Based Models</span></span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.2.2" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Tree-LSTM</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">Ours</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">SST-5</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">37.6</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">35.1</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">43.9</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.3.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">47.4</span></span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.0pt;padding-right:2.0pt;">SST-2</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">74.8</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">76.0</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">82.0</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.4.2.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">84.3</span></span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">IMDB</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">86.5</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">85.8</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">–</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.5.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">90.1</span></span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">SVA</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">94.4</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">95.1</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">96.2</span>
<span id="S5.SS2.SSS0.Px2.p2.1.p1.1.1.6.4.5" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">98.0</span></span>
</span>
</span>
</span>
</span>
<span id="S5.T2" class="ltx_table ltx_align_center">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Classification results in accuracy (%) on Stanford Sentiment Analysis fine-grained (SST-5) and binary (SST-2), IMDB sentiment analysis, and Subject-Verb Agreement (SVA) tasks.</span>
</span></span><span id="S5.SS2.SSS0.Px2.p2.2" class="ltx_inline-para ltx_minipage ltx_align_bottom" style="width:194.8pt;">
<span id="S5.SS2.SSS0.Px2.p2.2.p1" class="ltx_para ltx_align_center">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<span class="ltx_thead">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.1.1" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Model</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">En-De</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">En-Fr</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">SST-5</span></span>
</span>
<span class="ltx_tbody">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.2.1" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">TreeTransformer</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">29.47</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">45.53</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">47.4</span></span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.3.2" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.0pt;padding-right:2.0pt;">–HierEmb</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.3.2.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">29.20</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.3.2.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">44.80</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.3.2.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">46.1</span></span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.4.3" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-left:2.0pt;padding-right:2.0pt;">–SubMask</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.4.3.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">29.05</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.4.3.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">45.07</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.4.3.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">45.7</span></span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.5.4" class="ltx_tr">
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">–HierEmb –SubMask</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.5.4.2" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">28.98</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">44.50</span>
<span id="S5.SS2.SSS0.Px2.p2.2.p1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_bb" style="padding-left:2.0pt;padding-right:2.0pt;">45.0</span></span>
</span>
</span>
</span>
<span id="S5.T3" class="ltx_table ltx_align_center">
<span class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performances of different model variants on IWSLT’14 En-De, IWSLT’13 En-Fr and Stanford Sentiment Analysis (fine-grained) tasks. ‘–HierEmb’: no hierarchical embeddings, ‘–SubMask’: no subtree masking.</span>
</span></span>
</div>
<figure id="S5.F5" class="ltx_figure">
<img src="/static/img/2002.08046/S5_F5.png" alt="/static/img/2002.08046/S5_F5.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span><span class="gd_word" id="S5.F5.2.w1">Training</span><span> </span><span class="gd_word" id="S5.F5.2.w2">data</span><span> </span><span class="gd_word" id="S5.F5.2.w3">size</span><span> </span><span class="gd_word" id="S5.F5.2.w4">and</span><span> </span><span class="gd_word" id="S5.F5.2.w5">training/inference</span><span> </span><span class="gd_word" id="S5.F5.2.w6">time</span><span> </span><span class="gd_word" id="S5.F5.2.w7">analysis.</span></figcaption>
</figure>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Analysis</h3>

<figure id="S5.T4" class="ltx_table">
<img src="/static/img/2002.08046-gpt-3.5-turbo/S5_T4.png" alt="/static/img/2002.08046-gpt-3.5-turbo/S5_T4.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="gd_word" id="S5.T4.2.w1">Attention</span><span> </span><span class="gd_word" id="S5.T4.2.w2">distributions</span><span> </span><span class="gd_word" id="S5.T4.2.w3">(%)</span><span> </span><span class="gd_word" id="S5.T4.2.w4">between</span><span> </span><span class="gd_word" id="S5.T4.2.w5">phrases</span><span> </span><span class="gd_word" id="S5.T4.2.w6">(nodes)</span><span> </span><span class="gd_word" id="S5.T4.2.w7">and</span><span> </span><span class="gd_word" id="S5.T4.2.w8">tokens</span><span> </span><span class="gd_word" id="S5.T4.2.w9">(leaves)</span><span> </span><span class="gd_word" id="S5.T4.2.w10">across</span><span> </span><span class="gd_word" id="S5.T4.2.w11">different</span><span> </span><span class="gd_word" id="S5.T4.2.w12">translation</span><span> </span><span class="gd_word" id="S5.T4.2.w13">tasks.</span><span> </span><span class="gd_word" id="S5.T4.2.w14">Statistics</span><span> </span><span class="gd_word" id="S5.T4.2.w15">are</span><span> </span><span class="gd_word" id="S5.T4.2.w16">derived</span><span> </span><span class="gd_word" id="S5.T4.2.w17">from</span><span> </span><span class="gd_word" id="S5.T4.2.w18">IWSLT’14</span><span> </span><span class="gd_word" id="S5.T4.2.w19">En-De</span><span> </span><span class="gd_word" id="S5.T4.2.w20">and</span><span> </span><span class="gd_word" id="S5.T4.2.w21">IWSLT’13</span><span> </span><span class="gd_word" id="S5.T4.2.w22">En-Fr</span><span> </span><span class="gd_word" id="S5.T4.2.w23">test</span><span> </span><span class="gd_word" id="S5.T4.2.w24">sets.</span></figcaption>
</figure>
<section id="S5.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Model Variations.</h4>

<div id="S5.SS3.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.SSS0.Px1.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.1.w2">Table</span><span> </span><a href="#S5.T3" title="Table 3 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">3</a><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w1">,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w2">we</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w3">examine</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w4">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w5">contributions</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w6">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w7">each</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w8">component</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w9">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w10">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w11">Tree</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w12">Transformer</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w13">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w14">IWSLT’14</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w15">English-German</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w16">translation</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w17">task</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w18">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w19">Stanford</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w20">Sentiment</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w21">Analysis</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w22">(fine-grained)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w23">task.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w24">We</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w25">see</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w26">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w27">removing</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w28">either</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w29">or</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w30">both</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w31">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w32">hierarchical</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w33">embeddings</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w34">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w35">subtree</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w36">masking</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w37">methods</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w38">has</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w39">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w40">negative</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w41">impact</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w42">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w43">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w44">model</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px1.p1.1.2.w45">performance.</span></p>
</div>
</section>
<section id="S5.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Effectiveness on Small Datasets.</h4>

<div id="S5.SS3.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.SSS0.Px2.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.1.w1">Figure</span><span> </span><a href="#S5.F4.sf1" title="(a) ‣ Figure 5 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4(a)</a><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w2">shows</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w3">how</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w4">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w5">model</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w6">performs</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w7">compared</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w8">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w9">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w10">baselines</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w11">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w12">WMT’14</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w13">English-German</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w14">translation</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w15">task</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w16">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w17">varying</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w18">amounts</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w19">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w20">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w21">data.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w22">It</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w23">is</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w24">apparent</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w25">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w26">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w27">model</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w28">yields</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w29">substantial</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w30">improvements</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w31">(3.3</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w32">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w33">1.6</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w34">BLEU)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w35">when</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w36">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w37">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w38">data</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w39">is</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w40">less</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w41">than</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w42">1</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w43">million</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w44">pairs</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.2.w45">(</span><math id="S5.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="&lt;20" display="inline"><semantics id="S5.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S5.SS3.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS3.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml"/><mo id="S5.SS3.SSS0.Px2.p1.1.m1.1.1.1" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S5.SS3.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS3.SSS0.Px2.p1.1.m1.1.1.3.cmml">20</mn></mrow></semantics></math><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w1">%</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w2">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w3">WMT’14).</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w4">The</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w5">margin</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w6">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w7">gains</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w8">gradually</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w9">decreases</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w10">(1.0</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w11">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w12">1.1</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w13">BLEU)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w14">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w15">increasing</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w16">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w17">data.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w18">We</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w19">observe</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w20">similar</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w21">trend</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w22">in</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w23">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w24">classification</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w25">tasks</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.3.w26">(Table</span><span> </span><a href="#S5.T2" title="Table 2 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">2</a><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w1">),</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w2">where</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w3">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w4">model</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w5">outperforms</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w6">sequence-based</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w7">methods</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w8">by</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w9">around</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w10">10%</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w11">absolute</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w12">in</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w13">accuracy.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w14">This</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w15">suggests</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w16">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w17">utilizing</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w18">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w19">hierarchical</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w20">architectural</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w21">bias</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w22">can</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w23">compensate</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w24">for</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w25">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w26">shortage</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w27">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w28">labeled</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w29">data</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w30">in</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w31">low-resource</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px2.p1.1.4.w32">scenarios.</span><span> </span></p>
</div>
</section>
<section id="S5.SS3.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training Time Analysis.</h4>

<div id="S5.SS3.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.SSS0.Px3.p1.3" class="ltx_p"><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.1.w1">Figure</span><span> </span><a href="#S5.F4.sf2" title="(b) ‣ Figure 5 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4(b)</a><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w1"/><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w2">shows</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w3">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w4">empirical</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w5">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w6">time</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w7">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w8">inference</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w9">time</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w10">for</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w11">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w12">Transformer,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w13">Tree-LSTM,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w14">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w15">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w16">Tree</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w17">Transformer</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w18">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w19">respect</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w20">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w21">input</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w22">sequence</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w23">length.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w24">All</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w25">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w26">models</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w27">are</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w28">trained</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w29">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w30">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w31">sentiment</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w32">classification</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w33">task</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w34">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w35">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w36">single</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w37">GPU</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.2.w38">for</span><span> </span><math id="S5.SS3.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S5.SS3.SSS0.Px3.p1.1.m1.1a"><mn id="S5.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S5.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">1000</mn></semantics></math><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w1"/><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w2">iterations</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w3">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w4">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w5">batch-size</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.3.w6">of</span><span> </span><math id="S5.SS3.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S5.SS3.SSS0.Px3.p1.2.m2.1a"><mn id="S5.SS3.SSS0.Px3.p1.2.m2.1.1" xref="S5.SS3.SSS0.Px3.p1.2.m2.1.1.cmml">1</mn></semantics></math><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w1">.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w2">We</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w3">can</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w4">see</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w5">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w6">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w7">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w8">time</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w9">for</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w10">Tree-LSTM</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w11">grows</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w12">linearly</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w13">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w14">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w15">sequence</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w16">length.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w17">The</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w18">training</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w19">time</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w20">for</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w21">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w22">vanilla</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w23">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w24">Tree</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w25">Transformer</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w26">are</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w27">much</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w28">less</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w29">than</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w30">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w31">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w32">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w33">Tree-LSTM</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w34">and</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w35">remain</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w36">relatively</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w37">at</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w38">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w39">plateau</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w40">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w41">respect</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w42">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w43">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w44">sequence</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w45">length.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w46">This</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w47">demonstrates</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w48">our</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w49">model’s</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w50">speed</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w51">efficiency</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w52">compared</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w53">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w54">Tree-LSTM</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w55">or</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w56">other</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w57">recurrent/recursive</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w58">methods.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w59">For</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w60">inference,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w61">we</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w62">take</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w63">into</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w64">account</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w65">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w66">parsing</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w67">time</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w68">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w69">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w70">Stanford</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w71">parser</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.4.w72">(</span><math id="S5.SS3.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{O}(N)" display="inline"><semantics id="S5.SS3.SSS0.Px3.p1.3.m3.1a"><mrow id="S5.SS3.SSS0.Px3.p1.3.m3.1.2" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS3.SSS0.Px3.p1.3.m3.1.2.2" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.2.cmml">𝒪</mi><mo id="S5.SS3.SSS0.Px3.p1.3.m3.1.2.1" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S5.SS3.SSS0.Px3.p1.3.m3.1.2.3.2" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S5.SS3.SSS0.Px3.p1.3.m3.1.2.3.2.1" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.cmml">(</mo><mi id="S5.SS3.SSS0.Px3.p1.3.m3.1.1" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.1.cmml">N</mi><mo stretchy="false" id="S5.SS3.SSS0.Px3.p1.3.m3.1.2.3.2.2" xref="S5.SS3.SSS0.Px3.p1.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w1">),</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w2">which</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w3">substantially</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w4">overwhelms</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w5">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w6">overall</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px3.p1.3.5.w7">timing.</span></p>
</div>
</section>
<section id="S5.SS3.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Phrase- vs. Token-level Attentions.</h4>

<div id="S5.SS3.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS3.SSS0.Px4.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.1.w1">Table</span><span> </span><a href="#S5.T4" title="Table 4 ‣ 5.3 Analysis ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4</a><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w2">shows</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w3">how</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w4">frequently</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w5">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w6">target</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w7">language</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w8">token</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w9">attends</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w10">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w11">phrases</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w12">(nodes)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w13">vs.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w14">tokens</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w15">(leaves)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w16">in</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w17">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w18">source</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w19">tree.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w20">We</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w21">see</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w22">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w23">although</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w24">60-66%</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w25">of</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w26">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w27">source</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w28">tree</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w29">constituents</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w30">are</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w31">leaves,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w32">attentions</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w33">over</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w34">nodes</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w35">overwhelm</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w36">those</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w37">over</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w38">leaves</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w39">(around</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w40">59%</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w41">to</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w42">66%)</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w43">consistently</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w44">across</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w45">all</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w46">translation</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w47">tasks,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w48">meaning</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w49">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w50">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w51">model</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w52">slightly</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w53">favors</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w54">phrasal</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w55">attentions.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w56">The</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w57">results</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w58">also</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w59">suggest</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w60">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w61">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w62">attention</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w63">concentrations</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w64">are</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w65">not</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w66">correlated</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w67">with</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w68">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w69">leaf/node</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w70">ratio;</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w71">rather,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w72">they</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w73">depend</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w74">on</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w75">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w76">language</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w77">pairs.</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w78">Leaf/node</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w79">ratios</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w80">might</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w81">be</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w82">a</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w83">trivial</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w84">explanation</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w85">for</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w86">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w87">phenomenon,</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w88">but</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w89">the</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w90">results</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w91">indicate</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w92">that</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w93">certain</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w94">language-dependent</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w95">factors</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w96">may</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w97">be</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w98">at</span><span> </span><span class="gd_word" id="S5.SS3.SSS0.Px4.p1.1.2.w99">play.</span></p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p"><span class="gd_word" id="S6.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.p1.1.1.w2">presented</span><span> </span><span class="gd_word" id="S6.p1.1.1.w3">a</span><span> </span><span class="gd_word" id="S6.p1.1.1.w4">novel</span><span> </span><span class="gd_word" id="S6.p1.1.1.w5">approach</span><span> </span><span class="gd_word" id="S6.p1.1.1.w6">to</span><span> </span><span class="gd_word" id="S6.p1.1.1.w7">incorporate</span><span> </span><span class="gd_word" id="S6.p1.1.1.w8">constituency</span><span> </span><span class="gd_word" id="S6.p1.1.1.w9">parse</span><span> </span><span class="gd_word" id="S6.p1.1.1.w10">trees</span><span> </span><span class="gd_word" id="S6.p1.1.1.w11">as</span><span> </span><span class="gd_word" id="S6.p1.1.1.w12">an</span><span> </span><span class="gd_word" id="S6.p1.1.1.w13">architectural</span><span> </span><span class="gd_word" id="S6.p1.1.1.w14">bias</span><span> </span><span class="gd_word" id="S6.p1.1.1.w15">to</span><span> </span><span class="gd_word" id="S6.p1.1.1.w16">the</span><span> </span><span class="gd_word" id="S6.p1.1.1.w17">attention</span><span> </span><span class="gd_word" id="S6.p1.1.1.w18">mechanism</span><span> </span><span class="gd_word" id="S6.p1.1.1.w19">of</span><span> </span><span class="gd_word" id="S6.p1.1.1.w20">the</span><span> </span><span class="gd_word" id="S6.p1.1.1.w21">Transformer</span><span> </span><span class="gd_word" id="S6.p1.1.1.w22">network.</span><span> </span><span class="gd_word" id="S6.p1.1.1.w23">Our</span><span> </span><span class="gd_word" id="S6.p1.1.1.w24">method</span><span> </span><span class="gd_word" id="S6.p1.1.1.w25">encodes</span><span> </span><span class="gd_word" id="S6.p1.1.1.w26">trees</span><span> </span><span class="gd_word" id="S6.p1.1.1.w27">in</span><span> </span><span class="gd_word" id="S6.p1.1.1.w28">a</span><span> </span><span class="gd_word" id="S6.p1.1.1.w29">bottom-up</span><span> </span><span class="gd_word" id="S6.p1.1.1.w30">manner</span><span> </span><span class="gd_word" id="S6.p1.1.1.w31">with</span><span> </span><span class="gd_word" id="S6.p1.1.1.w32">constant</span><span> </span><span class="gd_word" id="S6.p1.1.1.w33">parallel</span><span> </span><span class="gd_word" id="S6.p1.1.1.w34">time</span><span> </span><span class="gd_word" id="S6.p1.1.1.w35">complexity.</span><span> </span><span class="gd_word" id="S6.p1.1.1.w36">We</span><span> </span><span class="gd_word" id="S6.p1.1.1.w37">have</span><span> </span><span class="gd_word" id="S6.p1.1.1.w38">shown</span><span> </span><span class="gd_word" id="S6.p1.1.1.w39">the</span><span> </span><span class="gd_word" id="S6.p1.1.1.w40">effectiveness</span><span> </span><span class="gd_word" id="S6.p1.1.1.w41">of</span><span> </span><span class="gd_word" id="S6.p1.1.1.w42">our</span><span> </span><span class="gd_word" id="S6.p1.1.1.w43">approach</span><span> </span><span class="gd_word" id="S6.p1.1.1.w44">on</span><span> </span><span class="gd_word" id="S6.p1.1.1.w45">various</span><span> </span><span class="gd_word" id="S6.p1.1.1.w46">NLP</span><span> </span><span class="gd_word" id="S6.p1.1.1.w47">tasks</span><span> </span><span class="gd_word" id="S6.p1.1.1.w48">involving</span><span> </span><span class="gd_word" id="S6.p1.1.1.w49">machine</span><span> </span><span class="gd_word" id="S6.p1.1.1.w50">translation</span><span> </span><span class="gd_word" id="S6.p1.1.1.w51">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w52">text</span><span> </span><span class="gd_word" id="S6.p1.1.1.w53">classification.</span><span> </span><span class="gd_word" id="S6.p1.1.1.w54">On</span><span> </span><span class="gd_word" id="S6.p1.1.1.w55">machine</span><span> </span><span class="gd_word" id="S6.p1.1.1.w56">translation,</span><span> </span><span class="gd_word" id="S6.p1.1.1.w57">our</span><span> </span><span class="gd_word" id="S6.p1.1.1.w58">model</span><span> </span><span class="gd_word" id="S6.p1.1.1.w59">yields</span><span> </span><span class="gd_word" id="S6.p1.1.1.w60">significant</span><span> </span><span class="gd_word" id="S6.p1.1.1.w61">improvements</span><span> </span><span class="gd_word" id="S6.p1.1.1.w62">on</span><span> </span><span class="gd_word" id="S6.p1.1.1.w63">IWSLT</span><span> </span><span class="gd_word" id="S6.p1.1.1.w64">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w65">WMT</span><span> </span><span class="gd_word" id="S6.p1.1.1.w66">translation</span><span> </span><span class="gd_word" id="S6.p1.1.1.w67">tasks.</span><span> </span><span class="gd_word" id="S6.p1.1.1.w68">On</span><span> </span><span class="gd_word" id="S6.p1.1.1.w69">text</span><span> </span><span class="gd_word" id="S6.p1.1.1.w70">classification,</span><span> </span><span class="gd_word" id="S6.p1.1.1.w71">it</span><span> </span><span class="gd_word" id="S6.p1.1.1.w72">also</span><span> </span><span class="gd_word" id="S6.p1.1.1.w73">shows</span><span> </span><span class="gd_word" id="S6.p1.1.1.w74">improvements</span><span> </span><span class="gd_word" id="S6.p1.1.1.w75">on</span><span> </span><span class="gd_word" id="S6.p1.1.1.w76">Stanford</span><span> </span><span class="gd_word" id="S6.p1.1.1.w77">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w78">IMDB</span><span> </span><span class="gd_word" id="S6.p1.1.1.w79">sentiment</span><span> </span><span class="gd_word" id="S6.p1.1.1.w80">analysis</span><span> </span><span class="gd_word" id="S6.p1.1.1.w81">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w82">subject-verb</span><span> </span><span class="gd_word" id="S6.p1.1.1.w83">agreement</span><span> </span><span class="gd_word" id="S6.p1.1.1.w84">tasks.</span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Alvarez-Melis &amp; Jaakkola (2017)</span>
<span class="ltx_bibblock">
David Alvarez-Melis and Tommi S Jaakkola.

</span>
<span class="ltx_bibblock">Tree-structured decoding with doubly-recurrent neural networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning
Representations (ICLR)</em>, 2017.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2018)</span>
<span class="ltx_bibblock">
Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova.

</span>
<span class="ltx_bibblock">Bert: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1810.04805</em>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eriguchi et al. (2016)</span>
<span class="ltx_bibblock">
Akiko Eriguchi, Kazuma Hashimoto, and Yoshimasa Tsuruoka.

</span>
<span class="ltx_bibblock">Tree-to-sequence attentional neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 54th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  823–833,
Berlin, Germany, August 2016. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/P16-1078" title="" class="ltx_ref ltx_Url">10.18653/v1/P16-1078</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://www.aclweb.org/anthology/P16-1078" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/P16-1078</a>.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Frege (1892)</span>
<span class="ltx_bibblock">
Gottlob Frege.

</span>
<span class="ltx_bibblock">über sinn und bedeutung.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Zeitschrift für Philosophie Und Philosophische Kritik</em>,
100(1):25–50, 1892.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gehring et al. (2017)</span>
<span class="ltx_bibblock">
Jonas Gehring, Michael Auli, David Grangier, Denis Yarats, and Yann N Dauphin.

</span>
<span class="ltx_bibblock">Convolutional Sequence to Sequence Learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Proc. of ICML</em>, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gū et al. (2018)</span>
<span class="ltx_bibblock">
Jetic Gū, Hassan S. Shavarani, and Anoop Sarkar.

</span>
<span class="ltx_bibblock">Top-down tree structured decoding with syntactic connections for
neural machine translation and parsing.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing</em>, pp.  401–413. Association for Computational
Linguistics, 2018.

</span>
<span class="ltx_bibblock">URL <a href="http://aclweb.org/anthology/D18-1037" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://aclweb.org/anthology/D18-1037</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hao et al. (2019)</span>
<span class="ltx_bibblock">
Jie Hao, Xing Wang, Shuming Shi, Jinfeng Zhang, and Zhaopeng Tu.

</span>
<span class="ltx_bibblock">Multi-granularity self-attention for neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harer et al. (2019)</span>
<span class="ltx_bibblock">
Jacob Harer, Chris Reale, and Peter Chin.

</span>
<span class="ltx_bibblock">Tree-transformer: A transformer-based method for correction of
tree-structured data.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1908.00449</em>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hewitt &amp; Manning (2019)</span>
<span class="ltx_bibblock">
John Hewitt and Christopher D Manning.

</span>
<span class="ltx_bibblock">A structural probe for finding syntax in word representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 1 (Long and Short Papers)</em>, pp.  4129–4138, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al. (2019)</span>
<span class="ltx_bibblock">
Yoon Kim, Alexander M Rush, Lei Yu, Adhiguna Kuncoro, Chris Dyer, and Gábor
Melis.

</span>
<span class="ltx_bibblock">Unsupervised recurrent neural network grammars.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1904.03746</em>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lample &amp; Conneau (2019)</span>
<span class="ltx_bibblock">
Guillaume Lample and Alexis Conneau.

</span>
<span class="ltx_bibblock">Cross-lingual language model pretraining.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1901.07291</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Linzen et al. (2016)</span>
<span class="ltx_bibblock">
Tal Linzen, Emmanuel Dupoux, and Yoav Goldberg.

</span>
<span class="ltx_bibblock">Assessing the ability of lstms to learn syntax-sensitive
dependencies.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
4:521–535, 2016.

</span>
<span class="ltx_bibblock">ISSN 2307-387X.

</span>
<span class="ltx_bibblock">URL <a href="https://transacl.org/ojs/index.php/tacl/article/view/972" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://transacl.org/ojs/index.php/tacl/article/view/972</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Manning et al. (2014)</span>
<span class="ltx_bibblock">
Christopher D. Manning, Mihai Surdeanu, John Bauer, Jenny Finkel, Steven J.
Bethard, and David McClosky.

</span>
<span class="ltx_bibblock">The Stanford CoreNLP natural language processing toolkit.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">Association for Computational Linguistics (ACL) System
Demonstrations</em>, pp.  55–60, 2014.

</span>
<span class="ltx_bibblock">URL <a href="http://www.aclweb.org/anthology/P/P14/P14-5010" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.aclweb.org/anthology/P/P14/P14-5010</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ott et al. (2018)</span>
<span class="ltx_bibblock">
Myle Ott, Sergey Edunov, David Grangier, and Michael Auli.

</span>
<span class="ltx_bibblock">Scaling neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Third Conference on Machine Translation
(WMT)</em>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. (2018)</span>
<span class="ltx_bibblock">
Alec Radford, Karthik Narasimhan, Tim Salimans, and Ilya Sutskever.

</span>
<span class="ltx_bibblock">Improving language understanding by generative pre-training.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">URL https://s3-us-west-2. amazonaws.
com/openai-assets/researchcovers/languageunsupervised/language understanding
paper. pdf</em>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sennrich et al. (2016)</span>
<span class="ltx_bibblock">
Rico Sennrich, Barry Haddow, and Alexandra Birch.

</span>
<span class="ltx_bibblock">Neural machine translation of rare words with subword units.

</span>
<span class="ltx_bibblock">In <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 54th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  1715–1725.
Association for Computational Linguistics, 2016.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/P16-1162" title="" class="ltx_ref ltx_Url">10.18653/v1/P16-1162</a>.

</span>
<span class="ltx_bibblock">URL <a href="http://www.aclweb.org/anthology/P16-1162" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://www.aclweb.org/anthology/P16-1162</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shaw et al. (2018)</span>
<span class="ltx_bibblock">
Peter Shaw, Jakob Uszkoreit, and Ashish Vaswani.

</span>
<span class="ltx_bibblock">Self-attention with relative position representations.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference of the North American
Chapter of the Association for Computational Linguistics: Human Language
Technologies, Volume 2 (Short Papers)</em>, pp.  464–468. Association for
Computational Linguistics, 2018.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/N18-2074" title="" class="ltx_ref ltx_Url">10.18653/v1/N18-2074</a>.

</span>
<span class="ltx_bibblock">URL <a href="http://aclweb.org/anthology/N18-2074" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://aclweb.org/anthology/N18-2074</a>.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2018)</span>
<span class="ltx_bibblock">
Yikang Shen, Zhouhan Lin, Athul Paul Jacob, Alessandro Sordoni, Aaron
Courville, and Yoshua Bengio.

</span>
<span class="ltx_bibblock">Straight to the tree: Constituency parsing with neural syntactic
distance.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 56th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, pp.  1171–1180.
Association for Computational Linguistics, 2018.

</span>
<span class="ltx_bibblock">URL <a href="http://aclweb.org/anthology/P18-1108" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://aclweb.org/anthology/P18-1108</a>.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2019)</span>
<span class="ltx_bibblock">
Yikang Shen, Shawn Tan, Alessandro Sordoni, and Aaron Courville.

</span>
<span class="ltx_bibblock">Ordered neurons: Integrating tree structures into recurrent neural
networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a href="https://openreview.net/forum?id=B1l6qiR5F7" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=B1l6qiR5F7</a>.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shi et al. (2018)</span>
<span class="ltx_bibblock">
Haoyue Shi, Hao Zhou, Jiaze Chen, and Lei Li.

</span>
<span class="ltx_bibblock">On tree-based neural sentence modeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing</em>, pp.  4631–4641, Brussels, Belgium,
October-November 2018. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/D18-1492" title="" class="ltx_ref ltx_Url">10.18653/v1/D18-1492</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://www.aclweb.org/anthology/D18-1492" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/D18-1492</a>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Socher et al. (2013)</span>
<span class="ltx_bibblock">
Richard Socher, Alex Perelygin, Jean Wu, Jason Chuang, Christopher D. Manning,
Andrew Ng, and Christopher Potts.

</span>
<span class="ltx_bibblock">Recursive deep models for semantic compositionality over a sentiment
treebank.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2013 Conference on Empirical Methods in
Natural Language Processing</em>, pp.  1631–1642. Association for Computational
Linguistics, 2013.

</span>
<span class="ltx_bibblock">URL <a href="http://aclweb.org/anthology/D13-1170" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://aclweb.org/anthology/D13-1170</a>.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Strubell et al. (2018)</span>
<span class="ltx_bibblock">
Emma Strubell, Patrick Verga, Daniel Andor, David Weiss, and Andrew McCallum.

</span>
<span class="ltx_bibblock">Linguistically-informed self-attention for semantic role labeling.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference on Empirical Methods in
Natural Language Processing</em>, pp.  5027–5038, Brussels, Belgium,
October-November 2018. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/D18-1548" title="" class="ltx_ref ltx_Url">10.18653/v1/D18-1548</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://www.aclweb.org/anthology/D18-1548" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/D18-1548</a>.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tai et al. (2015)</span>
<span class="ltx_bibblock">
Kai Sheng Tai, Richard Socher, and Christopher D. Manning.

</span>
<span class="ltx_bibblock">Improved semantic representations from tree-structured long
short-term memory networks.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 53rd Annual Meeting of the Association
for Computational Linguistics and the 7th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</em>, pp.  1556–1566,
Beijing, China, July 2015. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.3115/v1/P15-1150" title="" class="ltx_ref ltx_Url">10.3115/v1/P15-1150</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://www.aclweb.org/anthology/P15-1150" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/P15-1150</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones,
Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, pp. 5998–6008, 2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2019)</span>
<span class="ltx_bibblock">
Felix Wu, Angela Fan, Alexei Baevski, Yann Dauphin, and Michael Auli.

</span>
<span class="ltx_bibblock">Pay less attention with lightweight and dynamic convolutions.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2019.

</span>
<span class="ltx_bibblock">URL <a href="https://openreview.net/forum?id=SkVhlh09tX" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=SkVhlh09tX</a>.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2017)</span>
<span class="ltx_bibblock">
Baosong Yang, Derek F. Wong, Tong Xiao, Lidia S. Chao, and Jingbo Zhu.

</span>
<span class="ltx_bibblock">Towards bidirectional hierarchical representations for
attention-based neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2017 Conference on Empirical Methods in
Natural Language Processing</em>, pp.  1432–1441, Copenhagen, Denmark,
September 2017. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">doi: <a href="10.18653/v1/D17-1150" title="" class="ltx_ref ltx_Url">10.18653/v1/D17-1150</a>.

</span>
<span class="ltx_bibblock">URL <a href="https://www.aclweb.org/anthology/D17-1150" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.aclweb.org/anthology/D17-1150</a>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. (2019)</span>
<span class="ltx_bibblock">
Zhilin Yang, Zihang Dai, Yiming Yang, Jaime Carbonell, Ruslan Salakhutdinov,
and Quoc V Le.

</span>
<span class="ltx_bibblock">Xlnet: Generalized autoregressive pretraining for language
understanding.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.08237</em>, 2019.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yaushian Wang &amp; Chen (2019)</span>
<span class="ltx_bibblock">
Hung-Yi Lee Yaushian Wang and Yun-Nung Chen.

</span>
<span class="ltx_bibblock">Multitree transformer: Integrating tree structures into
self-attention.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing</em>, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"/>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Appendix</h2>

<section id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1 </span>Proof for proposition <a href="#Thmprop1" title="Proposition 1 ‣ 4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a>
</h3>

<div id="S7.SS1.p1" class="ltx_para ltx_noindent">
<p id="S7.SS1.p1.6" class="ltx_p"><span class="gd_word" id="S7.SS1.p1.6.1.w1">In</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w2">this</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w3">section,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w4">we</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w5">present</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w6">a</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w7">proof</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w8">of</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.1.w9">Proposition</span><span> </span><a href="#Thmprop1" title="Proposition 1 ‣ 4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S7.SS1.p1.6.2.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w2">The</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w3">main</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w4">argument</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w5">of</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w6">this</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w7">proposition</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w8">is</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w9">that</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w10">in</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w11">order</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.2.w12">for</span><span> </span><math id="S7.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S7.SS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.1.m1.1.1" xref="S7.SS1.p1.1.m1.1.1.cmml">ℋ</mi></semantics></math><span class="gd_word" id="S7.SS1.p1.6.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w2">to</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w3">be</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w4">a</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w5">legitimate</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w6">transformation</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w7">of</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w8">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w9">parse</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.3.w10">tree</span><span> </span><math id="S7.SS1.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S7.SS1.p1.2.m2.1a"><mrow id="S7.SS1.p1.2.m2.1.2" xref="S7.SS1.p1.2.m2.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.2.m2.1.2.2" xref="S7.SS1.p1.2.m2.1.2.2.cmml">𝒢</mi><mo id="S7.SS1.p1.2.m2.1.2.1" xref="S7.SS1.p1.2.m2.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p1.2.m2.1.2.3.2" xref="S7.SS1.p1.2.m2.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.2.m2.1.2.3.2.1" xref="S7.SS1.p1.2.m2.1.2.cmml">(</mo><mi id="S7.SS1.p1.2.m2.1.1" xref="S7.SS1.p1.2.m2.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p1.2.m2.1.2.3.2.2" xref="S7.SS1.p1.2.m2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p1.6.4.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w2">it</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w3">must</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w4">preserve</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w5">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w6">uniqueness</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w7">of</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w8">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w9">hierarchical</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w10">structure</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w11">encoded</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w12">by</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w13">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w14">tree.</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w15">Otherwise</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w16">speaking,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w17">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w18">result</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w19">of</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w20">such</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w21">transformation</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w22">must</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w23">reflect</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w24">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.4.w25">tree</span><span> </span><math id="S7.SS1.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S7.SS1.p1.3.m3.1a"><mrow id="S7.SS1.p1.3.m3.1.2" xref="S7.SS1.p1.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.3.m3.1.2.2" xref="S7.SS1.p1.3.m3.1.2.2.cmml">𝒢</mi><mo id="S7.SS1.p1.3.m3.1.2.1" xref="S7.SS1.p1.3.m3.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p1.3.m3.1.2.3.2" xref="S7.SS1.p1.3.m3.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.3.m3.1.2.3.2.1" xref="S7.SS1.p1.3.m3.1.2.cmml">(</mo><mi id="S7.SS1.p1.3.m3.1.1" xref="S7.SS1.p1.3.m3.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p1.3.m3.1.2.3.2.2" xref="S7.SS1.p1.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p1.6.5.w1"/><span> </span><span class="gd_word" id="S7.SS1.p1.6.5.w2">and</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.5.w3">only</span><span> </span><math id="S7.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S7.SS1.p1.4.m4.1a"><mrow id="S7.SS1.p1.4.m4.1.2" xref="S7.SS1.p1.4.m4.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.4.m4.1.2.2" xref="S7.SS1.p1.4.m4.1.2.2.cmml">𝒢</mi><mo id="S7.SS1.p1.4.m4.1.2.1" xref="S7.SS1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p1.4.m4.1.2.3.2" xref="S7.SS1.p1.4.m4.1.2.cmml"><mo stretchy="false" id="S7.SS1.p1.4.m4.1.2.3.2.1" xref="S7.SS1.p1.4.m4.1.2.cmml">(</mo><mi id="S7.SS1.p1.4.m4.1.1" xref="S7.SS1.p1.4.m4.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p1.4.m4.1.2.3.2.2" xref="S7.SS1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p1.6.6.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w2">and</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w3">not</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w4">any</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w5">other</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w6">tree</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w7">form.</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.6.w8">If</span><span> </span><math id="S7.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S7.SS1.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p1.5.m5.1.1" xref="S7.SS1.p1.5.m5.1.1.cmml">ℋ</mi></semantics></math><span class="gd_word" id="S7.SS1.p1.6.7.w1"/><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w2">does</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w3">not</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w4">have</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w5">this</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w6">property,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w7">it</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w8">may</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w9">transform</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w10">two</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w11">different</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w12">tree</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w13">structures</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w14">into</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w15">an</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w16">identical</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w17">representation,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w18">which</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w19">will</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w20">make</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w21">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w22">downstream</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w23">tree-encoding</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w24">process</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w25">ambiguous.</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w26">This</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w27">property</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w28">also</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w29">means</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w30">that</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w31">in</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w32">a</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w33">parse</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w34">tree</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w35">(1)</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w36">every</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w37">node</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w38">(either</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w39">leaf</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w40">or</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w41">nonterminal</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w42">node)</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w43">has</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w44">at</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w45">most</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w46">one</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w47">parent,</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w48">and</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w49">(2)</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w50">a</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w51">nonterminal</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w52">node</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w53">which</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w54">has</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w55">multiple</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w56">children</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w57">can</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w58">tell</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w59">the</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w60">sibling</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w61">order</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w62">between</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w63">its</span><span> </span><span class="gd_word" id="S7.SS1.p1.6.7.w64">children.</span></p>
</div>
<div id="S7.SS1.p2" class="ltx_para ltx_noindent">
<p id="S7.SS1.p2.11" class="ltx_p"><span class="gd_word" id="S7.SS1.p2.11.1.w1">For</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w2">requirement</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w3">(1)</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w4">specifically,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w5">except</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w6">for</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w7">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w8">root</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w9">node</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w10">which</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w11">has</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w12">no</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w13">parent,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w14">all</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w15">other</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w16">nodes</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w17">have</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w18">one</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w19">and</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w20">only</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w21">one</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w22">parent.</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w23">Therefore,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.1.w24">Proposition</span><span> </span><a href="#Thmprop1" title="Proposition 1 ‣ 4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="S7.SS1.p2.11.2.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w2">implies</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w3">that</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w4">if</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w5">there</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w6">exists</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w7">a</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.2.w8">inverse-transformation</span><span> </span><math id="S7.SS1.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S7.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.1.m1.1.1" xref="S7.SS1.p2.1.m1.1.1.cmml">ℐ</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.3.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w2">it</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w3">must</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w4">be</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w5">able</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w6">to</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w7">find</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w8">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w9">exact</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w10">parent</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w11">given</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w12">any</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w13">node</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w14">in</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w15">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w16">tree.</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w17">Our</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w18">proposed</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.3.w19">transformation</span><span> </span><math id="S7.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{H}" display="inline"><semantics id="S7.SS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.2.m2.1.1" xref="S7.SS1.p2.2.m2.1.1.cmml">ℋ</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.4.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.4.w2">satisfies</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.4.w3">this</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.4.w4">property.
Formally,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.4.w5">let</span><span> </span><math id="S7.SS1.p2.3.m3.1" class="ltx_Math" alttext="x\in\mathcal{L}\cup\mathcal{N}" display="inline"><semantics id="S7.SS1.p2.3.m3.1a"><mrow id="S7.SS1.p2.3.m3.1.1" xref="S7.SS1.p2.3.m3.1.1.cmml"><mi id="S7.SS1.p2.3.m3.1.1.2" xref="S7.SS1.p2.3.m3.1.1.2.cmml">x</mi><mo id="S7.SS1.p2.3.m3.1.1.1" xref="S7.SS1.p2.3.m3.1.1.1.cmml">∈</mo><mrow id="S7.SS1.p2.3.m3.1.1.3" xref="S7.SS1.p2.3.m3.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.3.m3.1.1.3.2" xref="S7.SS1.p2.3.m3.1.1.3.2.cmml">ℒ</mi><mo id="S7.SS1.p2.3.m3.1.1.3.1" xref="S7.SS1.p2.3.m3.1.1.3.1.cmml">∪</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.3.m3.1.1.3.3" xref="S7.SS1.p2.3.m3.1.1.3.3.cmml">𝒩</mi></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.11.5.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w2">be</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w3">a</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w4">node</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w5">in</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w6">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w7">tree</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.5.w8">and</span><span> </span><math id="S7.SS1.p2.4.m4.1" class="ltx_Math" alttext="\rho(x)\in\mathcal{N}" display="inline"><semantics id="S7.SS1.p2.4.m4.1a"><mrow id="S7.SS1.p2.4.m4.1.2" xref="S7.SS1.p2.4.m4.1.2.cmml"><mrow id="S7.SS1.p2.4.m4.1.2.2" xref="S7.SS1.p2.4.m4.1.2.2.cmml"><mi id="S7.SS1.p2.4.m4.1.2.2.2" xref="S7.SS1.p2.4.m4.1.2.2.2.cmml">ρ</mi><mo id="S7.SS1.p2.4.m4.1.2.2.1" xref="S7.SS1.p2.4.m4.1.2.2.1.cmml">⁢</mo><mrow id="S7.SS1.p2.4.m4.1.2.2.3.2" xref="S7.SS1.p2.4.m4.1.2.2.cmml"><mo stretchy="false" id="S7.SS1.p2.4.m4.1.2.2.3.2.1" xref="S7.SS1.p2.4.m4.1.2.2.cmml">(</mo><mi id="S7.SS1.p2.4.m4.1.1" xref="S7.SS1.p2.4.m4.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.4.m4.1.2.2.3.2.2" xref="S7.SS1.p2.4.m4.1.2.2.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p2.4.m4.1.2.1" xref="S7.SS1.p2.4.m4.1.2.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.4.m4.1.2.3" xref="S7.SS1.p2.4.m4.1.2.3.cmml">𝒩</mi></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.11.6.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.6.w2">be</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.6.w3">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.6.w4">parent</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.6.w5">of</span><span> </span><math id="S7.SS1.p2.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p2.5.m5.1a"><mi id="S7.SS1.p2.5.m5.1.1" xref="S7.SS1.p2.5.m5.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.7.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.7.w2">We</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.7.w3">define</span><span> </span><math id="S7.SS1.p2.6.m6.4" class="ltx_Math" alttext="\mathcal{P}(x)=\{y\in\mathcal{N}|x\in\mathcal{R}(y)\}" display="inline"><semantics id="S7.SS1.p2.6.m6.4a"><mrow id="S7.SS1.p2.6.m6.4.4" xref="S7.SS1.p2.6.m6.4.4.cmml"><mrow id="S7.SS1.p2.6.m6.4.4.4" xref="S7.SS1.p2.6.m6.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.6.m6.4.4.4.2" xref="S7.SS1.p2.6.m6.4.4.4.2.cmml">𝒫</mi><mo id="S7.SS1.p2.6.m6.4.4.4.1" xref="S7.SS1.p2.6.m6.4.4.4.1.cmml">⁢</mo><mrow id="S7.SS1.p2.6.m6.4.4.4.3.2" xref="S7.SS1.p2.6.m6.4.4.4.cmml"><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.4.3.2.1" xref="S7.SS1.p2.6.m6.4.4.4.cmml">(</mo><mi id="S7.SS1.p2.6.m6.1.1" xref="S7.SS1.p2.6.m6.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.4.3.2.2" xref="S7.SS1.p2.6.m6.4.4.4.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p2.6.m6.4.4.3" xref="S7.SS1.p2.6.m6.4.4.3.cmml">=</mo><mrow id="S7.SS1.p2.6.m6.4.4.2.2" xref="S7.SS1.p2.6.m6.4.4.2.3.cmml"><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.2.2.3" xref="S7.SS1.p2.6.m6.4.4.2.3.1.cmml">{</mo><mrow id="S7.SS1.p2.6.m6.3.3.1.1.1" xref="S7.SS1.p2.6.m6.3.3.1.1.1.cmml"><mi id="S7.SS1.p2.6.m6.3.3.1.1.1.2" xref="S7.SS1.p2.6.m6.3.3.1.1.1.2.cmml">y</mi><mo id="S7.SS1.p2.6.m6.3.3.1.1.1.1" xref="S7.SS1.p2.6.m6.3.3.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.6.m6.3.3.1.1.1.3" xref="S7.SS1.p2.6.m6.3.3.1.1.1.3.cmml">𝒩</mi></mrow><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.2.2.4" xref="S7.SS1.p2.6.m6.4.4.2.3.1.cmml">|</mo><mrow id="S7.SS1.p2.6.m6.4.4.2.2.2" xref="S7.SS1.p2.6.m6.4.4.2.2.2.cmml"><mi id="S7.SS1.p2.6.m6.4.4.2.2.2.2" xref="S7.SS1.p2.6.m6.4.4.2.2.2.2.cmml">x</mi><mo id="S7.SS1.p2.6.m6.4.4.2.2.2.1" xref="S7.SS1.p2.6.m6.4.4.2.2.2.1.cmml">∈</mo><mrow id="S7.SS1.p2.6.m6.4.4.2.2.2.3" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.6.m6.4.4.2.2.2.3.2" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.2.cmml">ℛ</mi><mo id="S7.SS1.p2.6.m6.4.4.2.2.2.3.1" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.1.cmml">⁢</mo><mrow id="S7.SS1.p2.6.m6.4.4.2.2.2.3.3.2" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.cmml"><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.2.2.2.3.3.2.1" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.cmml">(</mo><mi id="S7.SS1.p2.6.m6.2.2" xref="S7.SS1.p2.6.m6.2.2.cmml">y</mi><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.2.2.2.3.3.2.2" xref="S7.SS1.p2.6.m6.4.4.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.SS1.p2.6.m6.4.4.2.2.5" xref="S7.SS1.p2.6.m6.4.4.2.3.1.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.11.8.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w2">to</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w3">be</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w4">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w5">set</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w6">of</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w7">all</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w8">ancestors</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.8.w9">of</span><span> </span><math id="S7.SS1.p2.7.m7.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p2.7.m7.1a"><mi id="S7.SS1.p2.7.m7.1.1" xref="S7.SS1.p2.7.m7.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.9.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.9.w2">Thus,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.9.w3">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.9.w4">parent</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.9.w5">of</span><span> </span><math id="S7.SS1.p2.8.m8.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p2.8.m8.1a"><mi id="S7.SS1.p2.8.m8.1.1" xref="S7.SS1.p2.8.m8.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.10.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.10.w2">should</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.10.w3">belong</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.10.w4">to</span><span> </span><math id="S7.SS1.p2.9.m9.1" class="ltx_Math" alttext="\mathcal{P}(x)" display="inline"><semantics id="S7.SS1.p2.9.m9.1a"><mrow id="S7.SS1.p2.9.m9.1.2" xref="S7.SS1.p2.9.m9.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.9.m9.1.2.2" xref="S7.SS1.p2.9.m9.1.2.2.cmml">𝒫</mi><mo id="S7.SS1.p2.9.m9.1.2.1" xref="S7.SS1.p2.9.m9.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p2.9.m9.1.2.3.2" xref="S7.SS1.p2.9.m9.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.9.m9.1.2.3.2.1" xref="S7.SS1.p2.9.m9.1.2.cmml">(</mo><mi id="S7.SS1.p2.9.m9.1.1" xref="S7.SS1.p2.9.m9.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.9.m9.1.2.3.2.2" xref="S7.SS1.p2.9.m9.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.11.11.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w2">From</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w3">that,</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w4">we</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w5">derive</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w6">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.11.11.w7">parent</span><span> </span><math id="S7.SS1.p2.10.m10.1" class="ltx_Math" alttext="\rho(x)" display="inline"><semantics id="S7.SS1.p2.10.m10.1a"><mrow id="S7.SS1.p2.10.m10.1.2" xref="S7.SS1.p2.10.m10.1.2.cmml"><mi id="S7.SS1.p2.10.m10.1.2.2" xref="S7.SS1.p2.10.m10.1.2.2.cmml">ρ</mi><mo id="S7.SS1.p2.10.m10.1.2.1" xref="S7.SS1.p2.10.m10.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p2.10.m10.1.2.3.2" xref="S7.SS1.p2.10.m10.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.10.m10.1.2.3.2.1" xref="S7.SS1.p2.10.m10.1.2.cmml">(</mo><mi id="S7.SS1.p2.10.m10.1.1" xref="S7.SS1.p2.10.m10.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.10.m10.1.2.3.2.2" xref="S7.SS1.p2.10.m10.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.11.12.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.12.w2">of</span><span> </span><math id="S7.SS1.p2.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p2.11.m11.1a"><mi id="S7.SS1.p2.11.m11.1.1" xref="S7.SS1.p2.11.m11.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.11.13.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.11.13.w2">as:</span></p>
<table id="S7.E25" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E25.m1.5" class="ltx_Math" alttext="\rho(x)=y_{x}\in\mathcal{P}(x)\mbox{ such that }\mathcal{R}(y_{x})\cap\mathcal%&#10;{P}(x)=\{y_{x}\}" display="block"><semantics id="S7.E25.m1.5a"><mrow id="S7.E25.m1.5.5" xref="S7.E25.m1.5.5.cmml"><mrow id="S7.E25.m1.5.5.4" xref="S7.E25.m1.5.5.4.cmml"><mi id="S7.E25.m1.5.5.4.2" xref="S7.E25.m1.5.5.4.2.cmml">ρ</mi><mo id="S7.E25.m1.5.5.4.1" xref="S7.E25.m1.5.5.4.1.cmml">⁢</mo><mrow id="S7.E25.m1.5.5.4.3.2" xref="S7.E25.m1.5.5.4.cmml"><mo stretchy="false" id="S7.E25.m1.5.5.4.3.2.1" xref="S7.E25.m1.5.5.4.cmml">(</mo><mi id="S7.E25.m1.1.1" xref="S7.E25.m1.1.1.cmml">x</mi><mo stretchy="false" id="S7.E25.m1.5.5.4.3.2.2" xref="S7.E25.m1.5.5.4.cmml">)</mo></mrow></mrow><mo id="S7.E25.m1.5.5.5" xref="S7.E25.m1.5.5.5.cmml">=</mo><msub id="S7.E25.m1.5.5.6" xref="S7.E25.m1.5.5.6.cmml"><mi id="S7.E25.m1.5.5.6.2" xref="S7.E25.m1.5.5.6.2.cmml">y</mi><mi id="S7.E25.m1.5.5.6.3" xref="S7.E25.m1.5.5.6.3.cmml">x</mi></msub><mo id="S7.E25.m1.5.5.7" xref="S7.E25.m1.5.5.7.cmml">∈</mo><mrow id="S7.E25.m1.4.4.1" xref="S7.E25.m1.4.4.1.cmml"><mrow id="S7.E25.m1.4.4.1.1" xref="S7.E25.m1.4.4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E25.m1.4.4.1.1.3" xref="S7.E25.m1.4.4.1.1.3.cmml">𝒫</mi><mo id="S7.E25.m1.4.4.1.1.2" xref="S7.E25.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S7.E25.m1.4.4.1.1.4.2" xref="S7.E25.m1.4.4.1.1.cmml"><mo stretchy="false" id="S7.E25.m1.4.4.1.1.4.2.1" xref="S7.E25.m1.4.4.1.1.cmml">(</mo><mi id="S7.E25.m1.2.2" xref="S7.E25.m1.2.2.cmml">x</mi><mo stretchy="false" id="S7.E25.m1.4.4.1.1.4.2.2" xref="S7.E25.m1.4.4.1.1.cmml">)</mo></mrow><mo id="S7.E25.m1.4.4.1.1.2a" xref="S7.E25.m1.4.4.1.1.2.cmml">⁢</mo><mtext id="S7.E25.m1.4.4.1.1.5" xref="S7.E25.m1.4.4.1.1.5a.cmml"> such that </mtext><mo id="S7.E25.m1.4.4.1.1.2b" xref="S7.E25.m1.4.4.1.1.2.cmml">⁢</mo><mi class="ltx_font_mathcaligraphic" id="S7.E25.m1.4.4.1.1.6" xref="S7.E25.m1.4.4.1.1.6.cmml">ℛ</mi><mo id="S7.E25.m1.4.4.1.1.2c" xref="S7.E25.m1.4.4.1.1.2.cmml">⁢</mo><mrow id="S7.E25.m1.4.4.1.1.1.1" xref="S7.E25.m1.4.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E25.m1.4.4.1.1.1.1.2" xref="S7.E25.m1.4.4.1.1.1.1.1.cmml">(</mo><msub id="S7.E25.m1.4.4.1.1.1.1.1" xref="S7.E25.m1.4.4.1.1.1.1.1.cmml"><mi id="S7.E25.m1.4.4.1.1.1.1.1.2" xref="S7.E25.m1.4.4.1.1.1.1.1.2.cmml">y</mi><mi id="S7.E25.m1.4.4.1.1.1.1.1.3" xref="S7.E25.m1.4.4.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S7.E25.m1.4.4.1.1.1.1.3" xref="S7.E25.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E25.m1.4.4.1.2" xref="S7.E25.m1.4.4.1.2.cmml">∩</mo><mrow id="S7.E25.m1.4.4.1.3" xref="S7.E25.m1.4.4.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E25.m1.4.4.1.3.2" xref="S7.E25.m1.4.4.1.3.2.cmml">𝒫</mi><mo id="S7.E25.m1.4.4.1.3.1" xref="S7.E25.m1.4.4.1.3.1.cmml">⁢</mo><mrow id="S7.E25.m1.4.4.1.3.3.2" xref="S7.E25.m1.4.4.1.3.cmml"><mo stretchy="false" id="S7.E25.m1.4.4.1.3.3.2.1" xref="S7.E25.m1.4.4.1.3.cmml">(</mo><mi id="S7.E25.m1.3.3" xref="S7.E25.m1.3.3.cmml">x</mi><mo stretchy="false" id="S7.E25.m1.4.4.1.3.3.2.2" xref="S7.E25.m1.4.4.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E25.m1.5.5.8" xref="S7.E25.m1.5.5.8.cmml">=</mo><mrow id="S7.E25.m1.5.5.2.1" xref="S7.E25.m1.5.5.2.2.cmml"><mo stretchy="false" id="S7.E25.m1.5.5.2.1.2" xref="S7.E25.m1.5.5.2.2.cmml">{</mo><msub id="S7.E25.m1.5.5.2.1.1" xref="S7.E25.m1.5.5.2.1.1.cmml"><mi id="S7.E25.m1.5.5.2.1.1.2" xref="S7.E25.m1.5.5.2.1.1.2.cmml">y</mi><mi id="S7.E25.m1.5.5.2.1.1.3" xref="S7.E25.m1.5.5.2.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S7.E25.m1.5.5.2.1.3" xref="S7.E25.m1.5.5.2.2.cmml">}</mo></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr>
</table>
<p id="S7.SS1.p2.15" class="ltx_p"><span class="gd_word" id="S7.SS1.p2.15.1.w1">As</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.1.w2">implied</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.1.w3">in</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.1.w4">Equation</span><span> </span><a href="#S7.E25" title="(25) ‣ 7.1 Proof for proposition 1 ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">25</a><span class="gd_word" id="S7.SS1.p2.15.2.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.2.w2">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.2.w3">parent</span><span> </span><math id="S7.SS1.p2.12.m1.1" class="ltx_Math" alttext="\rho(x)" display="inline"><semantics id="S7.SS1.p2.12.m1.1a"><mrow id="S7.SS1.p2.12.m1.1.2" xref="S7.SS1.p2.12.m1.1.2.cmml"><mi id="S7.SS1.p2.12.m1.1.2.2" xref="S7.SS1.p2.12.m1.1.2.2.cmml">ρ</mi><mo id="S7.SS1.p2.12.m1.1.2.1" xref="S7.SS1.p2.12.m1.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p2.12.m1.1.2.3.2" xref="S7.SS1.p2.12.m1.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.12.m1.1.2.3.2.1" xref="S7.SS1.p2.12.m1.1.2.cmml">(</mo><mi id="S7.SS1.p2.12.m1.1.1" xref="S7.SS1.p2.12.m1.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.12.m1.1.2.3.2.2" xref="S7.SS1.p2.12.m1.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.15.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w2">is</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w3">one</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w4">of</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w5">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w6">ancestors</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.3.w7">of</span><span> </span><math id="S7.SS1.p2.13.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p2.13.m2.1a"><mi id="S7.SS1.p2.13.m2.1.1" xref="S7.SS1.p2.13.m2.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p2.15.4.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w2">whose</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w3">subtree</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w4">does</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w5">not</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w6">encapsulate</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w7">any</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w8">of</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w9">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w10">ancestors</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.4.w11">in</span><span> </span><math id="S7.SS1.p2.14.m3.1" class="ltx_Math" alttext="\mathcal{P}(x)" display="inline"><semantics id="S7.SS1.p2.14.m3.1a"><mrow id="S7.SS1.p2.14.m3.1.2" xref="S7.SS1.p2.14.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p2.14.m3.1.2.2" xref="S7.SS1.p2.14.m3.1.2.2.cmml">𝒫</mi><mo id="S7.SS1.p2.14.m3.1.2.1" xref="S7.SS1.p2.14.m3.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p2.14.m3.1.2.3.2" xref="S7.SS1.p2.14.m3.1.2.cmml"><mo stretchy="false" id="S7.SS1.p2.14.m3.1.2.3.2.1" xref="S7.SS1.p2.14.m3.1.2.cmml">(</mo><mi id="S7.SS1.p2.14.m3.1.1" xref="S7.SS1.p2.14.m3.1.1.cmml">x</mi><mo stretchy="false" id="S7.SS1.p2.14.m3.1.2.3.2.2" xref="S7.SS1.p2.14.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p2.15.5.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w2">except</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w3">itself.</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w4">In</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w5">other</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w6">words,</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w7">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w8">parent</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w9">is</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w10">the</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w11">immediate</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w12">ancestor.</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w13">In</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w14">a</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w15">parse</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w16">tree,</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w17">there</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w18">is</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w19">at</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w20">most</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w21">one</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.5.w22">node</span><span> </span><math id="S7.SS1.p2.15.m4.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S7.SS1.p2.15.m4.1a"><msub id="S7.SS1.p2.15.m4.1.1" xref="S7.SS1.p2.15.m4.1.1.cmml"><mi id="S7.SS1.p2.15.m4.1.1.2" xref="S7.SS1.p2.15.m4.1.1.2.cmml">y</mi><mi id="S7.SS1.p2.15.m4.1.1.3" xref="S7.SS1.p2.15.m4.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S7.SS1.p2.15.6.w1"/><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w2">that</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w3">satisfies</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w4">this</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w5">condition.</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w6">We</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w7">prove</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w8">this</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w9">by</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w10">contradiction</span><span> </span><span class="gd_word" id="S7.SS1.p2.15.6.w11">below.</span></p>
</div>
<div id="Thmproof1" class="ltx_theorem ltx_theorem_proof">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem">Proof 1</span></h6>
<div id="Thmproof1.p1" class="ltx_para ltx_noindent">
<p id="Thmproof1.p1.9" class="ltx_p"><span class="gd_word" id="Thmproof1.p1.9.1.w1">Suppose</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.1.w2">there</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.1.w3">exists</span><span> </span><math id="Thmproof1.p1.1.1.m1.1" class="ltx_Math" alttext="\rho^{\prime}(x)=y_{x}^{\prime}\neq y_{x}" display="inline"><semantics id="Thmproof1.p1.1.1.m1.1a"><mrow id="Thmproof1.p1.1.1.m1.1.2" xref="Thmproof1.p1.1.1.m1.1.2.cmml"><mrow id="Thmproof1.p1.1.1.m1.1.2.2" xref="Thmproof1.p1.1.1.m1.1.2.2.cmml"><msup id="Thmproof1.p1.1.1.m1.1.2.2.2" xref="Thmproof1.p1.1.1.m1.1.2.2.2.cmml"><mi id="Thmproof1.p1.1.1.m1.1.2.2.2.2" xref="Thmproof1.p1.1.1.m1.1.2.2.2.2.cmml">ρ</mi><mo mathvariant="normal" id="Thmproof1.p1.1.1.m1.1.2.2.2.3" xref="Thmproof1.p1.1.1.m1.1.2.2.2.3.cmml">′</mo></msup><mo mathvariant="italic" id="Thmproof1.p1.1.1.m1.1.2.2.1" xref="Thmproof1.p1.1.1.m1.1.2.2.1.cmml">⁢</mo><mrow id="Thmproof1.p1.1.1.m1.1.2.2.3.2" xref="Thmproof1.p1.1.1.m1.1.2.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.1.1.m1.1.2.2.3.2.1" xref="Thmproof1.p1.1.1.m1.1.2.2.cmml">(</mo><mi id="Thmproof1.p1.1.1.m1.1.1" xref="Thmproof1.p1.1.1.m1.1.1.cmml">x</mi><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.1.1.m1.1.2.2.3.2.2" xref="Thmproof1.p1.1.1.m1.1.2.2.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof1.p1.1.1.m1.1.2.3" xref="Thmproof1.p1.1.1.m1.1.2.3.cmml">=</mo><msubsup id="Thmproof1.p1.1.1.m1.1.2.4" xref="Thmproof1.p1.1.1.m1.1.2.4.cmml"><mi id="Thmproof1.p1.1.1.m1.1.2.4.2.2" xref="Thmproof1.p1.1.1.m1.1.2.4.2.2.cmml">y</mi><mi id="Thmproof1.p1.1.1.m1.1.2.4.2.3" xref="Thmproof1.p1.1.1.m1.1.2.4.2.3.cmml">x</mi><mo mathvariant="normal" id="Thmproof1.p1.1.1.m1.1.2.4.3" xref="Thmproof1.p1.1.1.m1.1.2.4.3.cmml">′</mo></msubsup><mo mathvariant="normal" id="Thmproof1.p1.1.1.m1.1.2.5" xref="Thmproof1.p1.1.1.m1.1.2.5.cmml">≠</mo><msub id="Thmproof1.p1.1.1.m1.1.2.6" xref="Thmproof1.p1.1.1.m1.1.2.6.cmml"><mi id="Thmproof1.p1.1.1.m1.1.2.6.2" xref="Thmproof1.p1.1.1.m1.1.2.6.2.cmml">y</mi><mi id="Thmproof1.p1.1.1.m1.1.2.6.3" xref="Thmproof1.p1.1.1.m1.1.2.6.3.cmml">x</mi></msub></mrow></semantics></math><span class="gd_word" id="Thmproof1.p1.9.2.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.2.w2">such</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.2.w3">that</span><span> </span><math id="Thmproof1.p1.2.2.m2.3" class="ltx_Math" alttext="\mathcal{R}(y_{x}^{\prime})\cap\mathcal{P}(x)=\{y_{x}^{\prime}\}" display="inline"><semantics id="Thmproof1.p1.2.2.m2.3a"><mrow id="Thmproof1.p1.2.2.m2.3.3" xref="Thmproof1.p1.2.2.m2.3.3.cmml"><mrow id="Thmproof1.p1.2.2.m2.2.2.1" xref="Thmproof1.p1.2.2.m2.2.2.1.cmml"><mrow id="Thmproof1.p1.2.2.m2.2.2.1.1" xref="Thmproof1.p1.2.2.m2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof1.p1.2.2.m2.2.2.1.1.3" xref="Thmproof1.p1.2.2.m2.2.2.1.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof1.p1.2.2.m2.2.2.1.1.2" xref="Thmproof1.p1.2.2.m2.2.2.1.1.2.cmml">⁢</mo><mrow id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.2" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.cmml">(</mo><msubsup id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.cmml"><mi id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.2.2" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.2.2.cmml">y</mi><mi id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.2.3" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.2.3.cmml">x</mi><mo mathvariant="normal" id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.3" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.3.cmml">′</mo></msubsup><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.3" xref="Thmproof1.p1.2.2.m2.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof1.p1.2.2.m2.2.2.1.2" xref="Thmproof1.p1.2.2.m2.2.2.1.2.cmml">∩</mo><mrow id="Thmproof1.p1.2.2.m2.2.2.1.3" xref="Thmproof1.p1.2.2.m2.2.2.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof1.p1.2.2.m2.2.2.1.3.2" xref="Thmproof1.p1.2.2.m2.2.2.1.3.2.cmml">𝒫</mi><mo mathvariant="italic" id="Thmproof1.p1.2.2.m2.2.2.1.3.1" xref="Thmproof1.p1.2.2.m2.2.2.1.3.1.cmml">⁢</mo><mrow id="Thmproof1.p1.2.2.m2.2.2.1.3.3.2" xref="Thmproof1.p1.2.2.m2.2.2.1.3.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.2.2.1.3.3.2.1" xref="Thmproof1.p1.2.2.m2.2.2.1.3.cmml">(</mo><mi id="Thmproof1.p1.2.2.m2.1.1" xref="Thmproof1.p1.2.2.m2.1.1.cmml">x</mi><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.2.2.1.3.3.2.2" xref="Thmproof1.p1.2.2.m2.2.2.1.3.cmml">)</mo></mrow></mrow></mrow><mo mathvariant="normal" id="Thmproof1.p1.2.2.m2.3.3.3" xref="Thmproof1.p1.2.2.m2.3.3.3.cmml">=</mo><mrow id="Thmproof1.p1.2.2.m2.3.3.2.1" xref="Thmproof1.p1.2.2.m2.3.3.2.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.3.3.2.1.2" xref="Thmproof1.p1.2.2.m2.3.3.2.2.cmml">{</mo><msubsup id="Thmproof1.p1.2.2.m2.3.3.2.1.1" xref="Thmproof1.p1.2.2.m2.3.3.2.1.1.cmml"><mi id="Thmproof1.p1.2.2.m2.3.3.2.1.1.2.2" xref="Thmproof1.p1.2.2.m2.3.3.2.1.1.2.2.cmml">y</mi><mi id="Thmproof1.p1.2.2.m2.3.3.2.1.1.2.3" xref="Thmproof1.p1.2.2.m2.3.3.2.1.1.2.3.cmml">x</mi><mo mathvariant="normal" id="Thmproof1.p1.2.2.m2.3.3.2.1.1.3" xref="Thmproof1.p1.2.2.m2.3.3.2.1.1.3.cmml">′</mo></msubsup><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.2.2.m2.3.3.2.1.3" xref="Thmproof1.p1.2.2.m2.3.3.2.2.cmml">}</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof1.p1.9.3.w1">,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.3.w2">i.e.,</span><span> </span><math id="Thmproof1.p1.3.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="Thmproof1.p1.3.3.m3.1a"><mi id="Thmproof1.p1.3.3.m3.1.1" xref="Thmproof1.p1.3.3.m3.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="Thmproof1.p1.9.4.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.4.w2">has</span><span> </span><math id="Thmproof1.p1.4.4.m4.1" class="ltx_Math" alttext="2" display="inline"><semantics id="Thmproof1.p1.4.4.m4.1a"><mn mathvariant="normal" id="Thmproof1.p1.4.4.m4.1.1" xref="Thmproof1.p1.4.4.m4.1.1.cmml">2</mn></semantics></math><span class="gd_word" id="Thmproof1.p1.9.5.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w2">parents.</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w3">Under</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w4">this</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w5">assumption,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w6">there</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w7">will</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w8">be</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w9">two</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w10">different</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w11">paths</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w12">from</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w13">the</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w14">root</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w15">node</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.5.w16">to</span><span> </span><math id="Thmproof1.p1.5.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="Thmproof1.p1.5.5.m5.1a"><mi id="Thmproof1.p1.5.5.m5.1.1" xref="Thmproof1.p1.5.5.m5.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="Thmproof1.p1.9.6.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.6.w2">–</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.6.w3">one</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.6.w4">via</span><span> </span><math id="Thmproof1.p1.6.6.m6.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="Thmproof1.p1.6.6.m6.1a"><msub id="Thmproof1.p1.6.6.m6.1.1" xref="Thmproof1.p1.6.6.m6.1.1.cmml"><mi id="Thmproof1.p1.6.6.m6.1.1.2" xref="Thmproof1.p1.6.6.m6.1.1.2.cmml">y</mi><mi id="Thmproof1.p1.6.6.m6.1.1.3" xref="Thmproof1.p1.6.6.m6.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="Thmproof1.p1.9.7.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.7.w2">and</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.7.w3">the</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.7.w4">other</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.7.w5">via</span><span> </span><math id="Thmproof1.p1.7.7.m7.1" class="ltx_Math" alttext="y_{x}^{\prime}" display="inline"><semantics id="Thmproof1.p1.7.7.m7.1a"><msubsup id="Thmproof1.p1.7.7.m7.1.1" xref="Thmproof1.p1.7.7.m7.1.1.cmml"><mi id="Thmproof1.p1.7.7.m7.1.1.2.2" xref="Thmproof1.p1.7.7.m7.1.1.2.2.cmml">y</mi><mi id="Thmproof1.p1.7.7.m7.1.1.2.3" xref="Thmproof1.p1.7.7.m7.1.1.2.3.cmml">x</mi><mo mathvariant="normal" id="Thmproof1.p1.7.7.m7.1.1.3" xref="Thmproof1.p1.7.7.m7.1.1.3.cmml">′</mo></msubsup></semantics></math><span class="gd_word" id="Thmproof1.p1.9.8.w1">.</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w2">This</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w3">makes</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w4">a</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w5">closed</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w6">cycle.</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w7">However,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w8">a</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w9">parse</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w10">tree</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w11">is</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w12">an</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w13">acyclic</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w14">directed</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w15">spanning</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w16">tree,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w17">which</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w18">does</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w19">not</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w20">have</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w21">cycles.</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w22">Thus,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w23">by</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w24">contradiction,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.8.w25">if</span><span> </span><math id="Thmproof1.p1.8.8.m8.1" class="ltx_Math" alttext="\mathcal{G}(x)" display="inline"><semantics id="Thmproof1.p1.8.8.m8.1a"><mrow id="Thmproof1.p1.8.8.m8.1.2" xref="Thmproof1.p1.8.8.m8.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof1.p1.8.8.m8.1.2.2" xref="Thmproof1.p1.8.8.m8.1.2.2.cmml">𝒢</mi><mo mathvariant="italic" id="Thmproof1.p1.8.8.m8.1.2.1" xref="Thmproof1.p1.8.8.m8.1.2.1.cmml">⁢</mo><mrow id="Thmproof1.p1.8.8.m8.1.2.3.2" xref="Thmproof1.p1.8.8.m8.1.2.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.8.8.m8.1.2.3.2.1" xref="Thmproof1.p1.8.8.m8.1.2.cmml">(</mo><mi id="Thmproof1.p1.8.8.m8.1.1" xref="Thmproof1.p1.8.8.m8.1.1.cmml">x</mi><mo mathvariant="normal" stretchy="false" id="Thmproof1.p1.8.8.m8.1.2.3.2.2" xref="Thmproof1.p1.8.8.m8.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof1.p1.9.9.w1"/><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w2">is</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w3">a</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w4">spanning</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w5">tree</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w6">reflecting</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w7">the</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w8">true</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w9">parse</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w10">tree,</span><span> </span><span class="gd_word" id="Thmproof1.p1.9.9.w11">then</span><span> </span><math id="Thmproof1.p1.9.9.m9.1" class="ltx_Math" alttext="y_{x}^{\prime}=y_{x}" display="inline"><semantics id="Thmproof1.p1.9.9.m9.1a"><mrow id="Thmproof1.p1.9.9.m9.1.1" xref="Thmproof1.p1.9.9.m9.1.1.cmml"><msubsup id="Thmproof1.p1.9.9.m9.1.1.2" xref="Thmproof1.p1.9.9.m9.1.1.2.cmml"><mi id="Thmproof1.p1.9.9.m9.1.1.2.2.2" xref="Thmproof1.p1.9.9.m9.1.1.2.2.2.cmml">y</mi><mi id="Thmproof1.p1.9.9.m9.1.1.2.2.3" xref="Thmproof1.p1.9.9.m9.1.1.2.2.3.cmml">x</mi><mo mathvariant="normal" id="Thmproof1.p1.9.9.m9.1.1.2.3" xref="Thmproof1.p1.9.9.m9.1.1.2.3.cmml">′</mo></msubsup><mo mathvariant="normal" id="Thmproof1.p1.9.9.m9.1.1.1" xref="Thmproof1.p1.9.9.m9.1.1.1.cmml">=</mo><msub id="Thmproof1.p1.9.9.m9.1.1.3" xref="Thmproof1.p1.9.9.m9.1.1.3.cmml"><mi id="Thmproof1.p1.9.9.m9.1.1.3.2" xref="Thmproof1.p1.9.9.m9.1.1.3.2.cmml">y</mi><mi id="Thmproof1.p1.9.9.m9.1.1.3.3" xref="Thmproof1.p1.9.9.m9.1.1.3.3.cmml">x</mi></msub></mrow></semantics></math><span class="gd_word" id="Thmproof1.p1.9.10.w1">.</span></p>
</div>
</div>
<div id="S7.SS1.p3" class="ltx_para ltx_noindent">
<p id="S7.SS1.p3.11" class="ltx_p"><span class="gd_word" id="S7.SS1.p3.11.1.w1">For</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w2">requirement</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w3">(2),</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w4">we</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w5">can</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w6">prove</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w7">it</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w8">by</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w9">exploiting</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w10">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w11">fact</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w12">that</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w13">in</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w14">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w15">definition</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.1.w16">of</span><span> </span><math id="S7.SS1.p3.1.m1.4" class="ltx_Math" alttext="\mathcal{T}(X)\overset{\Delta}{=}(\mathcal{L},\mathcal{N},\mathcal{R})" display="inline"><semantics id="S7.SS1.p3.1.m1.4a"><mrow id="S7.SS1.p3.1.m1.4.5" xref="S7.SS1.p3.1.m1.4.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.1.m1.4.5.2" xref="S7.SS1.p3.1.m1.4.5.2.cmml">𝒯</mi><mo id="S7.SS1.p3.1.m1.4.5.1" xref="S7.SS1.p3.1.m1.4.5.1.cmml">⁢</mo><mrow id="S7.SS1.p3.1.m1.4.5.3.2" xref="S7.SS1.p3.1.m1.4.5.cmml"><mo stretchy="false" id="S7.SS1.p3.1.m1.4.5.3.2.1" xref="S7.SS1.p3.1.m1.4.5.cmml">(</mo><mi id="S7.SS1.p3.1.m1.1.1" xref="S7.SS1.p3.1.m1.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p3.1.m1.4.5.3.2.2" xref="S7.SS1.p3.1.m1.4.5.cmml">)</mo></mrow><mo id="S7.SS1.p3.1.m1.4.5.1a" xref="S7.SS1.p3.1.m1.4.5.1.cmml">⁢</mo><mover accent="true" id="S7.SS1.p3.1.m1.4.5.4" xref="S7.SS1.p3.1.m1.4.5.4.cmml"><mo id="S7.SS1.p3.1.m1.4.5.4.2" xref="S7.SS1.p3.1.m1.4.5.4.2.cmml">=</mo><mo id="S7.SS1.p3.1.m1.4.5.4.1" xref="S7.SS1.p3.1.m1.4.5.4.1.cmml">Δ</mo></mover><mo id="S7.SS1.p3.1.m1.4.5.1b" xref="S7.SS1.p3.1.m1.4.5.1.cmml">⁢</mo><mrow id="S7.SS1.p3.1.m1.4.5.5.2" xref="S7.SS1.p3.1.m1.4.5.5.1.cmml"><mo stretchy="false" id="S7.SS1.p3.1.m1.4.5.5.2.1" xref="S7.SS1.p3.1.m1.4.5.5.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.1.m1.2.2" xref="S7.SS1.p3.1.m1.2.2.cmml">ℒ</mi><mo id="S7.SS1.p3.1.m1.4.5.5.2.2" xref="S7.SS1.p3.1.m1.4.5.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.1.m1.3.3" xref="S7.SS1.p3.1.m1.3.3.cmml">𝒩</mi><mo id="S7.SS1.p3.1.m1.4.5.5.2.3" xref="S7.SS1.p3.1.m1.4.5.5.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.1.m1.4.4" xref="S7.SS1.p3.1.m1.4.4.cmml">ℛ</mi><mo stretchy="false" id="S7.SS1.p3.1.m1.4.5.5.2.4" xref="S7.SS1.p3.1.m1.4.5.5.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p3.11.2.w1">,</span><span> </span><math id="S7.SS1.p3.2.m2.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S7.SS1.p3.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.2.m2.1.1" xref="S7.SS1.p3.2.m2.1.1.cmml">ℒ</mi></semantics></math><span class="gd_word" id="S7.SS1.p3.11.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w2">is</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w3">ordered</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w4">according</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w5">to</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w6">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w7">original</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w8">word</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w9">order</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w10">in</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w11">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w12">text.</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w13">Generally</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w14">speaking,</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w15">if</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w16">a</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w17">nonterminal</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.3.w18">node</span><span> </span><math id="S7.SS1.p3.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p3.3.m3.1a"><mi id="S7.SS1.p3.3.m3.1.1" xref="S7.SS1.p3.3.m3.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p3.11.4.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.4.w2">has</span><span> </span><math id="S7.SS1.p3.4.m4.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S7.SS1.p3.4.m4.1a"><mi id="S7.SS1.p3.4.m4.1.1" xref="S7.SS1.p3.4.m4.1.1.cmml">t</mi></semantics></math><span class="gd_word" id="S7.SS1.p3.11.5.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.5.w2">children</span><span> </span><math id="S7.SS1.p3.5.m5.3" class="ltx_Math" alttext="(c^{1},...,c^{t})" display="inline"><semantics id="S7.SS1.p3.5.m5.3a"><mrow id="S7.SS1.p3.5.m5.3.3.2" xref="S7.SS1.p3.5.m5.3.3.3.cmml"><mo stretchy="false" id="S7.SS1.p3.5.m5.3.3.2.3" xref="S7.SS1.p3.5.m5.3.3.3.cmml">(</mo><msup id="S7.SS1.p3.5.m5.2.2.1.1" xref="S7.SS1.p3.5.m5.2.2.1.1.cmml"><mi id="S7.SS1.p3.5.m5.2.2.1.1.2" xref="S7.SS1.p3.5.m5.2.2.1.1.2.cmml">c</mi><mn id="S7.SS1.p3.5.m5.2.2.1.1.3" xref="S7.SS1.p3.5.m5.2.2.1.1.3.cmml">1</mn></msup><mo id="S7.SS1.p3.5.m5.3.3.2.4" xref="S7.SS1.p3.5.m5.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S7.SS1.p3.5.m5.1.1" xref="S7.SS1.p3.5.m5.1.1.cmml">…</mi><mo id="S7.SS1.p3.5.m5.3.3.2.5" xref="S7.SS1.p3.5.m5.3.3.3.cmml">,</mo><msup id="S7.SS1.p3.5.m5.3.3.2.2" xref="S7.SS1.p3.5.m5.3.3.2.2.cmml"><mi id="S7.SS1.p3.5.m5.3.3.2.2.2" xref="S7.SS1.p3.5.m5.3.3.2.2.2.cmml">c</mi><mi id="S7.SS1.p3.5.m5.3.3.2.2.3" xref="S7.SS1.p3.5.m5.3.3.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="S7.SS1.p3.5.m5.3.3.2.6" xref="S7.SS1.p3.5.m5.3.3.3.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S7.SS1.p3.11.6.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.6.w2">each</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.6.w3">child</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.6.w4">node</span><span> </span><math id="S7.SS1.p3.6.m6.1" class="ltx_Math" alttext="c^{k}" display="inline"><semantics id="S7.SS1.p3.6.m6.1a"><msup id="S7.SS1.p3.6.m6.1.1" xref="S7.SS1.p3.6.m6.1.1.cmml"><mi id="S7.SS1.p3.6.m6.1.1.2" xref="S7.SS1.p3.6.m6.1.1.2.cmml">c</mi><mi id="S7.SS1.p3.6.m6.1.1.3" xref="S7.SS1.p3.6.m6.1.1.3.cmml">k</mi></msup></semantics></math><span class="gd_word" id="S7.SS1.p3.11.7.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w2">heads</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w3">(or</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w4">bears)</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w5">its</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w6">own</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.7.w7">subtree</span><span> </span><math id="S7.SS1.p3.7.m7.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})" display="inline"><semantics id="S7.SS1.p3.7.m7.1a"><mrow id="S7.SS1.p3.7.m7.1.1" xref="S7.SS1.p3.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.7.m7.1.1.3" xref="S7.SS1.p3.7.m7.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p3.7.m7.1.1.2" xref="S7.SS1.p3.7.m7.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p3.7.m7.1.1.1.1" xref="S7.SS1.p3.7.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p3.7.m7.1.1.1.1.2" xref="S7.SS1.p3.7.m7.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p3.7.m7.1.1.1.1.1" xref="S7.SS1.p3.7.m7.1.1.1.1.1.cmml"><mi id="S7.SS1.p3.7.m7.1.1.1.1.1.2" xref="S7.SS1.p3.7.m7.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p3.7.m7.1.1.1.1.1.3" xref="S7.SS1.p3.7.m7.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p3.7.m7.1.1.1.1.3" xref="S7.SS1.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p3.11.8.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.8.w2">which</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.8.w3">includes</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.8.w4">certain</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.8.w5">leaves</span><span> </span><math id="S7.SS1.p3.8.m8.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="S7.SS1.p3.8.m8.1a"><mrow id="S7.SS1.p3.8.m8.1.1" xref="S7.SS1.p3.8.m8.1.1.cmml"><mrow id="S7.SS1.p3.8.m8.1.1.1" xref="S7.SS1.p3.8.m8.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.8.m8.1.1.1.3" xref="S7.SS1.p3.8.m8.1.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p3.8.m8.1.1.1.2" xref="S7.SS1.p3.8.m8.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p3.8.m8.1.1.1.1.1" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p3.8.m8.1.1.1.1.1.2" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p3.8.m8.1.1.1.1.1.1" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p3.8.m8.1.1.1.1.1.1.2" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p3.8.m8.1.1.1.1.1.1.3" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p3.8.m8.1.1.1.1.1.3" xref="S7.SS1.p3.8.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p3.8.m8.1.1.2" xref="S7.SS1.p3.8.m8.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.8.m8.1.1.3" xref="S7.SS1.p3.8.m8.1.1.3.cmml">ℒ</mi></mrow></semantics></math><span class="gd_word" id="S7.SS1.p3.11.9.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.9.w2">Then,</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.9.w3">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.9.w4">order</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.9.w5">of</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.9.w6">leaves</span><span> </span><math id="S7.SS1.p3.9.m9.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S7.SS1.p3.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.9.m9.1.1" xref="S7.SS1.p3.9.m9.1.1.cmml">ℒ</mi></semantics></math><span class="gd_word" id="S7.SS1.p3.11.10.w1"/><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w2">indicates</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w3">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w4">order</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w5">of</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w6">different</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w7">leaf</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.10.w8">sets</span><span> </span><math id="S7.SS1.p3.10.m10.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="S7.SS1.p3.10.m10.1a"><mrow id="S7.SS1.p3.10.m10.1.1" xref="S7.SS1.p3.10.m10.1.1.cmml"><mrow id="S7.SS1.p3.10.m10.1.1.1" xref="S7.SS1.p3.10.m10.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.10.m10.1.1.1.3" xref="S7.SS1.p3.10.m10.1.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p3.10.m10.1.1.1.2" xref="S7.SS1.p3.10.m10.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p3.10.m10.1.1.1.1.1" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p3.10.m10.1.1.1.1.1.2" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p3.10.m10.1.1.1.1.1.1" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p3.10.m10.1.1.1.1.1.1.2" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p3.10.m10.1.1.1.1.1.1.3" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p3.10.m10.1.1.1.1.1.3" xref="S7.SS1.p3.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p3.10.m10.1.1.2" xref="S7.SS1.p3.10.m10.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p3.10.m10.1.1.3" xref="S7.SS1.p3.10.m10.1.1.3.cmml">ℒ</mi></mrow></semantics></math><span class="gd_word" id="S7.SS1.p3.11.11.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w2">which</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w3">in</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w4">turn</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w5">indicates</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w6">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w7">sibling</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w8">order</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w9">of</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w10">the</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w11">children</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w12">of</span><span> </span><span class="gd_word" id="S7.SS1.p3.11.11.w13">node</span><span> </span><math id="S7.SS1.p3.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p3.11.m11.1a"><mi id="S7.SS1.p3.11.m11.1.1" xref="S7.SS1.p3.11.m11.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p3.11.12.w1">.</span></p>
</div>
<div id="S7.SS1.p4" class="ltx_para ltx_noindent">
<p id="S7.SS1.p4.9" class="ltx_p"><span class="gd_word" id="S7.SS1.p4.9.1.w1">Formally,</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.1.w2">let</span><span> </span><math id="S7.SS1.p4.1.m1.3" class="ltx_Math" alttext="\mathcal{L}=(l_{1},...,l_{n})" display="inline"><semantics id="S7.SS1.p4.1.m1.3a"><mrow id="S7.SS1.p4.1.m1.3.3" xref="S7.SS1.p4.1.m1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p4.1.m1.3.3.4" xref="S7.SS1.p4.1.m1.3.3.4.cmml">ℒ</mi><mo id="S7.SS1.p4.1.m1.3.3.3" xref="S7.SS1.p4.1.m1.3.3.3.cmml">=</mo><mrow id="S7.SS1.p4.1.m1.3.3.2.2" xref="S7.SS1.p4.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S7.SS1.p4.1.m1.3.3.2.2.3" xref="S7.SS1.p4.1.m1.3.3.2.3.cmml">(</mo><msub id="S7.SS1.p4.1.m1.2.2.1.1.1" xref="S7.SS1.p4.1.m1.2.2.1.1.1.cmml"><mi id="S7.SS1.p4.1.m1.2.2.1.1.1.2" xref="S7.SS1.p4.1.m1.2.2.1.1.1.2.cmml">l</mi><mn id="S7.SS1.p4.1.m1.2.2.1.1.1.3" xref="S7.SS1.p4.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S7.SS1.p4.1.m1.3.3.2.2.4" xref="S7.SS1.p4.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S7.SS1.p4.1.m1.1.1" xref="S7.SS1.p4.1.m1.1.1.cmml">…</mi><mo id="S7.SS1.p4.1.m1.3.3.2.2.5" xref="S7.SS1.p4.1.m1.3.3.2.3.cmml">,</mo><msub id="S7.SS1.p4.1.m1.3.3.2.2.2" xref="S7.SS1.p4.1.m1.3.3.2.2.2.cmml"><mi id="S7.SS1.p4.1.m1.3.3.2.2.2.2" xref="S7.SS1.p4.1.m1.3.3.2.2.2.2.cmml">l</mi><mi id="S7.SS1.p4.1.m1.3.3.2.2.2.3" xref="S7.SS1.p4.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S7.SS1.p4.1.m1.3.3.2.2.6" xref="S7.SS1.p4.1.m1.3.3.2.3.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p4.9.2.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.2.w2">where</span><span> </span><math id="S7.SS1.p4.2.m2.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S7.SS1.p4.2.m2.1a"><msub id="S7.SS1.p4.2.m2.1.1" xref="S7.SS1.p4.2.m2.1.1.cmml"><mi id="S7.SS1.p4.2.m2.1.1.2" xref="S7.SS1.p4.2.m2.1.1.2.cmml">l</mi><mi id="S7.SS1.p4.2.m2.1.1.3" xref="S7.SS1.p4.2.m2.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S7.SS1.p4.9.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.3.w2">is</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.3.w3">the</span><span> </span><math id="S7.SS1.p4.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S7.SS1.p4.3.m3.1a"><mi id="S7.SS1.p4.3.m3.1.1" xref="S7.SS1.p4.3.m3.1.1.cmml">i</mi></semantics></math><span class="gd_word" id="S7.SS1.p4.9.4.w1">-th</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w2">word</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w3">in</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w4">the</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w5">input</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w6">text,</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.4.w7">and</span><span> </span><math id="S7.SS1.p4.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S7.SS1.p4.4.m4.1a"><mi id="S7.SS1.p4.4.m4.1.1" xref="S7.SS1.p4.4.m4.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S7.SS1.p4.9.5.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w2">is</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w3">an</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w4">arbitrary</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w5">nonterminal</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w6">node</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w7">whose</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w8">children</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.5.w9">are</span><span> </span><math id="S7.SS1.p4.5.m5.3" class="ltx_Math" alttext="(c^{1},...,c^{t})" display="inline"><semantics id="S7.SS1.p4.5.m5.3a"><mrow id="S7.SS1.p4.5.m5.3.3.2" xref="S7.SS1.p4.5.m5.3.3.3.cmml"><mo stretchy="false" id="S7.SS1.p4.5.m5.3.3.2.3" xref="S7.SS1.p4.5.m5.3.3.3.cmml">(</mo><msup id="S7.SS1.p4.5.m5.2.2.1.1" xref="S7.SS1.p4.5.m5.2.2.1.1.cmml"><mi id="S7.SS1.p4.5.m5.2.2.1.1.2" xref="S7.SS1.p4.5.m5.2.2.1.1.2.cmml">c</mi><mn id="S7.SS1.p4.5.m5.2.2.1.1.3" xref="S7.SS1.p4.5.m5.2.2.1.1.3.cmml">1</mn></msup><mo id="S7.SS1.p4.5.m5.3.3.2.4" xref="S7.SS1.p4.5.m5.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S7.SS1.p4.5.m5.1.1" xref="S7.SS1.p4.5.m5.1.1.cmml">…</mi><mo id="S7.SS1.p4.5.m5.3.3.2.5" xref="S7.SS1.p4.5.m5.3.3.3.cmml">,</mo><msup id="S7.SS1.p4.5.m5.3.3.2.2" xref="S7.SS1.p4.5.m5.3.3.2.2.cmml"><mi id="S7.SS1.p4.5.m5.3.3.2.2.2" xref="S7.SS1.p4.5.m5.3.3.2.2.2.cmml">c</mi><mi id="S7.SS1.p4.5.m5.3.3.2.2.3" xref="S7.SS1.p4.5.m5.3.3.2.2.3.cmml">t</mi></msup><mo stretchy="false" id="S7.SS1.p4.5.m5.3.3.2.6" xref="S7.SS1.p4.5.m5.3.3.3.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S7.SS1.p4.9.6.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.6.w2">(for</span><span> </span><math id="S7.SS1.p4.6.m6.1" class="ltx_Math" alttext="t&gt;1" display="inline"><semantics id="S7.SS1.p4.6.m6.1a"><mrow id="S7.SS1.p4.6.m6.1.1" xref="S7.SS1.p4.6.m6.1.1.cmml"><mi id="S7.SS1.p4.6.m6.1.1.2" xref="S7.SS1.p4.6.m6.1.1.2.cmml">t</mi><mo id="S7.SS1.p4.6.m6.1.1.1" xref="S7.SS1.p4.6.m6.1.1.1.cmml">&gt;</mo><mn id="S7.SS1.p4.6.m6.1.1.3" xref="S7.SS1.p4.6.m6.1.1.3.cmml">1</mn></mrow></semantics></math><span class="gd_word" id="S7.SS1.p4.9.7.w1">)</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w2">with</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w3">any</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w4">two</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w5">of</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w6">them</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.7.w7">being</span><span> </span><math id="S7.SS1.p4.7.m7.1" class="ltx_Math" alttext="c^{k}" display="inline"><semantics id="S7.SS1.p4.7.m7.1a"><msup id="S7.SS1.p4.7.m7.1.1" xref="S7.SS1.p4.7.m7.1.1.cmml"><mi id="S7.SS1.p4.7.m7.1.1.2" xref="S7.SS1.p4.7.m7.1.1.2.cmml">c</mi><mi id="S7.SS1.p4.7.m7.1.1.3" xref="S7.SS1.p4.7.m7.1.1.3.cmml">k</mi></msup></semantics></math><span class="gd_word" id="S7.SS1.p4.9.8.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.8.w2">and</span><span> </span><math id="S7.SS1.p4.8.m8.1" class="ltx_Math" alttext="c^{k^{\prime}}" display="inline"><semantics id="S7.SS1.p4.8.m8.1a"><msup id="S7.SS1.p4.8.m8.1.1" xref="S7.SS1.p4.8.m8.1.1.cmml"><mi id="S7.SS1.p4.8.m8.1.1.2" xref="S7.SS1.p4.8.m8.1.1.2.cmml">c</mi><msup id="S7.SS1.p4.8.m8.1.1.3" xref="S7.SS1.p4.8.m8.1.1.3.cmml"><mi id="S7.SS1.p4.8.m8.1.1.3.2" xref="S7.SS1.p4.8.m8.1.1.3.2.cmml">k</mi><mo id="S7.SS1.p4.8.m8.1.1.3.3" xref="S7.SS1.p4.8.m8.1.1.3.3.cmml">′</mo></msup></msup></semantics></math><span class="gd_word" id="S7.SS1.p4.9.9.w1"/><span> </span><span class="gd_word" id="S7.SS1.p4.9.9.w2">(</span><math id="S7.SS1.p4.9.m9.1" class="ltx_Math" alttext="c^{k}\neq c^{k^{\prime}}" display="inline"><semantics id="S7.SS1.p4.9.m9.1a"><mrow id="S7.SS1.p4.9.m9.1.1" xref="S7.SS1.p4.9.m9.1.1.cmml"><msup id="S7.SS1.p4.9.m9.1.1.2" xref="S7.SS1.p4.9.m9.1.1.2.cmml"><mi id="S7.SS1.p4.9.m9.1.1.2.2" xref="S7.SS1.p4.9.m9.1.1.2.2.cmml">c</mi><mi id="S7.SS1.p4.9.m9.1.1.2.3" xref="S7.SS1.p4.9.m9.1.1.2.3.cmml">k</mi></msup><mo id="S7.SS1.p4.9.m9.1.1.1" xref="S7.SS1.p4.9.m9.1.1.1.cmml">≠</mo><msup id="S7.SS1.p4.9.m9.1.1.3" xref="S7.SS1.p4.9.m9.1.1.3.cmml"><mi id="S7.SS1.p4.9.m9.1.1.3.2" xref="S7.SS1.p4.9.m9.1.1.3.2.cmml">c</mi><msup id="S7.SS1.p4.9.m9.1.1.3.3" xref="S7.SS1.p4.9.m9.1.1.3.3.cmml"><mi id="S7.SS1.p4.9.m9.1.1.3.3.2" xref="S7.SS1.p4.9.m9.1.1.3.3.2.cmml">k</mi><mo id="S7.SS1.p4.9.m9.1.1.3.3.3" xref="S7.SS1.p4.9.m9.1.1.3.3.3.cmml">′</mo></msup></msup></mrow></semantics></math><span class="gd_word" id="S7.SS1.p4.9.10.w1">),</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.10.w2">then</span><span> </span><span class="gd_word" id="S7.SS1.p4.9.10.w3">either:</span></p>
</div>
<div id="S7.SS1.p5" class="ltx_para ltx_noindent">
<table id="S7.E26" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E26.m1.1" class="ltx_Math" alttext="\left\{\begin{array}[]{ll}(i&lt;j\mbox{ }\forall l_{i}\in\mathcal{R}(c^{k})\cap%&#10;\mathcal{L}\mbox{ and }\forall l_{j}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal%&#10;{L})\mbox{ or }\\&#10;(i&gt;j\mbox{ }\forall l_{i}\in\mathcal{R}(c^{k})\cap\mathcal{L}\mbox{ and }%&#10;\forall l_{j}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal{L})\end{array}\right." display="block"><semantics id="S7.E26.m1.1a"><mrow id="S7.E26.m1.1.2.2" xref="S7.E26.m1.1.2.1.cmml"><mo id="S7.E26.m1.1.2.2.1" xref="S7.E26.m1.1.2.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt" id="S7.E26.m1.1.1" xref="S7.E26.m1.1.1.cmml"><mtr id="S7.E26.m1.1.1a" xref="S7.E26.m1.1.1.cmml"><mtd columnalign="left" id="S7.E26.m1.1.1b" xref="S7.E26.m1.1.1.cmml"><mrow id="S7.E26.m1.1.1.2.1.1" xref="S7.E26.m1.1.1.2.1.1.cmml"><mrow id="S7.E26.m1.1.1.2.1.1.1" xref="S7.E26.m1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.1" xref="S7.E26.m1.1.1.2.1.1.1.1.cmml">(</mo><mi id="S7.E26.m1.1.1.2.1.1.1.2" xref="S7.E26.m1.1.1.2.1.1.1.2.cmml">i</mi><mo id="S7.E26.m1.1.1.2.1.1.1.3" xref="S7.E26.m1.1.1.2.1.1.1.3.cmml">&lt;</mo><mi id="S7.E26.m1.1.1.2.1.1.1.4" xref="S7.E26.m1.1.1.2.1.1.1.4.cmml">j</mi><mtext id="S7.E26.m1.1.1.2.1.1.1.5" xref="S7.E26.m1.1.1.2.1.1.1.5a.cmml"> </mtext><mo id="S7.E26.m1.1.1.2.1.1.1.6" xref="S7.E26.m1.1.1.2.1.1.1.6.cmml">∀</mo><msub id="S7.E26.m1.1.1.2.1.1.1.7" xref="S7.E26.m1.1.1.2.1.1.1.7.cmml"><mi id="S7.E26.m1.1.1.2.1.1.1.7.2" xref="S7.E26.m1.1.1.2.1.1.1.7.2.cmml">l</mi><mi id="S7.E26.m1.1.1.2.1.1.1.7.3" xref="S7.E26.m1.1.1.2.1.1.1.7.3.cmml">i</mi></msub><mo id="S7.E26.m1.1.1.2.1.1.1.8" xref="S7.E26.m1.1.1.2.1.1.1.8.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.2.1.1.1.9" xref="S7.E26.m1.1.1.2.1.1.1.9.cmml">ℛ</mi><mrow id="S7.E26.m1.1.1.2.1.1.1.10" xref="S7.E26.m1.1.1.2.1.1.1.10.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.10.1" xref="S7.E26.m1.1.1.2.1.1.1.10.1.cmml">(</mo><msup id="S7.E26.m1.1.1.2.1.1.1.10.2" xref="S7.E26.m1.1.1.2.1.1.1.10.2.cmml"><mi id="S7.E26.m1.1.1.2.1.1.1.10.2.2" xref="S7.E26.m1.1.1.2.1.1.1.10.2.2.cmml">c</mi><mi id="S7.E26.m1.1.1.2.1.1.1.10.2.3" xref="S7.E26.m1.1.1.2.1.1.1.10.2.3.cmml">k</mi></msup><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.10.3" xref="S7.E26.m1.1.1.2.1.1.1.10.3.cmml">)</mo></mrow><mo id="S7.E26.m1.1.1.2.1.1.1.11" xref="S7.E26.m1.1.1.2.1.1.1.11.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.2.1.1.1.12" xref="S7.E26.m1.1.1.2.1.1.1.12.cmml">ℒ</mi><mtext id="S7.E26.m1.1.1.2.1.1.1.13" xref="S7.E26.m1.1.1.2.1.1.1.13a.cmml"> and </mtext><mo id="S7.E26.m1.1.1.2.1.1.1.14" xref="S7.E26.m1.1.1.2.1.1.1.14.cmml">∀</mo><msub id="S7.E26.m1.1.1.2.1.1.1.15" xref="S7.E26.m1.1.1.2.1.1.1.15.cmml"><mi id="S7.E26.m1.1.1.2.1.1.1.15.2" xref="S7.E26.m1.1.1.2.1.1.1.15.2.cmml">l</mi><mi id="S7.E26.m1.1.1.2.1.1.1.15.3" xref="S7.E26.m1.1.1.2.1.1.1.15.3.cmml">j</mi></msub><mo id="S7.E26.m1.1.1.2.1.1.1.16" xref="S7.E26.m1.1.1.2.1.1.1.16.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.2.1.1.1.17" xref="S7.E26.m1.1.1.2.1.1.1.17.cmml">ℛ</mi><mrow id="S7.E26.m1.1.1.2.1.1.1.18" xref="S7.E26.m1.1.1.2.1.1.1.18.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.18.1" xref="S7.E26.m1.1.1.2.1.1.1.18.1.cmml">(</mo><msup id="S7.E26.m1.1.1.2.1.1.1.18.2" xref="S7.E26.m1.1.1.2.1.1.1.18.2.cmml"><mi id="S7.E26.m1.1.1.2.1.1.1.18.2.2" xref="S7.E26.m1.1.1.2.1.1.1.18.2.2.cmml">c</mi><msup id="S7.E26.m1.1.1.2.1.1.1.18.2.3" xref="S7.E26.m1.1.1.2.1.1.1.18.2.3.cmml"><mi id="S7.E26.m1.1.1.2.1.1.1.18.2.3.2" xref="S7.E26.m1.1.1.2.1.1.1.18.2.3.2.cmml">k</mi><mo id="S7.E26.m1.1.1.2.1.1.1.18.2.3.3" xref="S7.E26.m1.1.1.2.1.1.1.18.2.3.3.cmml">′</mo></msup></msup><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.18.3" xref="S7.E26.m1.1.1.2.1.1.1.18.3.cmml">)</mo></mrow><mo id="S7.E26.m1.1.1.2.1.1.1.19" xref="S7.E26.m1.1.1.2.1.1.1.19.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.2.1.1.1.20" xref="S7.E26.m1.1.1.2.1.1.1.20.cmml">ℒ</mi><mo stretchy="false" id="S7.E26.m1.1.1.2.1.1.1.21" xref="S7.E26.m1.1.1.2.1.1.1.21.cmml">)</mo></mrow><mtext id="S7.E26.m1.1.1.2.1.1.2" xref="S7.E26.m1.1.1.2.1.1.2a.cmml"> or </mtext></mrow></mtd><mtd id="S7.E26.m1.1.1c" xref="S7.E26.m1.1.1.cmml"/></mtr><mtr id="S7.E26.m1.1.1d" xref="S7.E26.m1.1.1.cmml"><mtd columnalign="left" id="S7.E26.m1.1.1e" xref="S7.E26.m1.1.1.cmml"><mrow id="S7.E26.m1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.4" xref="S7.E26.m1.1.1.1.1.1.1.1.4.cmml">i</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.5" xref="S7.E26.m1.1.1.1.1.1.1.1.5.cmml">&gt;</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.6" xref="S7.E26.m1.1.1.1.1.1.1.1.6.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.6.2" xref="S7.E26.m1.1.1.1.1.1.1.1.6.2.cmml">j</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.6.1" xref="S7.E26.m1.1.1.1.1.1.1.1.6.1.cmml">⁢</mo><mtext id="S7.E26.m1.1.1.1.1.1.1.1.6.3" xref="S7.E26.m1.1.1.1.1.1.1.1.6.3a.cmml"> </mtext><mo id="S7.E26.m1.1.1.1.1.1.1.1.6.1a" xref="S7.E26.m1.1.1.1.1.1.1.1.6.1.cmml">⁢</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.6.4" xref="S7.E26.m1.1.1.1.1.1.1.1.6.4.cmml"><mo id="S7.E26.m1.1.1.1.1.1.1.1.6.4.1" xref="S7.E26.m1.1.1.1.1.1.1.1.6.4.1.cmml">∀</mo><msub id="S7.E26.m1.1.1.1.1.1.1.1.6.4.2" xref="S7.E26.m1.1.1.1.1.1.1.1.6.4.2.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.6.4.2.2" xref="S7.E26.m1.1.1.1.1.1.1.1.6.4.2.2.cmml">l</mi><mi id="S7.E26.m1.1.1.1.1.1.1.1.6.4.2.3" xref="S7.E26.m1.1.1.1.1.1.1.1.6.4.2.3.cmml">i</mi></msub></mrow></mrow><mo id="S7.E26.m1.1.1.1.1.1.1.1.7" xref="S7.E26.m1.1.1.1.1.1.1.1.7.cmml">∈</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S7.E26.m1.1.1.1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.1.1.1.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.3.cmml">ℛ</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E26.m1.1.1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.2.cmml">∩</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.1.1.1.1.1.1.3.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.2.cmml">ℒ</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.1.3.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mtext id="S7.E26.m1.1.1.1.1.1.1.1.1.3.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.3a.cmml"> and </mtext><mo id="S7.E26.m1.1.1.1.1.1.1.1.1.3.1a" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.1.3.4" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.cmml"><mo id="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.1" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.1.cmml">∀</mo><msub id="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2.2" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2.2.cmml">l</mi><mi id="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2.3" xref="S7.E26.m1.1.1.1.1.1.1.1.1.3.4.2.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S7.E26.m1.1.1.1.1.1.1.1.8" xref="S7.E26.m1.1.1.1.1.1.1.1.8.cmml">∈</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S7.E26.m1.1.1.1.1.1.1.1.2.1" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.1.1.1.1.1.2.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.3.cmml">ℛ</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.2.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.2.cmml">⁢</mo><mrow id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">(</mo><msup id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">c</mi><msup id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">k</mi><mo id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E26.m1.1.1.1.1.1.1.1.2.2" xref="S7.E26.m1.1.1.1.1.1.1.1.2.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.E26.m1.1.1.1.1.1.1.1.2.3" xref="S7.E26.m1.1.1.1.1.1.1.1.2.3.cmml">ℒ</mi></mrow></mrow><mo stretchy="false" id="S7.E26.m1.1.1.1.1.1.1.3" xref="S7.E26.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mtd><mtd id="S7.E26.m1.1.1f" xref="S7.E26.m1.1.1.cmml"/></mtr></mtable><mi id="S7.E26.m1.1.2.2.2" xref="S7.E26.m1.1.2.1.1.cmml"/></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr>
</table>
</div>
<div id="S7.SS1.p6" class="ltx_para ltx_noindent">
<p id="S7.SS1.p6.1" class="ltx_p"><span class="gd_word" id="S7.SS1.p6.1.1.w1">We</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w2">proceed</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w3">to</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w4">prove</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w5">the</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w6">first</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w7">clause</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w8">in</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.1.w9">Equation</span><span> </span><a href="#S7.E26" title="(26) ‣ 7.1 Proof for proposition 1 ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">26</a><span class="gd_word" id="S7.SS1.p6.1.2.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w2">while</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w3">the</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w4">second</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w5">clause</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w6">can</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w7">be</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w8">similarly</span><span> </span><span class="gd_word" id="S7.SS1.p6.1.2.w9">inferred.</span></p>
</div>
<div id="S7.SS1.p7" class="ltx_para ltx_noindent">
<p id="S7.SS1.p7.6" class="ltx_p"><span class="gd_word" id="S7.SS1.p7.6.1.w1">Specifically,</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.1.w2">the</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.1.w3">first</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.1.w4">clause</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.1.w5">in</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.1.w6">Equation</span><span> </span><a href="#S7.E26" title="(26) ‣ 7.1 Proof for proposition 1 ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">26</a><span class="gd_word" id="S7.SS1.p7.6.2.w1"/><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w2">implies</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w3">that</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w4">if</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w5">there</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w6">exists</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w7">a</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.2.w8">leaf</span><span> </span><math id="S7.SS1.p7.1.m1.1" class="ltx_Math" alttext="l_{i^{\prime}}\in\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="S7.SS1.p7.1.m1.1a"><mrow id="S7.SS1.p7.1.m1.1.1" xref="S7.SS1.p7.1.m1.1.1.cmml"><msub id="S7.SS1.p7.1.m1.1.1.3" xref="S7.SS1.p7.1.m1.1.1.3.cmml"><mi id="S7.SS1.p7.1.m1.1.1.3.2" xref="S7.SS1.p7.1.m1.1.1.3.2.cmml">l</mi><msup id="S7.SS1.p7.1.m1.1.1.3.3" xref="S7.SS1.p7.1.m1.1.1.3.3.cmml"><mi id="S7.SS1.p7.1.m1.1.1.3.3.2" xref="S7.SS1.p7.1.m1.1.1.3.3.2.cmml">i</mi><mo id="S7.SS1.p7.1.m1.1.1.3.3.3" xref="S7.SS1.p7.1.m1.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S7.SS1.p7.1.m1.1.1.2" xref="S7.SS1.p7.1.m1.1.1.2.cmml">∈</mo><mrow id="S7.SS1.p7.1.m1.1.1.1" xref="S7.SS1.p7.1.m1.1.1.1.cmml"><mrow id="S7.SS1.p7.1.m1.1.1.1.1" xref="S7.SS1.p7.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.1.m1.1.1.1.1.3" xref="S7.SS1.p7.1.m1.1.1.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.1.m1.1.1.1.1.2" xref="S7.SS1.p7.1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.1.m1.1.1.1.1.1.1" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.1.m1.1.1.1.1.1.1.2" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.1.m1.1.1.1.1.1.1.1" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.2" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.3" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p7.1.m1.1.1.1.1.1.1.3" xref="S7.SS1.p7.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p7.1.m1.1.1.1.2" xref="S7.SS1.p7.1.m1.1.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.1.m1.1.1.1.3" xref="S7.SS1.p7.1.m1.1.1.1.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p7.6.3.w2">and</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.3.w3">a</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.3.w4">leaf</span><span> </span><math id="S7.SS1.p7.2.m2.1" class="ltx_Math" alttext="l_{j^{\prime}}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal{L}" display="inline"><semantics id="S7.SS1.p7.2.m2.1a"><mrow id="S7.SS1.p7.2.m2.1.1" xref="S7.SS1.p7.2.m2.1.1.cmml"><msub id="S7.SS1.p7.2.m2.1.1.3" xref="S7.SS1.p7.2.m2.1.1.3.cmml"><mi id="S7.SS1.p7.2.m2.1.1.3.2" xref="S7.SS1.p7.2.m2.1.1.3.2.cmml">l</mi><msup id="S7.SS1.p7.2.m2.1.1.3.3" xref="S7.SS1.p7.2.m2.1.1.3.3.cmml"><mi id="S7.SS1.p7.2.m2.1.1.3.3.2" xref="S7.SS1.p7.2.m2.1.1.3.3.2.cmml">j</mi><mo id="S7.SS1.p7.2.m2.1.1.3.3.3" xref="S7.SS1.p7.2.m2.1.1.3.3.3.cmml">′</mo></msup></msub><mo id="S7.SS1.p7.2.m2.1.1.2" xref="S7.SS1.p7.2.m2.1.1.2.cmml">∈</mo><mrow id="S7.SS1.p7.2.m2.1.1.1" xref="S7.SS1.p7.2.m2.1.1.1.cmml"><mrow id="S7.SS1.p7.2.m2.1.1.1.1" xref="S7.SS1.p7.2.m2.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.2.m2.1.1.1.1.3" xref="S7.SS1.p7.2.m2.1.1.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.2.m2.1.1.1.1.2" xref="S7.SS1.p7.2.m2.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.2.m2.1.1.1.1.1.1" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.2.m2.1.1.1.1.1.1.2" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.2.m2.1.1.1.1.1.1.1" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.2" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.2.cmml">c</mi><msup id="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3.cmml"><mi id="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3.2" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo id="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3.3" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo stretchy="false" id="S7.SS1.p7.2.m2.1.1.1.1.1.1.3" xref="S7.SS1.p7.2.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p7.2.m2.1.1.1.2" xref="S7.SS1.p7.2.m2.1.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.2.m2.1.1.1.3" xref="S7.SS1.p7.2.m2.1.1.1.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.4.w1"/><span> </span><span class="gd_word" id="S7.SS1.p7.6.4.w2">such</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.4.w3">that</span><span> </span><math id="S7.SS1.p7.3.m3.1" class="ltx_Math" alttext="i^{\prime}&lt;j^{\prime}" display="inline"><semantics id="S7.SS1.p7.3.m3.1a"><mrow id="S7.SS1.p7.3.m3.1.1" xref="S7.SS1.p7.3.m3.1.1.cmml"><msup id="S7.SS1.p7.3.m3.1.1.2" xref="S7.SS1.p7.3.m3.1.1.2.cmml"><mi id="S7.SS1.p7.3.m3.1.1.2.2" xref="S7.SS1.p7.3.m3.1.1.2.2.cmml">i</mi><mo id="S7.SS1.p7.3.m3.1.1.2.3" xref="S7.SS1.p7.3.m3.1.1.2.3.cmml">′</mo></msup><mo id="S7.SS1.p7.3.m3.1.1.1" xref="S7.SS1.p7.3.m3.1.1.1.cmml">&lt;</mo><msup id="S7.SS1.p7.3.m3.1.1.3" xref="S7.SS1.p7.3.m3.1.1.3.cmml"><mi id="S7.SS1.p7.3.m3.1.1.3.2" xref="S7.SS1.p7.3.m3.1.1.3.2.cmml">j</mi><mo id="S7.SS1.p7.3.m3.1.1.3.3" xref="S7.SS1.p7.3.m3.1.1.3.3.cmml">′</mo></msup></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.5.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.5.w2">then</span><span> </span><math id="S7.SS1.p7.4.m4.2" class="ltx_Math" alttext="i&lt;j\mbox{ }\forall l_{i}\in\mathcal{R}(c^{k})\cap\mathcal{L}\mbox{ and }%&#10;\forall l_{j}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal{L}" display="inline"><semantics id="S7.SS1.p7.4.m4.2a"><mrow id="S7.SS1.p7.4.m4.2.2" xref="S7.SS1.p7.4.m4.2.2.cmml"><mi id="S7.SS1.p7.4.m4.2.2.4" xref="S7.SS1.p7.4.m4.2.2.4.cmml">i</mi><mo id="S7.SS1.p7.4.m4.2.2.5" xref="S7.SS1.p7.4.m4.2.2.5.cmml">&lt;</mo><mrow id="S7.SS1.p7.4.m4.2.2.6" xref="S7.SS1.p7.4.m4.2.2.6.cmml"><mi id="S7.SS1.p7.4.m4.2.2.6.2" xref="S7.SS1.p7.4.m4.2.2.6.2.cmml">j</mi><mo id="S7.SS1.p7.4.m4.2.2.6.1" xref="S7.SS1.p7.4.m4.2.2.6.1.cmml">⁢</mo><mtext id="S7.SS1.p7.4.m4.2.2.6.3" xref="S7.SS1.p7.4.m4.2.2.6.3a.cmml"> </mtext><mo id="S7.SS1.p7.4.m4.2.2.6.1a" xref="S7.SS1.p7.4.m4.2.2.6.1.cmml">⁢</mo><mrow id="S7.SS1.p7.4.m4.2.2.6.4" xref="S7.SS1.p7.4.m4.2.2.6.4.cmml"><mo id="S7.SS1.p7.4.m4.2.2.6.4.1" xref="S7.SS1.p7.4.m4.2.2.6.4.1.cmml">∀</mo><msub id="S7.SS1.p7.4.m4.2.2.6.4.2" xref="S7.SS1.p7.4.m4.2.2.6.4.2.cmml"><mi id="S7.SS1.p7.4.m4.2.2.6.4.2.2" xref="S7.SS1.p7.4.m4.2.2.6.4.2.2.cmml">l</mi><mi id="S7.SS1.p7.4.m4.2.2.6.4.2.3" xref="S7.SS1.p7.4.m4.2.2.6.4.2.3.cmml">i</mi></msub></mrow></mrow><mo id="S7.SS1.p7.4.m4.2.2.7" xref="S7.SS1.p7.4.m4.2.2.7.cmml">∈</mo><mrow id="S7.SS1.p7.4.m4.1.1.1" xref="S7.SS1.p7.4.m4.1.1.1.cmml"><mrow id="S7.SS1.p7.4.m4.1.1.1.1" xref="S7.SS1.p7.4.m4.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.4.m4.1.1.1.1.3" xref="S7.SS1.p7.4.m4.1.1.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.4.m4.1.1.1.1.2" xref="S7.SS1.p7.4.m4.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.4.m4.1.1.1.1.1.1" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.4.m4.1.1.1.1.1.1.2" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.4.m4.1.1.1.1.1.1.1" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.cmml"><mi id="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.2" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.3" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p7.4.m4.1.1.1.1.1.1.3" xref="S7.SS1.p7.4.m4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p7.4.m4.1.1.1.2" xref="S7.SS1.p7.4.m4.1.1.1.2.cmml">∩</mo><mrow id="S7.SS1.p7.4.m4.1.1.1.3" xref="S7.SS1.p7.4.m4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.4.m4.1.1.1.3.2" xref="S7.SS1.p7.4.m4.1.1.1.3.2.cmml">ℒ</mi><mo id="S7.SS1.p7.4.m4.1.1.1.3.1" xref="S7.SS1.p7.4.m4.1.1.1.3.1.cmml">⁢</mo><mtext id="S7.SS1.p7.4.m4.1.1.1.3.3" xref="S7.SS1.p7.4.m4.1.1.1.3.3a.cmml"> and </mtext><mo id="S7.SS1.p7.4.m4.1.1.1.3.1a" xref="S7.SS1.p7.4.m4.1.1.1.3.1.cmml">⁢</mo><mrow id="S7.SS1.p7.4.m4.1.1.1.3.4" xref="S7.SS1.p7.4.m4.1.1.1.3.4.cmml"><mo id="S7.SS1.p7.4.m4.1.1.1.3.4.1" xref="S7.SS1.p7.4.m4.1.1.1.3.4.1.cmml">∀</mo><msub id="S7.SS1.p7.4.m4.1.1.1.3.4.2" xref="S7.SS1.p7.4.m4.1.1.1.3.4.2.cmml"><mi id="S7.SS1.p7.4.m4.1.1.1.3.4.2.2" xref="S7.SS1.p7.4.m4.1.1.1.3.4.2.2.cmml">l</mi><mi id="S7.SS1.p7.4.m4.1.1.1.3.4.2.3" xref="S7.SS1.p7.4.m4.1.1.1.3.4.2.3.cmml">j</mi></msub></mrow></mrow></mrow><mo id="S7.SS1.p7.4.m4.2.2.8" xref="S7.SS1.p7.4.m4.2.2.8.cmml">∈</mo><mrow id="S7.SS1.p7.4.m4.2.2.2" xref="S7.SS1.p7.4.m4.2.2.2.cmml"><mrow id="S7.SS1.p7.4.m4.2.2.2.1" xref="S7.SS1.p7.4.m4.2.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.4.m4.2.2.2.1.3" xref="S7.SS1.p7.4.m4.2.2.2.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.4.m4.2.2.2.1.2" xref="S7.SS1.p7.4.m4.2.2.2.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.4.m4.2.2.2.1.1.1" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.4.m4.2.2.2.1.1.1.2" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.4.m4.2.2.2.1.1.1.1" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.cmml"><mi id="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.2" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.2.cmml">c</mi><msup id="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3.cmml"><mi id="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3.2" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3.2.cmml">k</mi><mo id="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3.3" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo stretchy="false" id="S7.SS1.p7.4.m4.2.2.2.1.1.1.3" xref="S7.SS1.p7.4.m4.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p7.4.m4.2.2.2.2" xref="S7.SS1.p7.4.m4.2.2.2.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.4.m4.2.2.2.3" xref="S7.SS1.p7.4.m4.2.2.2.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.6.w1">,</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.6.w2">or</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.6.w3">in</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.6.w4">other</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.6.w5">words,</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.6.w6">subtree</span><span> </span><math id="S7.SS1.p7.5.m5.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})" display="inline"><semantics id="S7.SS1.p7.5.m5.1a"><mrow id="S7.SS1.p7.5.m5.1.1" xref="S7.SS1.p7.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.5.m5.1.1.3" xref="S7.SS1.p7.5.m5.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.5.m5.1.1.2" xref="S7.SS1.p7.5.m5.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.5.m5.1.1.1.1" xref="S7.SS1.p7.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.5.m5.1.1.1.1.2" xref="S7.SS1.p7.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.5.m5.1.1.1.1.1" xref="S7.SS1.p7.5.m5.1.1.1.1.1.cmml"><mi id="S7.SS1.p7.5.m5.1.1.1.1.1.2" xref="S7.SS1.p7.5.m5.1.1.1.1.1.2.cmml">c</mi><mi id="S7.SS1.p7.5.m5.1.1.1.1.1.3" xref="S7.SS1.p7.5.m5.1.1.1.1.1.3.cmml">k</mi></msup><mo stretchy="false" id="S7.SS1.p7.5.m5.1.1.1.1.3" xref="S7.SS1.p7.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.7.w1"/><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w2">is</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w3">to</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w4">the</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w5">left</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w6">side</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w7">of</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.7.w8">subtree</span><span> </span><math id="S7.SS1.p7.6.m6.1" class="ltx_Math" alttext="\mathcal{R}(c^{k^{\prime}})" display="inline"><semantics id="S7.SS1.p7.6.m6.1a"><mrow id="S7.SS1.p7.6.m6.1.1" xref="S7.SS1.p7.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p7.6.m6.1.1.3" xref="S7.SS1.p7.6.m6.1.1.3.cmml">ℛ</mi><mo id="S7.SS1.p7.6.m6.1.1.2" xref="S7.SS1.p7.6.m6.1.1.2.cmml">⁢</mo><mrow id="S7.SS1.p7.6.m6.1.1.1.1" xref="S7.SS1.p7.6.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS1.p7.6.m6.1.1.1.1.2" xref="S7.SS1.p7.6.m6.1.1.1.1.1.cmml">(</mo><msup id="S7.SS1.p7.6.m6.1.1.1.1.1" xref="S7.SS1.p7.6.m6.1.1.1.1.1.cmml"><mi id="S7.SS1.p7.6.m6.1.1.1.1.1.2" xref="S7.SS1.p7.6.m6.1.1.1.1.1.2.cmml">c</mi><msup id="S7.SS1.p7.6.m6.1.1.1.1.1.3" xref="S7.SS1.p7.6.m6.1.1.1.1.1.3.cmml"><mi id="S7.SS1.p7.6.m6.1.1.1.1.1.3.2" xref="S7.SS1.p7.6.m6.1.1.1.1.1.3.2.cmml">k</mi><mo id="S7.SS1.p7.6.m6.1.1.1.1.1.3.3" xref="S7.SS1.p7.6.m6.1.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo stretchy="false" id="S7.SS1.p7.6.m6.1.1.1.1.3" xref="S7.SS1.p7.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p7.6.8.w1">.</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.8.w2">We</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.8.w3">prove</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.8.w4">this</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.8.w5">by</span><span> </span><span class="gd_word" id="S7.SS1.p7.6.8.w6">contradiction:</span></p>
</div>
<div id="Thmproof2" class="ltx_theorem ltx_theorem_proof">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem">Proof 2</span></h6>
<div id="Thmproof2.p1" class="ltx_para">
<p id="Thmproof2.p1.14" class="ltx_p"><span class="gd_word" id="Thmproof2.p1.14.1.w1">Suppose</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.1.w2">there</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.1.w3">exist</span><span> </span><math id="Thmproof2.p1.1.1.m1.3" class="ltx_Math" alttext="l_{i^{\prime}},l_{i^{*}}\in\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="Thmproof2.p1.1.1.m1.3a"><mrow id="Thmproof2.p1.1.1.m1.3.3" xref="Thmproof2.p1.1.1.m1.3.3.cmml"><mrow id="Thmproof2.p1.1.1.m1.2.2.2.2" xref="Thmproof2.p1.1.1.m1.2.2.2.3.cmml"><msub id="Thmproof2.p1.1.1.m1.1.1.1.1.1" xref="Thmproof2.p1.1.1.m1.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.1.1.m1.1.1.1.1.1.2" xref="Thmproof2.p1.1.1.m1.1.1.1.1.1.2.cmml">l</mi><msup id="Thmproof2.p1.1.1.m1.1.1.1.1.1.3" xref="Thmproof2.p1.1.1.m1.1.1.1.1.1.3.cmml"><mi id="Thmproof2.p1.1.1.m1.1.1.1.1.1.3.2" xref="Thmproof2.p1.1.1.m1.1.1.1.1.1.3.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.1.1.m1.1.1.1.1.1.3.3" xref="Thmproof2.p1.1.1.m1.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo mathvariant="normal" id="Thmproof2.p1.1.1.m1.2.2.2.2.3" xref="Thmproof2.p1.1.1.m1.2.2.2.3.cmml">,</mo><msub id="Thmproof2.p1.1.1.m1.2.2.2.2.2" xref="Thmproof2.p1.1.1.m1.2.2.2.2.2.cmml"><mi id="Thmproof2.p1.1.1.m1.2.2.2.2.2.2" xref="Thmproof2.p1.1.1.m1.2.2.2.2.2.2.cmml">l</mi><msup id="Thmproof2.p1.1.1.m1.2.2.2.2.2.3" xref="Thmproof2.p1.1.1.m1.2.2.2.2.2.3.cmml"><mi id="Thmproof2.p1.1.1.m1.2.2.2.2.2.3.2" xref="Thmproof2.p1.1.1.m1.2.2.2.2.2.3.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.1.1.m1.2.2.2.2.2.3.3" xref="Thmproof2.p1.1.1.m1.2.2.2.2.2.3.3.cmml">*</mo></msup></msub></mrow><mo mathvariant="normal" id="Thmproof2.p1.1.1.m1.3.3.4" xref="Thmproof2.p1.1.1.m1.3.3.4.cmml">∈</mo><mrow id="Thmproof2.p1.1.1.m1.3.3.3" xref="Thmproof2.p1.1.1.m1.3.3.3.cmml"><mrow id="Thmproof2.p1.1.1.m1.3.3.3.1" xref="Thmproof2.p1.1.1.m1.3.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.1.1.m1.3.3.3.1.3" xref="Thmproof2.p1.1.1.m1.3.3.3.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.1.1.m1.3.3.3.1.2" xref="Thmproof2.p1.1.1.m1.3.3.3.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.2" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.cmml"><mi id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.2" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.2.cmml">c</mi><mi id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.3" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.3.cmml">k</mi></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.3" xref="Thmproof2.p1.1.1.m1.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof2.p1.1.1.m1.3.3.3.2" xref="Thmproof2.p1.1.1.m1.3.3.3.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.1.1.m1.3.3.3.3" xref="Thmproof2.p1.1.1.m1.3.3.3.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.2.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.2.w2">and</span><span> </span><math id="Thmproof2.p1.2.2.m2.3" class="ltx_Math" alttext="l_{j^{\prime}},l_{j^{*}}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal{L}" display="inline"><semantics id="Thmproof2.p1.2.2.m2.3a"><mrow id="Thmproof2.p1.2.2.m2.3.3" xref="Thmproof2.p1.2.2.m2.3.3.cmml"><mrow id="Thmproof2.p1.2.2.m2.2.2.2.2" xref="Thmproof2.p1.2.2.m2.2.2.2.3.cmml"><msub id="Thmproof2.p1.2.2.m2.1.1.1.1.1" xref="Thmproof2.p1.2.2.m2.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.2.2.m2.1.1.1.1.1.2" xref="Thmproof2.p1.2.2.m2.1.1.1.1.1.2.cmml">l</mi><msup id="Thmproof2.p1.2.2.m2.1.1.1.1.1.3" xref="Thmproof2.p1.2.2.m2.1.1.1.1.1.3.cmml"><mi id="Thmproof2.p1.2.2.m2.1.1.1.1.1.3.2" xref="Thmproof2.p1.2.2.m2.1.1.1.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.1.1.1.1.1.3.3" xref="Thmproof2.p1.2.2.m2.1.1.1.1.1.3.3.cmml">′</mo></msup></msub><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.2.2.2.2.3" xref="Thmproof2.p1.2.2.m2.2.2.2.3.cmml">,</mo><msub id="Thmproof2.p1.2.2.m2.2.2.2.2.2" xref="Thmproof2.p1.2.2.m2.2.2.2.2.2.cmml"><mi id="Thmproof2.p1.2.2.m2.2.2.2.2.2.2" xref="Thmproof2.p1.2.2.m2.2.2.2.2.2.2.cmml">l</mi><msup id="Thmproof2.p1.2.2.m2.2.2.2.2.2.3" xref="Thmproof2.p1.2.2.m2.2.2.2.2.2.3.cmml"><mi id="Thmproof2.p1.2.2.m2.2.2.2.2.2.3.2" xref="Thmproof2.p1.2.2.m2.2.2.2.2.2.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.2.2.2.2.2.3.3" xref="Thmproof2.p1.2.2.m2.2.2.2.2.2.3.3.cmml">*</mo></msup></msub></mrow><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.3.3.4" xref="Thmproof2.p1.2.2.m2.3.3.4.cmml">∈</mo><mrow id="Thmproof2.p1.2.2.m2.3.3.3" xref="Thmproof2.p1.2.2.m2.3.3.3.cmml"><mrow id="Thmproof2.p1.2.2.m2.3.3.3.1" xref="Thmproof2.p1.2.2.m2.3.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.2.2.m2.3.3.3.1.3" xref="Thmproof2.p1.2.2.m2.3.3.3.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.2.2.m2.3.3.3.1.2" xref="Thmproof2.p1.2.2.m2.3.3.3.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.2" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.cmml"><mi id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.2" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.2.cmml">c</mi><msup id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3.cmml"><mi id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3.2" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3.2.cmml">k</mi><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3.3" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.3" xref="Thmproof2.p1.2.2.m2.3.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof2.p1.2.2.m2.3.3.3.2" xref="Thmproof2.p1.2.2.m2.3.3.3.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.2.2.m2.3.3.3.3" xref="Thmproof2.p1.2.2.m2.3.3.3.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.3.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.3.w2">such</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.3.w3">that</span><span> </span><math id="Thmproof2.p1.3.3.m3.1" class="ltx_Math" alttext="i^{\prime}&lt;j^{\prime}" display="inline"><semantics id="Thmproof2.p1.3.3.m3.1a"><mrow id="Thmproof2.p1.3.3.m3.1.1" xref="Thmproof2.p1.3.3.m3.1.1.cmml"><msup id="Thmproof2.p1.3.3.m3.1.1.2" xref="Thmproof2.p1.3.3.m3.1.1.2.cmml"><mi id="Thmproof2.p1.3.3.m3.1.1.2.2" xref="Thmproof2.p1.3.3.m3.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.3.3.m3.1.1.2.3" xref="Thmproof2.p1.3.3.m3.1.1.2.3.cmml">′</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.3.3.m3.1.1.1" xref="Thmproof2.p1.3.3.m3.1.1.1.cmml">&lt;</mo><msup id="Thmproof2.p1.3.3.m3.1.1.3" xref="Thmproof2.p1.3.3.m3.1.1.3.cmml"><mi id="Thmproof2.p1.3.3.m3.1.1.3.2" xref="Thmproof2.p1.3.3.m3.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.3.3.m3.1.1.3.3" xref="Thmproof2.p1.3.3.m3.1.1.3.3.cmml">′</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.4.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.4.w2">but</span><span> </span><math id="Thmproof2.p1.4.4.m4.1" class="ltx_Math" alttext="i^{*}\geq j^{*}" display="inline"><semantics id="Thmproof2.p1.4.4.m4.1a"><mrow id="Thmproof2.p1.4.4.m4.1.1" xref="Thmproof2.p1.4.4.m4.1.1.cmml"><msup id="Thmproof2.p1.4.4.m4.1.1.2" xref="Thmproof2.p1.4.4.m4.1.1.2.cmml"><mi id="Thmproof2.p1.4.4.m4.1.1.2.2" xref="Thmproof2.p1.4.4.m4.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.4.4.m4.1.1.2.3" xref="Thmproof2.p1.4.4.m4.1.1.2.3.cmml">*</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.4.4.m4.1.1.1" xref="Thmproof2.p1.4.4.m4.1.1.1.cmml">≥</mo><msup id="Thmproof2.p1.4.4.m4.1.1.3" xref="Thmproof2.p1.4.4.m4.1.1.3.cmml"><mi id="Thmproof2.p1.4.4.m4.1.1.3.2" xref="Thmproof2.p1.4.4.m4.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.4.4.m4.1.1.3.3" xref="Thmproof2.p1.4.4.m4.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.5.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.5.w2">and</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.5.w3">not</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.5.w4">both</span><span> </span><math id="Thmproof2.p1.5.5.m5.1" class="ltx_Math" alttext="i^{\prime}=i^{*}" display="inline"><semantics id="Thmproof2.p1.5.5.m5.1a"><mrow id="Thmproof2.p1.5.5.m5.1.1" xref="Thmproof2.p1.5.5.m5.1.1.cmml"><msup id="Thmproof2.p1.5.5.m5.1.1.2" xref="Thmproof2.p1.5.5.m5.1.1.2.cmml"><mi id="Thmproof2.p1.5.5.m5.1.1.2.2" xref="Thmproof2.p1.5.5.m5.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.5.5.m5.1.1.2.3" xref="Thmproof2.p1.5.5.m5.1.1.2.3.cmml">′</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.5.5.m5.1.1.1" xref="Thmproof2.p1.5.5.m5.1.1.1.cmml">=</mo><msup id="Thmproof2.p1.5.5.m5.1.1.3" xref="Thmproof2.p1.5.5.m5.1.1.3.cmml"><mi id="Thmproof2.p1.5.5.m5.1.1.3.2" xref="Thmproof2.p1.5.5.m5.1.1.3.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.5.5.m5.1.1.3.3" xref="Thmproof2.p1.5.5.m5.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.6.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.6.w2">and</span><span> </span><math id="Thmproof2.p1.6.6.m6.1" class="ltx_Math" alttext="j^{\prime}=j^{*}" display="inline"><semantics id="Thmproof2.p1.6.6.m6.1a"><mrow id="Thmproof2.p1.6.6.m6.1.1" xref="Thmproof2.p1.6.6.m6.1.1.cmml"><msup id="Thmproof2.p1.6.6.m6.1.1.2" xref="Thmproof2.p1.6.6.m6.1.1.2.cmml"><mi id="Thmproof2.p1.6.6.m6.1.1.2.2" xref="Thmproof2.p1.6.6.m6.1.1.2.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.6.6.m6.1.1.2.3" xref="Thmproof2.p1.6.6.m6.1.1.2.3.cmml">′</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.6.6.m6.1.1.1" xref="Thmproof2.p1.6.6.m6.1.1.1.cmml">=</mo><msup id="Thmproof2.p1.6.6.m6.1.1.3" xref="Thmproof2.p1.6.6.m6.1.1.3.cmml"><mi id="Thmproof2.p1.6.6.m6.1.1.3.2" xref="Thmproof2.p1.6.6.m6.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.6.6.m6.1.1.3.3" xref="Thmproof2.p1.6.6.m6.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.7.w1">.</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.7.w2">If</span><span> </span><math id="Thmproof2.p1.7.7.m7.1" class="ltx_Math" alttext="i^{*}=j^{*}" display="inline"><semantics id="Thmproof2.p1.7.7.m7.1a"><mrow id="Thmproof2.p1.7.7.m7.1.1" xref="Thmproof2.p1.7.7.m7.1.1.cmml"><msup id="Thmproof2.p1.7.7.m7.1.1.2" xref="Thmproof2.p1.7.7.m7.1.1.2.cmml"><mi id="Thmproof2.p1.7.7.m7.1.1.2.2" xref="Thmproof2.p1.7.7.m7.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.7.7.m7.1.1.2.3" xref="Thmproof2.p1.7.7.m7.1.1.2.3.cmml">*</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.7.7.m7.1.1.1" xref="Thmproof2.p1.7.7.m7.1.1.1.cmml">=</mo><msup id="Thmproof2.p1.7.7.m7.1.1.3" xref="Thmproof2.p1.7.7.m7.1.1.3.cmml"><mi id="Thmproof2.p1.7.7.m7.1.1.3.2" xref="Thmproof2.p1.7.7.m7.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.7.7.m7.1.1.3.3" xref="Thmproof2.p1.7.7.m7.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.8.w1">,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w2">this</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w3">creates</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w4">a</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w5">closed</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w6">cycle,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w7">which</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w8">is</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w9">impossible</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w10">as</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w11">described</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w12">in</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.8.w13">proof</span><span> </span><a href="#Thmproof1" title="Proof 1 ‣ 7.1 Proof for proposition 1 ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">1</a><span class="gd_word" id="Thmproof2.p1.14.9.w1">.
If</span><span> </span><math id="Thmproof2.p1.8.8.m8.1" class="ltx_Math" alttext="i^{*}&gt;j^{*}" display="inline"><semantics id="Thmproof2.p1.8.8.m8.1a"><mrow id="Thmproof2.p1.8.8.m8.1.1" xref="Thmproof2.p1.8.8.m8.1.1.cmml"><msup id="Thmproof2.p1.8.8.m8.1.1.2" xref="Thmproof2.p1.8.8.m8.1.1.2.cmml"><mi id="Thmproof2.p1.8.8.m8.1.1.2.2" xref="Thmproof2.p1.8.8.m8.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.8.8.m8.1.1.2.3" xref="Thmproof2.p1.8.8.m8.1.1.2.3.cmml">*</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.8.8.m8.1.1.1" xref="Thmproof2.p1.8.8.m8.1.1.1.cmml">&gt;</mo><msup id="Thmproof2.p1.8.8.m8.1.1.3" xref="Thmproof2.p1.8.8.m8.1.1.3.cmml"><mi id="Thmproof2.p1.8.8.m8.1.1.3.2" xref="Thmproof2.p1.8.8.m8.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.8.8.m8.1.1.3.3" xref="Thmproof2.p1.8.8.m8.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.10.w1">,</span><span> </span><math id="Thmproof2.p1.9.9.m9.1" class="ltx_Math" alttext="l_{j^{*}}" display="inline"><semantics id="Thmproof2.p1.9.9.m9.1a"><msub id="Thmproof2.p1.9.9.m9.1.1" xref="Thmproof2.p1.9.9.m9.1.1.cmml"><mi id="Thmproof2.p1.9.9.m9.1.1.2" xref="Thmproof2.p1.9.9.m9.1.1.2.cmml">l</mi><msup id="Thmproof2.p1.9.9.m9.1.1.3" xref="Thmproof2.p1.9.9.m9.1.1.3.cmml"><mi id="Thmproof2.p1.9.9.m9.1.1.3.2" xref="Thmproof2.p1.9.9.m9.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.9.9.m9.1.1.3.3" xref="Thmproof2.p1.9.9.m9.1.1.3.3.cmml">*</mo></msup></msub></semantics></math><span class="gd_word" id="Thmproof2.p1.14.11.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w2">lies</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w3">between</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w4">the</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w5">leftmost</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w6">and</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w7">rightmost</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w8">leaves</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.11.w9">of</span><span> </span><math id="Thmproof2.p1.10.10.m10.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="Thmproof2.p1.10.10.m10.1a"><mrow id="Thmproof2.p1.10.10.m10.1.1" xref="Thmproof2.p1.10.10.m10.1.1.cmml"><mrow id="Thmproof2.p1.10.10.m10.1.1.1" xref="Thmproof2.p1.10.10.m10.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.10.10.m10.1.1.1.3" xref="Thmproof2.p1.10.10.m10.1.1.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.10.10.m10.1.1.1.2" xref="Thmproof2.p1.10.10.m10.1.1.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.10.10.m10.1.1.1.1.1" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.10.10.m10.1.1.1.1.1.2" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.10.10.m10.1.1.1.1.1.1" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.2" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.2.cmml">c</mi><mi id="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.3" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.3.cmml">k</mi></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.10.10.m10.1.1.1.1.1.3" xref="Thmproof2.p1.10.10.m10.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof2.p1.10.10.m10.1.1.2" xref="Thmproof2.p1.10.10.m10.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.10.10.m10.1.1.3" xref="Thmproof2.p1.10.10.m10.1.1.3.cmml">ℒ</mi></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.12.w1">.</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.12.w2">As</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.12.w3">a</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.12.w4">result,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.12.w5">the</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.12.w6">subtree</span><span> </span><math id="Thmproof2.p1.11.11.m11.1" class="ltx_Math" alttext="\mathcal{R}(c^{k})" display="inline"><semantics id="Thmproof2.p1.11.11.m11.1a"><mrow id="Thmproof2.p1.11.11.m11.1.1" xref="Thmproof2.p1.11.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.11.11.m11.1.1.3" xref="Thmproof2.p1.11.11.m11.1.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.11.11.m11.1.1.2" xref="Thmproof2.p1.11.11.m11.1.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.11.11.m11.1.1.1.1" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.11.11.m11.1.1.1.1.2" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.11.11.m11.1.1.1.1.1" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.11.11.m11.1.1.1.1.1.2" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.2.cmml">c</mi><mi id="Thmproof2.p1.11.11.m11.1.1.1.1.1.3" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.3.cmml">k</mi></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.11.11.m11.1.1.1.1.3" xref="Thmproof2.p1.11.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.13.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w2">does</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w3">not</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w4">cover</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w5">a</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w6">full</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w7">contiguous</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w8">phrase</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w9">but</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w10">multiple</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w11">segmented</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w12">phrases,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w13">which</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w14">is</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w15">prohibited</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w16">for</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w17">a</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w18">parse</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w19">tree.</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w20">Therefore,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w21">by</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w22">contradiction,</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w23">there</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w24">can</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w25">not</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.13.w26">exist</span><span> </span><math id="Thmproof2.p1.12.12.m12.1" class="ltx_Math" alttext="l_{i^{*}}\in\mathcal{R}(c^{k})\cap\mathcal{L}" display="inline"><semantics id="Thmproof2.p1.12.12.m12.1a"><mrow id="Thmproof2.p1.12.12.m12.1.1" xref="Thmproof2.p1.12.12.m12.1.1.cmml"><msub id="Thmproof2.p1.12.12.m12.1.1.3" xref="Thmproof2.p1.12.12.m12.1.1.3.cmml"><mi id="Thmproof2.p1.12.12.m12.1.1.3.2" xref="Thmproof2.p1.12.12.m12.1.1.3.2.cmml">l</mi><msup id="Thmproof2.p1.12.12.m12.1.1.3.3" xref="Thmproof2.p1.12.12.m12.1.1.3.3.cmml"><mi id="Thmproof2.p1.12.12.m12.1.1.3.3.2" xref="Thmproof2.p1.12.12.m12.1.1.3.3.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.12.12.m12.1.1.3.3.3" xref="Thmproof2.p1.12.12.m12.1.1.3.3.3.cmml">*</mo></msup></msub><mo mathvariant="normal" id="Thmproof2.p1.12.12.m12.1.1.2" xref="Thmproof2.p1.12.12.m12.1.1.2.cmml">∈</mo><mrow id="Thmproof2.p1.12.12.m12.1.1.1" xref="Thmproof2.p1.12.12.m12.1.1.1.cmml"><mrow id="Thmproof2.p1.12.12.m12.1.1.1.1" xref="Thmproof2.p1.12.12.m12.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.12.12.m12.1.1.1.1.3" xref="Thmproof2.p1.12.12.m12.1.1.1.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.12.12.m12.1.1.1.1.2" xref="Thmproof2.p1.12.12.m12.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.2" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.2" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.2.cmml">c</mi><mi id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.3" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.3.cmml">k</mi></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.3" xref="Thmproof2.p1.12.12.m12.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof2.p1.12.12.m12.1.1.1.2" xref="Thmproof2.p1.12.12.m12.1.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.12.12.m12.1.1.1.3" xref="Thmproof2.p1.12.12.m12.1.1.1.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.14.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.14.w2">and</span><span> </span><math id="Thmproof2.p1.13.13.m13.1" class="ltx_Math" alttext="l_{j^{*}}\in\mathcal{R}(c^{k^{\prime}})\cap\mathcal{L}" display="inline"><semantics id="Thmproof2.p1.13.13.m13.1a"><mrow id="Thmproof2.p1.13.13.m13.1.1" xref="Thmproof2.p1.13.13.m13.1.1.cmml"><msub id="Thmproof2.p1.13.13.m13.1.1.3" xref="Thmproof2.p1.13.13.m13.1.1.3.cmml"><mi id="Thmproof2.p1.13.13.m13.1.1.3.2" xref="Thmproof2.p1.13.13.m13.1.1.3.2.cmml">l</mi><msup id="Thmproof2.p1.13.13.m13.1.1.3.3" xref="Thmproof2.p1.13.13.m13.1.1.3.3.cmml"><mi id="Thmproof2.p1.13.13.m13.1.1.3.3.2" xref="Thmproof2.p1.13.13.m13.1.1.3.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.13.13.m13.1.1.3.3.3" xref="Thmproof2.p1.13.13.m13.1.1.3.3.3.cmml">*</mo></msup></msub><mo mathvariant="normal" id="Thmproof2.p1.13.13.m13.1.1.2" xref="Thmproof2.p1.13.13.m13.1.1.2.cmml">∈</mo><mrow id="Thmproof2.p1.13.13.m13.1.1.1" xref="Thmproof2.p1.13.13.m13.1.1.1.cmml"><mrow id="Thmproof2.p1.13.13.m13.1.1.1.1" xref="Thmproof2.p1.13.13.m13.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.13.13.m13.1.1.1.1.3" xref="Thmproof2.p1.13.13.m13.1.1.1.1.3.cmml">ℛ</mi><mo mathvariant="italic" id="Thmproof2.p1.13.13.m13.1.1.1.1.2" xref="Thmproof2.p1.13.13.m13.1.1.1.1.2.cmml">⁢</mo><mrow id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.cmml"><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.2" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.cmml">(</mo><msup id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.cmml"><mi id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.2" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.2.cmml">c</mi><msup id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3.cmml"><mi id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3.2" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3.2.cmml">k</mi><mo mathvariant="normal" id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3.3" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.3.3.cmml">′</mo></msup></msup><mo mathvariant="normal" stretchy="false" id="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.3" xref="Thmproof2.p1.13.13.m13.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathvariant="normal" id="Thmproof2.p1.13.13.m13.1.1.1.2" xref="Thmproof2.p1.13.13.m13.1.1.1.2.cmml">∩</mo><mi class="ltx_font_mathcaligraphic" id="Thmproof2.p1.13.13.m13.1.1.1.3" xref="Thmproof2.p1.13.13.m13.1.1.1.3.cmml">ℒ</mi></mrow></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.15.w1"/><span> </span><span class="gd_word" id="Thmproof2.p1.14.15.w2">such</span><span> </span><span class="gd_word" id="Thmproof2.p1.14.15.w3">that</span><span> </span><math id="Thmproof2.p1.14.14.m14.1" class="ltx_Math" alttext="i^{*}\geq j^{*}" display="inline"><semantics id="Thmproof2.p1.14.14.m14.1a"><mrow id="Thmproof2.p1.14.14.m14.1.1" xref="Thmproof2.p1.14.14.m14.1.1.cmml"><msup id="Thmproof2.p1.14.14.m14.1.1.2" xref="Thmproof2.p1.14.14.m14.1.1.2.cmml"><mi id="Thmproof2.p1.14.14.m14.1.1.2.2" xref="Thmproof2.p1.14.14.m14.1.1.2.2.cmml">i</mi><mo mathvariant="normal" id="Thmproof2.p1.14.14.m14.1.1.2.3" xref="Thmproof2.p1.14.14.m14.1.1.2.3.cmml">*</mo></msup><mo mathvariant="normal" id="Thmproof2.p1.14.14.m14.1.1.1" xref="Thmproof2.p1.14.14.m14.1.1.1.cmml">≥</mo><msup id="Thmproof2.p1.14.14.m14.1.1.3" xref="Thmproof2.p1.14.14.m14.1.1.3.cmml"><mi id="Thmproof2.p1.14.14.m14.1.1.3.2" xref="Thmproof2.p1.14.14.m14.1.1.3.2.cmml">j</mi><mo mathvariant="normal" id="Thmproof2.p1.14.14.m14.1.1.3.3" xref="Thmproof2.p1.14.14.m14.1.1.3.3.cmml">*</mo></msup></mrow></semantics></math><span class="gd_word" id="Thmproof2.p1.14.16.w1">.

</span></p>
</div>
</div>
<div id="S7.SS1.p8" class="ltx_para ltx_noindent">
<p id="S7.SS1.p8.3" class="ltx_p"><span class="gd_word" id="S7.SS1.p8.3.1.w1">In</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w2">general,</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w3">combing</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w4">the</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w5">satisfactions</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w6">from</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w7">the</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w8">above</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w9">requirements,</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w10">the</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.1.w11">reverse-transformation</span><span> </span><math id="S7.SS1.p8.1.m1.1" class="ltx_Math" alttext="\mathcal{I}" display="inline"><semantics id="S7.SS1.p8.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.1.m1.1.1" xref="S7.SS1.p8.1.m1.1.1.cmml">ℐ</mi></semantics></math><span class="gd_word" id="S7.SS1.p8.3.2.w1"/><span> </span><span class="gd_word" id="S7.SS1.p8.3.2.w2">can</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.2.w3">convert</span><span> </span><math id="S7.SS1.p8.2.m2.4" class="ltx_Math" alttext="\mathcal{T}(X)=(\mathcal{L},\mathcal{N},\mathcal{R})" display="inline"><semantics id="S7.SS1.p8.2.m2.4a"><mrow id="S7.SS1.p8.2.m2.4.5" xref="S7.SS1.p8.2.m2.4.5.cmml"><mrow id="S7.SS1.p8.2.m2.4.5.2" xref="S7.SS1.p8.2.m2.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.2.m2.4.5.2.2" xref="S7.SS1.p8.2.m2.4.5.2.2.cmml">𝒯</mi><mo id="S7.SS1.p8.2.m2.4.5.2.1" xref="S7.SS1.p8.2.m2.4.5.2.1.cmml">⁢</mo><mrow id="S7.SS1.p8.2.m2.4.5.2.3.2" xref="S7.SS1.p8.2.m2.4.5.2.cmml"><mo stretchy="false" id="S7.SS1.p8.2.m2.4.5.2.3.2.1" xref="S7.SS1.p8.2.m2.4.5.2.cmml">(</mo><mi id="S7.SS1.p8.2.m2.1.1" xref="S7.SS1.p8.2.m2.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p8.2.m2.4.5.2.3.2.2" xref="S7.SS1.p8.2.m2.4.5.2.cmml">)</mo></mrow></mrow><mo id="S7.SS1.p8.2.m2.4.5.1" xref="S7.SS1.p8.2.m2.4.5.1.cmml">=</mo><mrow id="S7.SS1.p8.2.m2.4.5.3.2" xref="S7.SS1.p8.2.m2.4.5.3.1.cmml"><mo stretchy="false" id="S7.SS1.p8.2.m2.4.5.3.2.1" xref="S7.SS1.p8.2.m2.4.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.2.m2.2.2" xref="S7.SS1.p8.2.m2.2.2.cmml">ℒ</mi><mo id="S7.SS1.p8.2.m2.4.5.3.2.2" xref="S7.SS1.p8.2.m2.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.2.m2.3.3" xref="S7.SS1.p8.2.m2.3.3.cmml">𝒩</mi><mo id="S7.SS1.p8.2.m2.4.5.3.2.3" xref="S7.SS1.p8.2.m2.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.2.m2.4.4" xref="S7.SS1.p8.2.m2.4.4.cmml">ℛ</mi><mo stretchy="false" id="S7.SS1.p8.2.m2.4.5.3.2.4" xref="S7.SS1.p8.2.m2.4.5.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p8.3.3.w1"/><span> </span><span class="gd_word" id="S7.SS1.p8.3.3.w2">back</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.3.w3">to</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.3.w4">the</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.3.w5">original</span><span> </span><span class="gd_word" id="S7.SS1.p8.3.3.w6">graph</span><span> </span><math id="S7.SS1.p8.3.m3.1" class="ltx_Math" alttext="\mathcal{G}(X)" display="inline"><semantics id="S7.SS1.p8.3.m3.1a"><mrow id="S7.SS1.p8.3.m3.1.2" xref="S7.SS1.p8.3.m3.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS1.p8.3.m3.1.2.2" xref="S7.SS1.p8.3.m3.1.2.2.cmml">𝒢</mi><mo id="S7.SS1.p8.3.m3.1.2.1" xref="S7.SS1.p8.3.m3.1.2.1.cmml">⁢</mo><mrow id="S7.SS1.p8.3.m3.1.2.3.2" xref="S7.SS1.p8.3.m3.1.2.cmml"><mo stretchy="false" id="S7.SS1.p8.3.m3.1.2.3.2.1" xref="S7.SS1.p8.3.m3.1.2.cmml">(</mo><mi id="S7.SS1.p8.3.m3.1.1" xref="S7.SS1.p8.3.m3.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS1.p8.3.m3.1.2.3.2.2" xref="S7.SS1.p8.3.m3.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS1.p8.3.4.w1">:</span></p>
<table id="S7.E27" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E27.m1.3" class="ltx_Math" alttext="\mathcal{I}(\mathcal{H}(\mathcal{G}(X)))=\mathcal{G}(X)" display="block"><semantics id="S7.E27.m1.3a"><mrow id="S7.E27.m1.3.3" xref="S7.E27.m1.3.3.cmml"><mrow id="S7.E27.m1.3.3.1" xref="S7.E27.m1.3.3.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E27.m1.3.3.1.3" xref="S7.E27.m1.3.3.1.3.cmml">ℐ</mi><mo id="S7.E27.m1.3.3.1.2" xref="S7.E27.m1.3.3.1.2.cmml">⁢</mo><mrow id="S7.E27.m1.3.3.1.1.1" xref="S7.E27.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.2" xref="S7.E27.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S7.E27.m1.3.3.1.1.1.1" xref="S7.E27.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E27.m1.3.3.1.1.1.1.3" xref="S7.E27.m1.3.3.1.1.1.1.3.cmml">ℋ</mi><mo id="S7.E27.m1.3.3.1.1.1.1.2" xref="S7.E27.m1.3.3.1.1.1.1.2.cmml">⁢</mo><mrow id="S7.E27.m1.3.3.1.1.1.1.1.1" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.1.1.1.2" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E27.m1.3.3.1.1.1.1.1.1.1" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E27.m1.3.3.1.1.1.1.1.1.1.2" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.2.cmml">𝒢</mi><mo id="S7.E27.m1.3.3.1.1.1.1.1.1.1.1" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S7.E27.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.1.1.1.1.3.2.1" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S7.E27.m1.1.1" xref="S7.E27.m1.1.1.cmml">X</mi><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.1.1.1.1.3.2.2" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.1.1.1.3" xref="S7.E27.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S7.E27.m1.3.3.1.1.1.3" xref="S7.E27.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E27.m1.3.3.2" xref="S7.E27.m1.3.3.2.cmml">=</mo><mrow id="S7.E27.m1.3.3.3" xref="S7.E27.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E27.m1.3.3.3.2" xref="S7.E27.m1.3.3.3.2.cmml">𝒢</mi><mo id="S7.E27.m1.3.3.3.1" xref="S7.E27.m1.3.3.3.1.cmml">⁢</mo><mrow id="S7.E27.m1.3.3.3.3.2" xref="S7.E27.m1.3.3.3.cmml"><mo stretchy="false" id="S7.E27.m1.3.3.3.3.2.1" xref="S7.E27.m1.3.3.3.cmml">(</mo><mi id="S7.E27.m1.2.2" xref="S7.E27.m1.2.2.cmml">X</mi><mo stretchy="false" id="S7.E27.m1.3.3.3.3.2.2" xref="S7.E27.m1.3.3.3.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr>
</table>
</div>
</section>
<section id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2 </span>Time complexity analysis</h3>

<div id="S7.SS2.p1" class="ltx_para ltx_noindent">
<p id="S7.SS2.p1.35" class="ltx_p"><span class="gd_word" id="S7.SS2.p1.35.1.w1">In</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w2">this</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w3">section,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w4">we</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w5">prove</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w6">that</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w7">given</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w8">single-thread</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w9">sequential</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w10">computation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w11">(single</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w12">CPU),</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w13">our</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w14">method</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w15">operates</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.1.w16">at</span><span> </span><math id="S7.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{O}(N^{2})" display="inline"><semantics id="S7.SS2.p1.1.m1.1a"><mrow id="S7.SS2.p1.1.m1.1.1" xref="S7.SS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.1.m1.1.1.3" xref="S7.SS2.p1.1.m1.1.1.3.cmml">𝒪</mi><mo id="S7.SS2.p1.1.m1.1.1.2" xref="S7.SS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S7.SS2.p1.1.m1.1.1.1.1" xref="S7.SS2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.1.m1.1.1.1.1.2" xref="S7.SS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><msup id="S7.SS2.p1.1.m1.1.1.1.1.1" xref="S7.SS2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S7.SS2.p1.1.m1.1.1.1.1.1.2" xref="S7.SS2.p1.1.m1.1.1.1.1.1.2.cmml">N</mi><mn id="S7.SS2.p1.1.m1.1.1.1.1.1.3" xref="S7.SS2.p1.1.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.SS2.p1.1.m1.1.1.1.1.3" xref="S7.SS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.2.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w2">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w3">complexity.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w4">In</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w5">short,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w6">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w7">hierarchical</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w8">accumulation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w9">process</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.2.w10">(Section</span><span> </span><a href="#S4.SS1" title="4.1 Encoding Trees with Hierarchical Accumulations ‣ 4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4.1</a><span class="gd_word" id="S7.SS2.p1.35.3.w1">)</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.3.w2">runs</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.3.w3">at</span><span> </span><math id="S7.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{O}(N\log N)" display="inline"><semantics id="S7.SS2.p1.2.m2.1a"><mrow id="S7.SS2.p1.2.m2.1.1" xref="S7.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.2.m2.1.1.3" xref="S7.SS2.p1.2.m2.1.1.3.cmml">𝒪</mi><mo id="S7.SS2.p1.2.m2.1.1.2" xref="S7.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S7.SS2.p1.2.m2.1.1.1.1" xref="S7.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.2.m2.1.1.1.1.2" xref="S7.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S7.SS2.p1.2.m2.1.1.1.1.1" xref="S7.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S7.SS2.p1.2.m2.1.1.1.1.1.2" xref="S7.SS2.p1.2.m2.1.1.1.1.1.2.cmml">N</mi><mo id="S7.SS2.p1.2.m2.1.1.1.1.1.1" xref="S7.SS2.p1.2.m2.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS2.p1.2.m2.1.1.1.1.1.3" xref="S7.SS2.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S7.SS2.p1.2.m2.1.1.1.1.1.3.1" xref="S7.SS2.p1.2.m2.1.1.1.1.1.3.1.cmml">log</mi><mo id="S7.SS2.p1.2.m2.1.1.1.1.1.3a" xref="S7.SS2.p1.2.m2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S7.SS2.p1.2.m2.1.1.1.1.1.3.2" xref="S7.SS2.p1.2.m2.1.1.1.1.1.3.2.cmml">N</mi></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.2.m2.1.1.1.1.3" xref="S7.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.4.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w2">time,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w3">while</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w4">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w5">attention</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w6">scores</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.4.w7">(</span><math id="S7.SS2.p1.3.m3.1" class="ltx_Math" alttext="{\bm{Q}}{\bm{K}}^{T}" display="inline"><semantics id="S7.SS2.p1.3.m3.1a"><mrow id="S7.SS2.p1.3.m3.1.1" xref="S7.SS2.p1.3.m3.1.1.cmml"><mi id="S7.SS2.p1.3.m3.1.1.2" xref="S7.SS2.p1.3.m3.1.1.2.cmml">𝑸</mi><mo id="S7.SS2.p1.3.m3.1.1.1" xref="S7.SS2.p1.3.m3.1.1.1.cmml">⁢</mo><msup id="S7.SS2.p1.3.m3.1.1.3" xref="S7.SS2.p1.3.m3.1.1.3.cmml"><mi id="S7.SS2.p1.3.m3.1.1.3.2" xref="S7.SS2.p1.3.m3.1.1.3.2.cmml">𝑲</mi><mi id="S7.SS2.p1.3.m3.1.1.3.3" xref="S7.SS2.p1.3.m3.1.1.3.3.cmml">T</mi></msup></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.5.w1">)</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w2">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w3">standard</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w4">attention</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w5">are</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w6">computed</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.5.w7">at</span><span> </span><math id="S7.SS2.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{O}(N^{2})" display="inline"><semantics id="S7.SS2.p1.4.m4.1a"><mrow id="S7.SS2.p1.4.m4.1.1" xref="S7.SS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.4.m4.1.1.3" xref="S7.SS2.p1.4.m4.1.1.3.cmml">𝒪</mi><mo id="S7.SS2.p1.4.m4.1.1.2" xref="S7.SS2.p1.4.m4.1.1.2.cmml">⁢</mo><mrow id="S7.SS2.p1.4.m4.1.1.1.1" xref="S7.SS2.p1.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.4.m4.1.1.1.1.2" xref="S7.SS2.p1.4.m4.1.1.1.1.1.cmml">(</mo><msup id="S7.SS2.p1.4.m4.1.1.1.1.1" xref="S7.SS2.p1.4.m4.1.1.1.1.1.cmml"><mi id="S7.SS2.p1.4.m4.1.1.1.1.1.2" xref="S7.SS2.p1.4.m4.1.1.1.1.1.2.cmml">N</mi><mn id="S7.SS2.p1.4.m4.1.1.1.1.1.3" xref="S7.SS2.p1.4.m4.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.SS2.p1.4.m4.1.1.1.1.3" xref="S7.SS2.p1.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.6.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w2">Overall,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w4">tree-based</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w5">attention</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w6">can</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w7">performs</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.6.w8">at</span><span> </span><math id="S7.SS2.p1.5.m5.1" class="ltx_Math" alttext="\mathcal{O}(N^{2})" display="inline"><semantics id="S7.SS2.p1.5.m5.1a"><mrow id="S7.SS2.p1.5.m5.1.1" xref="S7.SS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.5.m5.1.1.3" xref="S7.SS2.p1.5.m5.1.1.3.cmml">𝒪</mi><mo id="S7.SS2.p1.5.m5.1.1.2" xref="S7.SS2.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S7.SS2.p1.5.m5.1.1.1.1" xref="S7.SS2.p1.5.m5.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.5.m5.1.1.1.1.2" xref="S7.SS2.p1.5.m5.1.1.1.1.1.cmml">(</mo><msup id="S7.SS2.p1.5.m5.1.1.1.1.1" xref="S7.SS2.p1.5.m5.1.1.1.1.1.cmml"><mi id="S7.SS2.p1.5.m5.1.1.1.1.1.2" xref="S7.SS2.p1.5.m5.1.1.1.1.1.2.cmml">N</mi><mn id="S7.SS2.p1.5.m5.1.1.1.1.1.3" xref="S7.SS2.p1.5.m5.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.SS2.p1.5.m5.1.1.1.1.3" xref="S7.SS2.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.7.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w2">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w3">complexity,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w4">same</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w5">as</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w6">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w7">Transformer.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w8">We</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w9">then</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w10">proceed</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w11">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w12">analyze</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w13">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w14">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w15">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w16">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w17">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w18">hierarchical</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w19">accumulation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w20">process.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w21">Formally,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.7.w22">let</span><span> </span><math id="S7.SS2.p1.6.m6.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S7.SS2.p1.6.m6.1a"><mi id="S7.SS2.p1.6.m6.1.1" xref="S7.SS2.p1.6.m6.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.8.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.8.w2">be</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.8.w3">a</span><span> </span><math id="S7.SS2.p1.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S7.SS2.p1.7.m7.1a"><mi id="S7.SS2.p1.7.m7.1.1" xref="S7.SS2.p1.7.m7.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.9.w1">-length</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.9.w2">sentence</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.9.w3">with</span><span> </span><math id="S7.SS2.p1.8.m8.4" class="ltx_Math" alttext="\mathcal{T}(X)=(\mathcal{L},\mathcal{N},\mathcal{R})" display="inline"><semantics id="S7.SS2.p1.8.m8.4a"><mrow id="S7.SS2.p1.8.m8.4.5" xref="S7.SS2.p1.8.m8.4.5.cmml"><mrow id="S7.SS2.p1.8.m8.4.5.2" xref="S7.SS2.p1.8.m8.4.5.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.8.m8.4.5.2.2" xref="S7.SS2.p1.8.m8.4.5.2.2.cmml">𝒯</mi><mo id="S7.SS2.p1.8.m8.4.5.2.1" xref="S7.SS2.p1.8.m8.4.5.2.1.cmml">⁢</mo><mrow id="S7.SS2.p1.8.m8.4.5.2.3.2" xref="S7.SS2.p1.8.m8.4.5.2.cmml"><mo stretchy="false" id="S7.SS2.p1.8.m8.4.5.2.3.2.1" xref="S7.SS2.p1.8.m8.4.5.2.cmml">(</mo><mi id="S7.SS2.p1.8.m8.1.1" xref="S7.SS2.p1.8.m8.1.1.cmml">X</mi><mo stretchy="false" id="S7.SS2.p1.8.m8.4.5.2.3.2.2" xref="S7.SS2.p1.8.m8.4.5.2.cmml">)</mo></mrow></mrow><mo id="S7.SS2.p1.8.m8.4.5.1" xref="S7.SS2.p1.8.m8.4.5.1.cmml">=</mo><mrow id="S7.SS2.p1.8.m8.4.5.3.2" xref="S7.SS2.p1.8.m8.4.5.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.8.m8.4.5.3.2.1" xref="S7.SS2.p1.8.m8.4.5.3.1.cmml">(</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.8.m8.2.2" xref="S7.SS2.p1.8.m8.2.2.cmml">ℒ</mi><mo id="S7.SS2.p1.8.m8.4.5.3.2.2" xref="S7.SS2.p1.8.m8.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.8.m8.3.3" xref="S7.SS2.p1.8.m8.3.3.cmml">𝒩</mi><mo id="S7.SS2.p1.8.m8.4.5.3.2.3" xref="S7.SS2.p1.8.m8.4.5.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.8.m8.4.4" xref="S7.SS2.p1.8.m8.4.4.cmml">ℛ</mi><mo stretchy="false" id="S7.SS2.p1.8.m8.4.5.3.2.4" xref="S7.SS2.p1.8.m8.4.5.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.10.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w2">as</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w3">its</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w4">balance</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w5">binary</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w6">constituency</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w7">parse</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w8">tree</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w9">as</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w10">defined</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w11">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.10.w12">section</span><span> </span><a href="#S4" title="4 Tree-based Attention ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4</a><span class="gd_word" id="S7.SS2.p1.35.11.w1">,</span><span> </span><math id="S7.SS2.p1.9.m9.1" class="ltx_Math" alttext="{\bm{N}}\in{\mathbb{R}}^{m\times d}" display="inline"><semantics id="S7.SS2.p1.9.m9.1a"><mrow id="S7.SS2.p1.9.m9.1.1" xref="S7.SS2.p1.9.m9.1.1.cmml"><mi id="S7.SS2.p1.9.m9.1.1.2" xref="S7.SS2.p1.9.m9.1.1.2.cmml">𝑵</mi><mo id="S7.SS2.p1.9.m9.1.1.1" xref="S7.SS2.p1.9.m9.1.1.1.cmml">∈</mo><msup id="S7.SS2.p1.9.m9.1.1.3" xref="S7.SS2.p1.9.m9.1.1.3.cmml"><mi id="S7.SS2.p1.9.m9.1.1.3.2" xref="S7.SS2.p1.9.m9.1.1.3.2.cmml">ℝ</mi><mrow id="S7.SS2.p1.9.m9.1.1.3.3" xref="S7.SS2.p1.9.m9.1.1.3.3.cmml"><mi id="S7.SS2.p1.9.m9.1.1.3.3.2" xref="S7.SS2.p1.9.m9.1.1.3.3.2.cmml">m</mi><mo id="S7.SS2.p1.9.m9.1.1.3.3.1" xref="S7.SS2.p1.9.m9.1.1.3.3.1.cmml">×</mo><mi id="S7.SS2.p1.9.m9.1.1.3.3.3" xref="S7.SS2.p1.9.m9.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.12.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.12.w2">and</span><span> </span><math id="S7.SS2.p1.10.m10.1" class="ltx_Math" alttext="{\bm{L}}\in{\mathbb{R}}^{n\times d}" display="inline"><semantics id="S7.SS2.p1.10.m10.1a"><mrow id="S7.SS2.p1.10.m10.1.1" xref="S7.SS2.p1.10.m10.1.1.cmml"><mi id="S7.SS2.p1.10.m10.1.1.2" xref="S7.SS2.p1.10.m10.1.1.2.cmml">𝑳</mi><mo id="S7.SS2.p1.10.m10.1.1.1" xref="S7.SS2.p1.10.m10.1.1.1.cmml">∈</mo><msup id="S7.SS2.p1.10.m10.1.1.3" xref="S7.SS2.p1.10.m10.1.1.3.cmml"><mi id="S7.SS2.p1.10.m10.1.1.3.2" xref="S7.SS2.p1.10.m10.1.1.3.2.cmml">ℝ</mi><mrow id="S7.SS2.p1.10.m10.1.1.3.3" xref="S7.SS2.p1.10.m10.1.1.3.3.cmml"><mi id="S7.SS2.p1.10.m10.1.1.3.3.2" xref="S7.SS2.p1.10.m10.1.1.3.3.2.cmml">n</mi><mo id="S7.SS2.p1.10.m10.1.1.3.3.1" xref="S7.SS2.p1.10.m10.1.1.3.3.1.cmml">×</mo><mi id="S7.SS2.p1.10.m10.1.1.3.3.3" xref="S7.SS2.p1.10.m10.1.1.3.3.3.cmml">d</mi></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.13.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w2">be</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w4">hidden</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w5">states</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w6">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w7">elements</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.13.w8">in</span><span> </span><math id="S7.SS2.p1.11.m11.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S7.SS2.p1.11.m11.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.11.m11.1.1" xref="S7.SS2.p1.11.m11.1.1.cmml">𝒩</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.14.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.14.w2">and</span><span> </span><math id="S7.SS2.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{L}" display="inline"><semantics id="S7.SS2.p1.12.m12.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.12.m12.1.1" xref="S7.SS2.p1.12.m12.1.1.cmml">ℒ</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.15.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.15.w2">respectively.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.15.w3">Therefore,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.15.w4">there</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.15.w5">are</span><span> </span><math id="S7.SS2.p1.13.m13.1" class="ltx_Math" alttext="m=n-1" display="inline"><semantics id="S7.SS2.p1.13.m13.1a"><mrow id="S7.SS2.p1.13.m13.1.1" xref="S7.SS2.p1.13.m13.1.1.cmml"><mi id="S7.SS2.p1.13.m13.1.1.2" xref="S7.SS2.p1.13.m13.1.1.2.cmml">m</mi><mo id="S7.SS2.p1.13.m13.1.1.1" xref="S7.SS2.p1.13.m13.1.1.1.cmml">=</mo><mrow id="S7.SS2.p1.13.m13.1.1.3" xref="S7.SS2.p1.13.m13.1.1.3.cmml"><mi id="S7.SS2.p1.13.m13.1.1.3.2" xref="S7.SS2.p1.13.m13.1.1.3.2.cmml">n</mi><mo id="S7.SS2.p1.13.m13.1.1.3.1" xref="S7.SS2.p1.13.m13.1.1.3.1.cmml">-</mo><mn id="S7.SS2.p1.13.m13.1.1.3.3" xref="S7.SS2.p1.13.m13.1.1.3.3.cmml">1</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.16.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w2">non-terminal</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w3">nodes</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w4">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w5">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w6">tree,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w7">which</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w8">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w9">also</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w10">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w11">size</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.16.w12">of</span><span> </span><math id="S7.SS2.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{N}" display="inline"><semantics id="S7.SS2.p1.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.14.m14.1.1" xref="S7.SS2.p1.14.m14.1.1.cmml">𝒩</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.17.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.17.w2">In</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.17.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.17.w4">upward</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.17.w5">cumulative-average</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.17.w6">operation</span><span> </span><math id="S7.SS2.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S7.SS2.p1.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.15.m15.1.1" xref="S7.SS2.p1.15.m15.1.1.cmml">𝒰</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.18.w1">,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w2">each</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w3">branch</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w4">from</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w5">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w6">root</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w7">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w8">a</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w9">leaf</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.18.w10">has</span><span> </span><math id="S7.SS2.p1.16.m16.2" class="ltx_Math" alttext="\approx\log(n)" display="inline"><semantics id="S7.SS2.p1.16.m16.2a"><mrow id="S7.SS2.p1.16.m16.2.3" xref="S7.SS2.p1.16.m16.2.3.cmml"><mi id="S7.SS2.p1.16.m16.2.3.2" xref="S7.SS2.p1.16.m16.2.3.2.cmml"/><mo id="S7.SS2.p1.16.m16.2.3.1" xref="S7.SS2.p1.16.m16.2.3.1.cmml">≈</mo><mrow id="S7.SS2.p1.16.m16.2.3.3.2" xref="S7.SS2.p1.16.m16.2.3.3.1.cmml"><mi id="S7.SS2.p1.16.m16.1.1" xref="S7.SS2.p1.16.m16.1.1.cmml">log</mi><mo id="S7.SS2.p1.16.m16.2.3.3.2a" xref="S7.SS2.p1.16.m16.2.3.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.16.m16.2.3.3.2.1" xref="S7.SS2.p1.16.m16.2.3.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.16.m16.2.3.3.2.1.1" xref="S7.SS2.p1.16.m16.2.3.3.1.cmml">(</mo><mi id="S7.SS2.p1.16.m16.2.2" xref="S7.SS2.p1.16.m16.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.16.m16.2.3.3.2.1.2" xref="S7.SS2.p1.16.m16.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.19.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w2">nodes,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w4">cumulative</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w5">operation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w6">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w7">these</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w8">nodes</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w9">can</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w10">be</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w11">done</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.19.w12">at</span><span> </span><math id="S7.SS2.p1.17.m17.3" class="ltx_Math" alttext="\mathcal{O}(\log(n))" display="inline"><semantics id="S7.SS2.p1.17.m17.3a"><mrow id="S7.SS2.p1.17.m17.3.3" xref="S7.SS2.p1.17.m17.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.17.m17.3.3.3" xref="S7.SS2.p1.17.m17.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.17.m17.3.3.2" xref="S7.SS2.p1.17.m17.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.17.m17.3.3.1.1" xref="S7.SS2.p1.17.m17.3.3.cmml"><mo stretchy="false" id="S7.SS2.p1.17.m17.3.3.1.1.2" xref="S7.SS2.p1.17.m17.3.3.cmml">(</mo><mrow id="S7.SS2.p1.17.m17.3.3.1.1.1.2" xref="S7.SS2.p1.17.m17.3.3.1.1.1.1.cmml"><mi id="S7.SS2.p1.17.m17.1.1" xref="S7.SS2.p1.17.m17.1.1.cmml">log</mi><mo id="S7.SS2.p1.17.m17.3.3.1.1.1.2a" xref="S7.SS2.p1.17.m17.3.3.1.1.1.1.cmml">⁡</mo><mrow id="S7.SS2.p1.17.m17.3.3.1.1.1.2.1" xref="S7.SS2.p1.17.m17.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.17.m17.3.3.1.1.1.2.1.1" xref="S7.SS2.p1.17.m17.3.3.1.1.1.1.cmml">(</mo><mi id="S7.SS2.p1.17.m17.2.2" xref="S7.SS2.p1.17.m17.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.17.m17.3.3.1.1.1.2.1.2" xref="S7.SS2.p1.17.m17.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.17.m17.3.3.1.1.3" xref="S7.SS2.p1.17.m17.3.3.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.20.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.20.w2">That</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.20.w3">is,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.20.w4">because</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.20.w5">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.20.w6">result</span><span> </span><math id="S7.SS2.p1.18.m18.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="S7.SS2.p1.18.m18.1a"><msub id="S7.SS2.p1.18.m18.1.1" xref="S7.SS2.p1.18.m18.1.1.cmml"><mi id="S7.SS2.p1.18.m18.1.1.2" xref="S7.SS2.p1.18.m18.1.1.2.cmml">y</mi><mi id="S7.SS2.p1.18.m18.1.1.3" xref="S7.SS2.p1.18.m18.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S7.SS2.p1.35.21.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.21.w2">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.21.w3">each</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.21.w4">node</span><span> </span><math id="S7.SS2.p1.19.m19.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S7.SS2.p1.19.m19.1a"><msub id="S7.SS2.p1.19.m19.1.1" xref="S7.SS2.p1.19.m19.1.1.cmml"><mi id="S7.SS2.p1.19.m19.1.1.2" xref="S7.SS2.p1.19.m19.1.1.2.cmml">x</mi><mi id="S7.SS2.p1.19.m19.1.1.3" xref="S7.SS2.p1.19.m19.1.1.3.cmml">i</mi></msub></semantics></math><span class="gd_word" id="S7.SS2.p1.35.22.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.22.w2">can</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.22.w3">be</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.22.w4">computed</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.22.w5">as</span><span> </span><math id="S7.SS2.p1.20.m20.1" class="ltx_Math" alttext="y_{i}=y_{i-1}+x_{i}" display="inline"><semantics id="S7.SS2.p1.20.m20.1a"><mrow id="S7.SS2.p1.20.m20.1.1" xref="S7.SS2.p1.20.m20.1.1.cmml"><msub id="S7.SS2.p1.20.m20.1.1.2" xref="S7.SS2.p1.20.m20.1.1.2.cmml"><mi id="S7.SS2.p1.20.m20.1.1.2.2" xref="S7.SS2.p1.20.m20.1.1.2.2.cmml">y</mi><mi id="S7.SS2.p1.20.m20.1.1.2.3" xref="S7.SS2.p1.20.m20.1.1.2.3.cmml">i</mi></msub><mo id="S7.SS2.p1.20.m20.1.1.1" xref="S7.SS2.p1.20.m20.1.1.1.cmml">=</mo><mrow id="S7.SS2.p1.20.m20.1.1.3" xref="S7.SS2.p1.20.m20.1.1.3.cmml"><msub id="S7.SS2.p1.20.m20.1.1.3.2" xref="S7.SS2.p1.20.m20.1.1.3.2.cmml"><mi id="S7.SS2.p1.20.m20.1.1.3.2.2" xref="S7.SS2.p1.20.m20.1.1.3.2.2.cmml">y</mi><mrow id="S7.SS2.p1.20.m20.1.1.3.2.3" xref="S7.SS2.p1.20.m20.1.1.3.2.3.cmml"><mi id="S7.SS2.p1.20.m20.1.1.3.2.3.2" xref="S7.SS2.p1.20.m20.1.1.3.2.3.2.cmml">i</mi><mo id="S7.SS2.p1.20.m20.1.1.3.2.3.1" xref="S7.SS2.p1.20.m20.1.1.3.2.3.1.cmml">-</mo><mn id="S7.SS2.p1.20.m20.1.1.3.2.3.3" xref="S7.SS2.p1.20.m20.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo id="S7.SS2.p1.20.m20.1.1.3.1" xref="S7.SS2.p1.20.m20.1.1.3.1.cmml">+</mo><msub id="S7.SS2.p1.20.m20.1.1.3.3" xref="S7.SS2.p1.20.m20.1.1.3.3.cmml"><mi id="S7.SS2.p1.20.m20.1.1.3.3.2" xref="S7.SS2.p1.20.m20.1.1.3.3.2.cmml">x</mi><mi id="S7.SS2.p1.20.m20.1.1.3.3.3" xref="S7.SS2.p1.20.m20.1.1.3.3.3.cmml">i</mi></msub></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.23.w1">,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w2">computations</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w3">for</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w4">all</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w5">nodes</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w6">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w7">a</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w8">branch</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w9">take</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w10">linear</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w11">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w12">using</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w13">dynamic</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w14">programming,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.23.w15">yielding</span><span> </span><math id="S7.SS2.p1.21.m21.3" class="ltx_Math" alttext="\mathcal{O}(\log(n))" display="inline"><semantics id="S7.SS2.p1.21.m21.3a"><mrow id="S7.SS2.p1.21.m21.3.3" xref="S7.SS2.p1.21.m21.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.21.m21.3.3.3" xref="S7.SS2.p1.21.m21.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.21.m21.3.3.2" xref="S7.SS2.p1.21.m21.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.21.m21.3.3.1.1" xref="S7.SS2.p1.21.m21.3.3.cmml"><mo stretchy="false" id="S7.SS2.p1.21.m21.3.3.1.1.2" xref="S7.SS2.p1.21.m21.3.3.cmml">(</mo><mrow id="S7.SS2.p1.21.m21.3.3.1.1.1.2" xref="S7.SS2.p1.21.m21.3.3.1.1.1.1.cmml"><mi id="S7.SS2.p1.21.m21.1.1" xref="S7.SS2.p1.21.m21.1.1.cmml">log</mi><mo id="S7.SS2.p1.21.m21.3.3.1.1.1.2a" xref="S7.SS2.p1.21.m21.3.3.1.1.1.1.cmml">⁡</mo><mrow id="S7.SS2.p1.21.m21.3.3.1.1.1.2.1" xref="S7.SS2.p1.21.m21.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.21.m21.3.3.1.1.1.2.1.1" xref="S7.SS2.p1.21.m21.3.3.1.1.1.1.cmml">(</mo><mi id="S7.SS2.p1.21.m21.2.2" xref="S7.SS2.p1.21.m21.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.21.m21.3.3.1.1.1.2.1.2" xref="S7.SS2.p1.21.m21.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.21.m21.3.3.1.1.3" xref="S7.SS2.p1.21.m21.3.3.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.24.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.24.w2">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.24.w3">complexity.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.24.w4">As</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.24.w5">we</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.24.w6">have</span><span> </span><math id="S7.SS2.p1.22.m22.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S7.SS2.p1.22.m22.1a"><mi id="S7.SS2.p1.22.m22.1.1" xref="S7.SS2.p1.22.m22.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.25.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w2">branches</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w3">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w4">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w5">tree,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w6">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w7">total</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w8">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.25.w9">for</span><span> </span><math id="S7.SS2.p1.23.m23.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S7.SS2.p1.23.m23.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.23.m23.1.1" xref="S7.SS2.p1.23.m23.1.1.cmml">𝒰</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.26.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.26.w2">is</span><span> </span><math id="S7.SS2.p1.24.m24.3" class="ltx_Math" alttext="\mathcal{O}(n\log(n))" display="inline"><semantics id="S7.SS2.p1.24.m24.3a"><mrow id="S7.SS2.p1.24.m24.3.3" xref="S7.SS2.p1.24.m24.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.24.m24.3.3.3" xref="S7.SS2.p1.24.m24.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.24.m24.3.3.2" xref="S7.SS2.p1.24.m24.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.24.m24.3.3.1.1" xref="S7.SS2.p1.24.m24.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.24.m24.3.3.1.1.2" xref="S7.SS2.p1.24.m24.3.3.1.1.1.cmml">(</mo><mrow id="S7.SS2.p1.24.m24.3.3.1.1.1" xref="S7.SS2.p1.24.m24.3.3.1.1.1.cmml"><mi id="S7.SS2.p1.24.m24.3.3.1.1.1.2" xref="S7.SS2.p1.24.m24.3.3.1.1.1.2.cmml">n</mi><mo id="S7.SS2.p1.24.m24.3.3.1.1.1.1" xref="S7.SS2.p1.24.m24.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS2.p1.24.m24.3.3.1.1.1.3.2" xref="S7.SS2.p1.24.m24.3.3.1.1.1.3.1.cmml"><mi id="S7.SS2.p1.24.m24.1.1" xref="S7.SS2.p1.24.m24.1.1.cmml">log</mi><mo id="S7.SS2.p1.24.m24.3.3.1.1.1.3.2a" xref="S7.SS2.p1.24.m24.3.3.1.1.1.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.24.m24.3.3.1.1.1.3.2.1" xref="S7.SS2.p1.24.m24.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.24.m24.3.3.1.1.1.3.2.1.1" xref="S7.SS2.p1.24.m24.3.3.1.1.1.3.1.cmml">(</mo><mi id="S7.SS2.p1.24.m24.2.2" xref="S7.SS2.p1.24.m24.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.24.m24.3.3.1.1.1.3.2.1.2" xref="S7.SS2.p1.24.m24.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.24.m24.3.3.1.1.3" xref="S7.SS2.p1.24.m24.3.3.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.27.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.27.w2">Likewise,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.27.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.27.w4">weighted</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.27.w5">aggregation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.27.w6">operation</span><span> </span><math id="S7.SS2.p1.25.m25.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S7.SS2.p1.25.m25.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.25.m25.1.1" xref="S7.SS2.p1.25.m25.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.28.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.28.w2">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.28.w3">also</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.28.w4">computed</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.28.w5">at</span><span> </span><math id="S7.SS2.p1.26.m26.3" class="ltx_Math" alttext="\mathcal{O}(n\log(n))" display="inline"><semantics id="S7.SS2.p1.26.m26.3a"><mrow id="S7.SS2.p1.26.m26.3.3" xref="S7.SS2.p1.26.m26.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.26.m26.3.3.3" xref="S7.SS2.p1.26.m26.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.26.m26.3.3.2" xref="S7.SS2.p1.26.m26.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.26.m26.3.3.1.1" xref="S7.SS2.p1.26.m26.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.26.m26.3.3.1.1.2" xref="S7.SS2.p1.26.m26.3.3.1.1.1.cmml">(</mo><mrow id="S7.SS2.p1.26.m26.3.3.1.1.1" xref="S7.SS2.p1.26.m26.3.3.1.1.1.cmml"><mi id="S7.SS2.p1.26.m26.3.3.1.1.1.2" xref="S7.SS2.p1.26.m26.3.3.1.1.1.2.cmml">n</mi><mo id="S7.SS2.p1.26.m26.3.3.1.1.1.1" xref="S7.SS2.p1.26.m26.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS2.p1.26.m26.3.3.1.1.1.3.2" xref="S7.SS2.p1.26.m26.3.3.1.1.1.3.1.cmml"><mi id="S7.SS2.p1.26.m26.1.1" xref="S7.SS2.p1.26.m26.1.1.cmml">log</mi><mo id="S7.SS2.p1.26.m26.3.3.1.1.1.3.2a" xref="S7.SS2.p1.26.m26.3.3.1.1.1.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.26.m26.3.3.1.1.1.3.2.1" xref="S7.SS2.p1.26.m26.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.26.m26.3.3.1.1.1.3.2.1.1" xref="S7.SS2.p1.26.m26.3.3.1.1.1.3.1.cmml">(</mo><mi id="S7.SS2.p1.26.m26.2.2" xref="S7.SS2.p1.26.m26.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.26.m26.3.3.1.1.1.3.2.1.2" xref="S7.SS2.p1.26.m26.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.26.m26.3.3.1.1.3" xref="S7.SS2.p1.26.m26.3.3.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.29.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.29.w2">complexity.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.29.w3">Specifically,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.29.w4">at</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.29.w5">level</span><span> </span><math id="S7.SS2.p1.27.m27.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S7.SS2.p1.27.m27.1a"><mi id="S7.SS2.p1.27.m27.1.1" xref="S7.SS2.p1.27.m27.1.1.cmml">i</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.30.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w2">from</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w4">root</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w5">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w6">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w7">tree,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.30.w8">there</span><span> </span><math id="S7.SS2.p1.28.m28.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S7.SS2.p1.28.m28.1a"><mi id="S7.SS2.p1.28.m28.1.1" xref="S7.SS2.p1.28.m28.1.1.cmml">i</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.31.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w2">non-terminal</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w3">nodes,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w4">which</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w5">each</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w6">has</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w7">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.31.w8">aggregate</span><span> </span><math id="S7.SS2.p1.29.m29.1" class="ltx_Math" alttext="n/i" display="inline"><semantics id="S7.SS2.p1.29.m29.1a"><mrow id="S7.SS2.p1.29.m29.1.1" xref="S7.SS2.p1.29.m29.1.1.cmml"><mi id="S7.SS2.p1.29.m29.1.1.2" xref="S7.SS2.p1.29.m29.1.1.2.cmml">n</mi><mo id="S7.SS2.p1.29.m29.1.1.1" xref="S7.SS2.p1.29.m29.1.1.1.cmml">/</mo><mi id="S7.SS2.p1.29.m29.1.1.3" xref="S7.SS2.p1.29.m29.1.1.3.cmml">i</mi></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.32.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.32.w2">components</span><span> </span><math id="S7.SS2.p1.30.m30.2" class="ltx_Math" alttext="\hat{{\bm{\mathsfit{S}}}}_{i,j}" display="inline"><semantics id="S7.SS2.p1.30.m30.2a"><msub id="S7.SS2.p1.30.m30.2.3" xref="S7.SS2.p1.30.m30.2.3.cmml"><mover accent="true" id="S7.SS2.p1.30.m30.2.3.2" xref="S7.SS2.p1.30.m30.2.3.2.cmml"><mi id="S7.SS2.p1.30.m30.2.3.2.2" xref="S7.SS2.p1.30.m30.2.3.2.2.cmml">𝑺</mi><mo stretchy="false" id="S7.SS2.p1.30.m30.2.3.2.1" xref="S7.SS2.p1.30.m30.2.3.2.1.cmml">^</mo></mover><mrow id="S7.SS2.p1.30.m30.2.2.2.4" xref="S7.SS2.p1.30.m30.2.2.2.3.cmml"><mi id="S7.SS2.p1.30.m30.1.1.1.1" xref="S7.SS2.p1.30.m30.1.1.1.1.cmml">i</mi><mo id="S7.SS2.p1.30.m30.2.2.2.4.1" xref="S7.SS2.p1.30.m30.2.2.2.3.cmml">,</mo><mi id="S7.SS2.p1.30.m30.2.2.2.2" xref="S7.SS2.p1.30.m30.2.2.2.2.cmml">j</mi></mrow></msub></semantics></math><span class="gd_word" id="S7.SS2.p1.35.33.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w2">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w3">calculate</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w4">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w5">final</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w6">representation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w7">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w8">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w9">node.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w10">Thus,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w11">at</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w12">each</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w13">level,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w14">there</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.33.w15">are</span><span> </span><math id="S7.SS2.p1.31.m31.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S7.SS2.p1.31.m31.1a"><mi id="S7.SS2.p1.31.m31.1.1" xref="S7.SS2.p1.31.m31.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.34.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w2">computations.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w3">Because</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w4">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w5">total</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w6">height</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w7">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w8">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w9">tree</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.34.w10">is</span><span> </span><math id="S7.SS2.p1.32.m32.2" class="ltx_Math" alttext="\log(n)" display="inline"><semantics id="S7.SS2.p1.32.m32.2a"><mrow id="S7.SS2.p1.32.m32.2.3.2" xref="S7.SS2.p1.32.m32.2.3.1.cmml"><mi id="S7.SS2.p1.32.m32.1.1" xref="S7.SS2.p1.32.m32.1.1.cmml">log</mi><mo id="S7.SS2.p1.32.m32.2.3.2a" xref="S7.SS2.p1.32.m32.2.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.32.m32.2.3.2.1" xref="S7.SS2.p1.32.m32.2.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.32.m32.2.3.2.1.1" xref="S7.SS2.p1.32.m32.2.3.1.cmml">(</mo><mi id="S7.SS2.p1.32.m32.2.2" xref="S7.SS2.p1.32.m32.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.32.m32.2.3.2.1.2" xref="S7.SS2.p1.32.m32.2.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.35.w1">,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.35.w2">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.35.w3">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.35.w4">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.35.w5">of</span><span> </span><math id="S7.SS2.p1.33.m33.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S7.SS2.p1.33.m33.1a"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.33.m33.1.1" xref="S7.SS2.p1.33.m33.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S7.SS2.p1.35.36.w1"/><span> </span><span class="gd_word" id="S7.SS2.p1.35.36.w2">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.36.w3">also</span><span> </span><math id="S7.SS2.p1.34.m34.3" class="ltx_Math" alttext="\mathcal{O}(n\log(n))" display="inline"><semantics id="S7.SS2.p1.34.m34.3a"><mrow id="S7.SS2.p1.34.m34.3.3" xref="S7.SS2.p1.34.m34.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.34.m34.3.3.3" xref="S7.SS2.p1.34.m34.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.34.m34.3.3.2" xref="S7.SS2.p1.34.m34.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.34.m34.3.3.1.1" xref="S7.SS2.p1.34.m34.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.34.m34.3.3.1.1.2" xref="S7.SS2.p1.34.m34.3.3.1.1.1.cmml">(</mo><mrow id="S7.SS2.p1.34.m34.3.3.1.1.1" xref="S7.SS2.p1.34.m34.3.3.1.1.1.cmml"><mi id="S7.SS2.p1.34.m34.3.3.1.1.1.2" xref="S7.SS2.p1.34.m34.3.3.1.1.1.2.cmml">n</mi><mo id="S7.SS2.p1.34.m34.3.3.1.1.1.1" xref="S7.SS2.p1.34.m34.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS2.p1.34.m34.3.3.1.1.1.3.2" xref="S7.SS2.p1.34.m34.3.3.1.1.1.3.1.cmml"><mi id="S7.SS2.p1.34.m34.1.1" xref="S7.SS2.p1.34.m34.1.1.cmml">log</mi><mo id="S7.SS2.p1.34.m34.3.3.1.1.1.3.2a" xref="S7.SS2.p1.34.m34.3.3.1.1.1.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.34.m34.3.3.1.1.1.3.2.1" xref="S7.SS2.p1.34.m34.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.34.m34.3.3.1.1.1.3.2.1.1" xref="S7.SS2.p1.34.m34.3.3.1.1.1.3.1.cmml">(</mo><mi id="S7.SS2.p1.34.m34.2.2" xref="S7.SS2.p1.34.m34.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.34.m34.3.3.1.1.1.3.2.1.2" xref="S7.SS2.p1.34.m34.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.34.m34.3.3.1.1.3" xref="S7.SS2.p1.34.m34.3.3.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.37.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w2">Hence,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w3">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w4">total</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w5">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w6">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w7">hierarchical</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w8">accumulation</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w9">process</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.37.w10">is</span><span> </span><math id="S7.SS2.p1.35.m35.3" class="ltx_Math" alttext="\mathcal{O}(n\log(n))" display="inline"><semantics id="S7.SS2.p1.35.m35.3a"><mrow id="S7.SS2.p1.35.m35.3.3" xref="S7.SS2.p1.35.m35.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.SS2.p1.35.m35.3.3.3" xref="S7.SS2.p1.35.m35.3.3.3.cmml">𝒪</mi><mo id="S7.SS2.p1.35.m35.3.3.2" xref="S7.SS2.p1.35.m35.3.3.2.cmml">⁢</mo><mrow id="S7.SS2.p1.35.m35.3.3.1.1" xref="S7.SS2.p1.35.m35.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.SS2.p1.35.m35.3.3.1.1.2" xref="S7.SS2.p1.35.m35.3.3.1.1.1.cmml">(</mo><mrow id="S7.SS2.p1.35.m35.3.3.1.1.1" xref="S7.SS2.p1.35.m35.3.3.1.1.1.cmml"><mi id="S7.SS2.p1.35.m35.3.3.1.1.1.2" xref="S7.SS2.p1.35.m35.3.3.1.1.1.2.cmml">n</mi><mo id="S7.SS2.p1.35.m35.3.3.1.1.1.1" xref="S7.SS2.p1.35.m35.3.3.1.1.1.1.cmml">⁢</mo><mrow id="S7.SS2.p1.35.m35.3.3.1.1.1.3.2" xref="S7.SS2.p1.35.m35.3.3.1.1.1.3.1.cmml"><mi id="S7.SS2.p1.35.m35.1.1" xref="S7.SS2.p1.35.m35.1.1.cmml">log</mi><mo id="S7.SS2.p1.35.m35.3.3.1.1.1.3.2a" xref="S7.SS2.p1.35.m35.3.3.1.1.1.3.1.cmml">⁡</mo><mrow id="S7.SS2.p1.35.m35.3.3.1.1.1.3.2.1" xref="S7.SS2.p1.35.m35.3.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S7.SS2.p1.35.m35.3.3.1.1.1.3.2.1.1" xref="S7.SS2.p1.35.m35.3.3.1.1.1.3.1.cmml">(</mo><mi id="S7.SS2.p1.35.m35.2.2" xref="S7.SS2.p1.35.m35.2.2.cmml">n</mi><mo stretchy="false" id="S7.SS2.p1.35.m35.3.3.1.1.1.3.2.1.2" xref="S7.SS2.p1.35.m35.3.3.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.SS2.p1.35.m35.3.3.1.1.3" xref="S7.SS2.p1.35.m35.3.3.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS2.p1.35.38.w1">.</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w2">As</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w3">such,</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w4">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w5">final</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w6">sequential</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w7">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w8">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w9">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w10">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w11">proposed</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w12">attention</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w13">layer</span><span> </span><span class="gd_word" id="S7.SS2.p1.35.38.w14">is:</span></p>
<table id="S7.E28" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S7.E28.m1.7" class="ltx_Math" alttext="\mathcal{O}(N^{2})+\mathcal{O}((N-1)^{2})+\mathcal{O}((N-1)N)+\mathcal{O}(N%&#10;\log(N))=\mathcal{O}(N^{2})" display="block"><semantics id="S7.E28.m1.7a"><mrow id="S7.E28.m1.7.7" xref="S7.E28.m1.7.7.cmml"><mrow id="S7.E28.m1.6.6.4" xref="S7.E28.m1.6.6.4.cmml"><mrow id="S7.E28.m1.3.3.1.1" xref="S7.E28.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E28.m1.3.3.1.1.3" xref="S7.E28.m1.3.3.1.1.3.cmml">𝒪</mi><mo id="S7.E28.m1.3.3.1.1.2" xref="S7.E28.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S7.E28.m1.3.3.1.1.1.1" xref="S7.E28.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.3.3.1.1.1.1.2" xref="S7.E28.m1.3.3.1.1.1.1.1.cmml">(</mo><msup id="S7.E28.m1.3.3.1.1.1.1.1" xref="S7.E28.m1.3.3.1.1.1.1.1.cmml"><mi id="S7.E28.m1.3.3.1.1.1.1.1.2" xref="S7.E28.m1.3.3.1.1.1.1.1.2.cmml">N</mi><mn id="S7.E28.m1.3.3.1.1.1.1.1.3" xref="S7.E28.m1.3.3.1.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.E28.m1.3.3.1.1.1.1.3" xref="S7.E28.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E28.m1.6.6.4.5" xref="S7.E28.m1.6.6.4.5.cmml">+</mo><mrow id="S7.E28.m1.4.4.2.2" xref="S7.E28.m1.4.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E28.m1.4.4.2.2.3" xref="S7.E28.m1.4.4.2.2.3.cmml">𝒪</mi><mo id="S7.E28.m1.4.4.2.2.2" xref="S7.E28.m1.4.4.2.2.2.cmml">⁢</mo><mrow id="S7.E28.m1.4.4.2.2.1.1" xref="S7.E28.m1.4.4.2.2.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.4.4.2.2.1.1.2" xref="S7.E28.m1.4.4.2.2.1.1.1.cmml">(</mo><msup id="S7.E28.m1.4.4.2.2.1.1.1" xref="S7.E28.m1.4.4.2.2.1.1.1.cmml"><mrow id="S7.E28.m1.4.4.2.2.1.1.1.1.1" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.4.4.2.2.1.1.1.1.1.2" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E28.m1.4.4.2.2.1.1.1.1.1.1" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.cmml"><mi id="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.2" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.2.cmml">N</mi><mo id="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.1" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.1.cmml">-</mo><mn id="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.3" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S7.E28.m1.4.4.2.2.1.1.1.1.1.3" xref="S7.E28.m1.4.4.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S7.E28.m1.4.4.2.2.1.1.1.3" xref="S7.E28.m1.4.4.2.2.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.E28.m1.4.4.2.2.1.1.3" xref="S7.E28.m1.4.4.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E28.m1.6.6.4.5a" xref="S7.E28.m1.6.6.4.5.cmml">+</mo><mrow id="S7.E28.m1.5.5.3.3" xref="S7.E28.m1.5.5.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E28.m1.5.5.3.3.3" xref="S7.E28.m1.5.5.3.3.3.cmml">𝒪</mi><mo id="S7.E28.m1.5.5.3.3.2" xref="S7.E28.m1.5.5.3.3.2.cmml">⁢</mo><mrow id="S7.E28.m1.5.5.3.3.1.1" xref="S7.E28.m1.5.5.3.3.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.5.5.3.3.1.1.2" xref="S7.E28.m1.5.5.3.3.1.1.1.cmml">(</mo><mrow id="S7.E28.m1.5.5.3.3.1.1.1" xref="S7.E28.m1.5.5.3.3.1.1.1.cmml"><mrow id="S7.E28.m1.5.5.3.3.1.1.1.1.1" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.5.5.3.3.1.1.1.1.1.2" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S7.E28.m1.5.5.3.3.1.1.1.1.1.1" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.cmml"><mi id="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.2" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.2.cmml">N</mi><mo id="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.1" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.1.cmml">-</mo><mn id="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.3" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S7.E28.m1.5.5.3.3.1.1.1.1.1.3" xref="S7.E28.m1.5.5.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S7.E28.m1.5.5.3.3.1.1.1.2" xref="S7.E28.m1.5.5.3.3.1.1.1.2.cmml">⁢</mo><mi id="S7.E28.m1.5.5.3.3.1.1.1.3" xref="S7.E28.m1.5.5.3.3.1.1.1.3.cmml">N</mi></mrow><mo stretchy="false" id="S7.E28.m1.5.5.3.3.1.1.3" xref="S7.E28.m1.5.5.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S7.E28.m1.6.6.4.5b" xref="S7.E28.m1.6.6.4.5.cmml">+</mo><mrow id="S7.E28.m1.6.6.4.4" xref="S7.E28.m1.6.6.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E28.m1.6.6.4.4.3" xref="S7.E28.m1.6.6.4.4.3.cmml">𝒪</mi><mo id="S7.E28.m1.6.6.4.4.2" xref="S7.E28.m1.6.6.4.4.2.cmml">⁢</mo><mrow id="S7.E28.m1.6.6.4.4.1.1" xref="S7.E28.m1.6.6.4.4.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.6.6.4.4.1.1.2" xref="S7.E28.m1.6.6.4.4.1.1.1.cmml">(</mo><mrow id="S7.E28.m1.6.6.4.4.1.1.1" xref="S7.E28.m1.6.6.4.4.1.1.1.cmml"><mi id="S7.E28.m1.6.6.4.4.1.1.1.2" xref="S7.E28.m1.6.6.4.4.1.1.1.2.cmml">N</mi><mo id="S7.E28.m1.6.6.4.4.1.1.1.1" xref="S7.E28.m1.6.6.4.4.1.1.1.1.cmml">⁢</mo><mrow id="S7.E28.m1.6.6.4.4.1.1.1.3.2" xref="S7.E28.m1.6.6.4.4.1.1.1.3.1.cmml"><mi id="S7.E28.m1.1.1" xref="S7.E28.m1.1.1.cmml">log</mi><mo id="S7.E28.m1.6.6.4.4.1.1.1.3.2a" xref="S7.E28.m1.6.6.4.4.1.1.1.3.1.cmml">⁡</mo><mrow id="S7.E28.m1.6.6.4.4.1.1.1.3.2.1" xref="S7.E28.m1.6.6.4.4.1.1.1.3.1.cmml"><mo stretchy="false" id="S7.E28.m1.6.6.4.4.1.1.1.3.2.1.1" xref="S7.E28.m1.6.6.4.4.1.1.1.3.1.cmml">(</mo><mi id="S7.E28.m1.2.2" xref="S7.E28.m1.2.2.cmml">N</mi><mo stretchy="false" id="S7.E28.m1.6.6.4.4.1.1.1.3.2.1.2" xref="S7.E28.m1.6.6.4.4.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S7.E28.m1.6.6.4.4.1.1.3" xref="S7.E28.m1.6.6.4.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S7.E28.m1.7.7.6" xref="S7.E28.m1.7.7.6.cmml">=</mo><mrow id="S7.E28.m1.7.7.5" xref="S7.E28.m1.7.7.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.E28.m1.7.7.5.3" xref="S7.E28.m1.7.7.5.3.cmml">𝒪</mi><mo id="S7.E28.m1.7.7.5.2" xref="S7.E28.m1.7.7.5.2.cmml">⁢</mo><mrow id="S7.E28.m1.7.7.5.1.1" xref="S7.E28.m1.7.7.5.1.1.1.cmml"><mo stretchy="false" id="S7.E28.m1.7.7.5.1.1.2" xref="S7.E28.m1.7.7.5.1.1.1.cmml">(</mo><msup id="S7.E28.m1.7.7.5.1.1.1" xref="S7.E28.m1.7.7.5.1.1.1.cmml"><mi id="S7.E28.m1.7.7.5.1.1.1.2" xref="S7.E28.m1.7.7.5.1.1.1.2.cmml">N</mi><mn id="S7.E28.m1.7.7.5.1.1.1.3" xref="S7.E28.m1.7.7.5.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S7.E28.m1.7.7.5.1.1.3" xref="S7.E28.m1.7.7.5.1.1.1.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr>
</table>
<p id="S7.SS2.p1.36" class="ltx_p"><span class="gd_word" id="S7.SS2.p1.36.1.w1">Having</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w2">said</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w3">that,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w4">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w5">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w6">era</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w7">that</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w8">powerful</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w9">GPU-based</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w10">hardware</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w11">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w12">ubiquitous,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w13">it</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w14">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w15">important</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w16">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w17">note</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w18">that</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w19">our</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w20">models</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w21">can</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w22">achieve</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w23">comparable</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w24">parallelizability</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w25">compared</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w26">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w27">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w28">Transformer,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w29">while</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w30">they</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w31">can</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w32">leverage</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w33">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w34">essence</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w35">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w36">hierarchical</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w37">structures</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w38">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w39">natural</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w40">languages.</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w41">The</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w42">purpose</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w43">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w44">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w45">above</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w46">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w47">complexity</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w48">analysis</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w49">is</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w50">only</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w51">to</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w52">show</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w53">more</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w54">insights</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w55">about</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w56">our</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w57">models.</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w58">That</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w59">being</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w60">said,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w61">even</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w62">though</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w63">we</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w64">provide</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w65">numerical</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w66">analysis</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w67">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w68">training</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w69">speed</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.1.w70">(figure</span><span> </span><a href="#S5.F4.sf2" title="(b) ‣ Figure 5 ‣ Results. ‣ 5.2 Text Classification ‣ 5 Experiments ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">4(b)</a><span class="gd_word" id="S7.SS2.p1.36.2.w1">)</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w2">as</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w3">objective</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w4">as</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w5">we</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w6">could,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w7">training</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w8">speed</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w9">depends</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w10">greatly</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w11">on</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w12">different</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w13">subjective</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w14">factors</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w15">that</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w16">may</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w17">stray</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w18">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w19">actual</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w20">timing</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w21">away</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w22">from</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w23">its</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w24">theoretical</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w25">asymptotic</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w26">time</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w27">complexity.</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w28">These</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w29">factors</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w30">are</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w31">data</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w32">preprocessing</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w33">and</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w34">batching,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w35">actual</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w36">low-level</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w37">and</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w38">high-level</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w39">programmatic</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w40">implementation</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w41">of</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w42">the</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w43">method,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w44">GPUs,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w45">CPUs,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w46">I/O</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w47">hardwares,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w48">etc.</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w49">For</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w50">instance,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w51">a</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w52">standard</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w53">LSTM</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w54">module</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w55">in</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w56">Tensorflow</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w57">or</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w58">Pytorch</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w59">may</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w60">performs</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w61">10</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w62">times</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w63">slower</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w64">than</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w65">an</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w66">LSTM</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w67">with</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w68">CUDA</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w69">CuDNN</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w70">kernels,</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w71">even</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w72">though</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w73">no</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w74">extra</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w75">computations</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w76">are</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w77">theoretical</span><span> </span><span class="gd_word" id="S7.SS2.p1.36.2.w78">required.</span></p>
</div>
</section>
<section id="S7.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3 </span>Overall Architecture</h3>

<div id="S7.SS3.p1" class="ltx_para ltx_noindent">
<p id="S7.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S7.SS3.p1.1.1.w1">Figure</span><span> </span><a href="#S7.F6" title="Figure 6 ‣ 7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">6</a><span class="gd_word" id="S7.SS3.p1.1.2.w1"/><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w2">shows</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w3">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w4">overall</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w5">Seq2Seq</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w6">architecture</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w7">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w8">our</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w9">model.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w10">In</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w11">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w12">encoder</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w13">specifically,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w14">we</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w15">parse</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w16">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w17">source</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w18">sequence</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w19">into</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w20">constituency</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w21">trees</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w22">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w23">then</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w24">feed</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w25">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w26">leaf</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w27">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w28">node</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w29">components</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w30">into</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w31">a</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w32">stack</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w33">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w34">encoder</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w35">layers.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w36">The</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w37">leaf</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w38">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w39">node</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w40">components</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w41">are</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w42">passed</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w43">through</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w44">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w45">tree-based</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w46">self-attention</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w47">layer,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w48">where</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w49">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w50">value</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w51">representation</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w52">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w53">node</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w54">is</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w55">incorporated</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w56">with</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w57">hierarchical</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w58">accumulation.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w59">After</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w60">that,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w61">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w62">output</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w63">representations</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w64">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w65">leaves</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w66">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w67">nodes</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w68">are</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w69">passed</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w70">through</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w71">a</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w72">weight-shared</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w73">series</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w74">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w75">layer</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w76">normalizations</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w77">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w78">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w79">feed-forward</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w80">layer.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w81">In</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w82">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w83">decoder,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w84">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w85">query</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w86">representation</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w87">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w88">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w89">target</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w90">domain</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w91">attends</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w92">on</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w93">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w94">leaves</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w95">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w96">nodes</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w97">representation</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w98">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w99">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w100">source</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w101">sequence</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w102">as</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w103">computed</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w104">by</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w105">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w106">encoder.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w107">For</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w108">more</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w109">insights,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w110">apply</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w111">hierarchical</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w112">accumulation</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w113">on</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w114">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w115">key</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w116">components</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w117">(instead</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w118">on</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w119">value</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w120">components)</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w121">causes</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w122">dramatic</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w123">performance</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w124">because</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w125">they</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w126">are</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w127">disrupted</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w128">after</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w129">being</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w130">multiplied</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w131">with</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w132">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w133">query</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w134">components</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w135">and</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w136">they</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w137">do</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w138">not</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w139">directly</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w140">contribute</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w141">to</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w142">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w143">representations</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w144">of</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w145">the</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w146">outputs.</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w147">Meanwhile,</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w148">applying</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w149">accumulation</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w150">on</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w151">attention</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w152">scores</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w153">does</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w154">not</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w155">yield</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w156">performance</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w157">benefits</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w158">but</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w159">increases</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w160">computational</span><span> </span><span class="gd_word" id="S7.SS3.p1.1.2.w161">burden.</span></p>
</div>
<div id="S7.SS3.p2" class="ltx_para ltx_noindent">
<p id="S7.SS3.p2.1" class="ltx_p"><span class="gd_word" id="S7.SS3.p2.1.1.w1">Table</span><span> </span><a href="#S7.T5" title="Table 5 ‣ 7.3 Overall Architecture ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">5</a><span class="gd_word" id="S7.SS3.p2.1.2.w1"/><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w2">shows</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w3">the</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w4">exact</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w5">number</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w6">of</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w7">parameters</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w8">of</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w9">the</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w10">Transformer</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w11">and</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w12">our</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w13">method.</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w14">As</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w15">it</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w16">can</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w17">be</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w18">seen,</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w19">the</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w20">increase</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w21">of</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w22">parameters</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w23">is</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w24">almost</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w25">unnoticeable</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w26">because</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w27">the</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w28">hierarchical</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w29">embedding</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w30">modules</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w31">share</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w32">weights</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w33">among</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w34">different</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w35">attention</span><span> </span><span class="gd_word" id="S7.SS3.p2.1.2.w36">heads.</span></p>
</div>
<figure id="S7.F6" class="ltx_figure"><img src="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/treetransformer_v3.png" id="S7.F6.g1" class="ltx_graphics ltx_centering" width="" height="" alt="/static/img/2002.08046-gpt-3.5-turbo//static/img/2002.08046/img/treetransformer_v3.png"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span><span class="gd_word" id="S7.F6.2.w1">Overall</span><span> </span><span class="gd_word" id="S7.F6.2.w2">architecture</span><span> </span><span class="gd_word" id="S7.F6.2.w3">of</span><span> </span><span class="gd_word" id="S7.F6.2.w4">Tree</span><span> </span><span class="gd_word" id="S7.F6.2.w5">Transformer.</span><span> </span><span class="gd_word" id="S7.F6.2.w6">(Dashed</span><span> </span><span class="gd_word" id="S7.F6.2.w7">lines:</span><span> </span><span class="gd_word" id="S7.F6.2.w8">sharing</span><span> </span><span class="gd_word" id="S7.F6.2.w9">parameters)</span></figcaption>
</figure>
<figure id="S7.T5" class="ltx_table">
<img src="/static/img/2002.08046-gpt-3.5-turbo/S7_T5.png" alt="/static/img/2002.08046-gpt-3.5-turbo/S7_T5.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="gd_word" id="S7.T5.2.w1">Exact</span><span> </span><span class="gd_word" id="S7.T5.2.w2">number</span><span> </span><span class="gd_word" id="S7.T5.2.w3">of</span><span> </span><span class="gd_word" id="S7.T5.2.w4">parameters</span><span> </span><span class="gd_word" id="S7.T5.2.w5">for</span><span> </span><span class="gd_word" id="S7.T5.2.w6">Transformer</span><span> </span><span class="gd_word" id="S7.T5.2.w7">and</span><span> </span><span class="gd_word" id="S7.T5.2.w8">our</span><span> </span><span class="gd_word" id="S7.T5.2.w9">model,</span><span> </span><span class="gd_word" id="S7.T5.2.w10">both</span><span> </span><span class="gd_word" id="S7.T5.2.w11">used</span><span> </span><span class="gd_word" id="S7.T5.2.w12">for</span><span> </span><span class="gd_word" id="S7.T5.2.w13">WMT’14</span><span> </span><span class="gd_word" id="S7.T5.2.w14">English-German</span><span> </span><span class="gd_word" id="S7.T5.2.w15">task.</span></figcaption>
</figure>
</section>
<section id="S7.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.4 </span>More detailed training configurations</h3>

<section id="S7.SS4.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Text Classification.</h4>

<div id="S7.SS4.SSS0.Px1.p1" class="ltx_para ltx_noindent">
<p id="S7.SS4.SSS0.Px1.p1.13" class="ltx_p"><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w1">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w2">adopt</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w3">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w4">tiny</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w5">size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w6">versions</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w7">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w8">our</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w9">tree-based</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w10">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w11">as</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w12">well</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w13">as</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w14">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w15">transformer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w16">baseline.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w17">The</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w18">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w19">possess</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w20">2</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w21">transformer-layers,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w22">each</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w23">has</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w24">model</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w25">dimension</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w26">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w27">64,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w28">4</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w29">heads.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w30">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w31">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w32">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w33">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.1.w34">for</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.1.m1.2" class="ltx_Math" alttext="15,000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.1.m1.2a"><mrow id="S7.SS4.SSS0.Px1.p1.1.m1.2.3.2" xref="S7.SS4.SSS0.Px1.p1.1.m1.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.1.m1.1.1" xref="S7.SS4.SSS0.Px1.p1.1.m1.1.1.cmml">15</mn><mo id="S7.SS4.SSS0.Px1.p1.1.m1.2.3.2.1" xref="S7.SS4.SSS0.Px1.p1.1.m1.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.1.m1.2.2" xref="S7.SS4.SSS0.Px1.p1.1.m1.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w2">updates,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w3">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w4">batch</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w5">size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.2.w6">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="2048" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.2.m2.1a"><mn id="S7.SS4.SSS0.Px1.p1.2.m2.1.1" xref="S7.SS4.SSS0.Px1.p1.2.m2.1.1.cmml">2048</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w2">tokens.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w3">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w4">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w5">random</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w6">initialized</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w7">embeddings</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w8">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w9">all</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w10">experiments.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w11">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w12">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w13">Stanford</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w14">Sentiment</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w15">Analysis</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w16">task</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w17">(SST),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w18">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w19">tested</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w20">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w21">two</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w22">subtasks:</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w23">binary</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w24">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w25">fine-grained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w26">(5</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w27">classes)</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w28">classification</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w29">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w30">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w31">standard</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w32">train/dev/test</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w33">splits</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w34">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w35">6920/872/1821</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w36">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w37">8544/1101/2210</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w38">respectively.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w39">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w40">optimize</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w41">every</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w42">sentiment</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w43">label</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w44">provided</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w45">in</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w46">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w47">dataset.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w48">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w49">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w50">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w51">learning</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w52">rate</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.3.w53">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="7\times 10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.3.m3.1a"><mrow id="S7.SS4.SSS0.Px1.p1.3.m3.1.1" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.2" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.2.cmml">7</mn><mo id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.1" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.1.cmml">×</mo><msup id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.cmml"><mn id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.2" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3.cmml"><mo id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3.1" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3.2" xref="S7.SS4.SSS0.Px1.p1.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.4.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.4.w2">dropout</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="0.5" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.4.m4.1a"><mn id="S7.SS4.SSS0.Px1.p1.4.m4.1.1" xref="S7.SS4.SSS0.Px1.p1.4.m4.1.1.cmml">0.5</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.5.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.5.w2">and</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.5.m5.1" class="ltx_Math" alttext="8000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.5.m5.1a"><mn id="S7.SS4.SSS0.Px1.p1.5.m5.1.1" xref="S7.SS4.SSS0.Px1.p1.5.m5.1.1.cmml">8000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w2">warmup</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w3">steps.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w4">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w5">subject-verb</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w6">agreement</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w7">task,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w8">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w9">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w10">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w11">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w12">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.6.w13">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.6.m6.2" class="ltx_Math" alttext="142,000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.6.m6.2a"><mrow id="S7.SS4.SSS0.Px1.p1.6.m6.2.3.2" xref="S7.SS4.SSS0.Px1.p1.6.m6.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.6.m6.1.1" xref="S7.SS4.SSS0.Px1.p1.6.m6.1.1.cmml">142</mn><mo id="S7.SS4.SSS0.Px1.p1.6.m6.2.3.2.1" xref="S7.SS4.SSS0.Px1.p1.6.m6.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.6.m6.2.2" xref="S7.SS4.SSS0.Px1.p1.6.m6.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w2">sentences,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w3">validated</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w4">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w5">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w6">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.7.w7">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.7.m7.2" class="ltx_Math" alttext="\approx 15,700" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.7.m7.2a"><mrow id="S7.SS4.SSS0.Px1.p1.7.m7.2.3" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.3.cmml"><mi id="S7.SS4.SSS0.Px1.p1.7.m7.2.3.2" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.3.2.cmml"/><mo id="S7.SS4.SSS0.Px1.p1.7.m7.2.3.1" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.3.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px1.p1.7.m7.2.3.3.2" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.3.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.7.m7.1.1" xref="S7.SS4.SSS0.Px1.p1.7.m7.1.1.cmml">15</mn><mo id="S7.SS4.SSS0.Px1.p1.7.m7.2.3.3.2.1" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.3.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.7.m7.2.2" xref="S7.SS4.SSS0.Px1.p1.7.m7.2.2.cmml">700</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w2">sentences</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w3">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w4">tested</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w5">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w6">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w7">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.8.w8">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.8.m8.3" class="ltx_Math" alttext="\approx 1,000,000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.8.m8.3a"><mrow id="S7.SS4.SSS0.Px1.p1.8.m8.3.4" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.cmml"><mi id="S7.SS4.SSS0.Px1.p1.8.m8.3.4.2" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.2.cmml"/><mo id="S7.SS4.SSS0.Px1.p1.8.m8.3.4.1" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.2" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.8.m8.1.1" xref="S7.SS4.SSS0.Px1.p1.8.m8.1.1.cmml">1</mn><mo id="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.2.1" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.8.m8.2.2" xref="S7.SS4.SSS0.Px1.p1.8.m8.2.2.cmml">000</mn><mo id="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.2.2" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.4.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.8.m8.3.3" xref="S7.SS4.SSS0.Px1.p1.8.m8.3.3.cmml">000</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w2">sentences.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w3">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w4">IMDB</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w5">sentiment</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w6">analysis</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w7">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w8">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w9">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w10">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w11">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w12">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.9.w13">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.9.m9.2" class="ltx_Math" alttext="25,000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.9.m9.2a"><mrow id="S7.SS4.SSS0.Px1.p1.9.m9.2.3.2" xref="S7.SS4.SSS0.Px1.p1.9.m9.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.9.m9.1.1" xref="S7.SS4.SSS0.Px1.p1.9.m9.1.1.cmml">25</mn><mo id="S7.SS4.SSS0.Px1.p1.9.m9.2.3.2.1" xref="S7.SS4.SSS0.Px1.p1.9.m9.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.9.m9.2.2" xref="S7.SS4.SSS0.Px1.p1.9.m9.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w2">documents</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w3">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w4">test</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w5">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.10.w6">of</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.10.m10.2" class="ltx_Math" alttext="25,000" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.10.m10.2a"><mrow id="S7.SS4.SSS0.Px1.p1.10.m10.2.3.2" xref="S7.SS4.SSS0.Px1.p1.10.m10.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px1.p1.10.m10.1.1" xref="S7.SS4.SSS0.Px1.p1.10.m10.1.1.cmml">25</mn><mo id="S7.SS4.SSS0.Px1.p1.10.m10.2.3.2.1" xref="S7.SS4.SSS0.Px1.p1.10.m10.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px1.p1.10.m10.2.2" xref="S7.SS4.SSS0.Px1.p1.10.m10.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w2">documents.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w3">As</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w4">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w5">documents</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w6">are</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w7">multi-sentence,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w8">they</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w9">are</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w10">added</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w11">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w12">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w13">dummy</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w14">root</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w15">node</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w16">which</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w17">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w18">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w19">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w20">predict</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w21">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w22">sentiment.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w23">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w24">both</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w25">subject-verb</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w26">agreement</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w27">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w28">IMDB</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w29">sentiment</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w30">analysis,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w31">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w32">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w33">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.11.w34">with</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.11.m11.1" class="ltx_Math" alttext="20" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.11.m11.1a"><mn id="S7.SS4.SSS0.Px1.p1.11.m11.1.1" xref="S7.SS4.SSS0.Px1.p1.11.m11.1.1.cmml">20</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.12.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.12.w2">warmup</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.12.w3">steps,</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.12.m12.1" class="ltx_Math" alttext="0.01" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.12.m12.1a"><mn id="S7.SS4.SSS0.Px1.p1.12.m12.1.1" xref="S7.SS4.SSS0.Px1.p1.12.m12.1.1.cmml">0.01</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.13.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.13.w2">learning</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.13.w3">rate</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.13.w4">and</span><span> </span><math id="S7.SS4.SSS0.Px1.p1.13.m13.1" class="ltx_Math" alttext="0.2" display="inline"><semantics id="S7.SS4.SSS0.Px1.p1.13.m13.1a"><mn id="S7.SS4.SSS0.Px1.p1.13.m13.1.1" xref="S7.SS4.SSS0.Px1.p1.13.m13.1.1.cmml">0.2</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.14.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px1.p1.13.14.w2">dropout.</span></p>
</div>
</section>
<section id="S7.SS4.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Machine Translation.</h4>

<div id="S7.SS4.SSS0.Px2.p1" class="ltx_para ltx_noindent">
<p id="S7.SS4.SSS0.Px2.p1.27" class="ltx_p"><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w1">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w2">replicate</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w3">most</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w4">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w5">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w6">base</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w7">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w8">settings</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.1.w9">from</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Ott et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w2">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w3">our</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w4">models,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w5">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w6">enable</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w7">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w8">fair</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w9">comparison</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w10">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w11">transformer-based</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.2.w12">methods</span><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>; Wu et al., <a href="#bib.bib25" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w2">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w3">IWSLT</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w4">experiments,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w5">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w6">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w7">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w8">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.3.w9">with</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="d=512" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.1.m1.1a"><mrow id="S7.SS4.SSS0.Px2.p1.1.m1.1.1" xref="S7.SS4.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p1.1.m1.1.1.2" xref="S7.SS4.SSS0.Px2.p1.1.m1.1.1.2.cmml">d</mi><mo id="S7.SS4.SSS0.Px2.p1.1.m1.1.1.1" xref="S7.SS4.SSS0.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p1.1.m1.1.1.3" xref="S7.SS4.SSS0.Px2.p1.1.m1.1.1.3.cmml">512</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.4.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.4.w2">feed-forward</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.4.w3">dimension</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="d_{ffn}=1024" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.2.m2.1a"><mrow id="S7.SS4.SSS0.Px2.p1.2.m2.1.1" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.cmml"><msub id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.cmml"><mi id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.2" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.2.cmml">d</mi><mrow id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.3" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.3.2" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.2.3.2.cmml">ffn</mi></mrow></msub><mo id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.1" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p1.2.m2.1.1.3" xref="S7.SS4.SSS0.Px2.p1.2.m2.1.1.3.cmml">1024</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.5.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.5.w2">approximate</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.5.w3">batch</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.5.w4">size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.5.w5">of</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="4000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.3.m3.1a"><mn id="S7.SS4.SSS0.Px2.p1.3.m3.1.1" xref="S7.SS4.SSS0.Px2.p1.3.m3.1.1.cmml">4000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.6.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.6.w2">tokens,</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.4.m4.2" class="ltx_Math" alttext="60,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.4.m4.2a"><mrow id="S7.SS4.SSS0.Px2.p1.4.m4.2.3.2" xref="S7.SS4.SSS0.Px2.p1.4.m4.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.4.m4.1.1" xref="S7.SS4.SSS0.Px2.p1.4.m4.1.1.cmml">60</mn><mo id="S7.SS4.SSS0.Px2.p1.4.m4.2.3.2.1" xref="S7.SS4.SSS0.Px2.p1.4.m4.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.4.m4.2.2" xref="S7.SS4.SSS0.Px2.p1.4.m4.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.7.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.7.w2">updates,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.7.w3">learning</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.7.w4">rate</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.5.m5.1a"><mrow id="S7.SS4.SSS0.Px2.p1.5.m5.1.1" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.2" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.2.cmml">5</mn><mo id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.1" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.1.cmml">×</mo><msup id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.cmml"><mn id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.2" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.cmml"><mo id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.1" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.2" xref="S7.SS4.SSS0.Px2.p1.5.m5.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.8.w1">,</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="4000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.6.m6.1a"><mn id="S7.SS4.SSS0.Px2.p1.6.m6.1.1" xref="S7.SS4.SSS0.Px2.p1.6.m6.1.1.cmml">4000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.9.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.9.w2">warmup</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.9.w3">steps,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.9.w4">dropout</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.9.w5">rate</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.7.m7.1a"><mn id="S7.SS4.SSS0.Px2.p1.7.m7.1.1" xref="S7.SS4.SSS0.Px2.p1.7.m7.1.1.cmml">0.3</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.10.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.10.w2">L2</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.10.w3">weight</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.10.w4">decay</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.8.m8.1a"><msup id="S7.SS4.SSS0.Px2.p1.8.m8.1.1" xref="S7.SS4.SSS0.Px2.p1.8.m8.1.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.8.m8.1.1.2" xref="S7.SS4.SSS0.Px2.p1.8.m8.1.1.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3" xref="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3.cmml"><mo id="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3.1" xref="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3.2" xref="S7.SS4.SSS0.Px2.p1.8.m8.1.1.3.2.cmml">4</mn></mrow></msup></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.11.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.11.w2">beam</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.11.w3">size</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.9.m9.1a"><mn id="S7.SS4.SSS0.Px2.p1.9.m9.1.1" xref="S7.SS4.SSS0.Px2.p1.9.m9.1.1.cmml">5</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.12.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.12.w2">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.12.w3">length</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.12.w4">penalty</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="1.0" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.10.m10.1a"><mn id="S7.SS4.SSS0.Px2.p1.10.m10.1.1" xref="S7.SS4.SSS0.Px2.p1.10.m10.1.1.cmml">1.0</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.13.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.13.w2">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.13.w3">English-German</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.13.w4">and</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.11.m11.1" class="ltx_Math" alttext="0.7" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.11.m11.1a"><mn id="S7.SS4.SSS0.Px2.p1.11.m11.1.1" xref="S7.SS4.SSS0.Px2.p1.11.m11.1.1.cmml">0.7</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w2">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w3">English-French.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w4">The</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w5">hierarchical</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w6">embedding</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.14.w7">size</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.12.m12.1" class="ltx_Math" alttext="|E|" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.12.m12.1a"><mrow id="S7.SS4.SSS0.Px2.p1.12.m12.1.2.2" xref="S7.SS4.SSS0.Px2.p1.12.m12.1.2.1.cmml"><mo stretchy="false" id="S7.SS4.SSS0.Px2.p1.12.m12.1.2.2.1" xref="S7.SS4.SSS0.Px2.p1.12.m12.1.2.1.1.cmml">|</mo><mi id="S7.SS4.SSS0.Px2.p1.12.m12.1.1" xref="S7.SS4.SSS0.Px2.p1.12.m12.1.1.cmml">E</mi><mo stretchy="false" id="S7.SS4.SSS0.Px2.p1.12.m12.1.2.2.2" xref="S7.SS4.SSS0.Px2.p1.12.m12.1.2.1.1.cmml">|</mo></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w2">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w3">set</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w4">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w5">100.
We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w6">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w7">BPE</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w8">tokens</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w9">pre-trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.15.w10">with</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.13.m13.2" class="ltx_Math" alttext="32,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.13.m13.2a"><mrow id="S7.SS4.SSS0.Px2.p1.13.m13.2.3.2" xref="S7.SS4.SSS0.Px2.p1.13.m13.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.13.m13.1.1" xref="S7.SS4.SSS0.Px2.p1.13.m13.1.1.cmml">32</mn><mo id="S7.SS4.SSS0.Px2.p1.13.m13.2.3.2.1" xref="S7.SS4.SSS0.Px2.p1.13.m13.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.13.m13.2.2" xref="S7.SS4.SSS0.Px2.p1.13.m13.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w2">iterations.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w3">Note</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w4">that</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w5">if</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w6">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w7">word</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w8">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w9">broken</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w10">into</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w11">multiple</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w12">BPE</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w13">subwords,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w14">it</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w15">form</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w16">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w17">subtree</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w18">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w19">leaves</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w20">as</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w21">such</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w22">subwords</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w23">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w24">root-node</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w25">as</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w26">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w27">POS</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w28">tag</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w29">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w30">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w31">word.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.16.w32">Figure</span><span> </span><a href="#S7.F7" title="Figure 7 ‣ Effectiveness on Small Datasets. ‣ 7.4 More detailed training configurations ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">7</a><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w2">visualizes</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w3">how</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w4">this</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w5">works.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w6">The</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w7">IWSLT</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w8">English-German</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w9">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w10">dataset</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.17.w11">contains</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.14.m14.2" class="ltx_Math" alttext="\approx 160,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.14.m14.2a"><mrow id="S7.SS4.SSS0.Px2.p1.14.m14.2.3" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.14.m14.2.3.2" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.3.2.cmml"/><mo id="S7.SS4.SSS0.Px2.p1.14.m14.2.3.1" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.3.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px2.p1.14.m14.2.3.3.2" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.3.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.14.m14.1.1" xref="S7.SS4.SSS0.Px2.p1.14.m14.1.1.cmml">160</mn><mo id="S7.SS4.SSS0.Px2.p1.14.m14.2.3.3.2.1" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.3.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.14.m14.2.2" xref="S7.SS4.SSS0.Px2.p1.14.m14.2.2.cmml">000</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.18.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.18.w2">sentence</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.18.w3">pairs,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.18.w4">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.18.w5">used</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.15.m15.1" class="ltx_Math" alttext="5\%" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.15.m15.1a"><mrow id="S7.SS4.SSS0.Px2.p1.15.m15.1.1" xref="S7.SS4.SSS0.Px2.p1.15.m15.1.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.15.m15.1.1.2" xref="S7.SS4.SSS0.Px2.p1.15.m15.1.1.2.cmml">5</mn><mo id="S7.SS4.SSS0.Px2.p1.15.m15.1.1.1" xref="S7.SS4.SSS0.Px2.p1.15.m15.1.1.1.cmml">%</mo></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w2">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w3">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w4">data</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w5">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w6">validation</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w7">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w8">combined</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w9">(IWSLT14.TED.dev2010,dev2012,tst2010-tst2012)</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w10">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w11">testing.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w12">Meanwhile,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w13">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w14">IWSLT</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w15">English-French</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w16">task</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.19.w17">has</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.16.m16.2" class="ltx_Math" alttext="\approx 200,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.16.m16.2a"><mrow id="S7.SS4.SSS0.Px2.p1.16.m16.2.3" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.16.m16.2.3.2" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.3.2.cmml"/><mo id="S7.SS4.SSS0.Px2.p1.16.m16.2.3.1" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.3.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px2.p1.16.m16.2.3.3.2" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.3.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.16.m16.1.1" xref="S7.SS4.SSS0.Px2.p1.16.m16.1.1.cmml">200</mn><mo id="S7.SS4.SSS0.Px2.p1.16.m16.2.3.3.2.1" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.3.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.16.m16.2.2" xref="S7.SS4.SSS0.Px2.p1.16.m16.2.2.cmml">000</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w2">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w3">sentence</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w4">pairs,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w5">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w6">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w7">IWSLT15.TED.tst2012</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w8">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w9">validation</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w10">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w11">IWSLT15.TED.tst2013</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w12">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w13">testing.
We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w14">use</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w15">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w16">Stanford</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w17">CoreNLP</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w18">parser</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.20.w19">(v3.9.1)</span><span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a href="http://nlp.stanford.edu/software/stanford-corenlp-full-2018-02-27.zip" title="" class="ltx_ref ltx_href">http://nlp.stanford.edu/software/stanford-corenlp-full-2018-02-27.zip</a></span></span></span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.21.w1"/><span> </span><cite class="ltx_cite ltx_citemacro_citep">(Manning et al., <a href="#bib.bib13" title="" class="ltx_ref">2014</a>)</cite><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w2">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w3">parse</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w4">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w5">datasets.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w6">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w7">WMT</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w8">experiments,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w9">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w10">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w11">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w12">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.22.w13">with</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.17.m17.1" class="ltx_Math" alttext="d_{model}=512" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.17.m17.1a"><mrow id="S7.SS4.SSS0.Px2.p1.17.m17.1.1" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.cmml"><msub id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.cmml"><mi id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.2" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.2.cmml">d</mi><mrow id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.3" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.3.2" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.2.3.2.cmml">model</mi></mrow></msub><mo id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.1" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p1.17.m17.1.1.3" xref="S7.SS4.SSS0.Px2.p1.17.m17.1.1.3.cmml">512</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.23.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.23.w2">feed-forward</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.23.w3">dimension</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.18.m18.1" class="ltx_Math" alttext="d_{ffn}=2048" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.18.m18.1a"><mrow id="S7.SS4.SSS0.Px2.p1.18.m18.1.1" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.cmml"><msub id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.cmml"><mi id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.2" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.2.cmml">d</mi><mrow id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.3" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.3.2" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.2.3.2.cmml">ffn</mi></mrow></msub><mo id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.1" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.1.cmml">=</mo><mn id="S7.SS4.SSS0.Px2.p1.18.m18.1.1.3" xref="S7.SS4.SSS0.Px2.p1.18.m18.1.1.3.cmml">2048</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.24.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.24.w2">batch</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.24.w3">size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.24.w4">of</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.19.m19.2" class="ltx_Math" alttext="\approx 32,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.19.m19.2a"><mrow id="S7.SS4.SSS0.Px2.p1.19.m19.2.3" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.3.cmml"><mi id="S7.SS4.SSS0.Px2.p1.19.m19.2.3.2" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.3.2.cmml"/><mo id="S7.SS4.SSS0.Px2.p1.19.m19.2.3.1" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.3.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px2.p1.19.m19.2.3.3.2" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.3.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.19.m19.1.1" xref="S7.SS4.SSS0.Px2.p1.19.m19.1.1.cmml">32</mn><mo id="S7.SS4.SSS0.Px2.p1.19.m19.2.3.3.2.1" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.3.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.19.m19.2.2" xref="S7.SS4.SSS0.Px2.p1.19.m19.2.2.cmml">000</mn></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.25.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.25.w2">tokens,</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.20.m20.2" class="ltx_Math" alttext="200,000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.20.m20.2a"><mrow id="S7.SS4.SSS0.Px2.p1.20.m20.2.3.2" xref="S7.SS4.SSS0.Px2.p1.20.m20.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.20.m20.1.1" xref="S7.SS4.SSS0.Px2.p1.20.m20.1.1.cmml">200</mn><mo id="S7.SS4.SSS0.Px2.p1.20.m20.2.3.2.1" xref="S7.SS4.SSS0.Px2.p1.20.m20.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px2.p1.20.m20.2.2" xref="S7.SS4.SSS0.Px2.p1.20.m20.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.26.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.26.w2">updates,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.26.w3">learning</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.26.w4">rate</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.21.m21.1" class="ltx_Math" alttext="7\times 10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.21.m21.1a"><mrow id="S7.SS4.SSS0.Px2.p1.21.m21.1.1" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.2" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.2.cmml">7</mn><mo id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.1" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.1.cmml">×</mo><msup id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.cmml"><mn id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.2" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3.cmml"><mo id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3.1" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3.2" xref="S7.SS4.SSS0.Px2.p1.21.m21.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.27.w1">,</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.22.m22.1" class="ltx_Math" alttext="4000" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.22.m22.1a"><mn id="S7.SS4.SSS0.Px2.p1.22.m22.1.1" xref="S7.SS4.SSS0.Px2.p1.22.m22.1.1.cmml">4000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.28.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.28.w2">warmup</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.28.w3">steps,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.28.w4">dropout</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.28.w5">rate</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.23.m23.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.23.m23.1a"><mn id="S7.SS4.SSS0.Px2.p1.23.m23.1.1" xref="S7.SS4.SSS0.Px2.p1.23.m23.1.1.cmml">0.1</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.29.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.29.w2">L2</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.29.w3">weight</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.29.w4">decay</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.24.m24.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.24.m24.1a"><msup id="S7.SS4.SSS0.Px2.p1.24.m24.1.1" xref="S7.SS4.SSS0.Px2.p1.24.m24.1.1.cmml"><mn id="S7.SS4.SSS0.Px2.p1.24.m24.1.1.2" xref="S7.SS4.SSS0.Px2.p1.24.m24.1.1.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3" xref="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3.cmml"><mo id="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3.1" xref="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3.2" xref="S7.SS4.SSS0.Px2.p1.24.m24.1.1.3.2.cmml">4</mn></mrow></msup></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.30.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.30.w2">beam</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.30.w3">size</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.25.m25.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.25.m25.1a"><mn id="S7.SS4.SSS0.Px2.p1.25.m25.1.1" xref="S7.SS4.SSS0.Px2.p1.25.m25.1.1.cmml">5</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.31.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.31.w2">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.31.w3">length</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.31.w4">penalty</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.26.m26.1" class="ltx_Math" alttext="0.6" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.26.m26.1a"><mn id="S7.SS4.SSS0.Px2.p1.26.m26.1.1" xref="S7.SS4.SSS0.Px2.p1.26.m26.1.1.cmml">0.6</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w2">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w3">take</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w4">average</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w5">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w6">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w7">last</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w8">5</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w9">checkpoints</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w10">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w11">evaluation.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w12">The</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w13">WMT”14</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w14">English-German</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w15">dataset</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.32.w16">contains</span><span> </span><math id="S7.SS4.SSS0.Px2.p1.27.m27.1" class="ltx_Math" alttext="\approx 4.5M" display="inline"><semantics id="S7.SS4.SSS0.Px2.p1.27.m27.1a"><mrow id="S7.SS4.SSS0.Px2.p1.27.m27.1.1" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.cmml"><mi id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.2" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.2.cmml"/><mo id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.1" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.1.cmml">≈</mo><mrow id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.cmml"><mn id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.2" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.2.cmml">4.5</mn><mo id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.1" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.1.cmml">⁢</mo><mi id="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.3" xref="S7.SS4.SSS0.Px2.p1.27.m27.1.1.3.3.cmml">M</mi></mrow></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w2">pairs.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w3">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w4">tested</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w5">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w6">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w7">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w8">newstest2014</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w9">test</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w10">set.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w11">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w12">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w13">tokenized-BLEU</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w14">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w15">evaluate</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w16">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px2.p1.27.33.w17">models.</span></p>
</div>
</section>
<section id="S7.SS4.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Training Time Analysis.</h4>

<div id="S7.SS4.SSS0.Px3.p1" class="ltx_para ltx_noindent">
<p id="S7.SS4.SSS0.Px3.p1.3" class="ltx_p"><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w1">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w2">this</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w3">experiment,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w4">all</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w5">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w6">examined</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w7">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w8">(Transformer,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w9">Tree</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w10">Transformer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w11">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w12">Tree-LSTM)</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w13">are</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w14">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w15">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w16">text</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w17">classification</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w18">task</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w19">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w20">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w21">GPU</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.1.w22">for</span><span> </span><math id="S7.SS4.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="1000" display="inline"><semantics id="S7.SS4.SSS0.Px3.p1.1.m1.1a"><mn id="S7.SS4.SSS0.Px3.p1.1.m1.1.1" xref="S7.SS4.SSS0.Px3.p1.1.m1.1.1.cmml">1000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w2">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w3">steps</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w4">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w5">batch-size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.2.w6">of</span><span> </span><math id="S7.SS4.SSS0.Px3.p1.2.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S7.SS4.SSS0.Px3.p1.2.m2.1a"><mn id="S7.SS4.SSS0.Px3.p1.2.m2.1.1" xref="S7.SS4.SSS0.Px3.p1.2.m2.1.1.cmml">1</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w2">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w3">vanilla</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w4">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w5">Tree</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w6">Transformer,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w7">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w8">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w9">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w10">2-layer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w11">encoder</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w12">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.3.w13">dimension</span><span> </span><math id="S7.SS4.SSS0.Px3.p1.3.m3.1" class="ltx_Math" alttext="64" display="inline"><semantics id="S7.SS4.SSS0.Px3.p1.3.m3.1a"><mn id="S7.SS4.SSS0.Px3.p1.3.m3.1.1" xref="S7.SS4.SSS0.Px3.p1.3.m3.1.1.cmml">64</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w2">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w3">Tree-LSTM,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w4">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w5">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w6">one-layer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w7">LSTM</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w8">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w9">dimension</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w10">64.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w11">A</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w12">binary</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w13">constituency</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w14">tree</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w15">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w16">built</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w17">given</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w18">each</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w19">input</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w20">sentence.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w21">The</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w22">parser’s</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w23">processing</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w24">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w25">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w26">significant.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w27">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w28">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w29">time,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w30">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w31">exclude</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w32">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w33">parser’s</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w34">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w35">because</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w36">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w37">parser</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w38">processes</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w39">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w40">data</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w41">only</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w42">once</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w43">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w44">this</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w45">counts</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w46">towards</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w47">to</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w48">preprocessing</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w49">procedures</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w50">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w51">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w52">dataset.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w53">However,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w54">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w55">include</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w56">parser’s</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w57">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w58">into</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w59">inference</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w60">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w61">because</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w62">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w63">receive</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w64">surface-form</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w65">text</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w66">instead</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w67">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w68">trees.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w69">In</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w70">practice,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w71">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w72">parsing</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w73">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w74">substantially</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w75">overshadows</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w76">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w77">computation</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w78">time</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w79">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w80">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w81">network.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w82">Thus,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w83">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w84">overall</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w85">process</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w86">will</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w87">be</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w88">faster</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w89">if</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w90">a</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w91">more</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w92">efficient</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w93">parser</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w94">is</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px3.p1.3.4.w95">developed.</span></p>
</div>
</section>
<section id="S7.SS4.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Effectiveness on Small Datasets.</h4>

<div id="S7.SS4.SSS0.Px4.p1" class="ltx_para ltx_noindent">
<p id="S7.SS4.SSS0.Px4.p1.9" class="ltx_p"><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w1">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w2">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w3">both</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w4">Transformer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w5">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w6">Tree</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w7">Transformer</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w8">on</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w9">base-size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w10">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w11">settings</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.1.w12">from</span><span> </span><cite class="ltx_cite ltx_citemacro_citet">Ott et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w2">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w3">trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w4">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w5">models</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w6">with</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w7">batch</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w8">size</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.2.w9">of</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.1.m1.2" class="ltx_Math" alttext="32,000" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.1.m1.2a"><mrow id="S7.SS4.SSS0.Px4.p1.1.m1.2.3.2" xref="S7.SS4.SSS0.Px4.p1.1.m1.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px4.p1.1.m1.1.1" xref="S7.SS4.SSS0.Px4.p1.1.m1.1.1.cmml">32</mn><mo id="S7.SS4.SSS0.Px4.p1.1.m1.2.3.2.1" xref="S7.SS4.SSS0.Px4.p1.1.m1.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px4.p1.1.m1.2.2" xref="S7.SS4.SSS0.Px4.p1.1.m1.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.3.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.3.w2">tokens,</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.2.m2.2" class="ltx_Math" alttext="100,000" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.2.m2.2a"><mrow id="S7.SS4.SSS0.Px4.p1.2.m2.2.3.2" xref="S7.SS4.SSS0.Px4.p1.2.m2.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px4.p1.2.m2.1.1" xref="S7.SS4.SSS0.Px4.p1.2.m2.1.1.cmml">100</mn><mo id="S7.SS4.SSS0.Px4.p1.2.m2.2.3.2.1" xref="S7.SS4.SSS0.Px4.p1.2.m2.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px4.p1.2.m2.2.2" xref="S7.SS4.SSS0.Px4.p1.2.m2.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.4.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.4.w2">updates,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.4.w3">learning</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.4.w4">rate</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="7\times 10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.3.m3.1a"><mrow id="S7.SS4.SSS0.Px4.p1.3.m3.1.1" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.cmml"><mn id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.2" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.2.cmml">7</mn><mo id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.1" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.1.cmml">×</mo><msup id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.cmml"><mn id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.2" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3.cmml"><mo id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3.1" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3.2" xref="S7.SS4.SSS0.Px4.p1.3.m3.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.5.w1">,</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="4000" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.4.m4.1a"><mn id="S7.SS4.SSS0.Px4.p1.4.m4.1.1" xref="S7.SS4.SSS0.Px4.p1.4.m4.1.1.cmml">4000</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.6.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.6.w2">warmup</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.6.w3">steps,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.6.w4">dropout</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.5.m5.1a"><mn id="S7.SS4.SSS0.Px4.p1.5.m5.1.1" xref="S7.SS4.SSS0.Px4.p1.5.m5.1.1.cmml">0.1</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.7.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.7.w2">L2</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.7.w3">weight</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.7.w4">decay</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.6.m6.1" class="ltx_Math" alttext="10^{-4}" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.6.m6.1a"><msup id="S7.SS4.SSS0.Px4.p1.6.m6.1.1" xref="S7.SS4.SSS0.Px4.p1.6.m6.1.1.cmml"><mn id="S7.SS4.SSS0.Px4.p1.6.m6.1.1.2" xref="S7.SS4.SSS0.Px4.p1.6.m6.1.1.2.cmml">10</mn><mrow id="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3" xref="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3.cmml"><mo id="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3.1" xref="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3.1.cmml">-</mo><mn id="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3.2" xref="S7.SS4.SSS0.Px4.p1.6.m6.1.1.3.2.cmml">4</mn></mrow></msup></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.8.w1">,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.8.w2">beam</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.8.w3">size</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.7.m7.1" class="ltx_Math" alttext="5" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.7.m7.1a"><mn id="S7.SS4.SSS0.Px4.p1.7.m7.1.1" xref="S7.SS4.SSS0.Px4.p1.7.m7.1.1.cmml">5</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.9.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.9.w2">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.9.w3">length</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.9.w4">penalty</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.8.m8.1" class="ltx_Math" alttext="0.6" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.8.m8.1a"><mn id="S7.SS4.SSS0.Px4.p1.8.m8.1.1" xref="S7.SS4.SSS0.Px4.p1.8.m8.1.1.cmml">0.6</mn></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w1">.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w2">For</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w3">both</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w4">sets</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w5">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w6">tasks,</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w7">we</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w8">take</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w9">average</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w10">of</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w11">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w12">last</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w13">5</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w14">checkpoints</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w15">for</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w16">evaluation.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w17">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w18">used</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w19">BPE</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w20">tokens</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w21">pre-trained</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.10.w22">with</span><span> </span><math id="S7.SS4.SSS0.Px4.p1.9.m9.2" class="ltx_Math" alttext="32,000" display="inline"><semantics id="S7.SS4.SSS0.Px4.p1.9.m9.2a"><mrow id="S7.SS4.SSS0.Px4.p1.9.m9.2.3.2" xref="S7.SS4.SSS0.Px4.p1.9.m9.2.3.1.cmml"><mn id="S7.SS4.SSS0.Px4.p1.9.m9.1.1" xref="S7.SS4.SSS0.Px4.p1.9.m9.1.1.cmml">32</mn><mo id="S7.SS4.SSS0.Px4.p1.9.m9.2.3.2.1" xref="S7.SS4.SSS0.Px4.p1.9.m9.2.3.1.cmml">,</mo><mn id="S7.SS4.SSS0.Px4.p1.9.m9.2.2" xref="S7.SS4.SSS0.Px4.p1.9.m9.2.2.cmml">000</mn></mrow></semantics></math><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w1"/><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w2">iterations.</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w3">We</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w4">randomly</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w5">samples</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w6">the</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w7">training</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w8">data</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w9">into</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w10">size-varying</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w11">portions:</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w12">2%(90K</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w13">pairs),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w14">5%(225K</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w15">pairs),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w16">10%(450K</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w17">pairs),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w18">25%(1.125M</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w19">pairs),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w20">50%(2.25M</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w21">pairs),</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w22">75%(3.375M</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w23">pairs)</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w24">and</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w25">100%(4.5M</span><span> </span><span class="gd_word" id="S7.SS4.SSS0.Px4.p1.9.11.w26">pairs).</span></p>
</div>
<figure id="S7.F7" class="ltx_figure">
<img src="/static/img/2002.08046/S7_F7.png" alt="/static/img/2002.08046/S7_F7.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span><span class="gd_word" id="S7.F7.2.w1">Process</span><span> </span><span class="gd_word" id="S7.F7.2.w2">to</span><span> </span><span class="gd_word" id="S7.F7.2.w3">break</span><span> </span><span class="gd_word" id="S7.F7.2.w4">standard</span><span> </span><span class="gd_word" id="S7.F7.2.w5">tree</span><span> </span><span class="gd_word" id="S7.F7.2.w6">(fig.</span><span> </span><a href="#S7.F6.sf1" title="(a) ‣ Figure 7 ‣ Effectiveness on Small Datasets. ‣ 7.4 More detailed training configurations ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">6(a)</a><span class="gd_word" id="S7.F7.3.w1">)</span><span> </span><span class="gd_word" id="S7.F7.3.w2">into</span><span> </span><span class="gd_word" id="S7.F7.3.w3">BPE</span><span> </span><span class="gd_word" id="S7.F7.3.w4">tree</span><span> </span><span class="gd_word" id="S7.F7.3.w5">(fig.</span><span> </span><a href="#S7.F6.sf2" title="(b) ‣ Figure 7 ‣ Effectiveness on Small Datasets. ‣ 7.4 More detailed training configurations ‣ 7 Appendix ‣ Tree-Structured Attention with Hierarchical Accumulation" class="ltx_ref">6(b)</a><span class="gd_word" id="S7.F7.4.w1">).</span></figcaption>
</figure>
</section>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Sep 15 18:23:07 2021 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"/></a>
</div></footer>
</div>
</body>
</html>
