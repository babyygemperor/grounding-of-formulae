<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours</title>
<!--Generated on Thu May 19 11:44:10 2022 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<meta name="keywords" lang="en" content="&#10;Protein Structure Prediction,  Distributed Deep Learning,  GPUs,  Model Parallelism&#10;"/>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">FastFold: Reducing AlphaFold Training Time 
<br class="ltx_break"/>from 11 Days to 67 Hours</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shenggan Cheng2, Ruidong Wu3, Zhongming Yu1, Binrui Li4, Xiwen Zhang3, Jian Peng3, Yang You21
</span><span class="ltx_author_notes"><span>
<span class="ltx_contact ltx_role_affiliation">2National University of Singapore (NUS) 1HPC-AI Technology Inc.
</span>
<span class="ltx_contact ltx_role_affiliation">3Helixon 4Shanghai Jiao Tong University 
</span>
<span class="ltx_contact ltx_role_affiliation">Shenggan Cheng was an employee of HPC-AI Technology Inc. before joining NUS. 
<br class="ltx_break"/>This work was done at HPC-AI Technology Inc. (contact@hpcaitech.com)
</span></span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.1" class="ltx_p"><span class="gd_word" id="id1.1.1.w1">Protein</span><span> </span><span class="gd_word" id="id1.1.1.w2">structure</span><span> </span><span class="gd_word" id="id1.1.1.w3">prediction</span><span> </span><span class="gd_word" id="id1.1.1.w4">is</span><span> </span><span class="gd_word" id="id1.1.1.w5">an</span><span> </span><span class="gd_word" id="id1.1.1.w6">important</span><span> </span><span class="gd_word" id="id1.1.1.w7">method</span><span> </span><span class="gd_word" id="id1.1.1.w8">for</span><span> </span><span class="gd_word" id="id1.1.1.w9">understanding</span><span> </span><span class="gd_word" id="id1.1.1.w10">gene</span><span> </span><span class="gd_word" id="id1.1.1.w11">translation</span><span> </span><span class="gd_word" id="id1.1.1.w12">and</span><span> </span><span class="gd_word" id="id1.1.1.w13">protein</span><span> </span><span class="gd_word" id="id1.1.1.w14">function</span><span> </span><span class="gd_word" id="id1.1.1.w15">in</span><span> </span><span class="gd_word" id="id1.1.1.w16">the</span><span> </span><span class="gd_word" id="id1.1.1.w17">domain</span><span> </span><span class="gd_word" id="id1.1.1.w18">of</span><span> </span><span class="gd_word" id="id1.1.1.w19">structural</span><span> </span><span class="gd_word" id="id1.1.1.w20">biology.</span><span> </span><span class="gd_word" id="id1.1.1.w21">AlphaFold</span><span> </span><span class="gd_word" id="id1.1.1.w22">introduced</span><span> </span><span class="gd_word" id="id1.1.1.w23">the</span><span> </span><span class="gd_word" id="id1.1.1.w24">Transformer</span><span> </span><span class="gd_word" id="id1.1.1.w25">model</span><span> </span><span class="gd_word" id="id1.1.1.w26">to</span><span> </span><span class="gd_word" id="id1.1.1.w27">the</span><span> </span><span class="gd_word" id="id1.1.1.w28">field</span><span> </span><span class="gd_word" id="id1.1.1.w29">of</span><span> </span><span class="gd_word" id="id1.1.1.w30">protein</span><span> </span><span class="gd_word" id="id1.1.1.w31">structure</span><span> </span><span class="gd_word" id="id1.1.1.w32">prediction</span><span> </span><span class="gd_word" id="id1.1.1.w33">with</span><span> </span><span class="gd_word" id="id1.1.1.w34">atomic</span><span> </span><span class="gd_word" id="id1.1.1.w35">accuracy.</span><span> </span><span class="gd_word" id="id1.1.1.w36">However,</span><span> </span><span class="gd_word" id="id1.1.1.w37">training</span><span> </span><span class="gd_word" id="id1.1.1.w38">and</span><span> </span><span class="gd_word" id="id1.1.1.w39">inference</span><span> </span><span class="gd_word" id="id1.1.1.w40">of</span><span> </span><span class="gd_word" id="id1.1.1.w41">AlphaFold</span><span> </span><span class="gd_word" id="id1.1.1.w42">model</span><span> </span><span class="gd_word" id="id1.1.1.w43">are</span><span> </span><span class="gd_word" id="id1.1.1.w44">time-consuming</span><span> </span><span class="gd_word" id="id1.1.1.w45">and</span><span> </span><span class="gd_word" id="id1.1.1.w46">expensive</span><span> </span><span class="gd_word" id="id1.1.1.w47">because</span><span> </span><span class="gd_word" id="id1.1.1.w48">of</span><span> </span><span class="gd_word" id="id1.1.1.w49">the</span><span> </span><span class="gd_word" id="id1.1.1.w50">special</span><span> </span><span class="gd_word" id="id1.1.1.w51">performance</span><span> </span><span class="gd_word" id="id1.1.1.w52">characteristics</span><span> </span><span class="gd_word" id="id1.1.1.w53">and</span><span> </span><span class="gd_word" id="id1.1.1.w54">huge</span><span> </span><span class="gd_word" id="id1.1.1.w55">memory</span><span> </span><span class="gd_word" id="id1.1.1.w56">consumption.</span><span> </span><span class="gd_word" id="id1.1.1.w57">In</span><span> </span><span class="gd_word" id="id1.1.1.w58">this</span><span> </span><span class="gd_word" id="id1.1.1.w59">paper,</span><span> </span><span class="gd_word" id="id1.1.1.w60">we</span><span> </span><span class="gd_word" id="id1.1.1.w61">propose</span><span> </span><span class="gd_word" id="id1.1.1.w62">FastFold,</span><span> </span><span class="gd_word" id="id1.1.1.w63">a</span><span> </span><span class="gd_word" id="id1.1.1.w64">highly</span><span> </span><span class="gd_word" id="id1.1.1.w65">efficient</span><span> </span><span class="gd_word" id="id1.1.1.w66">implementation</span><span> </span><span class="gd_word" id="id1.1.1.w67">of</span><span> </span><span class="gd_word" id="id1.1.1.w68">protein</span><span> </span><span class="gd_word" id="id1.1.1.w69">structure</span><span> </span><span class="gd_word" id="id1.1.1.w70">prediction</span><span> </span><span class="gd_word" id="id1.1.1.w71">model</span><span> </span><span class="gd_word" id="id1.1.1.w72">for</span><span> </span><span class="gd_word" id="id1.1.1.w73">training</span><span> </span><span class="gd_word" id="id1.1.1.w74">and</span><span> </span><span class="gd_word" id="id1.1.1.w75">inference.</span><span> </span><span class="gd_word" id="id1.1.1.w76">FastFold</span><span> </span><span class="gd_word" id="id1.1.1.w77">includes</span><span> </span><span class="gd_word" id="id1.1.1.w78">a</span><span> </span><span class="gd_word" id="id1.1.1.w79">series</span><span> </span><span class="gd_word" id="id1.1.1.w80">of</span><span> </span><span class="gd_word" id="id1.1.1.w81">GPU</span><span> </span><span class="gd_word" id="id1.1.1.w82">optimizations</span><span> </span><span class="gd_word" id="id1.1.1.w83">based</span><span> </span><span class="gd_word" id="id1.1.1.w84">on</span><span> </span><span class="gd_word" id="id1.1.1.w85">thorough</span><span> </span><span class="gd_word" id="id1.1.1.w86">analysis</span><span> </span><span class="gd_word" id="id1.1.1.w87">of</span><span> </span><span class="gd_word" id="id1.1.1.w88">AlphaFold’s</span><span> </span><span class="gd_word" id="id1.1.1.w89">performance.</span><span> </span><span class="gd_word" id="id1.1.1.w90">Meanwhile,</span><span> </span><span class="gd_word" id="id1.1.1.w91">with</span><span> </span><span class="gd_word" id="id1.1.1.w92">Dynamic</span><span> </span><span class="gd_word" id="id1.1.1.w93">Axial</span><span> </span><span class="gd_word" id="id1.1.1.w94">Parallelism</span><span> </span><span class="gd_word" id="id1.1.1.w95">and</span><span> </span><span class="gd_word" id="id1.1.1.w96">Duality</span><span> </span><span class="gd_word" id="id1.1.1.w97">Async</span><span> </span><span class="gd_word" id="id1.1.1.w98">Operation,</span><span> </span><span class="gd_word" id="id1.1.1.w99">FastFold</span><span> </span><span class="gd_word" id="id1.1.1.w100">achieves</span><span> </span><span class="gd_word" id="id1.1.1.w101">high</span><span> </span><span class="gd_word" id="id1.1.1.w102">model</span><span> </span><span class="gd_word" id="id1.1.1.w103">parallelism</span><span> </span><span class="gd_word" id="id1.1.1.w104">scaling</span><span> </span><span class="gd_word" id="id1.1.1.w105">efficiency,</span><span> </span><span class="gd_word" id="id1.1.1.w106">surpassing</span><span> </span><span class="gd_word" id="id1.1.1.w107">existing</span><span> </span><span class="gd_word" id="id1.1.1.w108">popular</span><span> </span><span class="gd_word" id="id1.1.1.w109">model</span><span> </span><span class="gd_word" id="id1.1.1.w110">parallelism</span><span> </span><span class="gd_word" id="id1.1.1.w111">techniques.</span><span> </span><span class="gd_word" id="id1.1.1.w112">Experimental</span><span> </span><span class="gd_word" id="id1.1.1.w113">results</span><span> </span><span class="gd_word" id="id1.1.1.w114">show</span><span> </span><span class="gd_word" id="id1.1.1.w115">that</span><span> </span><span class="gd_word" id="id1.1.1.w116">FastFold</span><span> </span><span class="gd_word" id="id1.1.1.w117">reduces</span><span> </span><span class="gd_word" id="id1.1.1.w118">overall</span><span> </span><span class="gd_word" id="id1.1.1.w119">training</span><span> </span><span class="gd_word" id="id1.1.1.w120">time</span><span> </span><span class="gd_word" id="id1.1.1.w121">from</span><span> </span><span class="gd_word" id="id1.1.1.w122">11</span><span> </span><span class="gd_word" id="id1.1.1.w123">days</span><span> </span><span class="gd_word" id="id1.1.1.w124">to</span><span> </span><span class="gd_word" id="id1.1.1.w125">67</span><span> </span><span class="gd_word" id="id1.1.1.w126">hours</span><span> </span><span class="gd_word" id="id1.1.1.w127">and</span><span> </span><span class="gd_word" id="id1.1.1.w128">achieves</span><span> </span><math id="id1.1.m1.1" class="ltx_Math" alttext="7.5\sim 9.5\times" display="inline"><semantics id="id1.1.m1.1a"><mrow id="id1.1.m1.1b"><mn id="id1.1.m1.1.1" xref="id1.1.m1.1.1.cmml">7.5</mn><mo id="id1.1.m1.1.2" xref="id1.1.m1.1.2.cmml">∼</mo><mn id="id1.1.m1.1.3" xref="id1.1.m1.1.3.cmml">9.5</mn><mo id="id1.1.m1.1.4" xref="id1.1.m1.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="id1.1.2.w1"/><span> </span><span class="gd_word" id="id1.1.2.w2">speedup</span><span> </span><span class="gd_word" id="id1.1.2.w3">for</span><span> </span><span class="gd_word" id="id1.1.2.w4">long-sequence</span><span> </span><span class="gd_word" id="id1.1.2.w5">inference.</span><span> </span><span class="gd_word" id="id1.1.2.w6">Furthermore,</span><span> </span><span class="gd_word" id="id1.1.2.w7">We</span><span> </span><span class="gd_word" id="id1.1.2.w8">scaled</span><span> </span><span class="gd_word" id="id1.1.2.w9">FastFold</span><span> </span><span class="gd_word" id="id1.1.2.w10">to</span><span> </span><span class="gd_word" id="id1.1.2.w11">512</span><span> </span><span class="gd_word" id="id1.1.2.w12">GPUs</span><span> </span><span class="gd_word" id="id1.1.2.w13">and</span><span> </span><span class="gd_word" id="id1.1.2.w14">achieved</span><span> </span><span class="gd_word" id="id1.1.2.w15">aggregate</span><span> </span><span class="gd_word" id="id1.1.2.w16">6.02</span><span> </span><span class="gd_word" id="id1.1.2.w17">PetaFLOPs</span><span> </span><span class="gd_word" id="id1.1.2.w18">with</span><span> </span><span class="gd_word" id="id1.1.2.w19">90.1%</span><span> </span><span class="gd_word" id="id1.1.2.w20">parallel</span><span> </span><span class="gd_word" id="id1.1.2.w21">efficiency.
The</span><span> </span><span class="gd_word" id="id1.1.2.w22">implementation</span><span> </span><span class="gd_word" id="id1.1.2.w23">can</span><span> </span><span class="gd_word" id="id1.1.2.w24">be</span><span> </span><span class="gd_word" id="id1.1.2.w25">found</span><span> </span><span class="gd_word" id="id1.1.2.w26">at</span><span> </span><a href="https://github.com/hpcaitech/FastFold" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/hpcaitech/FastFold</a><span class="gd_word" id="id1.1.3.w1">.</span></p>
</div>
<div class="ltx_keywords">
Protein Structure Prediction, Distributed Deep Learning, GPUs, Model Parallelism

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span>Introduction
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span class="gd_word" id="S1.p1.1.1.w1">Protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w2">structure</span><span> </span><span class="gd_word" id="S1.p1.1.1.w3">prediction</span><span> </span><span class="gd_word" id="S1.p1.1.1.w4">has</span><span> </span><span class="gd_word" id="S1.p1.1.1.w5">been</span><span> </span><span class="gd_word" id="S1.p1.1.1.w6">an</span><span> </span><span class="gd_word" id="S1.p1.1.1.w7">important</span><span> </span><span class="gd_word" id="S1.p1.1.1.w8">research</span><span> </span><span class="gd_word" id="S1.p1.1.1.w9">problem</span><span> </span><span class="gd_word" id="S1.p1.1.1.w10">in</span><span> </span><span class="gd_word" id="S1.p1.1.1.w11">structural</span><span> </span><span class="gd_word" id="S1.p1.1.1.w12">biology</span><span> </span><span class="gd_word" id="S1.p1.1.1.w13">for</span><span> </span><span class="gd_word" id="S1.p1.1.1.w14">over</span><span> </span><span class="gd_word" id="S1.p1.1.1.w15">50</span><span> </span><span class="gd_word" id="S1.p1.1.1.w16">years.</span><span> </span><span class="gd_word" id="S1.p1.1.1.w17">Predicting</span><span> </span><span class="gd_word" id="S1.p1.1.1.w18">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w19">three-dimensional</span><span> </span><span class="gd_word" id="S1.p1.1.1.w20">structure</span><span> </span><span class="gd_word" id="S1.p1.1.1.w21">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w22">a</span><span> </span><span class="gd_word" id="S1.p1.1.1.w23">protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w24">directly</span><span> </span><span class="gd_word" id="S1.p1.1.1.w25">from</span><span> </span><span class="gd_word" id="S1.p1.1.1.w26">its</span><span> </span><span class="gd_word" id="S1.p1.1.1.w27">amino</span><span> </span><span class="gd_word" id="S1.p1.1.1.w28">acid</span><span> </span><span class="gd_word" id="S1.p1.1.1.w29">sequence</span><span> </span><span class="gd_word" id="S1.p1.1.1.w30">has</span><span> </span><span class="gd_word" id="S1.p1.1.1.w31">a</span><span> </span><span class="gd_word" id="S1.p1.1.1.w32">wide</span><span> </span><span class="gd_word" id="S1.p1.1.1.w33">range</span><span> </span><span class="gd_word" id="S1.p1.1.1.w34">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w35">applications</span><span> </span><span class="gd_word" id="S1.p1.1.1.w36">in</span><span> </span><span class="gd_word" id="S1.p1.1.1.w37">many</span><span> </span><span class="gd_word" id="S1.p1.1.1.w38">fields,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w39">including</span><span> </span><span class="gd_word" id="S1.p1.1.1.w40">drug</span><span> </span><span class="gd_word" id="S1.p1.1.1.w41">design,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w42">protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w43">design,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w44">etc.</span><span> </span><span class="gd_word" id="S1.p1.1.1.w45">Both</span><span> </span><span class="gd_word" id="S1.p1.1.1.w46">experimental</span><span> </span><span class="gd_word" id="S1.p1.1.1.w47">and</span><span> </span><span class="gd_word" id="S1.p1.1.1.w48">computational</span><span> </span><span class="gd_word" id="S1.p1.1.1.w49">approaches</span><span> </span><span class="gd_word" id="S1.p1.1.1.w50">can</span><span> </span><span class="gd_word" id="S1.p1.1.1.w51">be</span><span> </span><span class="gd_word" id="S1.p1.1.1.w52">used</span><span> </span><span class="gd_word" id="S1.p1.1.1.w53">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w54">predict</span><span> </span><span class="gd_word" id="S1.p1.1.1.w55">protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w56">structure.</span><span> </span><span class="gd_word" id="S1.p1.1.1.w57">The</span><span> </span><span class="gd_word" id="S1.p1.1.1.w58">experimental</span><span> </span><span class="gd_word" id="S1.p1.1.1.w59">approach</span><span> </span><span class="gd_word" id="S1.p1.1.1.w60">allows</span><span> </span><span class="gd_word" id="S1.p1.1.1.w61">for</span><span> </span><span class="gd_word" id="S1.p1.1.1.w62">more</span><span> </span><span class="gd_word" id="S1.p1.1.1.w63">accurate</span><span> </span><span class="gd_word" id="S1.p1.1.1.w64">protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w65">structures</span><span> </span><span class="gd_word" id="S1.p1.1.1.w66">at</span><span> </span><span class="gd_word" id="S1.p1.1.1.w67">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w68">high</span><span> </span><span class="gd_word" id="S1.p1.1.1.w69">cost</span><span> </span><span class="gd_word" id="S1.p1.1.1.w70">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w71">time</span><span> </span><span class="gd_word" id="S1.p1.1.1.w72">and</span><span> </span><span class="gd_word" id="S1.p1.1.1.w73">finance.</span><span> </span><span class="gd_word" id="S1.p1.1.1.w74">The</span><span> </span><span class="gd_word" id="S1.p1.1.1.w75">computational</span><span> </span><span class="gd_word" id="S1.p1.1.1.w76">approach</span><span> </span><span class="gd_word" id="S1.p1.1.1.w77">can</span><span> </span><span class="gd_word" id="S1.p1.1.1.w78">predict</span><span> </span><span class="gd_word" id="S1.p1.1.1.w79">protein</span><span> </span><span class="gd_word" id="S1.p1.1.1.w80">structure</span><span> </span><span class="gd_word" id="S1.p1.1.1.w81">with</span><span> </span><span class="gd_word" id="S1.p1.1.1.w82">high</span><span> </span><span class="gd_word" id="S1.p1.1.1.w83">throughput</span><span> </span><span class="gd_word" id="S1.p1.1.1.w84">at</span><span> </span><span class="gd_word" id="S1.p1.1.1.w85">a</span><span> </span><span class="gd_word" id="S1.p1.1.1.w86">low</span><span> </span><span class="gd_word" id="S1.p1.1.1.w87">cost,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w88">so</span><span> </span><span class="gd_word" id="S1.p1.1.1.w89">it</span><span> </span><span class="gd_word" id="S1.p1.1.1.w90">is</span><span> </span><span class="gd_word" id="S1.p1.1.1.w91">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w92">paramount</span><span> </span><span class="gd_word" id="S1.p1.1.1.w93">importance</span><span> </span><span class="gd_word" id="S1.p1.1.1.w94">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w95">improve</span><span> </span><span class="gd_word" id="S1.p1.1.1.w96">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w97">prediction</span><span> </span><span class="gd_word" id="S1.p1.1.1.w98">accuracy</span><span> </span><span class="gd_word" id="S1.p1.1.1.w99">for</span><span> </span><span class="gd_word" id="S1.p1.1.1.w100">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w101">computational</span><span> </span><span class="gd_word" id="S1.p1.1.1.w102">approaches.</span></p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span class="gd_word" id="S1.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S1.p2.1.1.w2">recent</span><span> </span><span class="gd_word" id="S1.p2.1.1.w3">success</span><span> </span><span class="gd_word" id="S1.p2.1.1.w4">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w5">deep</span><span> </span><span class="gd_word" id="S1.p2.1.1.w6">neural</span><span> </span><span class="gd_word" id="S1.p2.1.1.w7">networks</span><span> </span><span class="gd_word" id="S1.p2.1.1.w8">has</span><span> </span><span class="gd_word" id="S1.p2.1.1.w9">led</span><span> </span><span class="gd_word" id="S1.p2.1.1.w10">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w11">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w12">widespread</span><span> </span><span class="gd_word" id="S1.p2.1.1.w13">use</span><span> </span><span class="gd_word" id="S1.p2.1.1.w14">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w15">Artificial</span><span> </span><span class="gd_word" id="S1.p2.1.1.w16">Intelligence</span><span> </span><span class="gd_word" id="S1.p2.1.1.w17">in</span><span> </span><span class="gd_word" id="S1.p2.1.1.w18">a</span><span> </span><span class="gd_word" id="S1.p2.1.1.w19">variety</span><span> </span><span class="gd_word" id="S1.p2.1.1.w20">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w21">domains,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w22">including</span><span> </span><span class="gd_word" id="S1.p2.1.1.w23">Computer</span><span> </span><span class="gd_word" id="S1.p2.1.1.w24">Vision</span><span> </span><span class="gd_word" id="S1.p2.1.1.w25">(CV),</span><span> </span><span class="gd_word" id="S1.p2.1.1.w26">Natural</span><span> </span><span class="gd_word" id="S1.p2.1.1.w27">Language</span><span> </span><span class="gd_word" id="S1.p2.1.1.w28">Processing</span><span> </span><span class="gd_word" id="S1.p2.1.1.w29">(NLP),</span><span> </span><span class="gd_word" id="S1.p2.1.1.w30">Recommendation</span><span> </span><span class="gd_word" id="S1.p2.1.1.w31">Systems,</span><span> </span><span class="gd_word" id="S1.p2.1.1.w32">etc.</span><span> </span><span class="gd_word" id="S1.p2.1.1.w33">Convolutional</span><span> </span><span class="gd_word" id="S1.p2.1.1.w34">Neural</span><span> </span><span class="gd_word" id="S1.p2.1.1.w35">Networks</span><span> </span><span class="gd_word" id="S1.p2.1.1.w36">(CNN)</span><span> </span><span class="gd_word" id="S1.p2.1.1.w37">were</span><span> </span><span class="gd_word" id="S1.p2.1.1.w38">introduced</span><span> </span><span class="gd_word" id="S1.p2.1.1.w39">to</span><span> </span><span class="gd_word" id="S1.p2.1.1.w40">the</span><span> </span><span class="gd_word" id="S1.p2.1.1.w41">field</span><span> </span><span class="gd_word" id="S1.p2.1.1.w42">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w43">protein</span><span> </span><span class="gd_word" id="S1.p2.1.1.w44">structure</span><span> </span><span class="gd_word" id="S1.p2.1.1.w45">prediction</span><span> </span><span class="gd_word" id="S1.p2.1.1.w46">by</span><span> </span><span class="gd_word" id="S1.p2.1.1.w47">AlphaFold</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite><span class="gd_word" id="S1.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S1.p2.1.2.w2">RaptorX-Contact</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite><span class="gd_word" id="S1.p2.1.3.w1">.</span><span> </span><span class="gd_word" id="S1.p2.1.3.w2">These</span><span> </span><span class="gd_word" id="S1.p2.1.3.w3">CNN</span><span> </span><span class="gd_word" id="S1.p2.1.3.w4">models</span><span> </span><span class="gd_word" id="S1.p2.1.3.w5">achieved</span><span> </span><span class="gd_word" id="S1.p2.1.3.w6">significant</span><span> </span><span class="gd_word" id="S1.p2.1.3.w7">performance</span><span> </span><span class="gd_word" id="S1.p2.1.3.w8">improvement</span><span> </span><span class="gd_word" id="S1.p2.1.3.w9">in</span><span> </span><span class="gd_word" id="S1.p2.1.3.w10">the</span><span> </span><span class="gd_word" id="S1.p2.1.3.w11">Critical</span><span> </span><span class="gd_word" id="S1.p2.1.3.w12">Assessment</span><span> </span><span class="gd_word" id="S1.p2.1.3.w13">of</span><span> </span><span class="gd_word" id="S1.p2.1.3.w14">Protein</span><span> </span><span class="gd_word" id="S1.p2.1.3.w15">Structure</span><span> </span><span class="gd_word" id="S1.p2.1.3.w16">Prediction</span><span> </span><span class="gd_word" id="S1.p2.1.3.w17">(CASP)</span><span> </span><span class="gd_word" id="S1.p2.1.3.w18">Challenge.</span><span> </span><span class="gd_word" id="S1.p2.1.3.w19">It</span><span> </span><span class="gd_word" id="S1.p2.1.3.w20">has</span><span> </span><span class="gd_word" id="S1.p2.1.3.w21">demonstrated</span><span> </span><span class="gd_word" id="S1.p2.1.3.w22">that</span><span> </span><span class="gd_word" id="S1.p2.1.3.w23">deep</span><span> </span><span class="gd_word" id="S1.p2.1.3.w24">neural</span><span> </span><span class="gd_word" id="S1.p2.1.3.w25">networks</span><span> </span><span class="gd_word" id="S1.p2.1.3.w26">can</span><span> </span><span class="gd_word" id="S1.p2.1.3.w27">be</span><span> </span><span class="gd_word" id="S1.p2.1.3.w28">an</span><span> </span><span class="gd_word" id="S1.p2.1.3.w29">efficient</span><span> </span><span class="gd_word" id="S1.p2.1.3.w30">solution</span><span> </span><span class="gd_word" id="S1.p2.1.3.w31">to</span><span> </span><span class="gd_word" id="S1.p2.1.3.w32">the</span><span> </span><span class="gd_word" id="S1.p2.1.3.w33">challenge</span><span> </span><span class="gd_word" id="S1.p2.1.3.w34">of</span><span> </span><span class="gd_word" id="S1.p2.1.3.w35">protein</span><span> </span><span class="gd_word" id="S1.p2.1.3.w36">structure</span><span> </span><span class="gd_word" id="S1.p2.1.3.w37">prediction.</span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span class="gd_word" id="S1.p3.1.1.w1">Meanwhile,</span><span> </span><span class="gd_word" id="S1.p3.1.1.w2">because</span><span> </span><span class="gd_word" id="S1.p3.1.1.w3">of</span><span> </span><span class="gd_word" id="S1.p3.1.1.w4">the</span><span> </span><span class="gd_word" id="S1.p3.1.1.w5">superior</span><span> </span><span class="gd_word" id="S1.p3.1.1.w6">performance</span><span> </span><span class="gd_word" id="S1.p3.1.1.w7">of</span><span> </span><span class="gd_word" id="S1.p3.1.1.w8">Multi-head</span><span> </span><span class="gd_word" id="S1.p3.1.1.w9">Attention</span><span> </span><span class="gd_word" id="S1.p3.1.1.w10">for</span><span> </span><span class="gd_word" id="S1.p3.1.1.w11">sequence</span><span> </span><span class="gd_word" id="S1.p3.1.1.w12">modelling</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite><span class="gd_word" id="S1.p3.1.2.w1">,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w2">Transformer</span><span> </span><span class="gd_word" id="S1.p3.1.2.w3">has</span><span> </span><span class="gd_word" id="S1.p3.1.2.w4">made</span><span> </span><span class="gd_word" id="S1.p3.1.2.w5">a</span><span> </span><span class="gd_word" id="S1.p3.1.2.w6">huge</span><span> </span><span class="gd_word" id="S1.p3.1.2.w7">performance</span><span> </span><span class="gd_word" id="S1.p3.1.2.w8">improvement</span><span> </span><span class="gd_word" id="S1.p3.1.2.w9">in</span><span> </span><span class="gd_word" id="S1.p3.1.2.w10">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w11">NLP/CV</span><span> </span><span class="gd_word" id="S1.p3.1.2.w12">field</span><span> </span><span class="gd_word" id="S1.p3.1.2.w13">and</span><span> </span><span class="gd_word" id="S1.p3.1.2.w14">gradually</span><span> </span><span class="gd_word" id="S1.p3.1.2.w15">has</span><span> </span><span class="gd_word" id="S1.p3.1.2.w16">become</span><span> </span><span class="gd_word" id="S1.p3.1.2.w17">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w18">mainstream</span><span> </span><span class="gd_word" id="S1.p3.1.2.w19">model</span><span> </span><span class="gd_word" id="S1.p3.1.2.w20">structure,</span><span> </span><span class="gd_word" id="S1.p3.1.2.w21">such</span><span> </span><span class="gd_word" id="S1.p3.1.2.w22">as</span><span> </span><span class="gd_word" id="S1.p3.1.2.w23">BERT</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite><span class="gd_word" id="S1.p3.1.3.w1">,</span><span> </span><span class="gd_word" id="S1.p3.1.3.w2">GPT</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite><span class="gd_word" id="S1.p3.1.4.w1">,</span><span> </span><span class="gd_word" id="S1.p3.1.4.w2">ViT</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite><span class="gd_word" id="S1.p3.1.5.w1">.</span><span> </span><span class="gd_word" id="S1.p3.1.5.w2">AlphaFold</span><span> </span><span class="gd_word" id="S1.p3.1.5.w3">2</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite><span class="gd_word" id="S1.p3.1.6.w1"/><span> </span><span class="gd_word" id="S1.p3.1.6.w2">successfully</span><span> </span><span class="gd_word" id="S1.p3.1.6.w3">introduced</span><span> </span><span class="gd_word" id="S1.p3.1.6.w4">Transformer</span><span> </span><span class="gd_word" id="S1.p3.1.6.w5">to</span><span> </span><span class="gd_word" id="S1.p3.1.6.w6">protein</span><span> </span><span class="gd_word" id="S1.p3.1.6.w7">structure</span><span> </span><span class="gd_word" id="S1.p3.1.6.w8">prediction</span><span> </span><span class="gd_word" id="S1.p3.1.6.w9">model,</span><span> </span><span class="gd_word" id="S1.p3.1.6.w10">becoming</span><span> </span><span class="gd_word" id="S1.p3.1.6.w11">the</span><span> </span><span class="gd_word" id="S1.p3.1.6.w12">first</span><span> </span><span class="gd_word" id="S1.p3.1.6.w13">model</span><span> </span><span class="gd_word" id="S1.p3.1.6.w14">to</span><span> </span><span class="gd_word" id="S1.p3.1.6.w15">achieve</span><span> </span><span class="gd_word" id="S1.p3.1.6.w16">atomic</span><span> </span><span class="gd_word" id="S1.p3.1.6.w17">accuracy.</span><span> </span><span class="gd_word" id="S1.p3.1.6.w18">(We</span><span> </span><span class="gd_word" id="S1.p3.1.6.w19">refer</span><span> </span><span class="gd_word" id="S1.p3.1.6.w20">AlphaFold</span><span> </span><span class="gd_word" id="S1.p3.1.6.w21">as</span><span> </span><span class="gd_word" id="S1.p3.1.6.w22">the</span><span> </span><span class="gd_word" id="S1.p3.1.6.w23">transformer-based</span><span> </span><span class="gd_word" id="S1.p3.1.6.w24">AlphaFold</span><span> </span><span class="gd_word" id="S1.p3.1.6.w25">2</span><span> </span><span class="gd_word" id="S1.p3.1.6.w26">model</span><span> </span><span class="gd_word" id="S1.p3.1.6.w27">in</span><span> </span><span class="gd_word" id="S1.p3.1.6.w28">the</span><span> </span><span class="gd_word" id="S1.p3.1.6.w29">following</span><span> </span><span class="gd_word" id="S1.p3.1.6.w30">sections.)</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span class="gd_word" id="S1.p4.1.1.w1">Although</span><span> </span><span class="gd_word" id="S1.p4.1.1.w2">Transformer</span><span> </span><span class="gd_word" id="S1.p4.1.1.w3">delivers</span><span> </span><span class="gd_word" id="S1.p4.1.1.w4">impressive</span><span> </span><span class="gd_word" id="S1.p4.1.1.w5">performance</span><span> </span><span class="gd_word" id="S1.p4.1.1.w6">in</span><span> </span><span class="gd_word" id="S1.p4.1.1.w7">prediction</span><span> </span><span class="gd_word" id="S1.p4.1.1.w8">accuracy,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w9">it</span><span> </span><span class="gd_word" id="S1.p4.1.1.w10">has</span><span> </span><span class="gd_word" id="S1.p4.1.1.w11">raised</span><span> </span><span class="gd_word" id="S1.p4.1.1.w12">serious</span><span> </span><span class="gd_word" id="S1.p4.1.1.w13">computational</span><span> </span><span class="gd_word" id="S1.p4.1.1.w14">challenges</span><span> </span><span class="gd_word" id="S1.p4.1.1.w15">to</span><span> </span><span class="gd_word" id="S1.p4.1.1.w16">training</span><span> </span><span class="gd_word" id="S1.p4.1.1.w17">and</span><span> </span><span class="gd_word" id="S1.p4.1.1.w18">inference.</span><span> </span><span class="gd_word" id="S1.p4.1.1.w19">As</span><span> </span><span class="gd_word" id="S1.p4.1.1.w20">AlphaFold’s</span><span> </span><span class="gd_word" id="S1.p4.1.1.w21">intermediate</span><span> </span><span class="gd_word" id="S1.p4.1.1.w22">representation</span><span> </span><span class="gd_word" id="S1.p4.1.1.w23">has</span><span> </span><span class="gd_word" id="S1.p4.1.1.w24">two</span><span> </span><span class="gd_word" id="S1.p4.1.1.w25">sequence</span><span> </span><span class="gd_word" id="S1.p4.1.1.w26">dimensions,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w27">its</span><span> </span><span class="gd_word" id="S1.p4.1.1.w28">computational</span><span> </span><span class="gd_word" id="S1.p4.1.1.w29">complexity</span><span> </span><span class="gd_word" id="S1.p4.1.1.w30">is</span><span> </span><span class="gd_word" id="S1.p4.1.1.w31">an</span><span> </span><span class="gd_word" id="S1.p4.1.1.w32">order</span><span> </span><span class="gd_word" id="S1.p4.1.1.w33">of</span><span> </span><span class="gd_word" id="S1.p4.1.1.w34">magnitude</span><span> </span><span class="gd_word" id="S1.p4.1.1.w35">higher</span><span> </span><span class="gd_word" id="S1.p4.1.1.w36">than</span><span> </span><span class="gd_word" id="S1.p4.1.1.w37">the</span><span> </span><span class="gd_word" id="S1.p4.1.1.w38">that</span><span> </span><span class="gd_word" id="S1.p4.1.1.w39">handled</span><span> </span><span class="gd_word" id="S1.p4.1.1.w40">by</span><span> </span><span class="gd_word" id="S1.p4.1.1.w41">the</span><span> </span><span class="gd_word" id="S1.p4.1.1.w42">general</span><span> </span><span class="gd_word" id="S1.p4.1.1.w43">Transformer.</span><span> </span><span class="gd_word" id="S1.p4.1.1.w44">In</span><span> </span><span class="gd_word" id="S1.p4.1.1.w45">addition,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w46">AlphaFold</span><span> </span><span class="gd_word" id="S1.p4.1.1.w47">has</span><span> </span><span class="gd_word" id="S1.p4.1.1.w48">a</span><span> </span><span class="gd_word" id="S1.p4.1.1.w49">unique</span><span> </span><span class="gd_word" id="S1.p4.1.1.w50">model</span><span> </span><span class="gd_word" id="S1.p4.1.1.w51">architecture,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w52">which</span><span> </span><span class="gd_word" id="S1.p4.1.1.w53">is</span><span> </span><span class="gd_word" id="S1.p4.1.1.w54">different</span><span> </span><span class="gd_word" id="S1.p4.1.1.w55">from</span><span> </span><span class="gd_word" id="S1.p4.1.1.w56">that</span><span> </span><span class="gd_word" id="S1.p4.1.1.w57">of</span><span> </span><span class="gd_word" id="S1.p4.1.1.w58">general</span><span> </span><span class="gd_word" id="S1.p4.1.1.w59">Transformer</span><span> </span><span class="gd_word" id="S1.p4.1.1.w60">models,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w61">making</span><span> </span><span class="gd_word" id="S1.p4.1.1.w62">it</span><span> </span><span class="gd_word" id="S1.p4.1.1.w63">less</span><span> </span><span class="gd_word" id="S1.p4.1.1.w64">computationally</span><span> </span><span class="gd_word" id="S1.p4.1.1.w65">efficient</span><span> </span><span class="gd_word" id="S1.p4.1.1.w66">on</span><span> </span><span class="gd_word" id="S1.p4.1.1.w67">the</span><span> </span><span class="gd_word" id="S1.p4.1.1.w68">GPU</span><span> </span><span class="gd_word" id="S1.p4.1.1.w69">platform.</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><span class="gd_word" id="S1.p5.1.1.w1">There</span><span> </span><span class="gd_word" id="S1.p5.1.1.w2">are</span><span> </span><span class="gd_word" id="S1.p5.1.1.w3">two</span><span> </span><span class="gd_word" id="S1.p5.1.1.w4">main</span><span> </span><span class="gd_word" id="S1.p5.1.1.w5">challenges</span><span> </span><span class="gd_word" id="S1.p5.1.1.w6">in</span><span> </span><span class="gd_word" id="S1.p5.1.1.w7">training:</span><span> </span><span class="gd_word" id="S1.p5.1.1.w8">1)</span><span> </span><span class="gd_word" id="S1.p5.1.1.w9">the</span><span> </span><span class="gd_word" id="S1.p5.1.1.w10">limited</span><span> </span><span class="gd_word" id="S1.p5.1.1.w11">global</span><span> </span><span class="gd_word" id="S1.p5.1.1.w12">batch</span><span> </span><span class="gd_word" id="S1.p5.1.1.w13">size</span><span> </span><span class="gd_word" id="S1.p5.1.1.w14">prevents</span><span> </span><span class="gd_word" id="S1.p5.1.1.w15">training</span><span> </span><span class="gd_word" id="S1.p5.1.1.w16">from</span><span> </span><span class="gd_word" id="S1.p5.1.1.w17">scaling</span><span> </span><span class="gd_word" id="S1.p5.1.1.w18">to</span><span> </span><span class="gd_word" id="S1.p5.1.1.w19">more</span><span> </span><span class="gd_word" id="S1.p5.1.1.w20">nodes</span><span> </span><span class="gd_word" id="S1.p5.1.1.w21">using</span><span> </span><span class="gd_word" id="S1.p5.1.1.w22">data</span><span> </span><span class="gd_word" id="S1.p5.1.1.w23">parallelism</span><span> </span><span class="gd_word" id="S1.p5.1.1.w24">as</span><span> </span><span class="gd_word" id="S1.p5.1.1.w25">a</span><span> </span><span class="gd_word" id="S1.p5.1.1.w26">larger</span><span> </span><span class="gd_word" id="S1.p5.1.1.w27">batch</span><span> </span><span class="gd_word" id="S1.p5.1.1.w28">size</span><span> </span><span class="gd_word" id="S1.p5.1.1.w29">will</span><span> </span><span class="gd_word" id="S1.p5.1.1.w30">lead</span><span> </span><span class="gd_word" id="S1.p5.1.1.w31">to</span><span> </span><span class="gd_word" id="S1.p5.1.1.w32">a</span><span> </span><span class="gd_word" id="S1.p5.1.1.w33">drop</span><span> </span><span class="gd_word" id="S1.p5.1.1.w34">in</span><span> </span><span class="gd_word" id="S1.p5.1.1.w35">accuracy,</span><span> </span><span class="gd_word" id="S1.p5.1.1.w36">so</span><span> </span><span class="gd_word" id="S1.p5.1.1.w37">it</span><span> </span><span class="gd_word" id="S1.p5.1.1.w38">takes</span><span> </span><span class="gd_word" id="S1.p5.1.1.w39">around</span><span> </span><span class="gd_word" id="S1.p5.1.1.w40">11</span><span> </span><span class="gd_word" id="S1.p5.1.1.w41">days</span><span> </span><span class="gd_word" id="S1.p5.1.1.w42">to</span><span> </span><span class="gd_word" id="S1.p5.1.1.w43">train</span><span> </span><span class="gd_word" id="S1.p5.1.1.w44">AlphaFold</span><span> </span><span class="gd_word" id="S1.p5.1.1.w45">with</span><span> </span><span class="gd_word" id="S1.p5.1.1.w46">its</span><span> </span><span class="gd_word" id="S1.p5.1.1.w47">official</span><span> </span><span class="gd_word" id="S1.p5.1.1.w48">open-source</span><span> </span><span class="gd_word" id="S1.p5.1.1.w49">implementation</span><span> </span><span class="gd_word" id="S1.p5.1.1.w50">on</span><span> </span><span class="gd_word" id="S1.p5.1.1.w51">128</span><span> </span><span class="gd_word" id="S1.p5.1.1.w52">Google</span><span> </span><span class="gd_word" id="S1.p5.1.1.w53">TPUv3</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite><span class="gd_word" id="S1.p5.1.2.w1">;</span><span> </span><span class="gd_word" id="S1.p5.1.2.w2">2)</span><span> </span><span class="gd_word" id="S1.p5.1.2.w3">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w4">huge</span><span> </span><span class="gd_word" id="S1.p5.1.2.w5">memory</span><span> </span><span class="gd_word" id="S1.p5.1.2.w6">consumption</span><span> </span><span class="gd_word" id="S1.p5.1.2.w7">exceeds</span><span> </span><span class="gd_word" id="S1.p5.1.2.w8">what</span><span> </span><span class="gd_word" id="S1.p5.1.2.w9">current</span><span> </span><span class="gd_word" id="S1.p5.1.2.w10">GPUs</span><span> </span><span class="gd_word" id="S1.p5.1.2.w11">can</span><span> </span><span class="gd_word" id="S1.p5.1.2.w12">handle.</span><span> </span><span class="gd_word" id="S1.p5.1.2.w13">During</span><span> </span><span class="gd_word" id="S1.p5.1.2.w14">inference,</span><span> </span><span class="gd_word" id="S1.p5.1.2.w15">longer</span><span> </span><span class="gd_word" id="S1.p5.1.2.w16">sequence</span><span> </span><span class="gd_word" id="S1.p5.1.2.w17">has</span><span> </span><span class="gd_word" id="S1.p5.1.2.w18">a</span><span> </span><span class="gd_word" id="S1.p5.1.2.w19">much</span><span> </span><span class="gd_word" id="S1.p5.1.2.w20">greater</span><span> </span><span class="gd_word" id="S1.p5.1.2.w21">demand</span><span> </span><span class="gd_word" id="S1.p5.1.2.w22">for</span><span> </span><span class="gd_word" id="S1.p5.1.2.w23">GPU</span><span> </span><span class="gd_word" id="S1.p5.1.2.w24">memory,</span><span> </span><span class="gd_word" id="S1.p5.1.2.w25">and</span><span> </span><span class="gd_word" id="S1.p5.1.2.w26">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w27">inference</span><span> </span><span class="gd_word" id="S1.p5.1.2.w28">time</span><span> </span><span class="gd_word" id="S1.p5.1.2.w29">for</span><span> </span><span class="gd_word" id="S1.p5.1.2.w30">one</span><span> </span><span class="gd_word" id="S1.p5.1.2.w31">long</span><span> </span><span class="gd_word" id="S1.p5.1.2.w32">sequence</span><span> </span><span class="gd_word" id="S1.p5.1.2.w33">can</span><span> </span><span class="gd_word" id="S1.p5.1.2.w34">even</span><span> </span><span class="gd_word" id="S1.p5.1.2.w35">reach</span><span> </span><span class="gd_word" id="S1.p5.1.2.w36">several</span><span> </span><span class="gd_word" id="S1.p5.1.2.w37">hours</span><span> </span><span class="gd_word" id="S1.p5.1.2.w38">for</span><span> </span><span class="gd_word" id="S1.p5.1.2.w39">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w40">AlphaFold</span><span> </span><span class="gd_word" id="S1.p5.1.2.w41">model.</span><span> </span><span class="gd_word" id="S1.p5.1.2.w42">AlphaFold</span><span> </span><span class="gd_word" id="S1.p5.1.2.w43">reduces</span><span> </span><span class="gd_word" id="S1.p5.1.2.w44">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w45">demand</span><span> </span><span class="gd_word" id="S1.p5.1.2.w46">for</span><span> </span><span class="gd_word" id="S1.p5.1.2.w47">GPU</span><span> </span><span class="gd_word" id="S1.p5.1.2.w48">memory</span><span> </span><span class="gd_word" id="S1.p5.1.2.w49">capacity</span><span> </span><span class="gd_word" id="S1.p5.1.2.w50">by</span><span> </span><span class="gd_word" id="S1.p5.1.2.w51">using</span><span> </span><span class="gd_word" id="S1.p5.1.2.w52">activation</span><span> </span><span class="gd_word" id="S1.p5.1.2.w53">checkpointing</span><span> </span><span class="gd_word" id="S1.p5.1.2.w54">and</span><span> </span><span class="gd_word" id="S1.p5.1.2.w55">chunking</span><span> </span><span class="gd_word" id="S1.p5.1.2.w56">technique</span><span> </span><span class="gd_word" id="S1.p5.1.2.w57">at</span><span> </span><span class="gd_word" id="S1.p5.1.2.w58">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w59">trade-off</span><span> </span><span class="gd_word" id="S1.p5.1.2.w60">of</span><span> </span><span class="gd_word" id="S1.p5.1.2.w61">some</span><span> </span><span class="gd_word" id="S1.p5.1.2.w62">performance.</span></p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><span class="gd_word" id="S1.p6.1.1.w1">To</span><span> </span><span class="gd_word" id="S1.p6.1.1.w2">solve</span><span> </span><span class="gd_word" id="S1.p6.1.1.w3">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w4">challenges</span><span> </span><span class="gd_word" id="S1.p6.1.1.w5">mentioned</span><span> </span><span class="gd_word" id="S1.p6.1.1.w6">above,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w7">we</span><span> </span><span class="gd_word" id="S1.p6.1.1.w8">propose</span><span> </span><span class="gd_word" id="S1.p6.1.1.w9">FastFold,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w10">a</span><span> </span><span class="gd_word" id="S1.p6.1.1.w11">highly</span><span> </span><span class="gd_word" id="S1.p6.1.1.w12">efficient</span><span> </span><span class="gd_word" id="S1.p6.1.1.w13">implementation</span><span> </span><span class="gd_word" id="S1.p6.1.1.w14">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w15">protein</span><span> </span><span class="gd_word" id="S1.p6.1.1.w16">structure</span><span> </span><span class="gd_word" id="S1.p6.1.1.w17">prediction</span><span> </span><span class="gd_word" id="S1.p6.1.1.w18">model</span><span> </span><span class="gd_word" id="S1.p6.1.1.w19">for</span><span> </span><span class="gd_word" id="S1.p6.1.1.w20">training</span><span> </span><span class="gd_word" id="S1.p6.1.1.w21">and</span><span> </span><span class="gd_word" id="S1.p6.1.1.w22">inference.</span><span> </span><span class="gd_word" id="S1.p6.1.1.w23">To</span><span> </span><span class="gd_word" id="S1.p6.1.1.w24">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w25">best</span><span> </span><span class="gd_word" id="S1.p6.1.1.w26">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w27">our</span><span> </span><span class="gd_word" id="S1.p6.1.1.w28">knowledge,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w29">FastFold</span><span> </span><span class="gd_word" id="S1.p6.1.1.w30">is</span><span> </span><span class="gd_word" id="S1.p6.1.1.w31">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w32">first</span><span> </span><span class="gd_word" id="S1.p6.1.1.w33">performance</span><span> </span><span class="gd_word" id="S1.p6.1.1.w34">optimization</span><span> </span><span class="gd_word" id="S1.p6.1.1.w35">work</span><span> </span><span class="gd_word" id="S1.p6.1.1.w36">for</span><span> </span><span class="gd_word" id="S1.p6.1.1.w37">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w38">training</span><span> </span><span class="gd_word" id="S1.p6.1.1.w39">and</span><span> </span><span class="gd_word" id="S1.p6.1.1.w40">inference</span><span> </span><span class="gd_word" id="S1.p6.1.1.w41">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w42">protein</span><span> </span><span class="gd_word" id="S1.p6.1.1.w43">structure</span><span> </span><span class="gd_word" id="S1.p6.1.1.w44">prediction</span><span> </span><span class="gd_word" id="S1.p6.1.1.w45">models.</span><span> </span><span class="gd_word" id="S1.p6.1.1.w46">FastFold</span><span> </span><span class="gd_word" id="S1.p6.1.1.w47">successfully</span><span> </span><span class="gd_word" id="S1.p6.1.1.w48">introduced</span><span> </span><span class="gd_word" id="S1.p6.1.1.w49">large</span><span> </span><span class="gd_word" id="S1.p6.1.1.w50">model</span><span> </span><span class="gd_word" id="S1.p6.1.1.w51">training</span><span> </span><span class="gd_word" id="S1.p6.1.1.w52">techniques</span><span> </span><span class="gd_word" id="S1.p6.1.1.w53">and</span><span> </span><span class="gd_word" id="S1.p6.1.1.w54">reduces</span><span> </span><span class="gd_word" id="S1.p6.1.1.w55">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w56">time</span><span> </span><span class="gd_word" id="S1.p6.1.1.w57">and</span><span> </span><span class="gd_word" id="S1.p6.1.1.w58">economic</span><span> </span><span class="gd_word" id="S1.p6.1.1.w59">cost</span><span> </span><span class="gd_word" id="S1.p6.1.1.w60">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w61">AlphaFold</span><span> </span><span class="gd_word" id="S1.p6.1.1.w62">model</span><span> </span><span class="gd_word" id="S1.p6.1.1.w63">training</span><span> </span><span class="gd_word" id="S1.p6.1.1.w64">and</span><span> </span><span class="gd_word" id="S1.p6.1.1.w65">inference</span><span> </span><span class="gd_word" id="S1.p6.1.1.w66">significantly.</span></p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><span class="gd_word" id="S1.p7.1.1.w1">FastFold</span><span> </span><span class="gd_word" id="S1.p7.1.1.w2">consists</span><span> </span><span class="gd_word" id="S1.p7.1.1.w3">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w4">a</span><span> </span><span class="gd_word" id="S1.p7.1.1.w5">high-performance</span><span> </span><span class="gd_word" id="S1.p7.1.1.w6">implementation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w7">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w8">Evoformer,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w9">the</span><span> </span><span class="gd_word" id="S1.p7.1.1.w10">backbone</span><span> </span><span class="gd_word" id="S1.p7.1.1.w11">structure</span><span> </span><span class="gd_word" id="S1.p7.1.1.w12">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w13">AlphaFold,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w14">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w15">an</span><span> </span><span class="gd_word" id="S1.p7.1.1.w16">innovative</span><span> </span><span class="gd_word" id="S1.p7.1.1.w17">model</span><span> </span><span class="gd_word" id="S1.p7.1.1.w18">parallelism</span><span> </span><span class="gd_word" id="S1.p7.1.1.w19">strategy</span><span> </span><span class="gd_word" id="S1.p7.1.1.w20">called</span><span> </span><span class="gd_word" id="S1.p7.1.1.w21">Dynamic</span><span> </span><span class="gd_word" id="S1.p7.1.1.w22">Axial</span><span> </span><span class="gd_word" id="S1.p7.1.1.w23">Parallelism.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w24">We</span><span> </span><span class="gd_word" id="S1.p7.1.1.w25">analyzed</span><span> </span><span class="gd_word" id="S1.p7.1.1.w26">the</span><span> </span><span class="gd_word" id="S1.p7.1.1.w27">complex</span><span> </span><span class="gd_word" id="S1.p7.1.1.w28">structure</span><span> </span><span class="gd_word" id="S1.p7.1.1.w29">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w30">Evoformer</span><span> </span><span class="gd_word" id="S1.p7.1.1.w31">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w32">performed</span><span> </span><span class="gd_word" id="S1.p7.1.1.w33">kernel</span><span> </span><span class="gd_word" id="S1.p7.1.1.w34">fusion.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w35">We</span><span> </span><span class="gd_word" id="S1.p7.1.1.w36">additionally</span><span> </span><span class="gd_word" id="S1.p7.1.1.w37">optimized</span><span> </span><span class="gd_word" id="S1.p7.1.1.w38">for</span><span> </span><span class="gd_word" id="S1.p7.1.1.w39">unique</span><span> </span><span class="gd_word" id="S1.p7.1.1.w40">operation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w41">in</span><span> </span><span class="gd_word" id="S1.p7.1.1.w42">Evoformer,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w43">as</span><span> </span><span class="gd_word" id="S1.p7.1.1.w44">well</span><span> </span><span class="gd_word" id="S1.p7.1.1.w45">as</span><span> </span><span class="gd_word" id="S1.p7.1.1.w46">specific</span><span> </span><span class="gd_word" id="S1.p7.1.1.w47">kernel</span><span> </span><span class="gd_word" id="S1.p7.1.1.w48">optimizations</span><span> </span><span class="gd_word" id="S1.p7.1.1.w49">such</span><span> </span><span class="gd_word" id="S1.p7.1.1.w50">as</span><span> </span><span class="gd_word" id="S1.p7.1.1.w51">Softmax</span><span> </span><span class="gd_word" id="S1.p7.1.1.w52">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w53">LayerNorm</span><span> </span><span class="gd_word" id="S1.p7.1.1.w54">based</span><span> </span><span class="gd_word" id="S1.p7.1.1.w55">on</span><span> </span><span class="gd_word" id="S1.p7.1.1.w56">performance</span><span> </span><span class="gd_word" id="S1.p7.1.1.w57">characteristics.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w58">The</span><span> </span><span class="gd_word" id="S1.p7.1.1.w59">high-performance</span><span> </span><span class="gd_word" id="S1.p7.1.1.w60">Evoformer</span><span> </span><span class="gd_word" id="S1.p7.1.1.w61">implementation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w62">substantially</span><span> </span><span class="gd_word" id="S1.p7.1.1.w63">reduces</span><span> </span><span class="gd_word" id="S1.p7.1.1.w64">the</span><span> </span><span class="gd_word" id="S1.p7.1.1.w65">economic</span><span> </span><span class="gd_word" id="S1.p7.1.1.w66">cost</span><span> </span><span class="gd_word" id="S1.p7.1.1.w67">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w68">training</span><span> </span><span class="gd_word" id="S1.p7.1.1.w69">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w70">inference.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w71">For</span><span> </span><span class="gd_word" id="S1.p7.1.1.w72">parallelism</span><span> </span><span class="gd_word" id="S1.p7.1.1.w73">strategy,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w74">we</span><span> </span><span class="gd_word" id="S1.p7.1.1.w75">propose</span><span> </span><span class="gd_word" id="S1.p7.1.1.w76">Dynamic</span><span> </span><span class="gd_word" id="S1.p7.1.1.w77">Axial</span><span> </span><span class="gd_word" id="S1.p7.1.1.w78">Parallelism,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w79">which</span><span> </span><span class="gd_word" id="S1.p7.1.1.w80">outperforms</span><span> </span><span class="gd_word" id="S1.p7.1.1.w81">the</span><span> </span><span class="gd_word" id="S1.p7.1.1.w82">current</span><span> </span><span class="gd_word" id="S1.p7.1.1.w83">standard</span><span> </span><span class="gd_word" id="S1.p7.1.1.w84">Tensor</span><span> </span><span class="gd_word" id="S1.p7.1.1.w85">Parallelism</span><span> </span><span class="gd_word" id="S1.p7.1.1.w86">in</span><span> </span><span class="gd_word" id="S1.p7.1.1.w87">terms</span><span> </span><span class="gd_word" id="S1.p7.1.1.w88">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w89">scaling</span><span> </span><span class="gd_word" id="S1.p7.1.1.w90">efficiency.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w91">For</span><span> </span><span class="gd_word" id="S1.p7.1.1.w92">communication</span><span> </span><span class="gd_word" id="S1.p7.1.1.w93">optimization,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w94">we</span><span> </span><span class="gd_word" id="S1.p7.1.1.w95">proposed</span><span> </span><span class="gd_word" id="S1.p7.1.1.w96">Duality</span><span> </span><span class="gd_word" id="S1.p7.1.1.w97">Async</span><span> </span><span class="gd_word" id="S1.p7.1.1.w98">Operation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w99">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w100">implemented</span><span> </span><span class="gd_word" id="S1.p7.1.1.w101">it</span><span> </span><span class="gd_word" id="S1.p7.1.1.w102">as</span><span> </span><span class="gd_word" id="S1.p7.1.1.w103">an</span><span> </span><span class="gd_word" id="S1.p7.1.1.w104">extension</span><span> </span><span class="gd_word" id="S1.p7.1.1.w105">of</span><span> </span><span class="gd_word" id="S1.p7.1.1.w106">PyTorch.</span><span> </span><span class="gd_word" id="S1.p7.1.1.w107">Relying</span><span> </span><span class="gd_word" id="S1.p7.1.1.w108">on</span><span> </span><span class="gd_word" id="S1.p7.1.1.w109">the</span><span> </span><span class="gd_word" id="S1.p7.1.1.w110">inserted</span><span> </span><span class="gd_word" id="S1.p7.1.1.w111">Duality</span><span> </span><span class="gd_word" id="S1.p7.1.1.w112">Async</span><span> </span><span class="gd_word" id="S1.p7.1.1.w113">Operation,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w114">FastFold</span><span> </span><span class="gd_word" id="S1.p7.1.1.w115">implements</span><span> </span><span class="gd_word" id="S1.p7.1.1.w116">computation-communication</span><span> </span><span class="gd_word" id="S1.p7.1.1.w117">overlap</span><span> </span><span class="gd_word" id="S1.p7.1.1.w118">in</span><span> </span><span class="gd_word" id="S1.p7.1.1.w119">forward</span><span> </span><span class="gd_word" id="S1.p7.1.1.w120">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w121">backward.
The</span><span> </span><span class="gd_word" id="S1.p7.1.1.w122">implementation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w123">can</span><span> </span><span class="gd_word" id="S1.p7.1.1.w124">be</span><span> </span><span class="gd_word" id="S1.p7.1.1.w125">found</span><span> </span><span class="gd_word" id="S1.p7.1.1.w126">at</span><span> </span><a href="https://github.com/hpcaitech/FastFold" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/hpcaitech/FastFold</a><span class="gd_word" id="S1.p7.1.2.w1">.</span></p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p"><span class="gd_word" id="S1.p8.1.1.w1">In</span><span> </span><span class="gd_word" id="S1.p8.1.1.w2">summary,</span><span> </span><span class="gd_word" id="S1.p8.1.1.w3">our</span><span> </span><span class="gd_word" id="S1.p8.1.1.w4">paper</span><span> </span><span class="gd_word" id="S1.p8.1.1.w5">has</span><span> </span><span class="gd_word" id="S1.p8.1.1.w6">the</span><span> </span><span class="gd_word" id="S1.p8.1.1.w7">following</span><span> </span><span class="gd_word" id="S1.p8.1.1.w8">major</span><span> </span><span class="gd_word" id="S1.p8.1.1.w9">contributions:</span></p>
</div>
<div id="S1.p9" class="ltx_para">
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p"><span class="gd_word" id="S1.I1.i1.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w2">optimized</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w3">for</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w4">AlphaFold</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w5">operators</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w6">based</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w7">on</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w8">the</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w9">AlphaFold-specific</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w10">performance</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w11">characteristic.</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w12">Combined</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w13">with</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w14">kernel</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w15">fusion,</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w16">the</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w17">kernel</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w18">implementation</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w19">of</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w20">FastFold</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w21">achieves</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w22">significant</span><span> </span><span class="gd_word" id="S1.I1.i1.p1.1.1.w23">speedup.</span></p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p"><span class="gd_word" id="S1.I1.i2.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w2">proposed</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w3">Dynamic</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w4">Axial</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w5">Parallelism,</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w6">which</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w7">has</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w8">a</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w9">lower</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w10">communication</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w11">overhead</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w12">than</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w13">other</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w14">model</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w15">parallelism</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w16">methods.</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w17">In</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w18">terms</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w19">of</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w20">communication</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w21">optimization,</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w22">the</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w23">proposed</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w24">Duality</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w25">Async</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w26">Operation</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w27">implements</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w28">computation-communication</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w29">overlap</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w30">in</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w31">dynamic</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w32">computational</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w33">graphs</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w34">framework</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w35">like</span><span> </span><span class="gd_word" id="S1.I1.i2.p1.1.1.w36">PyTorch.</span></p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p"><span class="gd_word" id="S1.I1.i3.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w2">successfully</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w3">scaled</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w4">the</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w5">AlphaFold</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w6">model</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w7">training</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w8">to</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w9">512</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w10">NVIDIA</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w11">A100</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w12">GPUs</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w13">and</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w14">obtained</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w15">aggregate</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w16">6.02</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w17">PetaFLOPs</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w18">at</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w19">the</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w20">training</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w21">stage.</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w22">The</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w23">overall</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w24">training</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w25">time</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w26">is</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w27">reduced</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w28">to</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w29">67</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w30">hours</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w31">from</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w32">11</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w33">days</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w34">with</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w35">significant</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w36">economic</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w37">cost</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w38">savings.</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w39">On</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w40">the</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w41">other</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w42">hand,</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w43">FastFold</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.1.w44">achieves</span><span> </span><math id="S1.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="7.5\sim 9.5\times" display="inline"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1b"><mn id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml">7.5</mn><mo id="S1.I1.i3.p1.1.m1.1.2" xref="S1.I1.i3.p1.1.m1.1.2.cmml">∼</mo><mn id="S1.I1.i3.p1.1.m1.1.3" xref="S1.I1.i3.p1.1.m1.1.3.cmml">9.5</mn><mo id="S1.I1.i3.p1.1.m1.1.4" xref="S1.I1.i3.p1.1.m1.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S1.I1.i3.p1.1.2.w1"/><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w2">speedup</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w3">for</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w4">long</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w5">sequences</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w6">and</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w7">makes</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w8">it</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w9">possible</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w10">for</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w11">inference</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w12">over</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w13">extremely</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w14">long</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w15">sequences</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w16">at</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w17">the</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w18">inference</span><span> </span><span class="gd_word" id="S1.I1.i3.p1.1.2.w19">stage.
</span></p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span>Background
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">II-A </span>Overview of AlphaFold
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p"><span class="gd_word" id="S2.SS1.p1.1.1.w1">Unlike</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w2">prior</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w3">protein</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w4">structure</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w5">models,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w6">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w7">is</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w8">an</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w9">end-to-end</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w10">model</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w11">that</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w12">uses</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w13">amino</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w14">acid</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w15">sequences</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w16">as</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w17">model</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w18">input</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w19">and</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w20">directly</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w21">outputs</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w22">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w23">three-dimensional</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w24">structure</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w25">of</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w27">protein.</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w28">Through</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w29">genetic</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w30">database</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w31">search</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w32">and</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w33">structure</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w34">database</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w35">search,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w36">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w37">obtains</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w38">Multiple</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w39">Sequence</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w40">Alignment</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w41">(MSA)</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w42">and</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w43">Templates</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w44">information</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w45">of</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w46">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w47">sequences.</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w48">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w49">information</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w50">includes</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w51">amino</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w52">acid</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w53">sequences</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w54">that</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w55">are</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w56">similar</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w57">to</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w58">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w59">target</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w60">sequence.</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w61">Using</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w62">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w63">information,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w64">amino</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w65">acids</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w66">that</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w67">have</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w68">mutated</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w69">during</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w70">evolution</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w71">can</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w72">be</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w73">identified,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w74">based</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w75">on</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w76">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w77">principle</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w78">that</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w79">these</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w80">co-evolving</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w81">residues</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w82">will</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w83">be</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w84">located</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w85">at</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w86">neighboring</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w87">positions</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w88">or</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w89">contacts</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w90">in</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w91">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w92">three-dimensional</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w93">structure</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w94">of</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w95">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w96">protein.</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w97">The</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w98">Templates</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w99">information,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w100">which</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w101">contains</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w102">structural</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w103">information</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w104">corresponding</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w105">to</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w106">known</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w107">sequences,</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w108">will</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w109">provide</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w110">sufficient</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w111">information</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w112">for</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w113">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w114">model</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w115">to</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w116">predict</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w117">the</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w118">protein</span><span> </span><span class="gd_word" id="S2.SS1.p1.1.1.w119">structure.</span></p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p"><span class="gd_word" id="S2.SS1.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w2">architecture</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w3">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w4">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w5">is</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w6">shown</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w7">in</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.1.w8">Figure</span><span> </span><a href="#S2.F1" title="Fig. 1 ‣ II-A Overview of AlphaFold ‣ II Background ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">1</a><span class="gd_word" id="S2.SS1.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w2">which</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w3">consists</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w4">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w5">three</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w6">parts:</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w7">Embedding,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w8">Evoformer,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w9">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w10">Structure</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w11">Module.</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w12">The</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w13">Embedding</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w14">part</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w15">encodes</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w16">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w17">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w18">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w19">Template</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w20">information</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w21">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w22">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w23">target</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w24">sequence</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w25">into</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w26">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w27">representation</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w28">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w29">pair</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w30">representation.</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w31">The</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w32">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w33">representation</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w34">contains</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w35">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w36">co-evolving</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w37">information</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w38">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w39">all</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w40">similar</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w41">sequences,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w42">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w43">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w44">pair</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w45">representation</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w46">contains</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w47">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w48">interaction</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w49">information</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w50">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w51">residues</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w52">pairs</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w53">in</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w54">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w55">sequences.</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w56">These</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w57">representations</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w58">are</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w59">fed</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w60">to</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w61">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w62">Evoformer</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w63">blocks,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w64">which</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w65">will</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w66">be</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w67">discussed</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w68">in</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w69">detail</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w70">in</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w71">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w72">next</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w73">section.</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w74">After</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w75">Evoformer,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w76">MSA</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w77">representation</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w78">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w79">pair</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w80">representation</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w81">contains</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w82">highly</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w83">processed</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w84">modeling</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w85">information</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w86">and</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w87">are</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w88">fed</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w89">into</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w90">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w91">Structure</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w92">Module,</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w93">which</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w94">eventually</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w95">outputs</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w96">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w97">three-dimensional</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w98">structure</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w99">of</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w100">the</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w101">protein</span><span> </span><span class="gd_word" id="S2.SS1.p2.1.2.w102">directly.</span></p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.1" class="ltx_p"><span class="gd_word" id="S2.SS1.p3.1.1.w1">To</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w2">speed</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w3">up</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w4">training</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w5">time</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w6">and</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w7">reduce</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w8">memory</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w9">consumption,</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w10">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w11">training</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w12">uses</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w13">Bfloat16</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.1.w14">precision</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite><span class="gd_word" id="S2.SS1.p3.1.2.w1">.</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w2">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w3">uses</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w4">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w5">recycling</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w6">technique</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w7">to</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w8">improve</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w9">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w10">accuracy</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w11">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w12">model</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w13">prediction</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w14">at</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w15">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w16">cost</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w17">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w18">repeatedly</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w19">performing</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w20">forward</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w21">propagation</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w22">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w23">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w24">model.</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w25">Recycling</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w26">re-embeds</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w27">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w28">output</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w29">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w30">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w31">model</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w32">into</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w33">representation</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w34">and</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w35">allows</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w36">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w37">model</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w38">to</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w39">process</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w40">multiple</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w41">versions</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w42">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w43">the</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w44">embedding</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w45">features.</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w46">The</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w47">number</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w48">of</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w49">recycling</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w50">is</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w51">set</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w52">by</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w53">uniformly</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w54">sampling</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w55">between</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w56">1</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w57">and</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w58">4</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w59">during</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w60">training,</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w61">and</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w62">is</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w63">fixed</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w64">to</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w65">4</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w66">when</span><span> </span><span class="gd_word" id="S2.SS1.p3.1.2.w67">inference.</span></p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.1" class="ltx_p"><span class="gd_word" id="S2.SS1.p4.1.1.w1">The</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w2">complete</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w3">training</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w4">process</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w5">of</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w6">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w7">includes</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w8">Initial</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w9">Training</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w10">and</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w11">Fine-tuning.</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w12">The</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w13">main</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w14">difference</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w15">is</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w16">that</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w17">Fine-tuning</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w18">uses</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w19">a</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w20">larger</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w21">sequence</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w22">length</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w23">for</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w24">training.</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w25">In</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w26">the</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w27">official</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w28">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.1.w29">experiments</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite><span class="gd_word" id="S2.SS1.p4.1.2.w1">,</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w2">the</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w3">training</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w4">process</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w5">was</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w6">done</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w7">on</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w8">128</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w9">TPUv3-cores</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w10">with</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w11">a</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w12">mini-batch</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w13">size</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w14">of</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w15">128.</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w16">The</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w17">limited</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w18">batch</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w19">size</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w20">prevents</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w21">AlphaFold</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w22">from</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w23">scaling</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w24">to</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w25">more</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w26">computational</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w27">resources,</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w28">and</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w29">the</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w30">overall</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w31">training</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w32">time</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w33">reaches</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w34">11</span><span> </span><span class="gd_word" id="S2.SS1.p4.1.2.w35">days.</span></p>
</div>
<figure id="S2.T1" class="ltx_table">
<img src="/static/img/2203.00854-gpt-3.5-turbo-16k/S2_T1.png" alt="/static/img/2203.00854-gpt-3.5-turbo-16k/S2_T1.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span><span class="gd_word" id="S2.T1.2.w1">Details</span><span> </span><span class="gd_word" id="S2.T1.2.w2">of</span><span> </span><span class="gd_word" id="S2.T1.2.w3">AlphaFold</span><span> </span><span class="gd_word" id="S2.T1.2.w4">model</span><span> </span><span class="gd_word" id="S2.T1.2.w5">training.</span></figcaption>
</figure>
<figure id="S2.F1" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S2.F1.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 1: </span><span class="gd_word" id="S2.F1.2.w1">The</span><span> </span><span class="gd_word" id="S2.F1.2.w2">Architecture</span><span> </span><span class="gd_word" id="S2.F1.2.w3">of</span><span> </span><span class="gd_word" id="S2.F1.2.w4">AlphaFold</span><span> </span><span class="gd_word" id="S2.F1.2.w5">Model.</span><span> </span><span class="gd_word" id="S2.F1.2.w6">The</span><span> </span><span class="gd_word" id="S2.F1.2.w7">amino</span><span> </span><span class="gd_word" id="S2.F1.2.w8">acid</span><span> </span><span class="gd_word" id="S2.F1.2.w9">sequence</span><span> </span><span class="gd_word" id="S2.F1.2.w10">is</span><span> </span><span class="gd_word" id="S2.F1.2.w11">encoded</span><span> </span><span class="gd_word" id="S2.F1.2.w12">into</span><span> </span><span class="gd_word" id="S2.F1.2.w13">MSA</span><span> </span><span class="gd_word" id="S2.F1.2.w14">and</span><span> </span><span class="gd_word" id="S2.F1.2.w15">pair</span><span> </span><span class="gd_word" id="S2.F1.2.w16">representation</span><span> </span><span class="gd_word" id="S2.F1.2.w17">after</span><span> </span><span class="gd_word" id="S2.F1.2.w18">Embedding</span><span> </span><span class="gd_word" id="S2.F1.2.w19">layer,</span><span> </span><span class="gd_word" id="S2.F1.2.w20">then</span><span> </span><span class="gd_word" id="S2.F1.2.w21">feeding</span><span> </span><span class="gd_word" id="S2.F1.2.w22">into</span><span> </span><span class="gd_word" id="S2.F1.2.w23">Structure</span><span> </span><span class="gd_word" id="S2.F1.2.w24">Module</span><span> </span><span class="gd_word" id="S2.F1.2.w25">after</span><span> </span><span class="gd_word" id="S2.F1.2.w26">48</span><span> </span><span class="gd_word" id="S2.F1.2.w27">Evoformer</span><span> </span><span class="gd_word" id="S2.F1.2.w28">blocks.</span><span> </span><span class="gd_word" id="S2.F1.2.w29">In</span><span> </span><span class="gd_word" id="S2.F1.2.w30">Evoformer,</span><span> </span><span class="gd_word" id="S2.F1.2.w31">MSA</span><span> </span><span class="gd_word" id="S2.F1.2.w32">and</span><span> </span><span class="gd_word" id="S2.F1.2.w33">pair</span><span> </span><span class="gd_word" id="S2.F1.2.w34">representation</span><span> </span><span class="gd_word" id="S2.F1.2.w35">were</span><span> </span><span class="gd_word" id="S2.F1.2.w36">processed</span><span> </span><span class="gd_word" id="S2.F1.2.w37">by</span><span> </span><span class="gd_word" id="S2.F1.2.w38">MSA</span><span> </span><span class="gd_word" id="S2.F1.2.w39">Stack</span><span> </span><span class="gd_word" id="S2.F1.2.w40">and</span><span> </span><span class="gd_word" id="S2.F1.2.w41">Pair</span><span> </span><span class="gd_word" id="S2.F1.2.w42">Stack,</span><span> </span><span class="gd_word" id="S2.F1.2.w43">respectively.</span><span> </span><span class="gd_word" id="S2.F1.2.w44">In</span><span> </span><span class="gd_word" id="S2.F1.2.w45">addition</span><span> </span><span class="gd_word" id="S2.F1.2.w46">to</span><span> </span><span class="gd_word" id="S2.F1.2.w47">this,</span><span> </span><span class="gd_word" id="S2.F1.2.w48">there</span><span> </span><span class="gd_word" id="S2.F1.2.w49">is</span><span> </span><span class="gd_word" id="S2.F1.2.w50">a</span><span> </span><span class="gd_word" id="S2.F1.2.w51">communication</span><span> </span><span class="gd_word" id="S2.F1.2.w52">mechanism</span><span> </span><span class="gd_word" id="S2.F1.2.w53">that</span><span> </span><span class="gd_word" id="S2.F1.2.w54">allows</span><span> </span><span class="gd_word" id="S2.F1.2.w55">information</span><span> </span><span class="gd_word" id="S2.F1.2.w56">to</span><span> </span><span class="gd_word" id="S2.F1.2.w57">be</span><span> </span><span class="gd_word" id="S2.F1.2.w58">exchanged</span><span> </span><span class="gd_word" id="S2.F1.2.w59">between</span><span> </span><span class="gd_word" id="S2.F1.2.w60">the</span><span> </span><span class="gd_word" id="S2.F1.2.w61">two</span><span> </span><span class="gd_word" id="S2.F1.2.w62">representation.</span></figcaption>
</figure>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">II-B </span>Evoformer
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p"><span class="gd_word" id="S2.SS2.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w2">main</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w3">trunk</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w4">of</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w5">the</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w6">network</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w7">consists</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w8">of</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w9">48</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w10">Evoformer</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w11">blocks,</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w12">and</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w13">each</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w14">block</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w15">has</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w16">three</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w17">parts:</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w18">MSA</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w19">Stack,</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w20">Communication,</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w21">and</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w22">Pair</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w23">Stack</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w24">as</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w25">shown</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w26">in</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.1.w27">Figure</span><span> </span><a href="#S2.F1" title="Fig. 1 ‣ II-A Overview of AlphaFold ‣ II Background ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">1</a><span class="gd_word" id="S2.SS2.p1.1.2.w1">.</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w2">The</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w3">representations</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w4">that</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w5">go</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w6">through</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w7">Evoformer</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w8">are</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w9">highly</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w10">processed</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w11">and</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w12">contain</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w13">feature</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w14">relationships</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w15">in</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w16">the</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w17">sequence</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w18">dimension</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w19">that</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w20">can</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w21">be</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w22">used</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w23">by</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w24">subsequent</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w25">modules</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w26">for</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w27">structure</span><span> </span><span class="gd_word" id="S2.SS2.p1.1.2.w28">prediction.</span></p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p"><span class="gd_word" id="S2.SS2.p2.1.1.w1">MSA</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w2">representations</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w3">are</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w4">processed</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w5">with</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w6">Row-wise</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w7">Attention,</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w8">Column-wise</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w9">Attention,</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w10">and</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w11">Transition</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w12">(2</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w13">MLP</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w14">layers),</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w15">while</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w16">pair</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w17">representations</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w18">are</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w19">processed</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w20">with</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w21">similar</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w22">blocks</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w23">with</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w24">additional</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w25">Triangular</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w26">Updates</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w27">Module.</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w28">Triangular</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w29">Updates</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w30">Module</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w31">uses</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w32">triangular</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w33">relationships</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w34">in</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w35">pair</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w36">information</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w37">to</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w38">infer</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w39">and</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w40">update</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w41">representations.</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w42">Attention</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w43">Biasing</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w44">and</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w45">Outer</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w46">Product</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w47">Mean</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w48">are</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w49">designed</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w50">to</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w51">enable</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w52">communication</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w53">between</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w54">two</span><span> </span><span class="gd_word" id="S2.SS2.p2.1.1.w55">representations.</span></p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">II-C </span>Parallelism for Training
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S2.SS3.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w2">modern</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w3">deep</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w4">learning</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w5">training,</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w6">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w7">methods</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w8">are</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w9">introduced</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w10">for</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w11">two</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w12">main</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w13">purposes:</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w14">1)</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w15">to</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w16">significantly</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w17">reduce</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w18">the</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w19">time</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w20">cost</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w21">of</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w22">training;</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w23">2)</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w24">to</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w25">train</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w26">large</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w27">models</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w28">with</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w29">limited</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w30">resources.</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w31">For</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w32">these</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w33">two</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w34">purposes,</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w35">the</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w36">most</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w37">mainstream</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w38">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w39">methods</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w40">include</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w41">Data</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w42">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w43">and</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w44">Model</span><span> </span><span class="gd_word" id="S2.SS3.p1.1.1.w45">Parallelism.</span></p>
</div>
<div id="S2.SS3.p2" class="ltx_para">
<p id="S2.SS3.p2.1" class="ltx_p"><span class="gd_word" id="S2.SS3.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w2">most</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w3">basic</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w4">and</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w5">widely</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w6">used</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w7">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w8">method</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w9">is</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w10">Data</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w11">Parallelism.</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w12">Each</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w13">device</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w14">has</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w15">a</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w16">complete</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w17">set</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w18">of</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w19">model</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w20">parameters</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w21">and</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w22">then</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w23">processes</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w24">different</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w25">training</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w26">data</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w27">(mini-batch).</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w28">During</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w29">the</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w30">training</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w31">phase,</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w32">each</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w33">device</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w34">calculates</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w35">the</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w36">local</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w37">gradient</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w38">using</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w39">a</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w40">local</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w41">mini-batch,</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w42">then</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w43">uses</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w44">All-Reduce</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w45">communication</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w46">to</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w47">obtain</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w48">the</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w49">globally</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w50">averaged</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w51">gradient,</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w52">after</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w53">which</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w54">the</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w55">model</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w56">parameters</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w57">are</span><span> </span><span class="gd_word" id="S2.SS3.p2.1.1.w58">updated.</span></p>
</div>
<div id="S2.SS3.p3" class="ltx_para">
<p id="S2.SS3.p3.1" class="ltx_p"><span class="gd_word" id="S2.SS3.p3.1.1.w1">Model</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w2">parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w3">distributes</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w4">the</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w5">model</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w6">parameters</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w7">to</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w8">different</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w9">devices,</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w10">which</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w11">are</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w12">generally</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w13">classified</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w14">as</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w15">Tensor</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w16">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w17">and</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w18">Pipeline</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w19">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w20">according</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w21">to</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w22">the</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w23">distribution</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w24">method.</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w25">Tensor</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w26">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w27">divides</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w28">the</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w29">model</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w30">parameters</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w31">into</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w32">different</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w33">devices,</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w34">each</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w35">of</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w36">which</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w37">computes</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w38">according</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w39">to</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w40">the</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w41">local</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w42">tensor</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w43">slice</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w44">and</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w45">uses</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w46">collective</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w47">communication</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w48">(All-Gather</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w49">or</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w50">All-Reduce)</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w51">when</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w52">the</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w53">entire</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w54">tensor</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w55">is</span><span> </span><span class="gd_word" id="S2.SS3.p3.1.1.w56">needed.</span></p>
</div>
<div id="S2.SS3.p4" class="ltx_para">
<p id="S2.SS3.p4.1" class="ltx_p"><span class="gd_word" id="S2.SS3.p4.1.1.w1">In</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w2">Pipeline</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w3">Parallelism,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w4">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w5">model</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w6">is</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w7">split</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w8">vertically</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w9">(layer-wise)</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w10">among</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w11">multiple</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w12">devices,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w13">with</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w14">several</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w15">successive</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w16">layers</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w17">on</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w18">a</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w19">single</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w20">device.</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w21">As</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w22">there</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w23">are</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w24">dependencies</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w25">between</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w26">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w27">computations</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w28">of</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w29">different</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w30">devices</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w31">in</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w32">Pipeline</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w33">Parallelism,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w34">it</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w35">will</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w36">introduce</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w37">device</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w38">idleness,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w39">which</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w40">is</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w41">called</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w42">bubbles.</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w43">To</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w44">improve</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w45">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w46">utilization</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w47">of</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w48">device</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w49">resources,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w50">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w51">current</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w52">mainstream</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w53">approach</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w54">will</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w55">continue</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w56">to</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w57">divide</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w58">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w59">mini-batch</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w60">into</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w61">micro-batch,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w62">providing</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w63">more</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w64">opportunities</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w65">for</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w66">overlapping,</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w67">thus</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w68">reducing</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w69">the</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w70">bubble</span><span> </span><span class="gd_word" id="S2.SS3.p4.1.1.w71">ratio.</span></p>
</div>
<div id="S2.SS3.p5" class="ltx_para">
<p id="S2.SS3.p5.1" class="ltx_p"><span class="gd_word" id="S2.SS3.p5.1.1.w1">A</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w2">combination</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w3">of</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w4">several</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w5">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w6">approaches</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w7">is</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w8">usually</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w9">required</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w10">for</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w11">training</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w12">large</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w13">models.</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.1.w14">Megatron-LM</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><span class="gd_word" id="S2.SS3.p5.1.2.w1">,</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w2">for</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w3">example,</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w4">uses</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w5">Tensor</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w6">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w7">as</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w8">intra-node</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w9">model</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w10">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w11">method</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w12">and</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w13">Pipeline</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w14">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w15">as</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w16">inter-node</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w17">model</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w18">parallel</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w19">method</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w20">since</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w21">Tensor</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w22">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w23">is</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w24">more</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w25">bandwidth-intensive</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w26">than</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w27">Pipeline</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w28">Parallelism.</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w29">Finally,</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w30">Data</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w31">Parallelism</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w32">is</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w33">used</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w34">to</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w35">scale</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w36">to</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w37">more</span><span> </span><span class="gd_word" id="S2.SS3.p5.1.2.w38">nodes.</span></p>
</div>
<figure id="S2.F2" class="ltx_figure">
<img src="/static/img/2203.00854/S2_F2.png" alt="/static/img/2203.00854/S2_F2.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 2: </span><span class="gd_word" id="S2.F2.2.w1">Two</span><span> </span><span class="gd_word" id="S2.F2.2.w2">mainstream</span><span> </span><span class="gd_word" id="S2.F2.2.w3">approaches</span><span> </span><span class="gd_word" id="S2.F2.2.w4">for</span><span> </span><span class="gd_word" id="S2.F2.2.w5">Model</span><span> </span><span class="gd_word" id="S2.F2.2.w6">Parallelism.</span></figcaption>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span>In-depth Analysis of Evoformer
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p"><span class="gd_word" id="S3.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S3.p1.1.1.w2">this</span><span> </span><span class="gd_word" id="S3.p1.1.1.w3">section</span><span> </span><span class="gd_word" id="S3.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="S3.p1.1.1.w5">will</span><span> </span><span class="gd_word" id="S3.p1.1.1.w6">compare</span><span> </span><span class="gd_word" id="S3.p1.1.1.w7">the</span><span> </span><span class="gd_word" id="S3.p1.1.1.w8">differences</span><span> </span><span class="gd_word" id="S3.p1.1.1.w9">between</span><span> </span><span class="gd_word" id="S3.p1.1.1.w10">Evoformer</span><span> </span><span class="gd_word" id="S3.p1.1.1.w11">and</span><span> </span><span class="gd_word" id="S3.p1.1.1.w12">Transformer</span><span> </span><span class="gd_word" id="S3.p1.1.1.w13">models</span><span> </span><span class="gd_word" id="S3.p1.1.1.w14">and</span><span> </span><span class="gd_word" id="S3.p1.1.1.w15">perform</span><span> </span><span class="gd_word" id="S3.p1.1.1.w16">a</span><span> </span><span class="gd_word" id="S3.p1.1.1.w17">performance</span><span> </span><span class="gd_word" id="S3.p1.1.1.w18">analysis</span><span> </span><span class="gd_word" id="S3.p1.1.1.w19">of</span><span> </span><span class="gd_word" id="S3.p1.1.1.w20">Evoformer.</span><span> </span><span class="gd_word" id="S3.p1.1.1.w21">These</span><span> </span><span class="gd_word" id="S3.p1.1.1.w22">Evoformer</span><span> </span><span class="gd_word" id="S3.p1.1.1.w23">performance</span><span> </span><span class="gd_word" id="S3.p1.1.1.w24">characteristics</span><span> </span><span class="gd_word" id="S3.p1.1.1.w25">inform</span><span> </span><span class="gd_word" id="S3.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="S3.p1.1.1.w27">subsequent</span><span> </span><span class="gd_word" id="S3.p1.1.1.w28">computation</span><span> </span><span class="gd_word" id="S3.p1.1.1.w29">and</span><span> </span><span class="gd_word" id="S3.p1.1.1.w30">parallel</span><span> </span><span class="gd_word" id="S3.p1.1.1.w31">optimization.</span></p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.6" class="ltx_p"><span class="gd_word" id="S3.p2.6.1.w1">For</span><span> </span><span class="gd_word" id="S3.p2.6.1.w2">the</span><span> </span><span class="gd_word" id="S3.p2.6.1.w3">convenience</span><span> </span><span class="gd_word" id="S3.p2.6.1.w4">of</span><span> </span><span class="gd_word" id="S3.p2.6.1.w5">later</span><span> </span><span class="gd_word" id="S3.p2.6.1.w6">expressions,</span><span> </span><span class="gd_word" id="S3.p2.6.1.w7">we</span><span> </span><span class="gd_word" id="S3.p2.6.1.w8">denote</span><span> </span><span class="gd_word" id="S3.p2.6.1.w9">the</span><span> </span><span class="gd_word" id="S3.p2.6.1.w10">number</span><span> </span><span class="gd_word" id="S3.p2.6.1.w11">of</span><span> </span><span class="gd_word" id="S3.p2.6.1.w12">residues</span><span> </span><span class="gd_word" id="S3.p2.6.1.w13">in</span><span> </span><span class="gd_word" id="S3.p2.6.1.w14">the</span><span> </span><span class="gd_word" id="S3.p2.6.1.w15">input</span><span> </span><span class="gd_word" id="S3.p2.6.1.w16">by</span><span> </span><math id="S3.p2.1.m1.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S3.p2.1.m1.1a"><msub id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mi id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">N</mi><mi id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml">r</mi></msub></semantics></math><span class="gd_word" id="S3.p2.6.2.w1">,</span><span> </span><span class="gd_word" id="S3.p2.6.2.w2">the</span><span> </span><span class="gd_word" id="S3.p2.6.2.w3">number</span><span> </span><span class="gd_word" id="S3.p2.6.2.w4">of</span><span> </span><span class="gd_word" id="S3.p2.6.2.w5">sequences</span><span> </span><span class="gd_word" id="S3.p2.6.2.w6">processed</span><span> </span><span class="gd_word" id="S3.p2.6.2.w7">in</span><span> </span><span class="gd_word" id="S3.p2.6.2.w8">the</span><span> </span><span class="gd_word" id="S3.p2.6.2.w9">MSA</span><span> </span><span class="gd_word" id="S3.p2.6.2.w10">stack</span><span> </span><span class="gd_word" id="S3.p2.6.2.w11">by</span><span> </span><math id="S3.p2.2.m2.1" class="ltx_Math" alttext="N_{s}" display="inline"><semantics id="S3.p2.2.m2.1a"><msub id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">N</mi><mi id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">s</mi></msub></semantics></math><span class="gd_word" id="S3.p2.6.3.w1">,</span><span> </span><span class="gd_word" id="S3.p2.6.3.w2">the</span><span> </span><span class="gd_word" id="S3.p2.6.3.w3">hidden</span><span> </span><span class="gd_word" id="S3.p2.6.3.w4">dim</span><span> </span><span class="gd_word" id="S3.p2.6.3.w5">for</span><span> </span><span class="gd_word" id="S3.p2.6.3.w6">MSA</span><span> </span><span class="gd_word" id="S3.p2.6.3.w7">representation</span><span> </span><span class="gd_word" id="S3.p2.6.3.w8">by</span><span> </span><math id="S3.p2.3.m3.1" class="ltx_Math" alttext="H_{m}=256" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><msub id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml"><mi id="S3.p2.3.m3.1.1.2.2" xref="S3.p2.3.m3.1.1.2.2.cmml">H</mi><mi id="S3.p2.3.m3.1.1.2.3" xref="S3.p2.3.m3.1.1.2.3.cmml">m</mi></msub><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">256</mn></mrow></semantics></math><span class="gd_word" id="S3.p2.6.4.w1">,</span><span> </span><span class="gd_word" id="S3.p2.6.4.w2">the</span><span> </span><span class="gd_word" id="S3.p2.6.4.w3">hidden</span><span> </span><span class="gd_word" id="S3.p2.6.4.w4">dim</span><span> </span><span class="gd_word" id="S3.p2.6.4.w5">for</span><span> </span><span class="gd_word" id="S3.p2.6.4.w6">pair</span><span> </span><span class="gd_word" id="S3.p2.6.4.w7">representation</span><span> </span><span class="gd_word" id="S3.p2.6.4.w8">by</span><span> </span><math id="S3.p2.4.m4.1" class="ltx_Math" alttext="H_{z}=128" display="inline"><semantics id="S3.p2.4.m4.1a"><mrow id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml"><msub id="S3.p2.4.m4.1.1.2" xref="S3.p2.4.m4.1.1.2.cmml"><mi id="S3.p2.4.m4.1.1.2.2" xref="S3.p2.4.m4.1.1.2.2.cmml">H</mi><mi id="S3.p2.4.m4.1.1.2.3" xref="S3.p2.4.m4.1.1.2.3.cmml">z</mi></msub><mo id="S3.p2.4.m4.1.1.1" xref="S3.p2.4.m4.1.1.1.cmml">=</mo><mn id="S3.p2.4.m4.1.1.3" xref="S3.p2.4.m4.1.1.3.cmml">128</mn></mrow></semantics></math><span class="gd_word" id="S3.p2.6.5.w1">.</span><span> </span><span class="gd_word" id="S3.p2.6.5.w2">Specific</span><span> </span><span class="gd_word" id="S3.p2.6.5.w3">values</span><span> </span><span class="gd_word" id="S3.p2.6.5.w4">of</span><span> </span><math id="S3.p2.5.m5.1" class="ltx_Math" alttext="N_{r}" display="inline"><semantics id="S3.p2.5.m5.1a"><msub id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mi id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">N</mi><mi id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml">r</mi></msub></semantics></math><span class="gd_word" id="S3.p2.6.6.w1"/><span> </span><span class="gd_word" id="S3.p2.6.6.w2">and</span><span> </span><math id="S3.p2.6.m6.1" class="ltx_Math" alttext="N_{s}" display="inline"><semantics id="S3.p2.6.m6.1a"><msub id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><mi id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">N</mi><mi id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml">s</mi></msub></semantics></math><span class="gd_word" id="S3.p2.6.7.w1"/><span> </span><span class="gd_word" id="S3.p2.6.7.w2">can</span><span> </span><span class="gd_word" id="S3.p2.6.7.w3">be</span><span> </span><span class="gd_word" id="S3.p2.6.7.w4">found</span><span> </span><span class="gd_word" id="S3.p2.6.7.w5">in</span><span> </span><span class="gd_word" id="S3.p2.6.7.w6">the</span><span> </span><span class="gd_word" id="S3.p2.6.7.w7">Table</span><span> </span><a href="#S2.T1" title="TABLE I ‣ II-A Overview of AlphaFold ‣ II Background ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">I</a><span class="gd_word" id="S3.p2.6.8.w1">.</span></p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">III-A </span>Differences between Evoformer and Transformer
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p"><span class="gd_word" id="S3.SS1.p1.1.1.w1">There</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w2">are</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w3">several</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w4">key</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w5">differences</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w6">between</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w7">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w8">and</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w9">vanilla</span><span> </span><span class="gd_word" id="S3.SS1.p1.1.1.w10">Transformer:</span></p>
</div>
<figure id="S3.T2" class="ltx_table">
<img src="/static/img/2203.00854-gpt-3.5-turbo-16k/S3_T2.png" alt="/static/img/2203.00854-gpt-3.5-turbo-16k/S3_T2.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span><span class="gd_word" id="S3.T2.2.w1">Different</span><span> </span><span class="gd_word" id="S3.T2.2.w2">Setting</span><span> </span><span class="gd_word" id="S3.T2.2.w3">of</span><span> </span><span class="gd_word" id="S3.T2.2.w4">Evoformer</span><span> </span><span class="gd_word" id="S3.T2.2.w5">in</span><span> </span><span class="gd_word" id="S3.T2.2.w6">AlphaFold</span><span> </span><span class="gd_word" id="S3.T2.2.w7">and</span><span> </span><span class="gd_word" id="S3.T2.2.w8">Transformer</span><span> </span><span class="gd_word" id="S3.T2.2.w9">in</span><span> </span><span class="gd_word" id="S3.T2.2.w10">ViT</span><span> </span><span class="gd_word" id="S3.T2.2.w11">and</span><span> </span><span class="gd_word" id="S3.T2.2.w12">GPT.</span></figcaption>
</figure>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p"><span class="gd_word" id="S3.SS1.p2.1.1.w1">1)</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w2">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w3">accepts</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w4">two</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w5">inputs,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w6">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w7">representation</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w8">and</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w9">Pair</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w10">representation,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w11">while</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w12">Transformer</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w13">processes</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w14">only</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w15">one</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w16">input</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w17">representation.</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w18">So</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w19">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w20">has</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w21">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w22">Stack</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w23">and</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w24">Pair</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w25">Stack</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w26">to</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w27">process</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w28">two</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w29">inputs</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w30">separately</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w31">and</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w32">introduce</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w33">communication</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w34">mechanisms</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w35">for</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w36">information</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w37">exchange.</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w38">The</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w39">intermediate</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w40">representation</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w41">has</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w42">two</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w43">sequence</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w44">dimensions,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w45">so</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w46">attention</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w47">has</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w48">to</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w49">be</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w50">computed</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w51">row-wise</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w52">and</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w53">column-wise</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w54">separately.</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w55">As</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w56">a</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w57">result,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w58">basic</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w59">structure</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w60">in</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w61">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w62">has</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w63">three</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w64">parts:</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w65">Row</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w66">Attention,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w67">Column</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w68">Attention,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w69">and</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w70">Feed-Forward.</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w71">For</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w72">Pair</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w73">Stack,</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w74">the</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w75">Triangular</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w76">Updates</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w77">Module</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w78">is</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w79">introduced</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w80">to</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w81">enhance</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w82">the</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w83">modeling</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w84">of</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w85">the</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w86">triangle</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w87">relationship</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w88">of</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w89">residues</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w90">before</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w91">the</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w92">attention</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w93">module.</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w94">The</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w95">details</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w96">of</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w97">the</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w98">Triangular</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w99">Updates</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w100">Module</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w101">are</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w102">shown</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w103">in</span><span> </span><span class="gd_word" id="S3.SS1.p2.1.1.w104">Figure</span><span> </span><a href="#S3.F4" title="Fig. 4 ‣ III-A Differences between Evoformer and Transformer ‣ III In-depth Analysis of Evoformer ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">4</a><span class="gd_word" id="S3.SS1.p2.1.2.w1">.</span></p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S3.F3.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 3: </span><span class="gd_word" id="S3.F3.2.w1">Attention</span><span> </span><span class="gd_word" id="S3.F3.2.w2">of</span><span> </span><span class="gd_word" id="S3.F3.2.w3">Evoformer.</span><span> </span><span class="gd_word" id="S3.F3.2.w4">There</span><span> </span><span class="gd_word" id="S3.F3.2.w5">are</span><span> </span><span class="gd_word" id="S3.F3.2.w6">two</span><span> </span><span class="gd_word" id="S3.F3.2.w7">main</span><span> </span><span class="gd_word" id="S3.F3.2.w8">differences</span><span> </span><span class="gd_word" id="S3.F3.2.w9">with</span><span> </span><span class="gd_word" id="S3.F3.2.w10">vanilla</span><span> </span><span class="gd_word" id="S3.F3.2.w11">Attention:</span><span> </span><span class="gd_word" id="S3.F3.2.w12">1)</span><span> </span><span class="gd_word" id="S3.F3.2.w13">add</span><span> </span><span class="gd_word" id="S3.F3.2.w14">gating</span><span> </span><span class="gd_word" id="S3.F3.2.w15">mechanism</span><span> </span><span class="gd_word" id="S3.F3.2.w16">on</span><span> </span><span class="gd_word" id="S3.F3.2.w17">Attention</span><span> </span><span class="gd_word" id="S3.F3.2.w18">Context;</span><span> </span><span class="gd_word" id="S3.F3.2.w19">2)</span><span> </span><span class="gd_word" id="S3.F3.2.w20">optional</span><span> </span><span class="gd_word" id="S3.F3.2.w21">pair</span><span> </span><span class="gd_word" id="S3.F3.2.w22">bias</span><span> </span><span class="gd_word" id="S3.F3.2.w23">add</span><span> </span><span class="gd_word" id="S3.F3.2.w24">to</span><span> </span><span class="gd_word" id="S3.F3.2.w25">Attention</span><span> </span><span class="gd_word" id="S3.F3.2.w26">Score</span><span> </span><span class="gd_word" id="S3.F3.2.w27">before</span><span> </span><span class="gd_word" id="S3.F3.2.w28">Softmax</span></figcaption>
</figure>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span class="gd_word" id="S3.SS1.p3.1.1.w1">2)</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w2">There</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w3">are</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w4">two</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w5">differences</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w6">between</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w7">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w8">in</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w9">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w10">and</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w11">vanilla</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w12">Transformer</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w13">which</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w14">are</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w15">shown</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w16">in</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.1.w17">Figure</span><span> </span><a href="#S3.F3" title="Fig. 3 ‣ III-A Differences between Evoformer and Transformer ‣ III In-depth Analysis of Evoformer ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">3</a><span class="gd_word" id="S3.SS1.p3.1.2.w1">.</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w2">Evoformer</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w3">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w4">introduces</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w5">a</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w6">gating</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w7">mechanism,</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w8">which</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w9">uses</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w10">the</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w11">Linear</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w12">layer</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w13">to</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w14">project</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w15">the</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w16">normalized</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w17">input</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w18">and</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w19">do</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w20">an</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w21">element-wise</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w22">product</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w23">with</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w24">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w25">Context,</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w26">thus</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w27">controlling</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w28">the</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w29">output</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w30">of</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w31">the</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w32">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w33">module.</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w34">Another</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w35">difference</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w36">is</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w37">pair</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w38">bias,</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w39">which</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w40">adds</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w41">linearly</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w42">projected</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w43">pair</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w44">representation</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w45">into</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w46">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w47">Score.</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w48">Pair</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w49">bias</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w50">is</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w51">enabled</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w52">in</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w53">all</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w54">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w55">except</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w56">Column</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w57">Attention</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w58">in</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w59">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p3.1.2.w60">Stack.</span></p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.1" class="ltx_p"><span class="gd_word" id="S3.SS1.p4.1.1.w1">3)</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w2">Pair</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w3">bias</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w4">allows</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w5">pair</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w6">representation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w7">to</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w8">participate</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w9">in</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w10">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w11">update</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w12">of</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w13">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w14">representation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w15">and</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w16">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w17">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w18">representation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w19">is</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w20">transformed</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w21">into</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w22">an</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w23">update</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w24">for</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w25">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w26">pair</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w27">representation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w28">with</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w29">Outer</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w30">Product</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w31">Mean.</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w32">All</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w33">MSA</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w34">entries</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w35">are</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w36">linearly</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w37">projected</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w38">with</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w39">two</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w40">different</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w41">Linear</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w42">layers.</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w43">To</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w44">compute</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w45">an</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w46">update</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w47">for</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w48">entry</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w49">ij</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w50">in</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w51">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w52">pair</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w53">representation,</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w54">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w55">outer</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w56">products</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w57">of</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w58">these</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w59">vectors</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w60">from</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w61">two</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w62">columns</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w63">i</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w64">and</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w65">j</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w66">are</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w67">averaged</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w68">over</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w69">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w70">sequences</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w71">and</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w72">projected</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w73">to</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.1.w74">dimension</span><span> </span><math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="H_{z}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">H</mi><mi id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml">z</mi></msub></semantics></math><span class="gd_word" id="S3.SS1.p4.1.2.w1">.</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w2">We</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w3">can</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w4">use</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w5">Einstein-notation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w6">sums</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w7">to</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w8">represent</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w9">the</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w10">core</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w11">computation</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w12">of</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w13">Outer</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w14">Product</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w15">Mean:</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w16">einsum(bsid,</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w17">bsje</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w18">-&gt;</span><span> </span><span class="gd_word" id="S3.SS1.p4.1.2.w19">bijde).</span></p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S3.F4.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 4: </span><span class="gd_word" id="S3.F4.2.w1">Triangular</span><span> </span><span class="gd_word" id="S3.F4.2.w2">Updates</span><span> </span><span class="gd_word" id="S3.F4.2.w3">Module</span><span> </span><span class="gd_word" id="S3.F4.2.w4">in</span><span> </span><span class="gd_word" id="S3.F4.2.w5">Evoformer.</span><span> </span><span class="gd_word" id="S3.F4.2.w6">Pair</span><span> </span><span class="gd_word" id="S3.F4.2.w7">Stack</span><span> </span><span class="gd_word" id="S3.F4.2.w8">has</span><span> </span><span class="gd_word" id="S3.F4.2.w9">two</span><span> </span><span class="gd_word" id="S3.F4.2.w10">consecutive</span><span> </span><span class="gd_word" id="S3.F4.2.w11">symmetric</span><span> </span><span class="gd_word" id="S3.F4.2.w12">Triangular</span><span> </span><span class="gd_word" id="S3.F4.2.w13">Updates</span><span> </span><span class="gd_word" id="S3.F4.2.w14">Module,</span><span> </span><span class="gd_word" id="S3.F4.2.w15">differing</span><span> </span><span class="gd_word" id="S3.F4.2.w16">only</span><span> </span><span class="gd_word" id="S3.F4.2.w17">in</span><span> </span><span class="gd_word" id="S3.F4.2.w18">the</span><span> </span><span class="gd_word" id="S3.F4.2.w19">order</span><span> </span><span class="gd_word" id="S3.F4.2.w20">of</span><span> </span><span class="gd_word" id="S3.F4.2.w21">the</span><span> </span><span class="gd_word" id="S3.F4.2.w22">axes</span><span> </span><span class="gd_word" id="S3.F4.2.w23">in</span><span> </span><span class="gd_word" id="S3.F4.2.w24">MatMul</span><span> </span><span class="gd_word" id="S3.F4.2.w25">part.</span></figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">III-B </span>Performance Analysis
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p"><span class="gd_word" id="S3.SS2.p1.1.1.w1">Further,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w2">we</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w3">can</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w4">analyze</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w5">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w6">performance</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w7">characteristic</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w8">at</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w9">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w10">operator</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w11">level</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w12">in</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w13">Evoformer.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w14">We</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w15">classify</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w16">Operators</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w17">into</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w18">three</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w19">main</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w20">categories</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w21">based</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w22">on</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w23">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w24">characteristics</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w25">of</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w27">computation</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w28">and</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w29">memory</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w30">access:</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w31">1)</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w32">GEMM.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w33">Operators</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w34">in</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w35">this</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w36">category</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w37">include</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w38">matrix</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w39">multiplication,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w40">batch</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w41">matrix-matrix</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w42">product,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w43">and</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w44">other</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w45">dense</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w46">matrix</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w47">calculations.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w48">Tensor</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w49">Core</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w50">from</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w51">NVIDIA</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w52">Tesla</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w53">GPU</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w54">can</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w55">dramatically</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w56">accelerate</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w57">GEMM</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w58">operators;</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w59">2)</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w60">Batch</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w61">Reduction.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w62">Operators</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w63">in</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w64">this</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w65">category</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w66">include</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w67">LayerNorm,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w68">Softmax,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w69">etc.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w70">These</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w71">operations</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w72">have</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w73">lower</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w74">computational</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w75">intensity</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w76">than</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w77">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w78">GEMM</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w79">operator</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w80">and</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w81">are</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w82">more</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w83">susceptible</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w84">to</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w85">access</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w86">bottlenecks;</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w87">3)</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w88">Element-wise</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w89">Operators.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w90">Operators</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w91">in</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w92">this</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w93">category</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w94">include</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w95">element-wise</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w96">addition</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w97">or</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w98">product,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w99">dropout,</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w100">and</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w101">activations.</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w102">This</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w103">is</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w104">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w105">category</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w106">with</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w107">the</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w108">lowest</span><span> </span><span class="gd_word" id="S3.SS2.p1.1.1.w109">compute-intensive.</span></p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p"><span class="gd_word" id="S3.SS2.p2.1.1.w1">GEMM</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w2">operators</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w3">are</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w4">generally</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w5">computed</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w6">by</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w7">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w8">highly</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w9">optimized</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w10">BLAS</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w11">library</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w12">provided</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w13">by</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w14">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w15">vendor,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w16">such</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w17">as</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w18">cuBLAS</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w19">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w20">GPU</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w21">platforms</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w22">and</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w23">MKL</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w24">(Math</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w25">Kernel</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w26">Library)</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w27">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w28">CPU</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w29">platforms.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w30">In</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w31">general,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w32">PyTorch</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w33">or</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w34">other</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w35">Deep</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w36">Learning</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w37">Frameworks</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w38">cannot</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w39">achieve</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w40">high</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w41">efficiency</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w42">for</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w43">many</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w44">non-GEMM</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w45">operators.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w46">For</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w47">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w48">model</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w49">training</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w50">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w51">NVIDIA</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w52">Tesla</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w53">A100,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w54">only</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w55">14.7%</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w56">of</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w57">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w58">time</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w59">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w60">spent</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w61">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w62">GEMM</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w63">operators,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w64">while</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w65">55.7%</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w66">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w67">Batch</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w68">Reduction,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w69">19.8%</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w70">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w71">Element-wise</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w72">and</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w73">9.8%</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w74">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w75">other</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w76">operators</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w77">like</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w78">data</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w79">movement.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w80">Batch</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w81">Reduce</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w82">takes</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w83">so</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w84">much</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w85">time</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w86">because</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w87">LayerNorm</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w88">and</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w89">Softmax</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w90">implementation</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w91">in</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w92">PyTorch</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w93">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w94">very</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w95">inefficient.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w96">This</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w97">performance</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w98">issue</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w99">also</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w100">occurs</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w101">on</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w102">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w103">NLP</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w104">Transformer</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w105">model</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w106">but</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w107">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w108">more</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w109">severe</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w110">in</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w111">AlphaFold.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w112">This</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w113">phenomenon</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w114">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w115">related</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w116">to</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w117">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w118">fact</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w119">that</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w120">the</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w121">hidden</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w122">dim</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w123">of</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w124">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w125">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w126">much</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w127">smaller</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w128">than</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w129">that</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w130">of</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w131">ViT</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w132">and</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w133">GPT,</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w134">which</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w135">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w136">shown</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w137">in</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.1.w138">Table</span><span> </span><a href="#S3.T2" title="TABLE II ‣ III-A Differences between Evoformer and Transformer ‣ III In-depth Analysis of Evoformer ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">II</a><span class="gd_word" id="S3.SS2.p2.1.2.w1">.</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w2">PyTorch’s</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w3">native</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w4">kernel</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w5">of</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w6">Batch</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w7">Reduction</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w8">is</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w9">less</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w10">performance</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w11">efficient</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w12">with</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w13">small</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w14">hidden</span><span> </span><span class="gd_word" id="S3.SS2.p2.1.2.w15">dim.</span></p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.1" class="ltx_p"><span class="gd_word" id="S3.SS2.p3.1.1.w1">From</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w2">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w3">memory</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w4">perspective,</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w5">we</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w6">can</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w7">observe</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w8">huge</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w9">memory</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w10">consumption</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w11">during</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w12">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w13">training.</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w14">However,</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w15">we</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w16">can</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w17">see</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w18">that</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w19">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w20">overall</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w21">model</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w22">parameter</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w23">count</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w24">of</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w25">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w26">is</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w27">only</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w28">93M</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w29">according</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w30">to</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.1.w31">Table</span><span> </span><a href="#S3.T2" title="TABLE II ‣ III-A Differences between Evoformer and Transformer ‣ III In-depth Analysis of Evoformer ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">II</a><span class="gd_word" id="S3.SS2.p3.1.2.w1">,</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w2">which</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w3">is</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w4">a</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w5">rather</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w6">small</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w7">Transformer</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w8">model.</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w9">The</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w10">memory</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w11">requirement</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w12">of</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w13">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w14">is</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w15">much</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w16">higher</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w17">than</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w18">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w19">general</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w20">Transformer</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w21">model,</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w22">largely</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w23">due</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w24">to</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w25">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w26">much</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w27">larger</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w28">intermediate</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w29">activation.</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w30">Taking</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w31">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w32">activation</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w33">in</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w34">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w35">Attention</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w36">module</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w37">as</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w38">an</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w39">example,</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w40">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w41">memory</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w42">required</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w43">to</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w44">store</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w45">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w46">activation</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w47">in</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w48">bytes</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w49">is</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w50">given</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w51">by</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w52">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w53">expression</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w54">below</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w55">because</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w56">of</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w57">the</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w58">cubic</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w59">scaling</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w60">in</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w61">attention</span><span> </span><span class="gd_word" id="S3.SS2.p3.1.2.w62">context.</span></p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.Ex1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.Ex1.m1.1" class="ltx_Math" alttext="N_{r}^{3}\times N_{head}\times sizeof(BFloat16)" display="block"><semantics id="S3.Ex1.m1.1a"><mrow id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml"><mrow id="S3.Ex1.m1.1.1.3" xref="S3.Ex1.m1.1.1.3.cmml"><msubsup id="S3.Ex1.m1.1.1.3.2" xref="S3.Ex1.m1.1.1.3.2.cmml"><mi id="S3.Ex1.m1.1.1.3.2.2.2" xref="S3.Ex1.m1.1.1.3.2.2.2.cmml">N</mi><mi id="S3.Ex1.m1.1.1.3.2.2.3" xref="S3.Ex1.m1.1.1.3.2.2.3.cmml">r</mi><mn id="S3.Ex1.m1.1.1.3.2.3" xref="S3.Ex1.m1.1.1.3.2.3.cmml">3</mn></msubsup><mo id="S3.Ex1.m1.1.1.3.1" xref="S3.Ex1.m1.1.1.3.1.cmml">×</mo><msub id="S3.Ex1.m1.1.1.3.3" xref="S3.Ex1.m1.1.1.3.3.cmml"><mi id="S3.Ex1.m1.1.1.3.3.2" xref="S3.Ex1.m1.1.1.3.3.2.cmml">N</mi><mrow id="S3.Ex1.m1.1.1.3.3.3" xref="S3.Ex1.m1.1.1.3.3.3.cmml"><mi id="S3.Ex1.m1.1.1.3.3.3.5" xref="S3.Ex1.m1.1.1.3.3.3.5.cmml">head</mi></mrow></msub><mo id="S3.Ex1.m1.1.1.3.1a" xref="S3.Ex1.m1.1.1.3.1.cmml">×</mo><mi id="S3.Ex1.m1.1.1.3.4" xref="S3.Ex1.m1.1.1.3.4.cmml">sizeof</mi></mrow><mo id="S3.Ex1.m1.1.1.2e" xref="S3.Ex1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex1.m1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.1.1.1.1.1.7" xref="S3.Ex1.m1.1.1.1.1.1.7.cmml">BFloat16</mi></mrow><mo stretchy="false" id="S3.Ex1.m1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr>
</table>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.2" class="ltx_p"><span class="gd_word" id="S3.SS2.p5.2.1.w1">It</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w2">exceeds</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w3">20</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w4">GB</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w5">for</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w6">48</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w7">layers</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.1.w8">when</span><span> </span><math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="N_{r}=384" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mrow id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><msub id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2.2" xref="S3.SS2.p5.1.m1.1.1.2.2.cmml">N</mi><mi id="S3.SS2.p5.1.m1.1.1.2.3" xref="S3.SS2.p5.1.m1.1.1.2.3.cmml">r</mi></msub><mo id="S3.SS2.p5.1.m1.1.1.1" xref="S3.SS2.p5.1.m1.1.1.1.cmml">=</mo><mn id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">384</mn></mrow></semantics></math><span class="gd_word" id="S3.SS2.p5.2.2.w1"/><span> </span><span class="gd_word" id="S3.SS2.p5.2.2.w2">and</span><span> </span><math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="N_{head}=4" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mrow id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml"><msub id="S3.SS2.p5.2.m2.1.1.2" xref="S3.SS2.p5.2.m2.1.1.2.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2.2" xref="S3.SS2.p5.2.m2.1.1.2.2.cmml">N</mi><mrow id="S3.SS2.p5.2.m2.1.1.2.3" xref="S3.SS2.p5.2.m2.1.1.2.3.cmml"><mi id="S3.SS2.p5.2.m2.1.1.2.3.5" xref="S3.SS2.p5.2.m2.1.1.2.3.5.cmml">head</mi></mrow></msub><mo id="S3.SS2.p5.2.m2.1.1.1" xref="S3.SS2.p5.2.m2.1.1.1.cmml">=</mo><mn id="S3.SS2.p5.2.m2.1.1.3" xref="S3.SS2.p5.2.m2.1.1.3.cmml">4</mn></mrow></semantics></math><span class="gd_word" id="S3.SS2.p5.2.3.w1">.</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w2">Such</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w3">a</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w4">huge</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w5">memory</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w6">consumption</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w7">makes</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w8">it</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w9">impractical</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w10">to</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w11">store</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w12">all</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w13">the</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w14">activation</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w15">for</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w16">backpropagation.</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w17">So</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w18">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w19">leverages</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w20">gradient</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w21">checkpointing</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.3.w22">technique</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite><span class="gd_word" id="S3.SS2.p5.2.4.w1"/><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w2">to</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w3">reduce</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w4">the</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w5">memory</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w6">consumption.</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w7">However,</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w8">AlphaFold</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w9">is</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w10">still</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w11">a</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w12">memory-heavy</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w13">model,</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w14">and</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w15">each</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w16">device</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w17">can</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w18">still</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w19">only</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w20">process</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w21">one</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w22">data</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w23">sample</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w24">at</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w25">the</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w26">time</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w27">of</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w28">training</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w29">with</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w30">limited</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w31">memory</span><span> </span><span class="gd_word" id="S3.SS2.p5.2.4.w32">capacity.</span></p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span>Implementation and Optimization
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span class="gd_word" id="S4.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S4.p1.1.1.w2">this</span><span> </span><span class="gd_word" id="S4.p1.1.1.w3">section</span><span> </span><span class="gd_word" id="S4.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="S4.p1.1.1.w5">will</span><span> </span><span class="gd_word" id="S4.p1.1.1.w6">introduce</span><span> </span><span class="gd_word" id="S4.p1.1.1.w7">FastFold</span><span> </span><span class="gd_word" id="S4.p1.1.1.w8">implementation</span><span> </span><span class="gd_word" id="S4.p1.1.1.w9">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w10">optimization,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w11">including:</span><span> </span><span class="gd_word" id="S4.p1.1.1.w12">1)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w13">Design</span><span> </span><span class="gd_word" id="S4.p1.1.1.w14">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w15">implementation</span><span> </span><span class="gd_word" id="S4.p1.1.1.w16">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w17">high</span><span> </span><span class="gd_word" id="S4.p1.1.1.w18">performance</span><span> </span><span class="gd_word" id="S4.p1.1.1.w19">GPU</span><span> </span><span class="gd_word" id="S4.p1.1.1.w20">kernel;</span><span> </span><span class="gd_word" id="S4.p1.1.1.w21">2)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w22">Design</span><span> </span><span class="gd_word" id="S4.p1.1.1.w23">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w24">implementation</span><span> </span><span class="gd_word" id="S4.p1.1.1.w25">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w26">Dynamic</span><span> </span><span class="gd_word" id="S4.p1.1.1.w27">Axial</span><span> </span><span class="gd_word" id="S4.p1.1.1.w28">Parallelism;</span><span> </span><span class="gd_word" id="S4.p1.1.1.w29">3)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w30">Communication</span><span> </span><span class="gd_word" id="S4.p1.1.1.w31">optimization</span><span> </span><span class="gd_word" id="S4.p1.1.1.w32">through</span><span> </span><span class="gd_word" id="S4.p1.1.1.w33">Duality</span><span> </span><span class="gd_word" id="S4.p1.1.1.w34">Async</span><span> </span><span class="gd_word" id="S4.p1.1.1.w35">Operation.</span></p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">IV-A </span>Computational Optimizations
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS1.p1.1.1.w1">According</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w2">to</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w3">its</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w4">performance</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w5">characteristics</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w6">mentioned</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w7">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w9">previous</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w10">section,</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w11">GEMM</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w12">operators</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w13">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w14">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w15">only</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w16">accounts</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w17">for</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w18">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w19">small</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w20">portion</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w21">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w22">total</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w23">runtime,</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w24">and</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w25">there</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w26">is</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w27">a</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w28">lot</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w29">of</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w30">potential</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w31">for</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w32">performance</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w33">improvement</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w34">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w35">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w36">non-GEMM</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w37">part.</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w38">To</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w39">achieve</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w40">high</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w41">performance,</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w42">we</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w43">implemented</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w44">several</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w45">model-specific</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w46">optimizations,</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w47">including</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w48">kernel</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w49">fusion</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w50">and</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w51">highly</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w52">optimized</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w53">kernels</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w54">for</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w55">Batch</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w56">Reduction</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w57">operators(Softmax</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w58">and</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w59">LayerNorm).</span></p>
</div>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">IV-A1 </span>Kernel Fusion</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w1">Kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w2">fusion</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w4">a</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w5">common</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w6">performance</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w7">optimization</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w8">technique</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w9">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w10">deep</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w11">learning,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w12">which</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w13">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w14">reduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w15">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w16">overhead</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w17">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w18">memory</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w19">accesses,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w20">improve</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w22">overall</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w23">efficiency</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w24">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w25">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w26">memory</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w27">system,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w28">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w29">reduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w30">kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w31">launch</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w32">overhead.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w33">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w34">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w35">model,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w36">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w37">apply</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w38">kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w39">fusion</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w40">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w41">two</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p1.1.1.w42">approaches:</span></p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w1">Merge</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w2">GEMM.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w3">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w5">computation</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w6">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w7">Query,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w8">Key</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w9">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w10">Value</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w11">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w12">Attention,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w13">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w14">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w15">merge</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w16">three</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w17">different</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w18">Linear</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w19">Layers</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w20">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w21">QKV</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w22">into</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w23">one,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w24">thus</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w25">improving</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w26">computational</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w27">efficiency</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w28">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w29">reducing</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w30">kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w31">launch</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w32">overhead.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w33">This</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w34">optimization</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w35">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w36">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w37">also</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w38">used</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w39">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w40">other</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w41">Transformer</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w42">optimization</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w43">implementations,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w44">such</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w45">as</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.1.w46">TurboTransformer</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w2">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w4">alphafold-specific</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w5">Triangular</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w6">Updates</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w7">Module</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.2.w8">(Figure</span><span> </span><a href="#S3.F4" title="Fig. 4 ‣ III-A Differences between Evoformer and Transformer ‣ III In-depth Analysis of Evoformer ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">4</a><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w1">),</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w2">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w3">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w4">also</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w5">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w6">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w7">merge</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w8">GEMM</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w9">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w10">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w11">merge</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w12">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w13">left</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w14">project</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w15">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w16">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w17">right</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w18">project</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w19">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w20">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w21">left</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w22">gating</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w23">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w24">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w25">right</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p2.1.3.w26">gating.</span></p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS1.p3.1.1.w1">JIT</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.1.w2">Fusion.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.1.w3">PyTorch</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.1.w4">JIT</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w2">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w3">generate</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w4">optimized</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w5">TorchScript</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w6">”Just-In-Time”.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w7">Thus,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w8">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w9">combine</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w10">several</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w11">element-wise</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w12">operators</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w13">into</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w14">ones</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w15">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w16">PyTorch</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w17">JIT.</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w18">(bias</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w19">+</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w20">sigmod</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w21">+</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w22">element-wise</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w23">product,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w24">bias</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w25">+</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w26">dropout</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w27">+</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w28">add,</span><span> </span><span class="gd_word" id="S4.SS1.SSS1.p3.1.2.w29">etc.)</span></p>
</div>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">IV-A2 </span>Fused Softmax</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w2">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w3">function</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w5">a</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w6">kind</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w7">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w8">normalized</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w9">exponential</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w10">function,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w11">which</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w12">converts</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w13">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w14">elements</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w15">into</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w16">between</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w17">0</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w18">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w19">1,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w20">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w21">then</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w22">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w23">sum</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w24">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w25">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w26">elements</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w27">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w28">1.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w29">For</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w30">numerical</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w31">stability,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w32">it</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w33">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w34">generally</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w35">necessary</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w36">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w37">implement</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w38">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w39">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w40">calculation</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w41">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w42">subtracting</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w43">all</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w44">elements</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w45">from</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w46">their</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w47">maximum</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w48">values</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w49">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w50">narrow</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w51">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w52">range</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w53">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w54">values</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w55">after</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w56">calculating</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w57">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w58">exponent.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w59">Therefore,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w60">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w61">formula</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w62">for</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w63">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w64">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w65">as</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p1.1.1.w66">follows:</span></p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<table id="S4.Ex2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex2.m1.3" class="ltx_Math" alttext="softmax(X)_{i}=e^{x_{i}-max(X)}/\sum_{x_{j}inX}e^{x_{j}-max(X)}" display="block"><semantics id="S4.Ex2.m1.3a"><mrow id="S4.Ex2.m1.3.4" xref="S4.Ex2.m1.3.4.cmml"><mrow id="S4.Ex2.m1.3.4.2" xref="S4.Ex2.m1.3.4.2.cmml"><mi id="S4.Ex2.m1.3.4.2.8" xref="S4.Ex2.m1.3.4.2.8.cmml">softmax</mi><mo id="S4.Ex2.m1.3.4.2.1f" xref="S4.Ex2.m1.3.4.2.1.cmml">⁢</mo><msub id="S4.Ex2.m1.3.4.2.9" xref="S4.Ex2.m1.3.4.2.9.cmml"><mrow id="S4.Ex2.m1.3.4.2.9.2.2" xref="S4.Ex2.m1.3.4.2.9.cmml"><mo stretchy="false" id="S4.Ex2.m1.3.4.2.9.2.2.1" xref="S4.Ex2.m1.3.4.2.9.cmml">(</mo><mi id="S4.Ex2.m1.3.3" xref="S4.Ex2.m1.3.3.cmml">X</mi><mo stretchy="false" id="S4.Ex2.m1.3.4.2.9.2.2.2" xref="S4.Ex2.m1.3.4.2.9.cmml">)</mo></mrow><mi id="S4.Ex2.m1.3.4.2.9.3" xref="S4.Ex2.m1.3.4.2.9.3.cmml">i</mi></msub></mrow><mo id="S4.Ex2.m1.3.4.1" xref="S4.Ex2.m1.3.4.1.cmml">=</mo><mrow id="S4.Ex2.m1.3.4.3" xref="S4.Ex2.m1.3.4.3.cmml"><msup id="S4.Ex2.m1.3.4.3.2" xref="S4.Ex2.m1.3.4.3.2.cmml"><mi id="S4.Ex2.m1.3.4.3.2.2" xref="S4.Ex2.m1.3.4.3.2.2.cmml">e</mi><mrow id="S4.Ex2.m1.1.1.1" xref="S4.Ex2.m1.1.1.1.cmml"><msub id="S4.Ex2.m1.1.1.1.3" xref="S4.Ex2.m1.1.1.1.3.cmml"><mi id="S4.Ex2.m1.1.1.1.3.2" xref="S4.Ex2.m1.1.1.1.3.2.cmml">x</mi><mi id="S4.Ex2.m1.1.1.1.3.3" xref="S4.Ex2.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S4.Ex2.m1.1.1.1.2" xref="S4.Ex2.m1.1.1.1.2.cmml">-</mo><mrow id="S4.Ex2.m1.1.1.1.4" xref="S4.Ex2.m1.1.1.1.4.cmml"><mi id="S4.Ex2.m1.1.1.1.4.4" xref="S4.Ex2.m1.1.1.1.4.4.cmml">max</mi><mo id="S4.Ex2.m1.1.1.1.4.1b" xref="S4.Ex2.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.1.1.1.4.5.2" xref="S4.Ex2.m1.1.1.1.4.cmml"><mo stretchy="false" id="S4.Ex2.m1.1.1.1.4.5.2.1" xref="S4.Ex2.m1.1.1.1.4.cmml">(</mo><mi id="S4.Ex2.m1.1.1.1.1" xref="S4.Ex2.m1.1.1.1.1.cmml">X</mi><mo stretchy="false" id="S4.Ex2.m1.1.1.1.4.5.2.2" xref="S4.Ex2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></msup><mo id="S4.Ex2.m1.3.4.3.1" xref="S4.Ex2.m1.3.4.3.1.cmml">/</mo><mrow id="S4.Ex2.m1.3.4.3.3" xref="S4.Ex2.m1.3.4.3.3.cmml"><munder id="S4.Ex2.m1.3.4.3.3.1" xref="S4.Ex2.m1.3.4.3.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S4.Ex2.m1.3.4.3.3.1.2" xref="S4.Ex2.m1.3.4.3.3.1.2.cmml">∑</mo><mrow id="S4.Ex2.m1.3.4.3.3.1.3" xref="S4.Ex2.m1.3.4.3.3.1.3.cmml"><msub id="S4.Ex2.m1.3.4.3.3.1.3.2" xref="S4.Ex2.m1.3.4.3.3.1.3.2.cmml"><mi id="S4.Ex2.m1.3.4.3.3.1.3.2.2" xref="S4.Ex2.m1.3.4.3.3.1.3.2.2.cmml">x</mi><mi id="S4.Ex2.m1.3.4.3.3.1.3.2.3" xref="S4.Ex2.m1.3.4.3.3.1.3.2.3.cmml">j</mi></msub><mo id="S4.Ex2.m1.3.4.3.3.1.3.1" xref="S4.Ex2.m1.3.4.3.3.1.3.1.cmml">⁢</mo><mo id="S4.Ex2.m1.3.4.3.3.1.3.4" xref="S4.Ex2.m1.3.4.3.3.1.3.4.cmml">in</mo><mo id="S4.Ex2.m1.3.4.3.3.1.3.1b" xref="S4.Ex2.m1.3.4.3.3.1.3.1.cmml">⁢</mo><mi id="S4.Ex2.m1.3.4.3.3.1.3.5" xref="S4.Ex2.m1.3.4.3.3.1.3.5.cmml">X</mi></mrow></munder><msup id="S4.Ex2.m1.3.4.3.3.2" xref="S4.Ex2.m1.3.4.3.3.2.cmml"><mi id="S4.Ex2.m1.3.4.3.3.2.2" xref="S4.Ex2.m1.3.4.3.3.2.2.cmml">e</mi><mrow id="S4.Ex2.m1.2.2.1" xref="S4.Ex2.m1.2.2.1.cmml"><msub id="S4.Ex2.m1.2.2.1.3" xref="S4.Ex2.m1.2.2.1.3.cmml"><mi id="S4.Ex2.m1.2.2.1.3.2" xref="S4.Ex2.m1.2.2.1.3.2.cmml">x</mi><mi id="S4.Ex2.m1.2.2.1.3.3" xref="S4.Ex2.m1.2.2.1.3.3.cmml">j</mi></msub><mo id="S4.Ex2.m1.2.2.1.2" xref="S4.Ex2.m1.2.2.1.2.cmml">-</mo><mrow id="S4.Ex2.m1.2.2.1.4" xref="S4.Ex2.m1.2.2.1.4.cmml"><mi id="S4.Ex2.m1.2.2.1.4.4" xref="S4.Ex2.m1.2.2.1.4.4.cmml">max</mi><mo id="S4.Ex2.m1.2.2.1.4.1b" xref="S4.Ex2.m1.2.2.1.4.1.cmml">⁢</mo><mrow id="S4.Ex2.m1.2.2.1.4.5.2" xref="S4.Ex2.m1.2.2.1.4.cmml"><mo stretchy="false" id="S4.Ex2.m1.2.2.1.4.5.2.1" xref="S4.Ex2.m1.2.2.1.4.cmml">(</mo><mi id="S4.Ex2.m1.2.2.1.1" xref="S4.Ex2.m1.2.2.1.1.cmml">X</mi><mo stretchy="false" id="S4.Ex2.m1.2.2.1.4.5.2.2" xref="S4.Ex2.m1.2.2.1.4.cmml">)</mo></mrow></mrow></mrow></msup></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr>
</table>
</div>
<div id="S4.SS1.SSS2.p3" class="ltx_para">
<p id="S4.SS1.SSS2.p3.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w1">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w2">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w3">function</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w5">used</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w6">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w7">attention,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w8">where</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w9">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w10">attention</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w11">score</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w12">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w13">normalized</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w14">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w15">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w16">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w17">function</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w18">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w19">subsequently</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w20">calculated</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w21">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w22">Value.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w23">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w24">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w25">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w26">model,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w27">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w28">input</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w29">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w30">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w31">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w32">function</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w33">has</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w34">many</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w35">rows,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w36">but</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w37">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w38">number</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w39">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w40">elements</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w41">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w42">each</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w43">row</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w44">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w45">relatively</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w46">small.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w47">For</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w48">this</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w49">situation,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w50">if</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w51">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w52">native</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w53">kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w54">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w55">not</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w56">properly</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w57">implemented</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w58">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w59">parallelized,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w60">it</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w61">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w62">easily</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w63">deliver</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w64">very</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w65">low</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p3.1.1.w66">performance.</span></p>
</div>
<div id="S4.SS1.SSS2.p4" class="ltx_para">
<p id="S4.SS1.SSS2.p4.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w1">For</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w2">small</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w3">column</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w4">size,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w5">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w6">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w7">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w8">warp</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w9">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w10">calculate</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w11">one-row</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w12">data,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w13">which</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w14">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w15">be</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w16">achieved</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w17">very</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w18">efficiently</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w19">using</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w21">communication</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w22">primitives</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w23">between</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w24">registers</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w25">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w26">warps.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w27">Referring</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w28">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.1.w29">Figure</span><span> </span><a href="#S4.F5" title="Fig. 5 ‣ IV-A2 Fused Softmax ‣ IV-A Computational Optimizations ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">5</a><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w1">,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w2">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w3">get</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w5">Global</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w6">Max</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w7">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w8">a</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w9">row,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w10">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w11">need</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w12">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w13">get</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w14">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w15">local</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w16">max</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w17">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w18">threads,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w19">then</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w20">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w21">WarpAllReduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w22">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w23">get</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w24">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w25">global</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w26">max</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w27">between</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w28">threads.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w29">We</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w30">then</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w31">perform</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w32">subtraction</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w33">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w34">exponential</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w35">operations,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w36">then</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w37">get</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w38">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w39">local</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w40">sum</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w41">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w42">threads</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w43">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w44">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w45">WarpAllReduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w46">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w47">get</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w48">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w49">global</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w50">sum</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w51">followed</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w52">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w53">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w54">final</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p4.1.2.w55">division.</span></p>
</div>
<div id="S4.SS1.SSS2.p5" class="ltx_para">
<p id="S4.SS1.SSS2.p5.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w1">We</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w2">implement</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w3">WarpAllReduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w4">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w5">perform</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w6">Global</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w7">Max</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w8">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w9">Global</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w10">Sum</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w11">operations</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w12">between</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w13">threads</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w14">within</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w15">Warp,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w16">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w17">WarpAllReduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w18">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w19">implemented</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w20">using</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w22">warp-level</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w23">primitive</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w24">__shfl_xor_sync.</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w25">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w26">addition,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w27">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w28">fused</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w29">scaling</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w30">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w31">add</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w32">bias</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w33">into</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w34">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w35">softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w36">kernel,</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w37">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w38">merge</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w39">accesses</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w40">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w41">improve</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w42">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w43">overall</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w44">performance</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w45">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w46">this</span><span> </span><span class="gd_word" id="S4.SS1.SSS2.p5.1.1.w47">part.</span></p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S4.F5.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 5: </span><span class="gd_word" id="S4.F5.2.w1">Implementation</span><span> </span><span class="gd_word" id="S4.F5.2.w2">of</span><span> </span><span class="gd_word" id="S4.F5.2.w3">Softmax</span><span> </span><span class="gd_word" id="S4.F5.2.w4">Kernel</span><span> </span><span class="gd_word" id="S4.F5.2.w5">in</span><span> </span><span class="gd_word" id="S4.F5.2.w6">FastFold.</span><span> </span><span class="gd_word" id="S4.F5.2.w7">FastFold</span><span> </span><span class="gd_word" id="S4.F5.2.w8">uses</span><span> </span><span class="gd_word" id="S4.F5.2.w9">a</span><span> </span><span class="gd_word" id="S4.F5.2.w10">warp</span><span> </span><span class="gd_word" id="S4.F5.2.w11">to</span><span> </span><span class="gd_word" id="S4.F5.2.w12">compute</span><span> </span><span class="gd_word" id="S4.F5.2.w13">a</span><span> </span><span class="gd_word" id="S4.F5.2.w14">row</span><span> </span><span class="gd_word" id="S4.F5.2.w15">of</span><span> </span><span class="gd_word" id="S4.F5.2.w16">data,</span><span> </span><span class="gd_word" id="S4.F5.2.w17">and</span><span> </span><span class="gd_word" id="S4.F5.2.w18">uses</span><span> </span><span class="gd_word" id="S4.F5.2.w19">warp-level</span><span> </span><span class="gd_word" id="S4.F5.2.w20">primitive</span><span> </span><span class="gd_word" id="S4.F5.2.w21">to</span><span> </span><span class="gd_word" id="S4.F5.2.w22">implement</span><span> </span><span class="gd_word" id="S4.F5.2.w23">WarpAllReduce</span></figcaption>
</figure>
</section>
<section id="S4.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">IV-A3 </span>LayerNorm</h4>

<div id="S4.SS1.SSS3.p1" class="ltx_para">
<p id="S4.SS1.SSS3.p1.2" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w1">Layer</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w2">Normalization</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w4">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w5">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w6">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w7">most</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w8">common</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w9">operations</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w10">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w11">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w12">Transformer</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w13">model.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w14">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w15">input</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w16">data</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w17">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w18">normalized</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w19">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w21">mean</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w22">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w23">standard</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w24">deviation</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w25">calculated</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w26">over</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w27">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w28">last</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w29">dimensions</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w30">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w31">LayerNorm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w32">Layer.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w33">Layer</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w34">Normalization</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w35">applies</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w36">element-wise</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.1.w37">scale</span><span> </span><math id="S4.SS1.SSS3.p1.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.SSS3.p1.1.m1.1a"><mi id="S4.SS1.SSS3.p1.1.m1.1.1" xref="S4.SS1.SSS3.p1.1.m1.1.1.cmml">γ</mi></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p1.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.2.w2">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.2.w3">bias</span><span> </span><math id="S4.SS1.SSS3.p1.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.SSS3.p1.2.m2.1a"><mi id="S4.SS1.SSS3.p1.2.m2.1.1" xref="S4.SS1.SSS3.p1.2.m2.1.1.cmml">β</mi></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w2">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w3">which</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w4">are</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w5">learnable</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p1.2.3.w6">parameters.</span></p>
</div>
<div id="S4.SS1.SSS3.p2" class="ltx_para">
<p id="S4.SS1.SSS3.p2.2" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w1">There</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w2">are</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w3">12</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w4">LayerNorm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w5">layers</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w6">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w7">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w8">block</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w9">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w10">Evoformer:</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w11">4</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w12">for</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w13">MSA</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w14">Stack,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w15">7</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w16">for</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w17">Pair</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w18">Stack,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w19">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w20">1</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w21">for</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w22">Outer</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w23">Product</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w24">Mean.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w25">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w26">LayerNorm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w27">Layer,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w28">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w29">input</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w30">data</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w31">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w32">normalized</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w33">using</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w34">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w35">mean</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w36">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w37">variance</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w38">determined</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w39">across</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w40">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w41">last</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w42">dimensions.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w43">Layer</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w44">Normalization</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w45">applies</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w46">element-wise</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w47">scale</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w48">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w49">bias</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.1.w50">with</span><span> </span><math id="S4.SS1.SSS3.p2.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS1.SSS3.p2.1.m1.1a"><mi id="S4.SS1.SSS3.p2.1.m1.1.1" xref="S4.SS1.SSS3.p2.1.m1.1.1.cmml">γ</mi></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p2.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.2.w2">and</span><span> </span><math id="S4.SS1.SSS3.p2.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.SS1.SSS3.p2.2.m2.1a"><mi id="S4.SS1.SSS3.p2.2.m2.1.1" xref="S4.SS1.SSS3.p2.2.m2.1.1.cmml">β</mi></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w2">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w3">calculation</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w5">as</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p2.2.3.w6">follows:</span></p>
</div>
<div id="S4.SS1.SSS3.p3" class="ltx_para">
<table id="S4.Ex3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex3.m1.2" class="ltx_Math" alttext="y=\frac{x-E[x]}{\sqrt{Var[X]+\epsilon}}*\gamma+\beta" display="block"><semantics id="S4.Ex3.m1.2a"><mrow id="S4.Ex3.m1.2.3" xref="S4.Ex3.m1.2.3.cmml"><mi id="S4.Ex3.m1.2.3.2" xref="S4.Ex3.m1.2.3.2.cmml">y</mi><mo id="S4.Ex3.m1.2.3.1" xref="S4.Ex3.m1.2.3.1.cmml">=</mo><mrow id="S4.Ex3.m1.2.3.3" xref="S4.Ex3.m1.2.3.3.cmml"><mrow id="S4.Ex3.m1.2.3.3.2" xref="S4.Ex3.m1.2.3.3.2.cmml"><mfrac id="S4.Ex3.m1.2.2" xref="S4.Ex3.m1.2.2.cmml"><mrow id="S4.Ex3.m1.1.1.1" xref="S4.Ex3.m1.1.1.1.cmml"><mi id="S4.Ex3.m1.1.1.1.3" xref="S4.Ex3.m1.1.1.1.3.cmml">x</mi><mo id="S4.Ex3.m1.1.1.1.2" xref="S4.Ex3.m1.1.1.1.2.cmml">-</mo><mrow id="S4.Ex3.m1.1.1.1.4" xref="S4.Ex3.m1.1.1.1.4.cmml"><mi id="S4.Ex3.m1.1.1.1.4.2" xref="S4.Ex3.m1.1.1.1.4.2.cmml">E</mi><mo id="S4.Ex3.m1.1.1.1.4.1" xref="S4.Ex3.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S4.Ex3.m1.1.1.1.4.3.2" xref="S4.Ex3.m1.1.1.1.4.3.1.cmml"><mo stretchy="false" id="S4.Ex3.m1.1.1.1.4.3.2.1" xref="S4.Ex3.m1.1.1.1.4.3.1.1.cmml">[</mo><mi id="S4.Ex3.m1.1.1.1.1" xref="S4.Ex3.m1.1.1.1.1.cmml">x</mi><mo stretchy="false" id="S4.Ex3.m1.1.1.1.4.3.2.2" xref="S4.Ex3.m1.1.1.1.4.3.1.1.cmml">]</mo></mrow></mrow></mrow><msqrt id="S4.Ex3.m1.2.2.2" xref="S4.Ex3.m1.2.2.2.cmml"><mrow id="S4.Ex3.m1.2.2.2.1.1" xref="S4.Ex3.m1.2.2.2.1.1.cmml"><mrow id="S4.Ex3.m1.2.2.2.1.1.3" xref="S4.Ex3.m1.2.2.2.1.1.3.cmml"><mi id="S4.Ex3.m1.2.2.2.1.1.3.4" xref="S4.Ex3.m1.2.2.2.1.1.3.4.cmml">Var</mi><mo id="S4.Ex3.m1.2.2.2.1.1.3.1b" xref="S4.Ex3.m1.2.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S4.Ex3.m1.2.2.2.1.1.3.5.2" xref="S4.Ex3.m1.2.2.2.1.1.3.5.1.cmml"><mo stretchy="false" id="S4.Ex3.m1.2.2.2.1.1.3.5.2.1" xref="S4.Ex3.m1.2.2.2.1.1.3.5.1.1.cmml">[</mo><mi id="S4.Ex3.m1.2.2.2.1.1.1" xref="S4.Ex3.m1.2.2.2.1.1.1.cmml">X</mi><mo stretchy="false" id="S4.Ex3.m1.2.2.2.1.1.3.5.2.2" xref="S4.Ex3.m1.2.2.2.1.1.3.5.1.1.cmml">]</mo></mrow></mrow><mo id="S4.Ex3.m1.2.2.2.1.1.2" xref="S4.Ex3.m1.2.2.2.1.1.2.cmml">+</mo><mi id="S4.Ex3.m1.2.2.2.1.1.4" xref="S4.Ex3.m1.2.2.2.1.1.4.cmml">ϵ</mi></mrow></msqrt></mfrac><mo id="S4.Ex3.m1.2.3.3.2.1" xref="S4.Ex3.m1.2.3.3.2.1.cmml">*</mo><mi id="S4.Ex3.m1.2.3.3.2.2" xref="S4.Ex3.m1.2.3.3.2.2.cmml">γ</mi></mrow><mo id="S4.Ex3.m1.2.3.3.1" xref="S4.Ex3.m1.2.3.3.1.cmml">+</mo><mi id="S4.Ex3.m1.2.3.3.3" xref="S4.Ex3.m1.2.3.3.3.cmml">β</mi></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr>
</table>
</div>
<div id="S4.SS1.SSS3.p4" class="ltx_para">
<p id="S4.SS1.SSS3.p4.3" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w1">There</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w2">are</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w3">several</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w4">methods</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w5">for</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w6">calculating</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w8">variance,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w9">including</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w10">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w11">two-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w12">method,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w13">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w14">one-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w15">method,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w16">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w17">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w18">Welford</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.1.w19">algorithm</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w2">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w3">two-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w4">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w5">obtains</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w6">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w7">global</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.2.w8">mean</span><span> </span><math id="S4.SS1.SSS3.p4.1.m1.1" class="ltx_Math" alttext="Mean(x)" display="inline"><semantics id="S4.SS1.SSS3.p4.1.m1.1a"><mrow id="S4.SS1.SSS3.p4.1.m1.1.2" xref="S4.SS1.SSS3.p4.1.m1.1.2.cmml"><mi id="S4.SS1.SSS3.p4.1.m1.1.2.5" xref="S4.SS1.SSS3.p4.1.m1.1.2.5.cmml">Mean</mi><mo id="S4.SS1.SSS3.p4.1.m1.1.2.1c" xref="S4.SS1.SSS3.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p4.1.m1.1.2.6.2" xref="S4.SS1.SSS3.p4.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p4.1.m1.1.2.6.2.1" xref="S4.SS1.SSS3.p4.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.SSS3.p4.1.m1.1.1" xref="S4.SS1.SSS3.p4.1.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.SSS3.p4.1.m1.1.2.6.2.2" xref="S4.SS1.SSS3.p4.1.m1.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w2">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w4">first</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w5">pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w6">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w7">calculates</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w8">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w9">variance</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w10">using</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w11">straightforward</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w12">variance</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.3.w13">definition</span><span> </span><math id="S4.SS1.SSS3.p4.2.m2.2" class="ltx_Math" alttext="Mean(x-Mean(x))^{2}" display="inline"><semantics id="S4.SS1.SSS3.p4.2.m2.2a"><mrow id="S4.SS1.SSS3.p4.2.m2.2.2" xref="S4.SS1.SSS3.p4.2.m2.2.2.cmml"><mi id="S4.SS1.SSS3.p4.2.m2.2.2.6" xref="S4.SS1.SSS3.p4.2.m2.2.2.6.cmml">Mean</mi><mo id="S4.SS1.SSS3.p4.2.m2.2.2.2c" xref="S4.SS1.SSS3.p4.2.m2.2.2.2.cmml">⁢</mo><msup id="S4.SS1.SSS3.p4.2.m2.2.2.1" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.cmml"><mrow id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.2" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.2" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.2.cmml">x</mi><mo id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.1" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.1.cmml">-</mo><mrow id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.5" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.5.cmml">Mean</mi><mo id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.1c" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.6.2" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.6.2.1" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.cmml">(</mo><mi id="S4.SS1.SSS3.p4.2.m2.1.1" xref="S4.SS1.SSS3.p4.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.6.2.2" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.3" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.1.1.1.cmml">)</mo></mrow><mn id="S4.SS1.SSS3.p4.2.m2.2.2.1.3" xref="S4.SS1.SSS3.p4.2.m2.2.2.1.3.cmml">2</mn></msup></mrow></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w1"/><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w2">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w4">second</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w5">pass.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w6">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w7">one-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w8">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w9">requires</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w10">only</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w11">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w12">pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w13">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w14">data</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w15">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w16">uses</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w17">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w18">variance</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w19">calculation</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.4.w20">formula:</span><span> </span><math id="S4.SS1.SSS3.p4.3.m3.2" class="ltx_Math" alttext="Mean(x^{2})-Mean^{2}(x)" display="inline"><semantics id="S4.SS1.SSS3.p4.3.m3.2a"><mrow id="S4.SS1.SSS3.p4.3.m3.2.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.cmml"><mrow id="S4.SS1.SSS3.p4.3.m3.2.2.1" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.cmml"><mi id="S4.SS1.SSS3.p4.3.m3.2.2.1.6" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.6.cmml">Mean</mi><mo id="S4.SS1.SSS3.p4.3.m3.2.2.1.2c" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.2.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.cmml">(</mo><msup id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.2.cmml">x</mi><mn id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.3" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.3" xref="S4.SS1.SSS3.p4.3.m3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.SSS3.p4.3.m3.2.2.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.2.cmml">-</mo><mrow id="S4.SS1.SSS3.p4.3.m3.2.2.3" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.cmml"><msup id="S4.SS1.SSS3.p4.3.m3.2.2.3.5" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.5.cmml"><mi id="S4.SS1.SSS3.p4.3.m3.2.2.3.5.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.5.2.cmml">Mean</mi><mn id="S4.SS1.SSS3.p4.3.m3.2.2.3.5.3" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.5.3.cmml">2</mn></msup><mo id="S4.SS1.SSS3.p4.3.m3.2.2.3.1c" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.1.cmml">⁢</mo><mrow id="S4.SS1.SSS3.p4.3.m3.2.2.3.6.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.SSS3.p4.3.m3.2.2.3.6.2.1" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.cmml">(</mo><mi id="S4.SS1.SSS3.p4.3.m3.1.1" xref="S4.SS1.SSS3.p4.3.m3.1.1.cmml">x</mi><mo stretchy="false" id="S4.SS1.SSS3.p4.3.m3.2.2.3.6.2.2" xref="S4.SS1.SSS3.p4.3.m3.2.2.3.cmml">)</mo></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w1">.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w2">Compared</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w3">with</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w5">two-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w6">method,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w7">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w8">one-pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w9">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w10">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w11">easier</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w12">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w13">achieve</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w14">good</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w15">performance,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w16">but</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w17">it</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w18">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w19">difficult</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w20">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w21">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w22">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w23">practical</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w24">implementations</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w25">because</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w26">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w27">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w28">numerical</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w29">unstable.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w30">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w31">Welford</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w32">algorithm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w33">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w34">be</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w35">represented</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w36">by</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w37">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w38">following</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p4.3.5.w39">equation:</span></p>
</div>
<div id="S4.SS1.SSS3.p5" class="ltx_para">
<table id="S4.Ex4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.Ex4.m1.2" class="ltx_Math" alttext="M_{n}=M_{n-1}+(x_{n}-\bar{x}_{n-1})(x_{n}-\bar{x}_{n}),\sigma_{n}^{2}=M_{n}/n" display="block"><semantics id="S4.Ex4.m1.2a"><mrow id="S4.Ex4.m1.2.2.2" xref="S4.Ex4.m1.2.2.3.cmml"><mrow id="S4.Ex4.m1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.cmml"><msub id="S4.Ex4.m1.1.1.1.1.4" xref="S4.Ex4.m1.1.1.1.1.4.cmml"><mi id="S4.Ex4.m1.1.1.1.1.4.2" xref="S4.Ex4.m1.1.1.1.1.4.2.cmml">M</mi><mi id="S4.Ex4.m1.1.1.1.1.4.3" xref="S4.Ex4.m1.1.1.1.1.4.3.cmml">n</mi></msub><mo id="S4.Ex4.m1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S4.Ex4.m1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.2.cmml"><msub id="S4.Ex4.m1.1.1.1.1.2.4" xref="S4.Ex4.m1.1.1.1.1.2.4.cmml"><mi id="S4.Ex4.m1.1.1.1.1.2.4.2" xref="S4.Ex4.m1.1.1.1.1.2.4.2.cmml">M</mi><mrow id="S4.Ex4.m1.1.1.1.1.2.4.3" xref="S4.Ex4.m1.1.1.1.1.2.4.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.2.4.3.2" xref="S4.Ex4.m1.1.1.1.1.2.4.3.2.cmml">n</mi><mo id="S4.Ex4.m1.1.1.1.1.2.4.3.1" xref="S4.Ex4.m1.1.1.1.1.2.4.3.1.cmml">-</mo><mn id="S4.Ex4.m1.1.1.1.1.2.4.3.3" xref="S4.Ex4.m1.1.1.1.1.2.4.3.3.cmml">1</mn></mrow></msub><mo id="S4.Ex4.m1.1.1.1.1.2.3" xref="S4.Ex4.m1.1.1.1.1.2.3.cmml">+</mo><mrow id="S4.Ex4.m1.1.1.1.1.2.2" xref="S4.Ex4.m1.1.1.1.1.2.2.cmml"><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">n</mi></msub><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.1.cmml">-</mo><msub id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2.2.cmml">x</mi><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.2.1.cmml">¯</mo></mover><mrow id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">n</mi><mo id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">-</mo><mn id="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.1.1.1.1.3" xref="S4.Ex4.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex4.m1.1.1.1.1.2.2.3" xref="S4.Ex4.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S4.Ex4.m1.1.1.1.1.2.2.2.1" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.cmml"><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.2.2.2.1.2" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.cmml"><msub id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2.2" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2.2.cmml">x</mi><mi id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2.3" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.2.3.cmml">n</mi></msub><mo id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.1" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.1.cmml">-</mo><msub id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.cmml"><mover accent="true" id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2.cmml"><mi id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2.2" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2.2.cmml">x</mi><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2.1" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.2.1.cmml">¯</mo></mover><mi id="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.3" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.3.3.cmml">n</mi></msub></mrow><mo stretchy="false" id="S4.Ex4.m1.1.1.1.1.2.2.2.1.3" xref="S4.Ex4.m1.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.Ex4.m1.2.2.2.3" xref="S4.Ex4.m1.2.2.3a.cmml">,</mo><mrow id="S4.Ex4.m1.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.cmml"><msubsup id="S4.Ex4.m1.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.cmml"><mi id="S4.Ex4.m1.2.2.2.2.2.2.2" xref="S4.Ex4.m1.2.2.2.2.2.2.2.cmml">σ</mi><mi id="S4.Ex4.m1.2.2.2.2.2.2.3" xref="S4.Ex4.m1.2.2.2.2.2.2.3.cmml">n</mi><mn id="S4.Ex4.m1.2.2.2.2.2.3" xref="S4.Ex4.m1.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S4.Ex4.m1.2.2.2.2.1" xref="S4.Ex4.m1.2.2.2.2.1.cmml">=</mo><mrow id="S4.Ex4.m1.2.2.2.2.3" xref="S4.Ex4.m1.2.2.2.2.3.cmml"><msub id="S4.Ex4.m1.2.2.2.2.3.2" xref="S4.Ex4.m1.2.2.2.2.3.2.cmml"><mi id="S4.Ex4.m1.2.2.2.2.3.2.2" xref="S4.Ex4.m1.2.2.2.2.3.2.2.cmml">M</mi><mi id="S4.Ex4.m1.2.2.2.2.3.2.3" xref="S4.Ex4.m1.2.2.2.2.3.2.3.cmml">n</mi></msub><mo id="S4.Ex4.m1.2.2.2.2.3.1" xref="S4.Ex4.m1.2.2.2.2.3.1.cmml">/</mo><mi id="S4.Ex4.m1.2.2.2.2.3.3" xref="S4.Ex4.m1.2.2.2.2.3.3.cmml">n</mi></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr>
</table>
</div>
<div id="S4.SS1.SSS3.p6" class="ltx_para">
<p id="S4.SS1.SSS3.p6.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w1">The</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w2">Welford</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w3">algorithm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w5">also</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w6">a</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w7">single</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w8">pass</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w9">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w10">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w11">has</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w12">good</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w13">numerical</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w14">stability,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w15">so</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w16">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w17">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w18">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w19">Welford</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w20">method</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w21">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w22">calculate</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w23">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p6.1.1.w24">variance.</span></p>
</div>
<div id="S4.SS1.SSS3.p7" class="ltx_para">
<p id="S4.SS1.SSS3.p7.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w1">Similar</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w2">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w3">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w4">Softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w5">kernel,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w6">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w7">also</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w8">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w9">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w10">warp</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w11">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w12">calculate</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w13">one-row</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w14">data.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w15">Each</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w16">thread</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w17">in</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w18">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w19">warp</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w20">calculates</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w21">local</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w22">mean</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w23">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w24">variance</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w25">from</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w26">part</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w27">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w28">data</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w29">from</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w30">one</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w31">row</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w32">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w33">then</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w34">uses</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w35">WarpAllReduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w36">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w37">obtain</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w38">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w39">global</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w40">mean</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w41">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w42">variance.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w43">Finally,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w44">each</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w45">thread</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w46">calculates</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w47">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w48">normalized</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w49">value</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w50">based</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w51">on</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w52">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w53">global</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w54">mean</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w55">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p7.1.1.w56">variance.</span></p>
</div>
<div id="S4.SS1.SSS3.p8" class="ltx_para">
<p id="S4.SS1.SSS3.p8.1" class="ltx_p"><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w1">In</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w2">Softmax</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w3">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w4">LayerNorm</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w5">kernel,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w6">we</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w7">use</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w8">vectorized</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w9">memory</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w10">access</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w11">to</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w12">improve</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w13">CUDA</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w14">Kernel</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w15">performance.</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w16">Many</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w17">CUDA</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w18">Kernels</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w19">are</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w20">bandwidth</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w21">constrained,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w22">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w23">using</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w24">vectorized</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w25">memory</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w26">access</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w27">can</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w28">reduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w29">the</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w30">total</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w31">number</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w32">of</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w33">instructions,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w34">reduce</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w35">latency,</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w36">and</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w37">improve</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w38">bandwidth</span><span> </span><span class="gd_word" id="S4.SS1.SSS3.p8.1.1.w39">utilization.</span></p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">IV-B </span>Parallel Evoformer
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS2.p1.1.1.w1">Because</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w4">restricted</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w5">global</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w6">batch</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w7">size,</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w8">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w9">training</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w10">can</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w11">only</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w12">scale</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w13">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w14">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w15">maximum</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w16">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w17">128</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w18">devices.</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w19">This</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w20">makes</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w22">training</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w23">time</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w24">very</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w25">long.</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w26">In</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w27">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w28">official</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w29">experiments,</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w30">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w31">complete</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w32">training</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w33">time</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w34">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w35">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w36">is</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w37">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w38">long</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w39">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w40">11</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w41">days.</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w42">Therefore,</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w43">by</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w44">introducing</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w45">model</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w46">parallelism,</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w47">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w48">training</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w49">can</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w50">be</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w51">better</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w52">scaled</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w53">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w54">more</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w55">computing</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w56">resources,</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w57">thus</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w58">reducing</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w59">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w60">overall</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w61">training</span><span> </span><span class="gd_word" id="S4.SS2.p1.1.1.w62">time.</span></p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p"><span class="gd_word" id="S4.SS2.p2.1.1.w1">As</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w2">we</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w3">described</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w4">in</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w5">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w6">background</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w7">section,</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w8">Pipeline</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w9">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w10">can</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w11">have</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w12">some</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w13">bubbles</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w14">that</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w15">reduce</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w16">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w17">efficiency</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w18">of</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w19">hardware</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w20">resources</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w21">utilization.</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w22">To</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w23">improve</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w24">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w25">performance</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w26">of</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w27">Pipeline</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w28">Parallelism,</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w29">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w30">mini-batch</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w31">need</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w32">to</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w33">be</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w34">further</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w35">split</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w36">to</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w37">multiple</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w38">micro-batches</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w39">and</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w40">combine</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w41">it</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w42">with</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w43">gradient</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w44">accumulate.</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w45">During</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w46">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w47">training</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w48">of</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w49">AlphaFold,</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w50">using</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w51">pipeline</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w52">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w53">does</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w54">not</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w55">scale</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w56">to</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w57">more</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w58">devices</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w59">with</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w60">guaranteed</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w61">performance</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w62">because</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w63">of</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w64">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w65">batch</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w66">size</span><span> </span><span class="gd_word" id="S4.SS2.p2.1.1.w67">limitation.</span></p>
</div>
<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">IV-B1 </span>Tensor Parallelism on AlphaFold
</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w1">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w2">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w3">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w4">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w5">applied</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w6">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w7">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w8">model</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w9">training.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w10">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w11">main</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w12">structure</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w13">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w14">Evoformer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w15">contains</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w16">Attention</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w17">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w18">FeedForward,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w19">similar</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w20">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w22">structure</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w23">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w24">vanilla</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w25">Transformer.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w26">Therefore,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w27">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w28">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w29">use</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w30">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w31">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w32">similar</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w33">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w34">that</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w35">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w36">Megatron-LM.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w37">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w38">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w39">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w40">mainly</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w41">imposed</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w42">on</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w43">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w44">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w45">layer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w46">because</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w47">matrix</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w48">multiplication</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w49">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w50">relatively</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w51">easy</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w52">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w53">distribute</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w54">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w55">different</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p1.1.1.w56">devices.</span></p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.16" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w1">Since</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w2">there</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w4">no</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w5">previous</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w6">work</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w7">about</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w8">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w9">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w10">on</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w11">AlphaFold,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w12">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w13">describe</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w14">here</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w15">how</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w16">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w17">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w18">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w19">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w20">used</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w21">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w22">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w23">training.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w24">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w25">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w26">types</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w27">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w28">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w29">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w30">proposed</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w31">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w32">Megatron-LM</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w33">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w34">column</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w35">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w36">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w37">row</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w38">parallelism.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w39">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w40">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w41">Layer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w42">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w43">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w44">written</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.1.w45">as</span><span> </span><math id="S4.SS2.SSS1.p2.1.m1.1" class="ltx_Math" alttext="Y=XA" display="inline"><semantics id="S4.SS2.SSS1.p2.1.m1.1a"><mrow id="S4.SS2.SSS1.p2.1.m1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.2.cmml">Y</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S4.SS2.SSS1.p2.1.m1.1.1.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3.2" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.2.cmml">X</mi><mo id="S4.SS2.SSS1.p2.1.m1.1.1.3.1" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.SS2.SSS1.p2.1.m1.1.1.3.3" xref="S4.SS2.SSS1.p2.1.m1.1.1.3.3.cmml">A</mi></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.2.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.2.w2">where</span><span> </span><math id="S4.SS2.SSS1.p2.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.SSS1.p2.2.m2.1a"><mi id="S4.SS2.SSS1.p2.2.m2.1.1" xref="S4.SS2.SSS1.p2.2.m2.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.3.w2">and</span><span> </span><math id="S4.SS2.SSS1.p2.3.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S4.SS2.SSS1.p2.3.m3.1a"><mi id="S4.SS2.SSS1.p2.3.m3.1.1" xref="S4.SS2.SSS1.p2.3.m3.1.1.cmml">Y</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w2">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w3">input</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w4">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w5">output</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w6">vectors,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w7">respectively,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.4.w8">and</span><span> </span><math id="S4.SS2.SSS1.p2.4.m4.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.SSS1.p2.4.m4.1a"><mi id="S4.SS2.SSS1.p2.4.m4.1.1" xref="S4.SS2.SSS1.p2.4.m4.1.1.cmml">A</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w2">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w4">weight</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w5">matrix.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w6">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w7">column</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w8">parallelism,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w9">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w10">divide</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w11">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w12">weight</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.5.w13">matrix</span><span> </span><math id="S4.SS2.SSS1.p2.5.m5.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.SSS1.p2.5.m5.1a"><mi id="S4.SS2.SSS1.p2.5.m5.1.1" xref="S4.SS2.SSS1.p2.5.m5.1.1.cmml">A</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w2">column-wise</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w3">across</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w4">N</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w5">devices</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.6.w6">as</span><span> </span><math id="S4.SS2.SSS1.p2.6.m6.4" class="ltx_Math" alttext="A_{1},A_{2},...,A_{n}" display="inline"><semantics id="S4.SS2.SSS1.p2.6.m6.4a"><mrow id="S4.SS2.SSS1.p2.6.m6.4.4.3" xref="S4.SS2.SSS1.p2.6.m6.4.4.4.cmml"><msub id="S4.SS2.SSS1.p2.6.m6.2.2.1.1" xref="S4.SS2.SSS1.p2.6.m6.2.2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.6.m6.2.2.1.1.2" xref="S4.SS2.SSS1.p2.6.m6.2.2.1.1.2.cmml">A</mi><mn id="S4.SS2.SSS1.p2.6.m6.2.2.1.1.3" xref="S4.SS2.SSS1.p2.6.m6.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.SSS1.p2.6.m6.4.4.3.4" xref="S4.SS2.SSS1.p2.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.6.m6.3.3.2.2" xref="S4.SS2.SSS1.p2.6.m6.3.3.2.2.cmml"><mi id="S4.SS2.SSS1.p2.6.m6.3.3.2.2.2" xref="S4.SS2.SSS1.p2.6.m6.3.3.2.2.2.cmml">A</mi><mn id="S4.SS2.SSS1.p2.6.m6.3.3.2.2.3" xref="S4.SS2.SSS1.p2.6.m6.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.SSS1.p2.6.m6.4.4.3.5" xref="S4.SS2.SSS1.p2.6.m6.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.SSS1.p2.6.m6.1.1" xref="S4.SS2.SSS1.p2.6.m6.1.1.cmml">…</mi><mo id="S4.SS2.SSS1.p2.6.m6.4.4.3.6" xref="S4.SS2.SSS1.p2.6.m6.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.6.m6.4.4.3.3" xref="S4.SS2.SSS1.p2.6.m6.4.4.3.3.cmml"><mi id="S4.SS2.SSS1.p2.6.m6.4.4.3.3.2" xref="S4.SS2.SSS1.p2.6.m6.4.4.3.3.2.cmml">A</mi><mi id="S4.SS2.SSS1.p2.6.m6.4.4.3.3.3" xref="S4.SS2.SSS1.p2.6.m6.4.4.3.3.3.cmml">n</mi></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.7.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.7.w2">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.7.w3">conduct</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.7.w4">matrix</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.7.w5">multiplications</span><span> </span><math id="S4.SS2.SSS1.p2.7.m7.1" class="ltx_Math" alttext="XA_{1}" display="inline"><semantics id="S4.SS2.SSS1.p2.7.m7.1a"><mrow id="S4.SS2.SSS1.p2.7.m7.1.1" xref="S4.SS2.SSS1.p2.7.m7.1.1.cmml"><mi id="S4.SS2.SSS1.p2.7.m7.1.1.2" xref="S4.SS2.SSS1.p2.7.m7.1.1.2.cmml">X</mi><mo id="S4.SS2.SSS1.p2.7.m7.1.1.1" xref="S4.SS2.SSS1.p2.7.m7.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS1.p2.7.m7.1.1.3" xref="S4.SS2.SSS1.p2.7.m7.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.7.m7.1.1.3.2" xref="S4.SS2.SSS1.p2.7.m7.1.1.3.2.cmml">A</mi><mn id="S4.SS2.SSS1.p2.7.m7.1.1.3.3" xref="S4.SS2.SSS1.p2.7.m7.1.1.3.3.cmml">1</mn></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.8.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.8.w2">through</span><span> </span><math id="S4.SS2.SSS1.p2.8.m8.1" class="ltx_Math" alttext="XA_{n}" display="inline"><semantics id="S4.SS2.SSS1.p2.8.m8.1a"><mrow id="S4.SS2.SSS1.p2.8.m8.1.1" xref="S4.SS2.SSS1.p2.8.m8.1.1.cmml"><mi id="S4.SS2.SSS1.p2.8.m8.1.1.2" xref="S4.SS2.SSS1.p2.8.m8.1.1.2.cmml">X</mi><mo id="S4.SS2.SSS1.p2.8.m8.1.1.1" xref="S4.SS2.SSS1.p2.8.m8.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS1.p2.8.m8.1.1.3" xref="S4.SS2.SSS1.p2.8.m8.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.8.m8.1.1.3.2" xref="S4.SS2.SSS1.p2.8.m8.1.1.3.2.cmml">A</mi><mi id="S4.SS2.SSS1.p2.8.m8.1.1.3.3" xref="S4.SS2.SSS1.p2.8.m8.1.1.3.3.cmml">n</mi></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.9.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.9.w2">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.9.w3">parallel,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.9.w4">resulting</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.9.w5">in</span><span> </span><math id="S4.SS2.SSS1.p2.9.m9.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS1.p2.9.m9.1a"><mi id="S4.SS2.SSS1.p2.9.m9.1.1" xref="S4.SS2.SSS1.p2.9.m9.1.1.cmml">N</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.10.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.10.w2">output</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.10.w3">vectors</span><span> </span><math id="S4.SS2.SSS1.p2.10.m10.4" class="ltx_Math" alttext="Y_{1},Y_{2},...,Y_{n}" display="inline"><semantics id="S4.SS2.SSS1.p2.10.m10.4a"><mrow id="S4.SS2.SSS1.p2.10.m10.4.4.3" xref="S4.SS2.SSS1.p2.10.m10.4.4.4.cmml"><msub id="S4.SS2.SSS1.p2.10.m10.2.2.1.1" xref="S4.SS2.SSS1.p2.10.m10.2.2.1.1.cmml"><mi id="S4.SS2.SSS1.p2.10.m10.2.2.1.1.2" xref="S4.SS2.SSS1.p2.10.m10.2.2.1.1.2.cmml">Y</mi><mn id="S4.SS2.SSS1.p2.10.m10.2.2.1.1.3" xref="S4.SS2.SSS1.p2.10.m10.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS2.SSS1.p2.10.m10.4.4.3.4" xref="S4.SS2.SSS1.p2.10.m10.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.10.m10.3.3.2.2" xref="S4.SS2.SSS1.p2.10.m10.3.3.2.2.cmml"><mi id="S4.SS2.SSS1.p2.10.m10.3.3.2.2.2" xref="S4.SS2.SSS1.p2.10.m10.3.3.2.2.2.cmml">Y</mi><mn id="S4.SS2.SSS1.p2.10.m10.3.3.2.2.3" xref="S4.SS2.SSS1.p2.10.m10.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS2.SSS1.p2.10.m10.4.4.3.5" xref="S4.SS2.SSS1.p2.10.m10.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S4.SS2.SSS1.p2.10.m10.1.1" xref="S4.SS2.SSS1.p2.10.m10.1.1.cmml">…</mi><mo id="S4.SS2.SSS1.p2.10.m10.4.4.3.6" xref="S4.SS2.SSS1.p2.10.m10.4.4.4.cmml">,</mo><msub id="S4.SS2.SSS1.p2.10.m10.4.4.3.3" xref="S4.SS2.SSS1.p2.10.m10.4.4.3.3.cmml"><mi id="S4.SS2.SSS1.p2.10.m10.4.4.3.3.2" xref="S4.SS2.SSS1.p2.10.m10.4.4.3.3.2.cmml">Y</mi><mi id="S4.SS2.SSS1.p2.10.m10.4.4.3.3.3" xref="S4.SS2.SSS1.p2.10.m10.4.4.3.3.3.cmml">n</mi></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w1">.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w2">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w3">row</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w4">parallelism,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w5">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w6">divide</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w7">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w8">weight</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.11.w9">matrix</span><span> </span><math id="S4.SS2.SSS1.p2.11.m11.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.SS2.SSS1.p2.11.m11.1a"><mi id="S4.SS2.SSS1.p2.11.m11.1.1" xref="S4.SS2.SSS1.p2.11.m11.1.1.cmml">A</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.12.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.12.w2">column-wise</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.12.w3">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.12.w4">input</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.12.w5">vectors</span><span> </span><math id="S4.SS2.SSS1.p2.12.m12.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S4.SS2.SSS1.p2.12.m12.1a"><mi id="S4.SS2.SSS1.p2.12.m12.1.1" xref="S4.SS2.SSS1.p2.12.m12.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w2">across</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w3">N</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w4">device,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w5">then</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w6">conduct</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w7">matrix</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.13.w8">multiplications</span><span> </span><math id="S4.SS2.SSS1.p2.13.m13.1" class="ltx_Math" alttext="X_{1}A_{1}" display="inline"><semantics id="S4.SS2.SSS1.p2.13.m13.1a"><mrow id="S4.SS2.SSS1.p2.13.m13.1.1" xref="S4.SS2.SSS1.p2.13.m13.1.1.cmml"><msub id="S4.SS2.SSS1.p2.13.m13.1.1.2" xref="S4.SS2.SSS1.p2.13.m13.1.1.2.cmml"><mi id="S4.SS2.SSS1.p2.13.m13.1.1.2.2" xref="S4.SS2.SSS1.p2.13.m13.1.1.2.2.cmml">X</mi><mn id="S4.SS2.SSS1.p2.13.m13.1.1.2.3" xref="S4.SS2.SSS1.p2.13.m13.1.1.2.3.cmml">1</mn></msub><mo id="S4.SS2.SSS1.p2.13.m13.1.1.1" xref="S4.SS2.SSS1.p2.13.m13.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS1.p2.13.m13.1.1.3" xref="S4.SS2.SSS1.p2.13.m13.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.13.m13.1.1.3.2" xref="S4.SS2.SSS1.p2.13.m13.1.1.3.2.cmml">A</mi><mn id="S4.SS2.SSS1.p2.13.m13.1.1.3.3" xref="S4.SS2.SSS1.p2.13.m13.1.1.3.3.cmml">1</mn></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.14.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.14.w2">through</span><span> </span><math id="S4.SS2.SSS1.p2.14.m14.1" class="ltx_Math" alttext="X_{n}A_{n}" display="inline"><semantics id="S4.SS2.SSS1.p2.14.m14.1a"><mrow id="S4.SS2.SSS1.p2.14.m14.1.1" xref="S4.SS2.SSS1.p2.14.m14.1.1.cmml"><msub id="S4.SS2.SSS1.p2.14.m14.1.1.2" xref="S4.SS2.SSS1.p2.14.m14.1.1.2.cmml"><mi id="S4.SS2.SSS1.p2.14.m14.1.1.2.2" xref="S4.SS2.SSS1.p2.14.m14.1.1.2.2.cmml">X</mi><mi id="S4.SS2.SSS1.p2.14.m14.1.1.2.3" xref="S4.SS2.SSS1.p2.14.m14.1.1.2.3.cmml">n</mi></msub><mo id="S4.SS2.SSS1.p2.14.m14.1.1.1" xref="S4.SS2.SSS1.p2.14.m14.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS1.p2.14.m14.1.1.3" xref="S4.SS2.SSS1.p2.14.m14.1.1.3.cmml"><mi id="S4.SS2.SSS1.p2.14.m14.1.1.3.2" xref="S4.SS2.SSS1.p2.14.m14.1.1.3.2.cmml">A</mi><mi id="S4.SS2.SSS1.p2.14.m14.1.1.3.3" xref="S4.SS2.SSS1.p2.14.m14.1.1.3.3.cmml">n</mi></msub></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.15.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.15.w2">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.15.w3">parallel,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.15.w4">resulting</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.15.w5">in</span><span> </span><math id="S4.SS2.SSS1.p2.15.m15.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS1.p2.15.m15.1a"><mi id="S4.SS2.SSS1.p2.15.m15.1.1" xref="S4.SS2.SSS1.p2.15.m15.1.1.cmml">N</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w2">output</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w3">vectors,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w4">after</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w5">AllReduce</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w6">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w7">get</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w8">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.16.w9">final</span><span> </span><math id="S4.SS2.SSS1.p2.16.m16.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S4.SS2.SSS1.p2.16.m16.1a"><mi id="S4.SS2.SSS1.p2.16.m16.1.1" xref="S4.SS2.SSS1.p2.16.m16.1.1.cmml">Y</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w1">.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w2">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w3">FeedForward,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w4">column</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w5">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w6">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w7">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w8">used</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w9">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w10">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w11">previous</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w12">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w13">layer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w14">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w15">row</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w16">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w17">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w18">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w19">next</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w20">layer.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w21">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w22">Multi-head</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w23">Attention,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w24">column</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w25">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w26">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w27">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w28">used</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w29">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w30">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w31">computation</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w32">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w33">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w34">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w35">layer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w36">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w37">QKV</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w38">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w39">row</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w40">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w41">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w42">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w43">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w44">Multi-head</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w45">Attention,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w46">you</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w47">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w48">use</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w49">column</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w50">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w51">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w52">calculating</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w53">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w54">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w55">layer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w56">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w57">QKV</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w58">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w59">row</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w60">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w61">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w62">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w63">output</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w64">Linear</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w65">layer.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w66">This</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w67">method</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w68">minimizes</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w69">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w70">number</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w71">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w72">times</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w73">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w74">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w75">needs</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w76">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p2.16.17.w77">communicate.</span></p>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para">
<p id="S4.SS2.SSS1.p3.1" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w1">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w2">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w3">(TP)</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w4">will</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w5">introduce</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w6">many</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w7">synchronization</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w8">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w9">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w10">each</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w11">Evoformer</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w12">layer,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w13">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w14">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w15">only</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w16">apply</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w17">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w18">some</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w19">part</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w20">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w22">model</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w23">like</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w24">Attention</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w25">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w26">FeedForward.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w27">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w28">scaling</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w29">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w30">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w31">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w32">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w33">limited</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w34">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w35">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w36">number</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w37">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w38">heads</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w39">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w40">Attention.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w41">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w42">heads</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w43">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w44">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w45">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w46">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w47">4</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w48">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w49">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w50">Pair</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w51">Stack,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w52">so</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w53">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w54">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w55">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w56">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w57">scaled</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w58">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w59">a</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w60">maximum</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w61">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w62">4</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w63">devices.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w64">On</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w65">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w66">other</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w67">hand,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w68">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w69">model</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w70">parameter</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w71">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w72">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w73">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w74">small,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w75">however,</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w76">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w77">input</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w78">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w79">activation</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w80">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w81">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w82">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w83">extremely</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w84">large.</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w85">So</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w86">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w87">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w88">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w89">inefficient</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w90">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w91">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w92">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w93">scale</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w94">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w95">more</span><span> </span><span class="gd_word" id="S4.SS2.SSS1.p3.1.1.w96">devices.</span></p>
</div>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">IV-B2 </span>Dynamic Axial Parallelism
</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w1">To</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w2">tackle</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w3">this</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w4">problem,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w5">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w6">propose</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w7">Dynamic</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w8">Axial</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w9">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w10">(DAP),</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w11">which</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w12">provides</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w13">end-to-end</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w14">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w15">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w16">Evoformer.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w17">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w18">AlphaFold</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w19">training,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w21">number</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w22">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w23">parameters</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w24">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w25">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w26">model</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w27">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w28">relatively</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w29">small,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w30">but</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w31">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w32">activation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w33">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w34">relatively</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w35">large.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w36">So</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w37">unlike</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w38">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w39">Parallelism,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w40">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w41">choose</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w42">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w43">keep</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w44">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w45">complete</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w46">model</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w47">parameters</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w48">on</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w49">each</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w50">device</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w51">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w52">divide</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w53">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w54">input</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w55">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w56">activation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w57">among</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w58">different</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w59">devices.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w60">Both</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w61">MSA</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w62">representation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w63">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w64">pair</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w65">representation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w66">processed</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w67">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w68">Evoformer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w69">contain</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w70">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w71">sequence</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w72">dimensions,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w73">but</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w74">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w75">calculations</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w76">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w77">Evoformer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w78">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w79">all</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w80">along</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w81">one</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w82">sequence</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w83">dimension</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w84">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w85">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w86">data.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w87">So</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w88">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w89">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w90">divide</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w91">on</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w92">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w93">other</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w94">dimension</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w95">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w96">insert</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w97">All_to_All</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w98">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w99">when</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w100">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w101">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w102">sequence</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w103">dimensions</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w104">are</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w105">transformed,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w106">thus</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w107">keeping</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w108">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w109">data</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w110">dimension</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w111">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w112">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w113">computation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w114">direction</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w115">complete</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w116">on</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w117">each</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w118">device,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w119">which</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w120">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w121">shown</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w122">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.1.w123">Figure</span><span> </span><a href="#S4.F6.sf1" title="(a) ‣ Fig. 6 ‣ IV-B2 Dynamic Axial Parallelism ‣ IV-B Parallel Evoformer ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">6(a)</a><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w2">No</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w3">other</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w4">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w5">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w6">needed</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w7">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w8">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w9">computation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w10">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w11">Attention.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w12">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w13">Outer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w14">Product</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w15">Mean,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w16">we</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w17">need</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w18">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w19">get</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w20">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w21">global</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w22">Left</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w23">Projection</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w24">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w25">AllGather,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w26">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w27">then</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w28">perform</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w29">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w30">outer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w31">product</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w32">mean</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w33">calculation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w34">with</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w35">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w36">local</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w37">Right</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w38">Projection.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w39">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w40">Triangular</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w41">Updates</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w42">Module</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w43">also</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w44">uses</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w45">a</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w46">similar</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w47">approach</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w48">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w49">Outer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w50">Product</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w51">Mean</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w52">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p1.1.2.w53">parallelism.</span></p>
</div>
<figure id="S4.F6" class="ltx_figure">
<img src="/static/img/2203.00854/S4_F6.png" alt="/static/img/2203.00854/S4_F6.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 6: </span><span class="gd_word" id="S4.F6.2.w1">Communication</span><span> </span><span class="gd_word" id="S4.F6.2.w2">for</span><span> </span><span class="gd_word" id="S4.F6.2.w3">Dynamic</span><span> </span><span class="gd_word" id="S4.F6.2.w4">Axial</span><span> </span><span class="gd_word" id="S4.F6.2.w5">Parallelism.</span><span> </span><span class="gd_word" id="S4.F6.2.w6">All_to_All</span><span> </span><span class="gd_word" id="S4.F6.2.w7">is</span><span> </span><span class="gd_word" id="S4.F6.2.w8">required</span><span> </span><span class="gd_word" id="S4.F6.2.w9">at</span><span> </span><span class="gd_word" id="S4.F6.2.w10">transpose,</span><span> </span><span class="gd_word" id="S4.F6.2.w11">for</span><span> </span><span class="gd_word" id="S4.F6.2.w12">example</span><span> </span><span class="gd_word" id="S4.F6.2.w13">in</span><span> </span><span class="gd_word" id="S4.F6.2.w14">the</span><span> </span><span class="gd_word" id="S4.F6.2.w15">middle</span><span> </span><span class="gd_word" id="S4.F6.2.w16">of</span><span> </span><span class="gd_word" id="S4.F6.2.w17">Row</span><span> </span><span class="gd_word" id="S4.F6.2.w18">Attention</span><span> </span><span class="gd_word" id="S4.F6.2.w19">and</span><span> </span><span class="gd_word" id="S4.F6.2.w20">Column</span><span> </span><span class="gd_word" id="S4.F6.2.w21">Attention.</span><span> </span><span class="gd_word" id="S4.F6.2.w22">AllGather</span><span> </span><span class="gd_word" id="S4.F6.2.w23">needs</span><span> </span><span class="gd_word" id="S4.F6.2.w24">to</span><span> </span><span class="gd_word" id="S4.F6.2.w25">be</span><span> </span><span class="gd_word" id="S4.F6.2.w26">inserted</span><span> </span><span class="gd_word" id="S4.F6.2.w27">in</span><span> </span><span class="gd_word" id="S4.F6.2.w28">Outer</span><span> </span><span class="gd_word" id="S4.F6.2.w29">Product</span><span> </span><span class="gd_word" id="S4.F6.2.w30">Mean</span><span> </span><span class="gd_word" id="S4.F6.2.w31">and</span><span> </span><span class="gd_word" id="S4.F6.2.w32">Triangular</span><span> </span><span class="gd_word" id="S4.F6.2.w33">Updates</span><span> </span><span class="gd_word" id="S4.F6.2.w34">Module.</span><span> </span></figcaption>
</figure>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.2" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS2.p2.2.1.w1">Table</span><span> </span><a href="#S4.T3" title="TABLE III ‣ IV-B2 Dynamic Axial Parallelism ‣ IV-B Parallel Evoformer ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">III</a><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w2">compares</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w4">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w5">overhead</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w6">introduced</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w7">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w8">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w9">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w10">parallel</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w11">approaches,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w12">Tensor</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w13">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w14">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w15">Dynamic</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w16">Axial</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w17">Parallelism.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w18">It</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w19">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w20">be</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w21">observed</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w22">that</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w23">TP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w24">supports</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w25">parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w26">only</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w27">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w28">Attention</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w29">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w30">FeedForward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w31">(FF)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w32">,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w33">while</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w34">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w35">supports</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w36">all</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w37">computational</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w38">modules</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w39">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w40">Evoformer.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w41">TP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w42">introduces</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w43">12</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w44">AllReduce</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w45">communications</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w46">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w47">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w48">Attention+FF,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w49">with</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w50">6</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w51">AllReduce</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w52">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w53">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w54">forward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w55">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w56">6</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w57">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w58">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w59">backward.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w60">In</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w61">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w62">forward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w63">computation,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w64">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w65">introduces</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w66">one</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w67">AllGather</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w68">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w69">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w70">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w71">Outer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w72">Product</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w73">Mean</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w74">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w75">one</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w76">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w77">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w78">each</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w79">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w80">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w81">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w82">Triangular</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w83">Updates</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w84">Modules.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w85">The</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w86">backward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w87">pass</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w88">has</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w89">no</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w90">additional</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w91">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w92">overhead.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w93">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w94">makes</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w95">these</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w96">two</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w97">parts</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w98">parallelizable</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w99">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w100">introducing</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w101">three</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w102">AllGather</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w103">communications.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w104">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w105">needs</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w106">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w107">insert</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w108">All_to_All</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w109">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w110">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w111">between</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w112">calculations</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w113">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w114">different</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w115">directions,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w116">12</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w117">times</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w118">(Forward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w119">6</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w120">times,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w121">backward</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w122">6</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w123">times)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w124">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w125">an</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w126">Evoformer</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w127">block.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w128">However,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w129">TP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w130">needs</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w131">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w132">pass</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w133">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w134">entire</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w135">intermediate</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w136">representation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w137">during</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w138">AllReduce</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w139">communication,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w140">while</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w141">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w142">only</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w143">needs</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w144">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.2.w145">pass</span><span> </span><math id="S4.SS2.SSS2.p2.1.m1.1" class="ltx_Math" alttext="1/N^{2}" display="inline"><semantics id="S4.SS2.SSS2.p2.1.m1.1a"><mrow id="S4.SS2.SSS2.p2.1.m1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.cmml"><mn id="S4.SS2.SSS2.p2.1.m1.1.1.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.2.cmml">1</mn><mo id="S4.SS2.SSS2.p2.1.m1.1.1.1" xref="S4.SS2.SSS2.p2.1.m1.1.1.1.cmml">/</mo><msup id="S4.SS2.SSS2.p2.1.m1.1.1.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.cmml"><mi id="S4.SS2.SSS2.p2.1.m1.1.1.3.2" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.2.cmml">N</mi><mn id="S4.SS2.SSS2.p2.1.m1.1.1.3.3" xref="S4.SS2.SSS2.p2.1.m1.1.1.3.3.cmml">2</mn></msup></mrow></semantics></math><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w4">intermediate</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w5">representation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w6">during</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w7">All_to_All</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w8">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.3.w9">with</span><span> </span><math id="S4.SS2.SSS2.p2.2.m2.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.SS2.SSS2.p2.2.m2.1a"><mi id="S4.SS2.SSS2.p2.2.m2.1.1" xref="S4.SS2.SSS2.p2.2.m2.1.1.cmml">N</mi></semantics></math><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w1"/><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w2">devices.</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w3">So</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w4">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w5">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w6">volume</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w7">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w8">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w9">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w10">much</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w11">smaller</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w12">than</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p2.2.4.w13">TP.</span></p>
</div>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.1" class="ltx_p"><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w1">Overall,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w2">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w3">has</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w4">several</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w5">advantages</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w6">over</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w7">TP:</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w8">1)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w9">it</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w10">supports</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w11">all</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w12">computational</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w13">modules</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w14">in</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w15">Evoformer;</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w16">2)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w17">the</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w18">amount</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w19">of</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w20">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w21">required</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w22">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w23">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w24">is</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w25">much</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w26">smaller</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w27">than</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w28">that</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w29">required</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w30">by</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w31">TP;</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w32">3)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w33">Parallelism</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w34">can</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w35">distribute</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w36">activation</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w37">to</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w38">different</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w39">devices,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w40">and</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w41">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w42">consumes</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w43">less</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w44">memory</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w45">than</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w46">TP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w47">because</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w48">it</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w49">has</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w50">more</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w51">parallel</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w52">parts;</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w53">4)</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w54">DAP</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w55">has</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w56">more</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w57">opportunities</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w58">for</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w59">communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w60">optimization,</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w61">such</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w62">as</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w63">computation-communication</span><span> </span><span class="gd_word" id="S4.SS2.SSS2.p3.1.1.w64">overlap.</span></p>
</div>
<figure id="S4.T3" class="ltx_table">
<img src="/static/img/2203.00854-gpt-3.5-turbo-16k/S4_T3.png" alt="/static/img/2203.00854-gpt-3.5-turbo-16k/S4_T3.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span><span class="gd_word" id="S4.T3.2.w1">Communication</span><span> </span><span class="gd_word" id="S4.T3.2.w2">overhead</span><span> </span><span class="gd_word" id="S4.T3.2.w3">for</span><span> </span><span class="gd_word" id="S4.T3.2.w4">each</span><span> </span><span class="gd_word" id="S4.T3.2.w5">Evoformer</span><span> </span><span class="gd_word" id="S4.T3.2.w6">block.</span></figcaption>
</figure>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">IV-C </span>Communication Optimization
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p1.1.1.w1">Dynamic</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w2">Axial</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w3">Parallelism</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w4">requires</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w5">All_to_All</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w6">and</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w7">AllGather</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w8">communication</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w9">between</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w10">all</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w11">axial</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w12">parallelism</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w13">devices.</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w14">Similar</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w15">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w16">Tensor</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w17">Parallelism,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w18">because</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w19">of</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w21">synchronized</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w22">communication</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w23">in</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w24">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w25">layer,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w26">communication</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w27">of</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w28">Dynamic</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w29">Axial</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w30">Parallelism</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w31">can</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w32">be</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w33">a</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w34">bottleneck.</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w35">So</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w36">we</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w37">design</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w38">and</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w39">implement</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w40">some</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w41">communication</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w42">optimization</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w43">strategies</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w44">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w45">reduce</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w46">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w47">overhead.
</span></p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w2">communication</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w4">synchronous</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w5">in</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w6">PyTorch.</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w7">Although</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w8">all</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w9">computation</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w10">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w11">communication</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w12">will</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w13">assign</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w14">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w15">different</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w16">CUDA</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w17">streams,</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w18">PyTorch</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w19">will</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w20">barrier</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w21">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w22">computation</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w23">stream</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w24">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w25">wait</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w26">for</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w27">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w28">completion</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w29">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w30">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w31">communication.</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w32">On</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w33">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w34">other</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w35">hand,</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w36">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w37">computation</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w38">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w39">straightforward</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w40">in</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w41">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w42">vanilla</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w43">Transformer</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w44">model,</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w45">so</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w46">there</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w47">is</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w48">no</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w49">opportunity</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w50">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w51">overlap</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w52">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w53">communication</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w54">in</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w55">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w56">transformer</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w57">layer,</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w58">such</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w59">as</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.1.w60">Megatron-LM</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><span class="gd_word" id="S4.SS3.p2.1.2.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.1.2.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.1.2.w3">DeepSpeed-MoE</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite><span class="gd_word" id="S4.SS3.p2.1.3.w1">.</span></p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p3.1.1.w1">While</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w2">in</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w3">AlphaFold,</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w4">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w5">have</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w6">two</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w7">representation</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w8">features</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w9">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w10">process,</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w11">which</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w12">give</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w13">us</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w14">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w15">opportunity</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w16">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w17">overlap</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w18">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w19">computation</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w20">and</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w21">communication.</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w22">And</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w23">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w24">overlap</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w25">will</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w26">affect</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w27">by</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w28">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w29">order</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w30">of</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w31">kernel</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w32">launch.</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w33">However,</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w34">in</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w35">dynamic-graph</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w36">Deep</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w37">learning</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w38">frameworks</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w39">like</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w40">PyTorch,</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w41">it’s</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w42">hard</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w43">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w44">explicitly</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w45">use</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w46">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w47">communication</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w48">interfaces</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w49">and</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w50">implement</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w51">corresponding</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w52">communication</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w53">in</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w54">backpropagation.</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w55">So</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w56">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w57">design</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w58">Duality</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w59">Async</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w60">Operation</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w61">for</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w62">PyTorch</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w63">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w64">implement</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w65">Communication</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w66">and</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w67">Computation</span><span> </span><span class="gd_word" id="S4.SS3.p3.1.1.w68">Overlap.</span></p>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p4.1.1.w1">Duality</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w2">Async</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w3">Operation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w5">shown</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w6">in</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.1.w7">Figure</span><span> </span><a href="#S4.F7" title="Fig. 7 ‣ IV-C Communication Optimization ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">7</a><span class="gd_word" id="S4.SS3.p4.1.2.w1">.</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w2">Duality</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w3">Async</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w4">Operation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w5">consists</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w6">of</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w7">a</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w8">pair</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w9">of</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w10">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w11">operators.</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w12">During</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w13">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w14">forward</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w15">propagation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w16">of</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w17">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w18">model,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w19">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w20">former</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w21">operator</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w22">triggers</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w23">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w24">communication,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w25">then</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w26">some</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w27">computation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w28">without</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w29">dependencies</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w30">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w31">performed</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w32">on</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w33">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w34">Computation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w35">Stream,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w36">and</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w37">then</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w38">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w39">latter</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w40">operator</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w41">blocks</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w42">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w43">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w44">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w45">until</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w46">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w47">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w48">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w49">completed,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w50">and</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w51">then</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w52">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w53">subsequent</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w54">computation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w55">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w56">performed.</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w57">When</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w58">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w59">model</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w60">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w61">propagated</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w62">backward,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w63">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w64">latter</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w65">operator</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w66">will</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w67">trigger</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w68">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w69">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w70">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w71">and</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w72">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w73">former</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w74">operator</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w75">will</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w76">block</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w77">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w78">communication.</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w79">We</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w80">observe</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w81">that</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w82">when</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w83">using</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w84">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w85">communication,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w86">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w87">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w88">task</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w89">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w90">carried</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w91">out</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w92">in</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w93">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w94">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w95">stream</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w96">while</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w97">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w98">Computation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w99">Stream</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w100">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w101">doing</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w102">some</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w103">non-dependent</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w104">computation</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w105">at</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w106">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w107">same</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w108">time,</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w109">so</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w110">the</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w111">communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w112">overhead</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w113">is</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w114">reduced</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w115">by</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w116">computation-communication</span><span> </span><span class="gd_word" id="S4.SS3.p4.1.2.w117">overlap.</span></p>
</div>
<figure id="S4.F7" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S4.F7.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 7: </span><span class="gd_word" id="S4.F7.2.w1">Asynchronous</span><span> </span><span class="gd_word" id="S4.F7.2.w2">with</span><span> </span><span class="gd_word" id="S4.F7.2.w3">Duality</span><span> </span><span class="gd_word" id="S4.F7.2.w4">Async</span><span> </span><span class="gd_word" id="S4.F7.2.w5">Operation.</span><span> </span><span class="gd_word" id="S4.F7.2.w6">Computation</span><span> </span><span class="gd_word" id="S4.F7.2.w7">and</span><span> </span><span class="gd_word" id="S4.F7.2.w8">communication</span><span> </span><span class="gd_word" id="S4.F7.2.w9">overlap</span><span> </span><span class="gd_word" id="S4.F7.2.w10">is</span><span> </span><span class="gd_word" id="S4.F7.2.w11">achieved</span><span> </span><span class="gd_word" id="S4.F7.2.w12">through</span><span> </span><span class="gd_word" id="S4.F7.2.w13">a</span><span> </span><span class="gd_word" id="S4.F7.2.w14">pair</span><span> </span><span class="gd_word" id="S4.F7.2.w15">of</span><span> </span><span class="gd_word" id="S4.F7.2.w16">communication</span><span> </span><span class="gd_word" id="S4.F7.2.w17">operators</span><span> </span><span class="gd_word" id="S4.F7.2.w18">that</span><span> </span><span class="gd_word" id="S4.F7.2.w19">trigger</span><span> </span><span class="gd_word" id="S4.F7.2.w20">and</span><span> </span><span class="gd_word" id="S4.F7.2.w21">block</span><span> </span><span class="gd_word" id="S4.F7.2.w22">asynchronous</span><span> </span><span class="gd_word" id="S4.F7.2.w23">communication</span><span> </span><span class="gd_word" id="S4.F7.2.w24">in</span><span> </span><span class="gd_word" id="S4.F7.2.w25">the</span><span> </span><span class="gd_word" id="S4.F7.2.w26">forward</span><span> </span><span class="gd_word" id="S4.F7.2.w27">and</span><span> </span><span class="gd_word" id="S4.F7.2.w28">backward.</span></figcaption>
</figure>
<div id="S4.SS3.p5" class="ltx_para">
<p id="S4.SS3.p5.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p5.1.1.w1">We</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w2">implement</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w3">Duality</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w4">Async</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w5">Operation</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w6">with</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w7">PyTorch</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w8">Autogard</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w9">Function</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w10">provided</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w11">by</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w12">PyTorch</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w13">automatic</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w14">differentiation</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w15">package.</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w16">PyTorch</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w17">Autogard</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w18">Function</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w19">provides</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w21">ability</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w22">to</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w23">define</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w24">the</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w25">forward</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w26">and</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w27">backward</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w28">independently.</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w29">We</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w30">accomplish</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w31">the</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w32">interoperation</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w33">by</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w34">passing</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w35">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w36">communication</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w37">requests</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w38">between</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w39">two</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w40">operators,</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w41">thus</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w42">enabling</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w43">triggering</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w44">and</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w45">blocking</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w46">of</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w47">the</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w48">asynchronous</span><span> </span><span class="gd_word" id="S4.SS3.p5.1.1.w49">communication.</span></p>
</div>
<figure id="S4.F8" class="ltx_figure">
<img src="/static/img/2203.00854/S4_F8.png" alt="/static/img/2203.00854/S4_F8.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 8: </span><span class="gd_word" id="S4.F8.2.w1">Fused</span><span> </span><span class="gd_word" id="S4.F8.2.w2">Softmax</span><span> </span><span class="gd_word" id="S4.F8.2.w3">Performance</span><span> </span><span class="gd_word" id="S4.F8.2.w4">on</span><span> </span><span class="gd_word" id="S4.F8.2.w5">NVIDIA</span><span> </span><span class="gd_word" id="S4.F8.2.w6">Telsa</span><span> </span><span class="gd_word" id="S4.F8.2.w7">A100.</span></figcaption>
</figure>
<figure id="S4.F9" class="ltx_figure">
<img src="/static/img/2203.00854/S4_F9.png" alt="/static/img/2203.00854/S4_F9.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 9: </span><span class="gd_word" id="S4.F9.2.w1">LayerNorm</span><span> </span><span class="gd_word" id="S4.F9.2.w2">Performance</span><span> </span><span class="gd_word" id="S4.F9.2.w3">on</span><span> </span><span class="gd_word" id="S4.F9.2.w4">NVIDIA</span><span> </span><span class="gd_word" id="S4.F9.2.w5">Telsa</span><span> </span><span class="gd_word" id="S4.F9.2.w6">A100.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span>Evaluations
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p"><span class="gd_word" id="S5.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S5.p1.1.1.w2">first</span><span> </span><span class="gd_word" id="S5.p1.1.1.w3">evaluated</span><span> </span><span class="gd_word" id="S5.p1.1.1.w4">performance</span><span> </span><span class="gd_word" id="S5.p1.1.1.w5">improvement</span><span> </span><span class="gd_word" id="S5.p1.1.1.w6">of</span><span> </span><span class="gd_word" id="S5.p1.1.1.w7">the</span><span> </span><span class="gd_word" id="S5.p1.1.1.w8">kernels</span><span> </span><span class="gd_word" id="S5.p1.1.1.w9">for</span><span> </span><span class="gd_word" id="S5.p1.1.1.w10">Evoformer,</span><span> </span><span class="gd_word" id="S5.p1.1.1.w11">and</span><span> </span><span class="gd_word" id="S5.p1.1.1.w12">then</span><span> </span><span class="gd_word" id="S5.p1.1.1.w13">end-to-end</span><span> </span><span class="gd_word" id="S5.p1.1.1.w14">training</span><span> </span><span class="gd_word" id="S5.p1.1.1.w15">and</span><span> </span><span class="gd_word" id="S5.p1.1.1.w16">inference</span><span> </span><span class="gd_word" id="S5.p1.1.1.w17">performance.</span><span> </span><span class="gd_word" id="S5.p1.1.1.w18">All</span><span> </span><span class="gd_word" id="S5.p1.1.1.w19">experiments</span><span> </span><span class="gd_word" id="S5.p1.1.1.w20">were</span><span> </span><span class="gd_word" id="S5.p1.1.1.w21">done</span><span> </span><span class="gd_word" id="S5.p1.1.1.w22">on</span><span> </span><span class="gd_word" id="S5.p1.1.1.w23">the</span><span> </span><span class="gd_word" id="S5.p1.1.1.w24">NVIDIA</span><span> </span><span class="gd_word" id="S5.p1.1.1.w25">Tesla</span><span> </span><span class="gd_word" id="S5.p1.1.1.w26">A100</span><span> </span><span class="gd_word" id="S5.p1.1.1.w27">platform.</span><span> </span><span class="gd_word" id="S5.p1.1.1.w28">The</span><span> </span><span class="gd_word" id="S5.p1.1.1.w29">baseline</span><span> </span><span class="gd_word" id="S5.p1.1.1.w30">is</span><span> </span><span class="gd_word" id="S5.p1.1.1.w31">the</span><span> </span><span class="gd_word" id="S5.p1.1.1.w32">official</span><span> </span><span class="gd_word" id="S5.p1.1.1.w33">implementation</span><span> </span><span class="gd_word" id="S5.p1.1.1.w34">of</span><span> </span><span class="gd_word" id="S5.p1.1.1.w35">AlphaFold</span><span> </span><span class="gd_word" id="S5.p1.1.1.w36">and</span><span> </span><span class="gd_word" id="S5.p1.1.1.w37">another</span><span> </span><span class="gd_word" id="S5.p1.1.1.w38">open-source</span><span> </span><span class="gd_word" id="S5.p1.1.1.w39">PyTorch</span><span> </span><span class="gd_word" id="S5.p1.1.1.w40">implementation</span><span> </span><span class="gd_word" id="S5.p1.1.1.w41">of</span><span> </span><span class="gd_word" id="S5.p1.1.1.w42">OpenFold</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite><span class="gd_word" id="S5.p1.1.2.w1">.</span><span> </span><span class="gd_word" id="S5.p1.1.2.w2">The</span><span> </span><span class="gd_word" id="S5.p1.1.2.w3">official</span><span> </span><span class="gd_word" id="S5.p1.1.2.w4">implementation</span><span> </span><span class="gd_word" id="S5.p1.1.2.w5">of</span><span> </span><span class="gd_word" id="S5.p1.1.2.w6">AlphaFold</span><span> </span><span class="gd_word" id="S5.p1.1.2.w7">has</span><span> </span><span class="gd_word" id="S5.p1.1.2.w8">only</span><span> </span><span class="gd_word" id="S5.p1.1.2.w9">the</span><span> </span><span class="gd_word" id="S5.p1.1.2.w10">inference</span><span> </span><span class="gd_word" id="S5.p1.1.2.w11">part,</span><span> </span><span class="gd_word" id="S5.p1.1.2.w12">while</span><span> </span><span class="gd_word" id="S5.p1.1.2.w13">OpenFold</span><span> </span><span class="gd_word" id="S5.p1.1.2.w14">reproduces</span><span> </span><span class="gd_word" id="S5.p1.1.2.w15">both</span><span> </span><span class="gd_word" id="S5.p1.1.2.w16">training</span><span> </span><span class="gd_word" id="S5.p1.1.2.w17">and</span><span> </span><span class="gd_word" id="S5.p1.1.2.w18">inference</span><span> </span><span class="gd_word" id="S5.p1.1.2.w19">according</span><span> </span><span class="gd_word" id="S5.p1.1.2.w20">to</span><span> </span><span class="gd_word" id="S5.p1.1.2.w21">the</span><span> </span><span class="gd_word" id="S5.p1.1.2.w22">original</span><span> </span><span class="gd_word" id="S5.p1.1.2.w23">AlphaFold</span><span> </span><span class="gd_word" id="S5.p1.1.2.w24">paper.</span></p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">V-A </span>Evoformer Performance
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.6" class="ltx_p"><span class="gd_word" id="S5.SS1.p1.6.1.w1">Figure</span><span> </span><a href="#S4.F8.sf1" title="(a) ‣ Fig. 8 ‣ IV-C Communication Optimization ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">8(a)</a><span class="gd_word" id="S5.SS1.p1.6.2.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.2.w2">and</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.2.w3">Figure</span><span> </span><a href="#S4.F9.sf1" title="(a) ‣ Fig. 9 ‣ IV-C Communication Optimization ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">9(a)</a><span class="gd_word" id="S5.SS1.p1.6.3.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w2">present</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w3">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w4">performance</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w5">comparisons</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w6">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w7">Fused</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w8">Softmax</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w9">and</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w10">LayerNorm,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w11">respectively.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w12">We</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w13">use</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w14">a</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w15">certain</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w16">range</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w17">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w18">problem</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w19">sizes</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w20">to</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w21">evaluate</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w22">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w23">latency</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w24">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w25">kernel</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w26">at</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w27">Bfloat16</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w28">precision.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w29">For</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w30">Fused</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w31">Softmax,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w32">we</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w33">compare</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w34">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w35">performance</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w36">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w37">PyTorch</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w38">native</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w39">kernel</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w40">and</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w41">FastFold</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w42">optimized</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w43">kernel.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w44">The</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w45">problem</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.3.w46">size</span><span> </span><math id="S5.SS1.p1.1.m1.2" class="ltx_Math" alttext="(X,Y)" display="inline"><semantics id="S5.SS1.p1.1.m1.2a"><mrow id="S5.SS1.p1.1.m1.2.3.2" xref="S5.SS1.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="S5.SS1.p1.1.m1.2.3.2.1" xref="S5.SS1.p1.1.m1.2.3.1.cmml">(</mo><mi id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml">X</mi><mo id="S5.SS1.p1.1.m1.2.3.2.2" xref="S5.SS1.p1.1.m1.2.3.1.cmml">,</mo><mi id="S5.SS1.p1.1.m1.2.2" xref="S5.SS1.p1.1.m1.2.2.cmml">Y</mi><mo stretchy="false" id="S5.SS1.p1.1.m1.2.3.2.3" xref="S5.SS1.p1.1.m1.2.3.1.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S5.SS1.p1.6.4.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w2">means</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w3">that</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w4">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w5">length</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w6">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w7">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w8">sequence</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w9">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w10">Attention</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w11">input</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.4.w12">is</span><span> </span><math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="X" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mi id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml">X</mi></semantics></math><span class="gd_word" id="S5.SS1.p1.6.5.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w2">and</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w3">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w4">hidden</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w5">size</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w6">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w7">Attention</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.5.w8">is</span><span> </span><math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="Y" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mi id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml">Y</mi></semantics></math><span class="gd_word" id="S5.SS1.p1.6.6.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w2">As</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w3">can</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w4">be</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w5">seen</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w6">from</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.6.w7">Figure</span><span> </span><a href="#S4.F8.sf1" title="(a) ‣ Fig. 8 ‣ IV-C Communication Optimization ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">8(a)</a><span class="gd_word" id="S5.SS1.p1.6.7.w1">,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w2">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w3">FastFold</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w4">kernel</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w5">can</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w6">achieve</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w7">a</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w8">performance</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w9">improvement</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.7.w10">of</span><span> </span><math id="S5.SS1.p1.4.m4.1" class="ltx_Math" alttext="1.77\sim 3.32\times" display="inline"><semantics id="S5.SS1.p1.4.m4.1a"><mrow id="S5.SS1.p1.4.m4.1b"><mn id="S5.SS1.p1.4.m4.1.1" xref="S5.SS1.p1.4.m4.1.1.cmml">1.77</mn><mo id="S5.SS1.p1.4.m4.1.2" xref="S5.SS1.p1.4.m4.1.2.cmml">∼</mo><mn id="S5.SS1.p1.4.m4.1.3" xref="S5.SS1.p1.4.m4.1.3.cmml">3.32</mn><mo id="S5.SS1.p1.4.m4.1.4" xref="S5.SS1.p1.4.m4.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS1.p1.6.8.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w2">For</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w3">LayerNorm,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w4">we</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w5">compare</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w6">not</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w7">only</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w8">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w9">PyTorch</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w10">native</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w11">kernel</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w12">but</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w13">also</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w14">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w15">highly</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w16">optimized</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w17">LayerNorm</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w18">kernel</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w19">from</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w20">NVIDIA</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.8.w21">Apex</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite><span class="gd_word" id="S5.SS1.p1.6.9.w1">.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.9.w2">According</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.9.w3">to</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.9.w4">Figure</span><span> </span><a href="#S4.F9.sf1" title="(a) ‣ Fig. 9 ‣ IV-C Communication Optimization ‣ IV Implementation and Optimization ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">9(a)</a><span class="gd_word" id="S5.SS1.p1.6.10.w1">,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w2">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w3">performance</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w4">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w5">FastFold</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w6">is</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w7">improved</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.10.w8">by</span><span> </span><math id="S5.SS1.p1.5.m5.1" class="ltx_Math" alttext="5.53\sim 8.65\times" display="inline"><semantics id="S5.SS1.p1.5.m5.1a"><mrow id="S5.SS1.p1.5.m5.1b"><mn id="S5.SS1.p1.5.m5.1.1" xref="S5.SS1.p1.5.m5.1.1.cmml">5.53</mn><mo id="S5.SS1.p1.5.m5.1.2" xref="S5.SS1.p1.5.m5.1.2.cmml">∼</mo><mn id="S5.SS1.p1.5.m5.1.3" xref="S5.SS1.p1.5.m5.1.3.cmml">8.65</mn><mo id="S5.SS1.p1.5.m5.1.4" xref="S5.SS1.p1.5.m5.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS1.p1.6.11.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.11.w2">and</span><span> </span><math id="S5.SS1.p1.6.m6.1" class="ltx_Math" alttext="1.20\sim 1.62\times" display="inline"><semantics id="S5.SS1.p1.6.m6.1a"><mrow id="S5.SS1.p1.6.m6.1b"><mn id="S5.SS1.p1.6.m6.1.1" xref="S5.SS1.p1.6.m6.1.1.cmml">1.20</mn><mo id="S5.SS1.p1.6.m6.1.2" xref="S5.SS1.p1.6.m6.1.2.cmml">∼</mo><mn id="S5.SS1.p1.6.m6.1.3" xref="S5.SS1.p1.6.m6.1.3.cmml">1.62</mn><mo id="S5.SS1.p1.6.m6.1.4" xref="S5.SS1.p1.6.m6.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS1.p1.6.12.w1"/><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w2">compared</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w3">to</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w4">PyTorch</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w5">and</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w6">Apex,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w7">respectively.</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w8">Because</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w9">of</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w10">our</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w11">special</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w12">optimization</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w13">for</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w14">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w15">limited</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w16">range,</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w17">FastFold</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w18">also</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w19">achieves</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w20">a</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w21">good</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w22">performance</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w23">improvement</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w24">over</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w25">the</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w26">highly</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w27">optimized</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w28">Apex</span><span> </span><span class="gd_word" id="S5.SS1.p1.6.12.w29">LayerNorm.</span></p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">V-B </span>End-to-End Training Performance
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS2.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w3">evaluation</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w4">of</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w5">End-to-End</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w6">Training</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w7">Performance,</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w8">we</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w9">use</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w10">the</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w11">training</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w12">parameters</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w13">from</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w14">the</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w15">official</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w16">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w17">paper</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w18">for</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w19">testing</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w20">as</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w21">much</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w22">as</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w23">possible.</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w24">This</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w25">allows</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w26">a</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w27">better</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w28">comparison</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w29">of</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w30">how</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w31">different</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w32">methods</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w33">or</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w34">implementations</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w35">work</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w36">on</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w37">real</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w38">training</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w39">scenarios.</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w40">All</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w41">training</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w42">experiments</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w43">are</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w44">done</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w45">on</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w46">a</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w47">128-node</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w48">GPU</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w49">supercomputer.</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w50">In</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w51">the</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w52">supercomputer,</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w53">each</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w54">node</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w55">includes</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w56">4</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w57">NVIDIA</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w58">Tesla</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w59">A100s</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w60">and</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w61">has</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w62">NVIDIA</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w63">NVLink</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w64">for</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w65">GPU</span><span> </span><span class="gd_word" id="S5.SS2.p1.1.1.w66">interconnects.</span></p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span class="gd_word" id="S5.SS2.p2.1.1.w1">Because</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w2">tensor</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w3">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w4">is</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w5">more</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w6">dependent</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w7">on</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w8">high-speed</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w9">interconnections</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w10">between</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w11">devices</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w12">for</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w13">communication,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w14">model</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w15">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w16">is</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w17">generally</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w18">used</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w19">within</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w20">nodes</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w21">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w22">data</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w23">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w24">between</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w25">nodes</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w26">during</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w27">training.</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w28">We</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w29">test</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w30">the</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w31">training</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w32">performance</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w33">of</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w34">the</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w35">model</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w36">at</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w37">two</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w38">levels,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w39">model</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w40">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w41">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w42">data</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w43">parallelism,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w44">respectively,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w45">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w46">the</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w47">results</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w48">are</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w49">shown</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w50">in</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.1.w51">Figure</span><span> </span><a href="#S5.F10" title="Fig. 10 ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">10</a><span class="gd_word" id="S5.SS2.p2.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS2.p2.1.2.w2">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.2.w3">Figure</span><span> </span><a href="#S5.F11" title="Fig. 11 ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">11</a><span class="gd_word" id="S5.SS2.p2.1.3.w1">.</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w2">For</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w3">model</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w4">parallelism,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w5">we</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w6">compare</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w7">the</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w8">scalability</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w9">of</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w10">two</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w11">parallel</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w12">methods,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w13">Tensor</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w14">Parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w15">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w16">Dynamic</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w17">Axial</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w18">Parallelism,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w19">under</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w20">two</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w21">training</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w22">settings,</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w23">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w24">Training</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w25">and</span><span> </span><span class="gd_word" id="S5.SS2.p2.1.3.w26">Fine-tuning.
</span></p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.1" class="ltx_p"><span class="gd_word" id="S5.SS2.p3.1.1.w1">For</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w2">model</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w3">parallelism,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w4">we</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w5">compared</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w6">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w7">scalability</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w8">of</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w9">two</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w10">parallel</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w11">methods,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w12">TP</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w13">and</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w14">DAP,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w15">under</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w16">two</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w17">training</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w18">settings,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w19">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w20">Training</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w21">and</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w22">Fine-tuning.</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w23">As</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w24">can</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w25">be</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w26">seen</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w27">in</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.1.w28">Figure</span><span> </span><a href="#S5.F10" title="Fig. 10 ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">10</a><span class="gd_word" id="S5.SS2.p3.1.2.w1">,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w2">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w3">scalability</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w4">of</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w5">DAP</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w6">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w7">significantly</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w8">better</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w9">than</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w10">TP</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w11">for</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w12">both</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w13">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w14">Training</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w15">and</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w16">Fine-tuning.</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w17">It</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w18">can</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w19">be</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w20">observed</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w21">that</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w22">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w23">scalability</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w24">of</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w25">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w26">Training</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w27">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w28">worse</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w29">because</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w30">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w31">sequence</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w32">length</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w33">of</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w34">residues</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w35">and</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w36">MSA</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w37">direction</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w38">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w39">smaller</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w40">in</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w41">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w42">Training,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w43">so</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w44">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w45">overhead</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w46">from</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w47">communication</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w48">will</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w49">be</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w50">more</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w51">obvious.</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w52">One</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w53">point</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w54">worth</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w55">noting</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w56">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w57">that</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w58">when</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w59">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w60">Training</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w61">scales</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w62">to</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w63">4</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w64">GPUs,</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w65">we</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w66">can</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w67">turn</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w68">off</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w69">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w70">activation</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w71">checkpoint</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w72">because</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w73">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w74">GPU</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w75">memory</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w76">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w77">sufficient.</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w78">The</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w79">performance</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w80">improvement</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w81">is</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w82">shown</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w83">in</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.2.w84">Figure</span><span> </span><a href="#S5.F10" title="Fig. 10 ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">10</a><span class="gd_word" id="S5.SS2.p3.1.3.w1"/><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w2">from</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w4">blue</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w5">dashed</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w6">line</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w7">to</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w8">the</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w9">blue</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w10">solid</span><span> </span><span class="gd_word" id="S5.SS2.p3.1.3.w11">line.</span></p>
</div>
<figure id="S5.F10" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S5.F10.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 10: </span><span class="gd_word" id="S5.F10.2.w1">Parallel</span><span> </span><span class="gd_word" id="S5.F10.2.w2">Efficiency</span><span> </span><span class="gd_word" id="S5.F10.2.w3">on</span><span> </span><span class="gd_word" id="S5.F10.2.w4">Model</span><span> </span><span class="gd_word" id="S5.F10.2.w5">Parallelism</span><span> </span><span class="gd_word" id="S5.F10.2.w6">Intra-node.</span></figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para">
<p id="S5.SS2.p4.1" class="ltx_p"><span class="gd_word" id="S5.SS2.p4.1.1.w1">For</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w2">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w3">parallelism,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w4">we</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w5">use</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w6">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w7">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w8">for</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w9">scaling</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w10">with</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w11">fixed</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w12">MP</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w13">settings.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w14">Following</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w15">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w16">settings</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w17">of</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w18">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w19">official</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w20">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w21">paper,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w22">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w23">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w24">scales</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w25">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w26">global</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w27">batch</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w28">size</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w29">to</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w30">128.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w31">In</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w32">Fine-tuning</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w33">training,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w34">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w35">computation</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w36">of</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w37">a</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w38">sample</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w39">is</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w40">scaled</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w41">to</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w42">a</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w43">full</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w44">node</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w45">(4</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w46">GPUs)</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w47">using</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w48">DAP,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w49">so</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w50">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w51">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w52">will</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w53">scale</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w54">from</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w55">1</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w56">to</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w57">128</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w58">nodes.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w59">In</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w60">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w61">Training,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w62">considering</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w63">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w64">scaling</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w65">efficiency,</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w66">DAP</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w67">is</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w68">only</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w69">scaled</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w70">to</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w71">half</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w72">nodes</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w73">(2</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w74">GPU</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w75">s),</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w76">so</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w77">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w78">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w79">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w80">will</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w81">be</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w82">scaled</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w83">to</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w84">64</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w85">nodes</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w86">only.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w87">The</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w88">scaling</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w89">results</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w90">are</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w91">shown</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w92">in</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.1.w93">Figure</span><span> </span><a href="#S5.F11" title="Fig. 11 ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">11</a><span class="gd_word" id="S5.SS2.p4.1.2.w1">.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w2">It</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w3">can</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w4">be</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w5">seen</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w6">that</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w7">for</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w8">data</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w9">parallelism</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w10">basically</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w11">scales</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w12">linearly.</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w13">the</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w14">scaling</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w15">efficiency</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w16">of</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w17">Fine-tuning</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w18">training</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w19">reaches</span><span> </span><span class="gd_word" id="S5.SS2.p4.1.2.w20">90.1%.</span></p>
</div>
<figure id="S5.F11" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S5.F11.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 11: </span><span class="gd_word" id="S5.F11.2.w1">Parallel</span><span> </span><span class="gd_word" id="S5.F11.2.w2">Efficiency</span><span> </span><span class="gd_word" id="S5.F11.2.w3">on</span><span> </span><span class="gd_word" id="S5.F11.2.w4">Data</span><span> </span><span class="gd_word" id="S5.F11.2.w5">Parallelism</span><span> </span><span class="gd_word" id="S5.F11.2.w6">Inter-node.</span></figcaption>
</figure>
<figure id="S5.T4" class="ltx_table">
<img src="/static/img/2203.00854-gpt-3.5-turbo-16k/S5_T4.png" alt="/static/img/2203.00854-gpt-3.5-turbo-16k/S5_T4.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE IV: </span><span class="gd_word" id="S5.T4.2.w1">Resource</span><span> </span><span class="gd_word" id="S5.T4.2.w2">and</span><span> </span><span class="gd_word" id="S5.T4.2.w3">Time</span><span> </span><span class="gd_word" id="S5.T4.2.w4">Cost</span><span> </span><span class="gd_word" id="S5.T4.2.w5">Compare.</span></figcaption>
</figure>
<div id="S5.SS2.p5" class="ltx_para">
<p id="S5.SS2.p5.1" class="ltx_p"><span class="gd_word" id="S5.SS2.p5.1.1.w1">Based</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w2">on</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w4">results</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w5">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w6">our</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w7">evaluations</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w8">on</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w9">training</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w10">performance,</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w11">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w12">overall</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w13">time</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w14">and</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w15">economic</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w16">cost</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w17">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w18">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w19">can</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w20">be</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w21">extrapolated.</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w22">Based</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w23">on</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w24">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w25">results</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w26">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w27">our</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w28">tests</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w29">on</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w30">training</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w31">performance,</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w32">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w33">overall</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w34">time</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w35">and</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w36">economic</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w37">cost</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w38">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w39">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w40">can</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w41">be</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w42">extrapolated.</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.1.w43">Table</span><span> </span><a href="#S5.T4" title="TABLE IV ‣ V-B End-to-End Training Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">IV</a><span class="gd_word" id="S5.SS2.p5.1.2.w1"/><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w2">lists</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w3">and</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w4">compares</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w5">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w6">time</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w7">and</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w8">economic</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w9">costs</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w10">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w11">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w12">three</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w13">implementations</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w14">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w15">AlphaFold,</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w16">OpenFold,</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w17">and</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w18">FastFold.</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w19">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w20">does</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w21">not</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w22">have</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w23">a</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w24">publicly</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w25">available</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w26">training</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w27">code,</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w28">so</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w29">the</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w30">data</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w31">of</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w32">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w33">is</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w34">derived</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w35">from</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w36">official</span><span> </span><span class="gd_word" id="S5.SS2.p5.1.2.w37">papers.</span></p>
</div>
<div id="S5.SS2.p6" class="ltx_para">
<p id="S5.SS2.p6.3" class="ltx_p"><span class="gd_word" id="S5.SS2.p6.3.1.w1">Considering</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w2">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w3">time</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w4">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w5">economic</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w6">cost,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w7">we</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w8">chose</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w9">to</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.1.w10">use</span><span> </span><math id="S5.SS2.p6.1.m1.1" class="ltx_Math" alttext="256\times A100" display="inline"><semantics id="S5.SS2.p6.1.m1.1a"><mrow id="S5.SS2.p6.1.m1.1.1" xref="S5.SS2.p6.1.m1.1.1.cmml"><mrow id="S5.SS2.p6.1.m1.1.1.2" xref="S5.SS2.p6.1.m1.1.1.2.cmml"><mn id="S5.SS2.p6.1.m1.1.1.2.2" xref="S5.SS2.p6.1.m1.1.1.2.2.cmml">256</mn><mo id="S5.SS2.p6.1.m1.1.1.2.1" xref="S5.SS2.p6.1.m1.1.1.2.1.cmml">×</mo><mi id="S5.SS2.p6.1.m1.1.1.2.3" xref="S5.SS2.p6.1.m1.1.1.2.3.cmml">A</mi></mrow><mo id="S5.SS2.p6.1.m1.1.1.1" xref="S5.SS2.p6.1.m1.1.1.1.cmml">⁢</mo><mn id="S5.SS2.p6.1.m1.1.1.3" xref="S5.SS2.p6.1.m1.1.1.3.cmml">100</mn></mrow></semantics></math><span class="gd_word" id="S5.SS2.p6.3.2.w1"/><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w2">for</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w3">Initial</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w4">Training</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w5">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w6">then</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w7">scale</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.2.w8">to</span><span> </span><math id="S5.SS2.p6.2.m2.1" class="ltx_Math" alttext="512\times A100" display="inline"><semantics id="S5.SS2.p6.2.m2.1a"><mrow id="S5.SS2.p6.2.m2.1.1" xref="S5.SS2.p6.2.m2.1.1.cmml"><mrow id="S5.SS2.p6.2.m2.1.1.2" xref="S5.SS2.p6.2.m2.1.1.2.cmml"><mn id="S5.SS2.p6.2.m2.1.1.2.2" xref="S5.SS2.p6.2.m2.1.1.2.2.cmml">512</mn><mo id="S5.SS2.p6.2.m2.1.1.2.1" xref="S5.SS2.p6.2.m2.1.1.2.1.cmml">×</mo><mi id="S5.SS2.p6.2.m2.1.1.2.3" xref="S5.SS2.p6.2.m2.1.1.2.3.cmml">A</mi></mrow><mo id="S5.SS2.p6.2.m2.1.1.1" xref="S5.SS2.p6.2.m2.1.1.1.cmml">⁢</mo><mn id="S5.SS2.p6.2.m2.1.1.3" xref="S5.SS2.p6.2.m2.1.1.3.cmml">100</mn></mrow></semantics></math><span class="gd_word" id="S5.SS2.p6.3.3.w1"/><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w2">during</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w3">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w4">Fine-tuning</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w5">phase.</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w6">Based</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w7">on</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w8">this</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w9">setting,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w10">FastFold</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w11">can</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w12">reduce</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w13">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w14">training</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w15">time</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w16">to</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w17">2.81</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w18">days.</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w19">Compared</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w20">with</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w21">AlphaFold,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w22">which</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w23">requires</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w24">11</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w25">days</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w26">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w27">training,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w28">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w29">time</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w30">cost</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w31">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w32">training</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w33">is</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w34">reduced</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w35">by</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w36">3.91</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w37">times.</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w38">Compared</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w39">with</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w40">OpenFold,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w41">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w42">time</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w43">cost</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w44">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w45">training</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w46">is</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w47">reduced</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w48">by</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w49">2.98</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w50">times,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w51">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w52">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w53">economic</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w54">cost</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w55">is</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w56">reduced</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w57">by</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w58">20%.</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w59">In</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w60">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w61">Fine-tuning</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w62">phase,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w63">FastFold</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w64">achieved</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w65">aggregate</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w66">6.02</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w67">PetaFLOPs</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.3.w68">with</span><span> </span><math id="S5.SS2.p6.3.m3.1" class="ltx_Math" alttext="512\times A100" display="inline"><semantics id="S5.SS2.p6.3.m3.1a"><mrow id="S5.SS2.p6.3.m3.1.1" xref="S5.SS2.p6.3.m3.1.1.cmml"><mrow id="S5.SS2.p6.3.m3.1.1.2" xref="S5.SS2.p6.3.m3.1.1.2.cmml"><mn id="S5.SS2.p6.3.m3.1.1.2.2" xref="S5.SS2.p6.3.m3.1.1.2.2.cmml">512</mn><mo id="S5.SS2.p6.3.m3.1.1.2.1" xref="S5.SS2.p6.3.m3.1.1.2.1.cmml">×</mo><mi id="S5.SS2.p6.3.m3.1.1.2.3" xref="S5.SS2.p6.3.m3.1.1.2.3.cmml">A</mi></mrow><mo id="S5.SS2.p6.3.m3.1.1.1" xref="S5.SS2.p6.3.m3.1.1.1.cmml">⁢</mo><mn id="S5.SS2.p6.3.m3.1.1.3" xref="S5.SS2.p6.3.m3.1.1.3.cmml">100</mn></mrow></semantics></math><span class="gd_word" id="S5.SS2.p6.3.4.w1">.</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w2">With</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w3">such</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w4">a</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w5">significant</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w6">reduction</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w7">in</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w8">time</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w9">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w10">economic</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w11">costs,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w12">FastFold</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w13">makes</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w14">training</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w15">a</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w16">protein</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w17">structure</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w18">prediction</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w19">model</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w20">faster</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w21">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w22">cheaper,</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w23">which</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w24">will</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w25">drive</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w26">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w27">efficiency</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w28">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w29">research</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w30">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w31">development</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w32">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w33">related</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w34">models</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w35">and</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w36">facilitate</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w37">the</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w38">development</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w39">of</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w40">Evoformer-based</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w41">protein</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w42">structure</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w43">prediction</span><span> </span><span class="gd_word" id="S5.SS2.p6.3.4.w44">models.</span></p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">V-C </span>End-to-End Inference Performance
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS3.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w2">compare</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w3">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w4">inference</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w5">performance</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w6">of</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w7">FastFold,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w8">OpenFold,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w9">and</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w10">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w11">implementations</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w12">in</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w13">three</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w14">scenarios:</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w15">short</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w16">sequence,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w17">long</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w18">sequence,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w19">and</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w20">extremely</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w21">long</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w22">sequence.</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w23">All</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w24">inference</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w25">experiments</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w26">are</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w27">done</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w28">on</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w29">a</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w30">GPU</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w31">server</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w32">consisting</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w33">of</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w34">8</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w35">NVIDIA</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w36">A100s</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w37">(with</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w38">NVLink).</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w39">In</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w40">practical</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w41">inference</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w42">scenarios</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w43">with</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w44">AlphaFold,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w45">it</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w46">is</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w47">generally</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w48">necessary</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w49">to</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w50">infer</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w51">multiple</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w52">models</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w53">and</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w54">ensemble</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w55">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w56">results</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w57">to</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w58">improve</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w59">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w60">accuracy</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w61">of</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w62">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w63">prediction</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w64">results.</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w65">Since</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w66">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w67">performance</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w68">characteristics</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w69">of</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w70">multiple</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w71">models</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w72">are</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w73">consistent,</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w74">all</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w75">our</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w76">experiments</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w77">on</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w78">inference</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w79">performance</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w80">only</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w81">evaluate</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w82">the</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w83">inference</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w84">performance</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w85">of</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w86">a</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w87">single</span><span> </span><span class="gd_word" id="S5.SS3.p1.1.1.w88">model.</span></p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.3" class="ltx_p"><span class="gd_word" id="S5.SS3.p2.3.1.w1">For</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w2">short</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w3">sequences,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w4">typically</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w5">amino</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w6">acid</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w7">sequences</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w8">are</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w9">no</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w10">more</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w11">than</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w12">1K</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w13">in</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w14">length,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w15">and</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w16">single</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w17">model</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w18">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w19">takes</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w20">from</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w21">a</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w22">few</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w23">seconds</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w24">to</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w25">about</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w26">a</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w27">minute.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w28">At</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w29">this</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w30">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w31">range,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w32">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w33">video</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w34">memory</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w35">consumption</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w36">is</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w37">relatively</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w38">small</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w39">and</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w40">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w41">efficiency</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w42">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w43">using</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w44">distributed</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w45">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w46">would</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w47">be</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w48">lower.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w49">So</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w50">we</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w51">compared</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w52">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w53">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w54">latency</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w55">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w56">three</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w57">implementations</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w58">on</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w59">1</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w60">GPU,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w61">and</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w62">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w63">results</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w64">are</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w65">shown</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w66">in</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.1.w67">Figure</span><span> </span><a href="#S5.F12" title="Fig. 12 ‣ V-C End-to-End Inference Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">12</a><span class="gd_word" id="S5.SS3.p2.3.2.w1">.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w2">In</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w3">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w4">scenario</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w5">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w6">short</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w7">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w8">inference,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w9">FastFold’s</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w10">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w11">performance</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w12">is</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w13">improved</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.2.w14">by</span><span> </span><math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="2.01\sim 4.05\times" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mrow id="S5.SS3.p2.1.m1.1b"><mn id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">2.01</mn><mo id="S5.SS3.p2.1.m1.1.2" xref="S5.SS3.p2.1.m1.1.2.cmml">∼</mo><mn id="S5.SS3.p2.1.m1.1.3" xref="S5.SS3.p2.1.m1.1.3.cmml">4.05</mn><mo id="S5.SS3.p2.1.m1.1.4" xref="S5.SS3.p2.1.m1.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS3.p2.3.3.w1"/><span> </span><span class="gd_word" id="S5.SS3.p2.3.3.w2">and</span><span> </span><math id="S5.SS3.p2.2.m2.1" class="ltx_Math" alttext="1.25\sim 2.11\times" display="inline"><semantics id="S5.SS3.p2.2.m2.1a"><mrow id="S5.SS3.p2.2.m2.1b"><mn id="S5.SS3.p2.2.m2.1.1" xref="S5.SS3.p2.2.m2.1.1.cmml">1.25</mn><mo id="S5.SS3.p2.2.m2.1.2" xref="S5.SS3.p2.2.m2.1.2.cmml">∼</mo><mn id="S5.SS3.p2.2.m2.1.3" xref="S5.SS3.p2.2.m2.1.3.cmml">2.11</mn><mo id="S5.SS3.p2.2.m2.1.4" xref="S5.SS3.p2.2.m2.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS3.p2.3.4.w1"/><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w2">compared</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w3">to</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w4">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w5">and</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w6">OpenFold,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w7">respectively.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w8">The</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w9">performance</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w10">benefits</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w11">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w12">FastFold</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w13">are</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w14">mainly</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w15">due</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w16">to</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w17">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w18">highly</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w19">optimized</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w20">CUDA</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w21">Kernel</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w22">implementation.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w23">It</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w24">is</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w25">worth</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w26">noting</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w27">that</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w28">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w29">performance</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w30">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w31">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w32">is</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w33">lower</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w34">on</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w35">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w36">GPU</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w37">platform</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w38">because</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w39">it</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w40">uses</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w41">JAX,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w42">which</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w43">has</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w44">better</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w45">support</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w46">for</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w47">Google</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w48">TPU,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w49">and</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w50">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w51">computational</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w52">performance</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w53">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w54">JAX</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w55">on</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w56">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w57">GPU</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w58">platform</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w59">may</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w60">not</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w61">be</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w62">optimal.</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w63">And</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w64">in</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w65">addition</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w66">to</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w67">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w68">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w69">time,</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w70">it</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.4.w71">takes</span><span> </span><math id="S5.SS3.p2.3.m3.1" class="ltx_Math" alttext="50\sim 150" display="inline"><semantics id="S5.SS3.p2.3.m3.1a"><mrow id="S5.SS3.p2.3.m3.1.1" xref="S5.SS3.p2.3.m3.1.1.cmml"><mn id="S5.SS3.p2.3.m3.1.1.2" xref="S5.SS3.p2.3.m3.1.1.2.cmml">50</mn><mo id="S5.SS3.p2.3.m3.1.1.1" xref="S5.SS3.p2.3.m3.1.1.1.cmml">∼</mo><mn id="S5.SS3.p2.3.m3.1.1.3" xref="S5.SS3.p2.3.m3.1.1.3.cmml">150</mn></mrow></semantics></math><span class="gd_word" id="S5.SS3.p2.3.5.w1"/><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w2">seconds</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w3">to</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w4">compile</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w5">kernel</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w6">during</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w7">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w8">inference</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w9">of</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w10">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w11">when</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w12">using</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w13">the</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w14">JAX</span><span> </span><span class="gd_word" id="S5.SS3.p2.3.5.w15">framework.</span></p>
</div>
<figure id="S5.F12" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S5.F12.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 12: </span><span class="gd_word" id="S5.F12.2.w1">Comparison</span><span> </span><span class="gd_word" id="S5.F12.2.w2">of</span><span> </span><span class="gd_word" id="S5.F12.2.w3">inference</span><span> </span><span class="gd_word" id="S5.F12.2.w4">latency</span><span> </span><span class="gd_word" id="S5.F12.2.w5">for</span><span> </span><span class="gd_word" id="S5.F12.2.w6">short</span><span> </span><span class="gd_word" id="S5.F12.2.w7">sequences.</span></figcaption>
</figure>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.2" class="ltx_p"><span class="gd_word" id="S5.SS3.p3.2.1.w1">For</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w2">long</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w3">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w4">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w5">with</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w6">amino</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w7">acid</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w8">sequences</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w9">of</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w10">1K</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w11">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w12">2.5K</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w13">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w14">length,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w15">direct</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w16">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w17">already</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w18">encounters</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w19">memory</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w20">capacity</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w21">problems</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w22">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w23">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w24">times</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w25">of</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w26">several</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w27">minutes</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w28">or</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w29">even</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w30">tens</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w31">of</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w32">minutes.</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w33">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w34">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w35">OpenFold</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w36">need</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w37">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w38">use</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w39">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w40">chunking</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w41">technique</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w42">for</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w43">inference,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w44">that</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w45">is,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w46">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w47">a</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w48">single</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w49">operator,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w50">chunks</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w51">are</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w52">divided</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w53">along</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w54">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w55">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w56">dimension</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w57">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w58">then</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w59">computed</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w60">sequentially.</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w61">The</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w62">chunking</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w63">technique</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w64">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w65">effectively</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w66">reduce</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w67">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w68">memory</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w69">consumption</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w70">during</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w71">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w72">computation,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w73">but</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w74">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w75">a</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w76">certain</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w77">extent,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w78">it</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w79">will</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w80">reduce</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w81">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w82">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w83">performance.</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w84">For</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w85">FastFold,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w86">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w87">distributed</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w88">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w89">method</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w90">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w91">be</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w92">used</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w93">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w94">reduce</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w95">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w96">memory</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w97">capacity</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w98">requirement</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w99">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w100">significantly</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w101">shorten</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w102">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w103">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w104">time.</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w105">As</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w106">shown</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w107">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.1.w108">Figure</span><span> </span><a href="#S5.F13" title="Fig. 13 ‣ V-C End-to-End Inference Performance ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">13</a><span class="gd_word" id="S5.SS3.p3.2.2.w1">,</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w2">FastFold</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w3">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w4">reduce</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w5">inference</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w6">time</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.2.w7">by</span><span> </span><math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="7.5\sim 9.5\times" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1b"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">7.5</mn><mo id="S5.SS3.p3.1.m1.1.2" xref="S5.SS3.p3.1.m1.1.2.cmml">∼</mo><mn id="S5.SS3.p3.1.m1.1.3" xref="S5.SS3.p3.1.m1.1.3.cmml">9.5</mn><mo id="S5.SS3.p3.1.m1.1.4" xref="S5.SS3.p3.1.m1.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS3.p3.2.3.w1"/><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w2">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w3">comparison</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w4">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w5">OpenFold</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w6">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.3.w7">by</span><span> </span><math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="9.3\sim 11.6\times" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1b"><mn id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">9.3</mn><mo id="S5.SS3.p3.2.m2.1.2" xref="S5.SS3.p3.2.m2.1.2.cmml">∼</mo><mn id="S5.SS3.p3.2.m2.1.3" xref="S5.SS3.p3.2.m2.1.3.cmml">11.6</mn><mo id="S5.SS3.p3.2.m2.1.4" xref="S5.SS3.p3.2.m2.1.4.cmml">×</mo></mrow></semantics></math><span class="gd_word" id="S5.SS3.p3.2.4.w1"/><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w2">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w3">comparison</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w4">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w5">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w6">when</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w7">using</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w8">distributed</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w9">inference.</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w10">We</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w11">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w12">see</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w13">that</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w14">Dynamic</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w15">Axial</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w16">Parallelism</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w17">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w18">scale</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w19">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w20">more</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w21">GPUs</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w22">(Tensor</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w23">Parallelism</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w24">can</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w25">only</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w26">scale</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w27">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w28">4</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w29">GPUs</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w30">due</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w31">to</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w32">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w33">limitations</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w34">mentioned</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w35">in</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w36">section</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w37">IV.B),</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w38">and</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w39">the</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w40">overall</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w41">scaling</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w42">efficiency</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w43">is</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w44">significantly</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w45">better</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w46">than</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w47">Tensor</span><span> </span><span class="gd_word" id="S5.SS3.p3.2.4.w48">Parallelism.</span></p>
</div>
<figure id="S5.F13" class="ltx_figure">
<img src="/static/img/2203.00854/S5_F13.png" alt="/static/img/2203.00854/S5_F13.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 13: </span><span class="gd_word" id="S5.F13.2.w1">Comparison</span><span> </span><span class="gd_word" id="S5.F13.2.w2">of</span><span> </span><span class="gd_word" id="S5.F13.2.w3">inference</span><span> </span><span class="gd_word" id="S5.F13.2.w4">performance</span><span> </span><span class="gd_word" id="S5.F13.2.w5">for</span><span> </span><span class="gd_word" id="S5.F13.2.w6">long</span><span> </span><span class="gd_word" id="S5.F13.2.w7">sequences.</span></figcaption>
</figure>
<div id="S5.SS3.p4" class="ltx_para">
<p id="S5.SS3.p4.1" class="ltx_p"><span class="gd_word" id="S5.SS3.p4.1.1.w1">For</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w2">inference</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w3">with</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w4">extremely</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w5">long</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w6">sequences</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w7">over</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w8">3k</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w9">in</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w10">length,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w11">even</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w12">with</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w13">chunk</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w14">technology,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w15">the</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w16">limit</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w17">of</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w18">the</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w19">single</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w20">GPU’s</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w21">memory</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w22">capacity</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w23">is</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w24">exceeded.</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w25">As</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w26">shown</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w27">in</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w28">Table</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w29">3,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w30">for</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w31">both</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w32">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w33">and</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w34">OpenFold,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w35">Out</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w36">of</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w37">Memory</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w38">(OOM)</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w39">occurs</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w40">when</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w41">the</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w42">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w43">length</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w44">reaches</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w45">3K.</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w46">However,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w47">for</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w48">FastFold,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w49">because</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w50">of</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w51">distributed</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w52">inference,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w53">more</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w54">computation</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w55">and</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w56">memory</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w57">of</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w58">the</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w59">GPU</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w60">can</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w61">be</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w62">utilized</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w63">to</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w64">accomplish</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w65">extremely</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w66">long</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w67">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w68">inference.</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w69">Moreover,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w70">for</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w71">sequences</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w72">of</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w73">up</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w74">to</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w75">4K</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w76">in</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w77">length,</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w78">The</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w79">inference</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w80">latency</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w81">FastFold</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w82">is</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w83">within</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w84">10</span><span> </span><span class="gd_word" id="S5.SS3.p4.1.1.w85">minutes.
</span></p>
</div>
<figure id="S5.T5" class="ltx_table">
<img src="/static/img/2203.00854-gpt-3.5-turbo-16k/S5_T5.png" alt="/static/img/2203.00854-gpt-3.5-turbo-16k/S5_T5.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE V: </span><span class="gd_word" id="S5.T5.2.w1">Inference</span><span> </span><span class="gd_word" id="S5.T5.2.w2">Latency</span><span> </span><span class="gd_word" id="S5.T5.2.w3">for</span><span> </span><span class="gd_word" id="S5.T5.2.w4">Extremely</span><span> </span><span class="gd_word" id="S5.T5.2.w5">Long</span><span> </span><span class="gd_word" id="S5.T5.2.w6">Sequence</span><span> </span><span class="gd_word" id="S5.T5.2.w7">(s).</span></figcaption>
</figure>
<div id="S5.SS3.p5" class="ltx_para">
<p id="S5.SS3.p5.1" class="ltx_p"><span class="gd_word" id="S5.SS3.p5.1.1.w1">FastFold</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w2">can</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w3">significantly</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w4">reduce</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w5">inference</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w6">time</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w7">and</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w8">economic</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w9">cost</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w10">for</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w11">inference</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w12">of</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w13">different</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w14">sequence</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w15">lengths,</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w16">and</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w17">enable</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w18">protein</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w19">structure</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w20">prediction</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w21">of</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w22">ultra-long</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w23">sequences.</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w24">fastFold</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w25">can</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w26">support</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w27">large-scale</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w28">high-throughput</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w29">protein</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w30">structure</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w31">prediction</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w32">tasks,</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w33">which</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w34">will</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w35">greatly</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w36">promote</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w37">the</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w38">application</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w39">scenarios</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w40">of</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w41">protein</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w42">structure</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w43">prediction</span><span> </span><span class="gd_word" id="S5.SS3.p5.1.1.w44">models.</span></p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">V-D </span>Validation
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p"><span class="gd_word" id="S5.SS4.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w2">validated</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w3">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w4">correctness</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w5">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w6">FastFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w7">by</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w8">comparing</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w9">inference</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w10">results</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w11">with</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w12">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w13">official</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w14">implementation</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w15">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w16">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w17">from</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w18">Google</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w19">DeepMind.</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w20">From</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w21">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w22">point</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w23">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w24">view</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w25">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w26">theoretical</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w27">analysis,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w28">neither</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w29">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w30">optimization</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w31">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w32">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w33">kernel</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w34">nor</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w35">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w36">parallel</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w37">strategy</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w38">will</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w39">change</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w40">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w41">structure</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w42">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w43">results</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w44">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w45">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w46">computation.</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w47">However,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w48">because</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w49">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w50">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w51">introduction</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w52">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w53">some</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w54">custom</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w55">CUDA</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w56">Kernel,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w57">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w58">different</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w59">calculation</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w60">methods</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w61">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w62">orders</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w63">will</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w64">lead</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w65">to</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w66">certain</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w67">precision</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w68">errors.</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w69">To</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w70">demonstrate</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w71">that</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w72">FastFold’s</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w73">prediction</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w74">is</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w75">as</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w76">expected,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w77">we</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w78">use</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w79">both</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w80">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w81">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w82">FastFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w83">to</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w84">predict</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w85">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w86">same</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w87">amino</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w88">acid</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w89">sequence,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w90">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w91">visualize</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w92">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w93">inference</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w94">results</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w95">for</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w96">comparison.</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w97">The</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w98">results</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w99">are</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w100">shown</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w101">in</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.1.w102">Figure</span><span> </span><a href="#S5.F14" title="Fig. 14 ‣ V-D Validation ‣ V Evaluations ‣ FastFold: Reducing AlphaFold Training Time from 11 Days to 67 Hours" class="ltx_ref">14</a><span class="gd_word" id="S5.SS4.p1.1.2.w1">,</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w2">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w3">it</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w4">can</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w5">be</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w6">seen</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w7">that</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w8">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w9">protein</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w10">structures</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w11">predicted</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w12">by</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w13">FastFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w14">and</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w15">the</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w16">results</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w17">of</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w18">AlphaFold</span><span> </span><span class="gd_word" id="S5.SS4.p1.1.2.w19">match.</span></p>
</div>
<figure id="S5.F14" class="ltx_figure"><img src="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" id="S5.F14.g1" class="ltx_graphics ltx_centering" alt="/static/img/2203.00854-gpt-3.5-turbo-16k//static/img/2203.00854/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Fig. 14: </span><span class="gd_word" id="S5.F14.2.w1">Protein</span><span> </span><span class="gd_word" id="S5.F14.2.w2">structure</span><span> </span><span class="gd_word" id="S5.F14.2.w3">prediction</span><span> </span><span class="gd_word" id="S5.F14.2.w4">results</span><span> </span><span class="gd_word" id="S5.F14.2.w5">of</span><span> </span><span class="gd_word" id="S5.F14.2.w6">AlphaFold</span><span> </span><span class="gd_word" id="S5.F14.2.w7">and</span><span> </span><span class="gd_word" id="S5.F14.2.w8">FastFold.</span></figcaption>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span>Related Work
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p"><span class="gd_word" id="S6.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="S6.p1.1.1.w2">optimization</span><span> </span><span class="gd_word" id="S6.p1.1.1.w3">of</span><span> </span><span class="gd_word" id="S6.p1.1.1.w4">protein</span><span> </span><span class="gd_word" id="S6.p1.1.1.w5">structure</span><span> </span><span class="gd_word" id="S6.p1.1.1.w6">prediction</span><span> </span><span class="gd_word" id="S6.p1.1.1.w7">model</span><span> </span><span class="gd_word" id="S6.p1.1.1.w8">training</span><span> </span><span class="gd_word" id="S6.p1.1.1.w9">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w10">inference</span><span> </span><span class="gd_word" id="S6.p1.1.1.w11">has</span><span> </span><span class="gd_word" id="S6.p1.1.1.w12">rarely</span><span> </span><span class="gd_word" id="S6.p1.1.1.w13">been</span><span> </span><span class="gd_word" id="S6.p1.1.1.w14">studied.</span><span> </span><span class="gd_word" id="S6.p1.1.1.w15">ParaFold</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite><span class="gd_word" id="S6.p1.1.2.w1"/><span> </span><span class="gd_word" id="S6.p1.1.2.w2">is</span><span> </span><span class="gd_word" id="S6.p1.1.2.w3">an</span><span> </span><span class="gd_word" id="S6.p1.1.2.w4">optimized</span><span> </span><span class="gd_word" id="S6.p1.1.2.w5">system</span><span> </span><span class="gd_word" id="S6.p1.1.2.w6">for</span><span> </span><span class="gd_word" id="S6.p1.1.2.w7">AlphaFold</span><span> </span><span class="gd_word" id="S6.p1.1.2.w8">inference</span><span> </span><span class="gd_word" id="S6.p1.1.2.w9">on</span><span> </span><span class="gd_word" id="S6.p1.1.2.w10">heterogeneous</span><span> </span><span class="gd_word" id="S6.p1.1.2.w11">platforms.</span><span> </span><span class="gd_word" id="S6.p1.1.2.w12">The</span><span> </span><span class="gd_word" id="S6.p1.1.2.w13">main</span><span> </span><span class="gd_word" id="S6.p1.1.2.w14">contribution</span><span> </span><span class="gd_word" id="S6.p1.1.2.w15">is</span><span> </span><span class="gd_word" id="S6.p1.1.2.w16">in</span><span> </span><span class="gd_word" id="S6.p1.1.2.w17">optimizing</span><span> </span><span class="gd_word" id="S6.p1.1.2.w18">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w19">data</span><span> </span><span class="gd_word" id="S6.p1.1.2.w20">processing</span><span> </span><span class="gd_word" id="S6.p1.1.2.w21">flow,</span><span> </span><span class="gd_word" id="S6.p1.1.2.w22">including</span><span> </span><span class="gd_word" id="S6.p1.1.2.w23">data</span><span> </span><span class="gd_word" id="S6.p1.1.2.w24">processing</span><span> </span><span class="gd_word" id="S6.p1.1.2.w25">for</span><span> </span><span class="gd_word" id="S6.p1.1.2.w26">multi-threaded</span><span> </span><span class="gd_word" id="S6.p1.1.2.w27">parallelism</span><span> </span><span class="gd_word" id="S6.p1.1.2.w28">on</span><span> </span><span class="gd_word" id="S6.p1.1.2.w29">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w30">CPU</span><span> </span><span class="gd_word" id="S6.p1.1.2.w31">platform.</span><span> </span><span class="gd_word" id="S6.p1.1.2.w32">While</span><span> </span><span class="gd_word" id="S6.p1.1.2.w33">FastFold</span><span> </span><span class="gd_word" id="S6.p1.1.2.w34">focuses</span><span> </span><span class="gd_word" id="S6.p1.1.2.w35">on</span><span> </span><span class="gd_word" id="S6.p1.1.2.w36">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w37">training</span><span> </span><span class="gd_word" id="S6.p1.1.2.w38">and</span><span> </span><span class="gd_word" id="S6.p1.1.2.w39">inference</span><span> </span><span class="gd_word" id="S6.p1.1.2.w40">of</span><span> </span><span class="gd_word" id="S6.p1.1.2.w41">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w42">AlphaFold</span><span> </span><span class="gd_word" id="S6.p1.1.2.w43">model</span><span> </span><span class="gd_word" id="S6.p1.1.2.w44">in</span><span> </span><span class="gd_word" id="S6.p1.1.2.w45">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w46">GPU</span><span> </span><span class="gd_word" id="S6.p1.1.2.w47">platform.</span><span> </span><span class="gd_word" id="S6.p1.1.2.w48">The</span><span> </span><span class="gd_word" id="S6.p1.1.2.w49">model</span><span> </span><span class="gd_word" id="S6.p1.1.2.w50">optimization</span><span> </span><span class="gd_word" id="S6.p1.1.2.w51">of</span><span> </span><span class="gd_word" id="S6.p1.1.2.w52">FastFold</span><span> </span><span class="gd_word" id="S6.p1.1.2.w53">and</span><span> </span><span class="gd_word" id="S6.p1.1.2.w54">the</span><span> </span><span class="gd_word" id="S6.p1.1.2.w55">total</span><span> </span><span class="gd_word" id="S6.p1.1.2.w56">data</span><span> </span><span class="gd_word" id="S6.p1.1.2.w57">processing</span><span> </span><span class="gd_word" id="S6.p1.1.2.w58">flow</span><span> </span><span class="gd_word" id="S6.p1.1.2.w59">optimization</span><span> </span><span class="gd_word" id="S6.p1.1.2.w60">of</span><span> </span><span class="gd_word" id="S6.p1.1.2.w61">ParaFold</span><span> </span><span class="gd_word" id="S6.p1.1.2.w62">are</span><span> </span><span class="gd_word" id="S6.p1.1.2.w63">complementary</span><span> </span><span class="gd_word" id="S6.p1.1.2.w64">and</span><span> </span><span class="gd_word" id="S6.p1.1.2.w65">can</span><span> </span><span class="gd_word" id="S6.p1.1.2.w66">be</span><span> </span><span class="gd_word" id="S6.p1.1.2.w67">combined</span><span> </span><span class="gd_word" id="S6.p1.1.2.w68">in</span><span> </span><span class="gd_word" id="S6.p1.1.2.w69">future</span><span> </span><span class="gd_word" id="S6.p1.1.2.w70">work.</span></p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p"><span class="gd_word" id="S6.p2.1.1.w1">There</span><span> </span><span class="gd_word" id="S6.p2.1.1.w2">has</span><span> </span><span class="gd_word" id="S6.p2.1.1.w3">been</span><span> </span><span class="gd_word" id="S6.p2.1.1.w4">a</span><span> </span><span class="gd_word" id="S6.p2.1.1.w5">significant</span><span> </span><span class="gd_word" id="S6.p2.1.1.w6">amount</span><span> </span><span class="gd_word" id="S6.p2.1.1.w7">of</span><span> </span><span class="gd_word" id="S6.p2.1.1.w8">work</span><span> </span><span class="gd_word" id="S6.p2.1.1.w9">on</span><span> </span><span class="gd_word" id="S6.p2.1.1.w10">optimizing</span><span> </span><span class="gd_word" id="S6.p2.1.1.w11">the</span><span> </span><span class="gd_word" id="S6.p2.1.1.w12">performance</span><span> </span><span class="gd_word" id="S6.p2.1.1.w13">of</span><span> </span><span class="gd_word" id="S6.p2.1.1.w14">the</span><span> </span><span class="gd_word" id="S6.p2.1.1.w15">Transformer</span><span> </span><span class="gd_word" id="S6.p2.1.1.w16">model,</span><span> </span><span class="gd_word" id="S6.p2.1.1.w17">which</span><span> </span><span class="gd_word" id="S6.p2.1.1.w18">can</span><span> </span><span class="gd_word" id="S6.p2.1.1.w19">be</span><span> </span><span class="gd_word" id="S6.p2.1.1.w20">summarized</span><span> </span><span class="gd_word" id="S6.p2.1.1.w21">into</span><span> </span><span class="gd_word" id="S6.p2.1.1.w22">two</span><span> </span><span class="gd_word" id="S6.p2.1.1.w23">categories:</span><span> </span><span class="gd_word" id="S6.p2.1.1.w24">efficient</span><span> </span><span class="gd_word" id="S6.p2.1.1.w25">design</span><span> </span><span class="gd_word" id="S6.p2.1.1.w26">of</span><span> </span><span class="gd_word" id="S6.p2.1.1.w27">Transformer</span><span> </span><span class="gd_word" id="S6.p2.1.1.w28">and</span><span> </span><span class="gd_word" id="S6.p2.1.1.w29">efficient</span><span> </span><span class="gd_word" id="S6.p2.1.1.w30">implementation</span><span> </span><span class="gd_word" id="S6.p2.1.1.w31">of</span><span> </span><span class="gd_word" id="S6.p2.1.1.w32">Transformer.</span><span> </span><span class="gd_word" id="S6.p2.1.1.w33">Many</span><span> </span><span class="gd_word" id="S6.p2.1.1.w34">works</span><span> </span><span class="gd_word" id="S6.p2.1.1.w35">try</span><span> </span><span class="gd_word" id="S6.p2.1.1.w36">to</span><span> </span><span class="gd_word" id="S6.p2.1.1.w37">improve</span><span> </span><span class="gd_word" id="S6.p2.1.1.w38">Transformer</span><span> </span><span class="gd_word" id="S6.p2.1.1.w39">by</span><span> </span><span class="gd_word" id="S6.p2.1.1.w40">reducing</span><span> </span><span class="gd_word" id="S6.p2.1.1.w41">the</span><span> </span><span class="gd_word" id="S6.p2.1.1.w42">complexity</span><span> </span><span class="gd_word" id="S6.p2.1.1.w43">of</span><span> </span><span class="gd_word" id="S6.p2.1.1.w44">attention</span><span> </span><span class="gd_word" id="S6.p2.1.1.w45">computation</span><span> </span><span class="gd_word" id="S6.p2.1.1.w46">through</span><span> </span><span class="gd_word" id="S6.p2.1.1.w47">chunking</span><span> </span><span class="gd_word" id="S6.p2.1.1.w48">or</span><span> </span><span class="gd_word" id="S6.p2.1.1.w49">sliding</span><span> </span><span class="gd_word" id="S6.p2.1.1.w50">windows,</span><span> </span><span class="gd_word" id="S6.p2.1.1.w51">or</span><span> </span><span class="gd_word" id="S6.p2.1.1.w52">low-rank</span><span> </span><span class="gd_word" id="S6.p2.1.1.w53">approximate,</span><span> </span><span class="gd_word" id="S6.p2.1.1.w54">such</span><span> </span><span class="gd_word" id="S6.p2.1.1.w55">as</span><span> </span><span class="gd_word" id="S6.p2.1.1.w56">Performer</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite><span class="gd_word" id="S6.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S6.p2.1.2.w2">Reformer</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><span class="gd_word" id="S6.p2.1.3.w1">,</span><span> </span><span class="gd_word" id="S6.p2.1.3.w2">Linformer</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite><span class="gd_word" id="S6.p2.1.4.w1">,</span><span> </span><span class="gd_word" id="S6.p2.1.4.w2">etc.</span><span> </span><span class="gd_word" id="S6.p2.1.4.w3">On</span><span> </span><span class="gd_word" id="S6.p2.1.4.w4">the</span><span> </span><span class="gd_word" id="S6.p2.1.4.w5">other</span><span> </span><span class="gd_word" id="S6.p2.1.4.w6">hand,</span><span> </span><span class="gd_word" id="S6.p2.1.4.w7">there</span><span> </span><span class="gd_word" id="S6.p2.1.4.w8">are</span><span> </span><span class="gd_word" id="S6.p2.1.4.w9">many</span><span> </span><span class="gd_word" id="S6.p2.1.4.w10">works</span><span> </span><span class="gd_word" id="S6.p2.1.4.w11">such</span><span> </span><span class="gd_word" id="S6.p2.1.4.w12">as</span><span> </span><span class="gd_word" id="S6.p2.1.4.w13">LightSeq</span><span> </span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite><span class="gd_word" id="S6.p2.1.5.w1">and</span><span> </span><span class="gd_word" id="S6.p2.1.5.w2">TurboTransformer</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite><span class="gd_word" id="S6.p2.1.6.w1">,</span><span> </span><span class="gd_word" id="S6.p2.1.6.w2">which</span><span> </span><span class="gd_word" id="S6.p2.1.6.w3">focuses</span><span> </span><span class="gd_word" id="S6.p2.1.6.w4">on</span><span> </span><span class="gd_word" id="S6.p2.1.6.w5">optimizing</span><span> </span><span class="gd_word" id="S6.p2.1.6.w6">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w7">performance</span><span> </span><span class="gd_word" id="S6.p2.1.6.w8">of</span><span> </span><span class="gd_word" id="S6.p2.1.6.w9">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w10">vanilla</span><span> </span><span class="gd_word" id="S6.p2.1.6.w11">Transformer</span><span> </span><span class="gd_word" id="S6.p2.1.6.w12">on</span><span> </span><span class="gd_word" id="S6.p2.1.6.w13">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w14">GPU</span><span> </span><span class="gd_word" id="S6.p2.1.6.w15">platform.</span><span> </span><span class="gd_word" id="S6.p2.1.6.w16">These</span><span> </span><span class="gd_word" id="S6.p2.1.6.w17">efforts</span><span> </span><span class="gd_word" id="S6.p2.1.6.w18">included</span><span> </span><span class="gd_word" id="S6.p2.1.6.w19">CUDA</span><span> </span><span class="gd_word" id="S6.p2.1.6.w20">optimization</span><span> </span><span class="gd_word" id="S6.p2.1.6.w21">and</span><span> </span><span class="gd_word" id="S6.p2.1.6.w22">memory</span><span> </span><span class="gd_word" id="S6.p2.1.6.w23">management</span><span> </span><span class="gd_word" id="S6.p2.1.6.w24">for</span><span> </span><span class="gd_word" id="S6.p2.1.6.w25">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w26">Transformer</span><span> </span><span class="gd_word" id="S6.p2.1.6.w27">model.</span><span> </span><span class="gd_word" id="S6.p2.1.6.w28">However,</span><span> </span><span class="gd_word" id="S6.p2.1.6.w29">there</span><span> </span><span class="gd_word" id="S6.p2.1.6.w30">are</span><span> </span><span class="gd_word" id="S6.p2.1.6.w31">several</span><span> </span><span class="gd_word" id="S6.p2.1.6.w32">differences</span><span> </span><span class="gd_word" id="S6.p2.1.6.w33">between</span><span> </span><span class="gd_word" id="S6.p2.1.6.w34">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w35">Evoformer</span><span> </span><span class="gd_word" id="S6.p2.1.6.w36">and</span><span> </span><span class="gd_word" id="S6.p2.1.6.w37">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w38">vanilla</span><span> </span><span class="gd_word" id="S6.p2.1.6.w39">Transform,</span><span> </span><span class="gd_word" id="S6.p2.1.6.w40">and</span><span> </span><span class="gd_word" id="S6.p2.1.6.w41">while</span><span> </span><span class="gd_word" id="S6.p2.1.6.w42">some</span><span> </span><span class="gd_word" id="S6.p2.1.6.w43">prior</span><span> </span><span class="gd_word" id="S6.p2.1.6.w44">optimization</span><span> </span><span class="gd_word" id="S6.p2.1.6.w45">technology</span><span> </span><span class="gd_word" id="S6.p2.1.6.w46">can</span><span> </span><span class="gd_word" id="S6.p2.1.6.w47">be</span><span> </span><span class="gd_word" id="S6.p2.1.6.w48">used,</span><span> </span><span class="gd_word" id="S6.p2.1.6.w49">FastFold</span><span> </span><span class="gd_word" id="S6.p2.1.6.w50">is</span><span> </span><span class="gd_word" id="S6.p2.1.6.w51">computationally</span><span> </span><span class="gd_word" id="S6.p2.1.6.w52">optimized</span><span> </span><span class="gd_word" id="S6.p2.1.6.w53">mostly</span><span> </span><span class="gd_word" id="S6.p2.1.6.w54">based</span><span> </span><span class="gd_word" id="S6.p2.1.6.w55">on</span><span> </span><span class="gd_word" id="S6.p2.1.6.w56">the</span><span> </span><span class="gd_word" id="S6.p2.1.6.w57">characteristics</span><span> </span><span class="gd_word" id="S6.p2.1.6.w58">of</span><span> </span><span class="gd_word" id="S6.p2.1.6.w59">Evoformer.</span></p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p"><span class="gd_word" id="S6.p3.1.1.w1">Many</span><span> </span><span class="gd_word" id="S6.p3.1.1.w2">works</span><span> </span><span class="gd_word" id="S6.p3.1.1.w3">are</span><span> </span><span class="gd_word" id="S6.p3.1.1.w4">being</span><span> </span><span class="gd_word" id="S6.p3.1.1.w5">done</span><span> </span><span class="gd_word" id="S6.p3.1.1.w6">to</span><span> </span><span class="gd_word" id="S6.p3.1.1.w7">tackle</span><span> </span><span class="gd_word" id="S6.p3.1.1.w8">the</span><span> </span><span class="gd_word" id="S6.p3.1.1.w9">challenge</span><span> </span><span class="gd_word" id="S6.p3.1.1.w10">that</span><span> </span><span class="gd_word" id="S6.p3.1.1.w11">large-scale</span><span> </span><span class="gd_word" id="S6.p3.1.1.w12">training</span><span> </span><span class="gd_word" id="S6.p3.1.1.w13">poses.</span><span> </span><span class="gd_word" id="S6.p3.1.1.w14">Large</span><span> </span><span class="gd_word" id="S6.p3.1.1.w15">batch</span><span> </span><span class="gd_word" id="S6.p3.1.1.w16">training,</span><span> </span><span class="gd_word" id="S6.p3.1.1.w17">such</span><span> </span><span class="gd_word" id="S6.p3.1.1.w18">as</span><span> </span><span class="gd_word" id="S6.p3.1.1.w19">LAMB</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite><span class="gd_word" id="S6.p3.1.2.w1"/><span> </span><span class="gd_word" id="S6.p3.1.2.w2">or</span><span> </span><span class="gd_word" id="S6.p3.1.2.w3">LARS</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite><span class="gd_word" id="S6.p3.1.3.w1">,</span><span> </span><span class="gd_word" id="S6.p3.1.3.w2">has</span><span> </span><span class="gd_word" id="S6.p3.1.3.w3">also</span><span> </span><span class="gd_word" id="S6.p3.1.3.w4">been</span><span> </span><span class="gd_word" id="S6.p3.1.3.w5">used</span><span> </span><span class="gd_word" id="S6.p3.1.3.w6">to</span><span> </span><span class="gd_word" id="S6.p3.1.3.w7">speed</span><span> </span><span class="gd_word" id="S6.p3.1.3.w8">up</span><span> </span><span class="gd_word" id="S6.p3.1.3.w9">training.</span><span> </span><span class="gd_word" id="S6.p3.1.3.w10">These</span><span> </span><span class="gd_word" id="S6.p3.1.3.w11">strategies</span><span> </span><span class="gd_word" id="S6.p3.1.3.w12">address</span><span> </span><span class="gd_word" id="S6.p3.1.3.w13">optimization</span><span> </span><span class="gd_word" id="S6.p3.1.3.w14">issues</span><span> </span><span class="gd_word" id="S6.p3.1.3.w15">that</span><span> </span><span class="gd_word" id="S6.p3.1.3.w16">arise</span><span> </span><span class="gd_word" id="S6.p3.1.3.w17">during</span><span> </span><span class="gd_word" id="S6.p3.1.3.w18">data</span><span> </span><span class="gd_word" id="S6.p3.1.3.w19">parallelism</span><span> </span><span class="gd_word" id="S6.p3.1.3.w20">scaling.</span><span> </span><span class="gd_word" id="S6.p3.1.3.w21">For</span><span> </span><span class="gd_word" id="S6.p3.1.3.w22">large</span><span> </span><span class="gd_word" id="S6.p3.1.3.w23">model</span><span> </span><span class="gd_word" id="S6.p3.1.3.w24">training,</span><span> </span><span class="gd_word" id="S6.p3.1.3.w25">there</span><span> </span><span class="gd_word" id="S6.p3.1.3.w26">are</span><span> </span><span class="gd_word" id="S6.p3.1.3.w27">mainly</span><span> </span><span class="gd_word" id="S6.p3.1.3.w28">two</span><span> </span><span class="gd_word" id="S6.p3.1.3.w29">approaches</span><span> </span><span class="gd_word" id="S6.p3.1.3.w30">to</span><span> </span><span class="gd_word" id="S6.p3.1.3.w31">achieve</span><span> </span><span class="gd_word" id="S6.p3.1.3.w32">high</span><span> </span><span class="gd_word" id="S6.p3.1.3.w33">performance.</span><span> </span><span class="gd_word" id="S6.p3.1.3.w34">Megatron-LM</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><span class="gd_word" id="S6.p3.1.4.w1"/><span> </span><span class="gd_word" id="S6.p3.1.4.w2">provides</span><span> </span><span class="gd_word" id="S6.p3.1.4.w3">a</span><span> </span><span class="gd_word" id="S6.p3.1.4.w4">sophisticated</span><span> </span><span class="gd_word" id="S6.p3.1.4.w5">hybrid</span><span> </span><span class="gd_word" id="S6.p3.1.4.w6">parallel</span><span> </span><span class="gd_word" id="S6.p3.1.4.w7">strategy</span><span> </span><span class="gd_word" id="S6.p3.1.4.w8">to</span><span> </span><span class="gd_word" id="S6.p3.1.4.w9">scale</span><span> </span><span class="gd_word" id="S6.p3.1.4.w10">the</span><span> </span><span class="gd_word" id="S6.p3.1.4.w11">model</span><span> </span><span class="gd_word" id="S6.p3.1.4.w12">to</span><span> </span><span class="gd_word" id="S6.p3.1.4.w13">more</span><span> </span><span class="gd_word" id="S6.p3.1.4.w14">GPUs</span><span> </span><span class="gd_word" id="S6.p3.1.4.w15">for</span><span> </span><span class="gd_word" id="S6.p3.1.4.w16">training.</span><span> </span><span class="gd_word" id="S6.p3.1.4.w17">Another</span><span> </span><span class="gd_word" id="S6.p3.1.4.w18">approach</span><span> </span><span class="gd_word" id="S6.p3.1.4.w19">is</span><span> </span><span class="gd_word" id="S6.p3.1.4.w20">DeepSpeed</span><span> </span><span class="gd_word" id="S6.p3.1.4.w21">ZeRO</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite><span class="gd_word" id="S6.p3.1.5.w1">,</span><span> </span><span class="gd_word" id="S6.p3.1.5.w2">which</span><span> </span><span class="gd_word" id="S6.p3.1.5.w3">provides</span><span> </span><span class="gd_word" id="S6.p3.1.5.w4">a</span><span> </span><span class="gd_word" id="S6.p3.1.5.w5">memory-efficient</span><span> </span><span class="gd_word" id="S6.p3.1.5.w6">optimizer</span><span> </span><span class="gd_word" id="S6.p3.1.5.w7">combined</span><span> </span><span class="gd_word" id="S6.p3.1.5.w8">with</span><span> </span><span class="gd_word" id="S6.p3.1.5.w9">offload</span><span> </span><span class="gd_word" id="S6.p3.1.5.w10">technology.</span><span> </span><span class="gd_word" id="S6.p3.1.5.w11">For</span><span> </span><span class="gd_word" id="S6.p3.1.5.w12">large-scale</span><span> </span><span class="gd_word" id="S6.p3.1.5.w13">training</span><span> </span><span class="gd_word" id="S6.p3.1.5.w14">of</span><span> </span><span class="gd_word" id="S6.p3.1.5.w15">AlphaFold,</span><span> </span><span class="gd_word" id="S6.p3.1.5.w16">the</span><span> </span><span class="gd_word" id="S6.p3.1.5.w17">main</span><span> </span><span class="gd_word" id="S6.p3.1.5.w18">difficulty</span><span> </span><span class="gd_word" id="S6.p3.1.5.w19">lies</span><span> </span><span class="gd_word" id="S6.p3.1.5.w20">in</span><span> </span><span class="gd_word" id="S6.p3.1.5.w21">model</span><span> </span><span class="gd_word" id="S6.p3.1.5.w22">parallelism,</span><span> </span><span class="gd_word" id="S6.p3.1.5.w23">and</span><span> </span><span class="gd_word" id="S6.p3.1.5.w24">FastFold</span><span> </span><span class="gd_word" id="S6.p3.1.5.w25">proposed</span><span> </span><span class="gd_word" id="S6.p3.1.5.w26">Dynamic</span><span> </span><span class="gd_word" id="S6.p3.1.5.w27">Axial</span><span> </span><span class="gd_word" id="S6.p3.1.5.w28">Parallelism,</span><span> </span><span class="gd_word" id="S6.p3.1.5.w29">which</span><span> </span><span class="gd_word" id="S6.p3.1.5.w30">has</span><span> </span><span class="gd_word" id="S6.p3.1.5.w31">higher</span><span> </span><span class="gd_word" id="S6.p3.1.5.w32">scaling</span><span> </span><span class="gd_word" id="S6.p3.1.5.w33">efficiency</span><span> </span><span class="gd_word" id="S6.p3.1.5.w34">than</span><span> </span><span class="gd_word" id="S6.p3.1.5.w35">the</span><span> </span><span class="gd_word" id="S6.p3.1.5.w36">current</span><span> </span><span class="gd_word" id="S6.p3.1.5.w37">mainstream</span><span> </span><span class="gd_word" id="S6.p3.1.5.w38">model</span><span> </span><span class="gd_word" id="S6.p3.1.5.w39">parallelism</span><span> </span><span class="gd_word" id="S6.p3.1.5.w40">methods.</span></p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VII </span>Conclusion
</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p"><span class="gd_word" id="S7.p1.1.1.w1">Addressing</span><span> </span><span class="gd_word" id="S7.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w3">challenges</span><span> </span><span class="gd_word" id="S7.p1.1.1.w4">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w5">protein</span><span> </span><span class="gd_word" id="S7.p1.1.1.w6">structure</span><span> </span><span class="gd_word" id="S7.p1.1.1.w7">prediction</span><span> </span><span class="gd_word" id="S7.p1.1.1.w8">model</span><span> </span><span class="gd_word" id="S7.p1.1.1.w9">training</span><span> </span><span class="gd_word" id="S7.p1.1.1.w10">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w11">inference</span><span> </span><span class="gd_word" id="S7.p1.1.1.w12">has</span><span> </span><span class="gd_word" id="S7.p1.1.1.w13">important</span><span> </span><span class="gd_word" id="S7.p1.1.1.w14">implications</span><span> </span><span class="gd_word" id="S7.p1.1.1.w15">for</span><span> </span><span class="gd_word" id="S7.p1.1.1.w16">its</span><span> </span><span class="gd_word" id="S7.p1.1.1.w17">better</span><span> </span><span class="gd_word" id="S7.p1.1.1.w18">application</span><span> </span><span class="gd_word" id="S7.p1.1.1.w19">in</span><span> </span><span class="gd_word" id="S7.p1.1.1.w20">structural</span><span> </span><span class="gd_word" id="S7.p1.1.1.w21">biology.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w22">FastFold</span><span> </span><span class="gd_word" id="S7.p1.1.1.w23">analyzes</span><span> </span><span class="gd_word" id="S7.p1.1.1.w24">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w25">main</span><span> </span><span class="gd_word" id="S7.p1.1.1.w26">structure</span><span> </span><span class="gd_word" id="S7.p1.1.1.w27">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w28">AlphaFold</span><span> </span><span class="gd_word" id="S7.p1.1.1.w29">from</span><span> </span><span class="gd_word" id="S7.p1.1.1.w30">a</span><span> </span><span class="gd_word" id="S7.p1.1.1.w31">computational</span><span> </span><span class="gd_word" id="S7.p1.1.1.w32">perspective,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w33">providing</span><span> </span><span class="gd_word" id="S7.p1.1.1.w34">an</span><span> </span><span class="gd_word" id="S7.p1.1.1.w35">efficient</span><span> </span><span class="gd_word" id="S7.p1.1.1.w36">CUDA</span><span> </span><span class="gd_word" id="S7.p1.1.1.w37">Kernel</span><span> </span><span class="gd_word" id="S7.p1.1.1.w38">implementation</span><span> </span><span class="gd_word" id="S7.p1.1.1.w39">on</span><span> </span><span class="gd_word" id="S7.p1.1.1.w40">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w41">GPU</span><span> </span><span class="gd_word" id="S7.p1.1.1.w42">platform.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w43">FastFold</span><span> </span><span class="gd_word" id="S7.p1.1.1.w44">also</span><span> </span><span class="gd_word" id="S7.p1.1.1.w45">proposed</span><span> </span><span class="gd_word" id="S7.p1.1.1.w46">Dynamic</span><span> </span><span class="gd_word" id="S7.p1.1.1.w47">Axial</span><span> </span><span class="gd_word" id="S7.p1.1.1.w48">Parallelism,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w49">which</span><span> </span><span class="gd_word" id="S7.p1.1.1.w50">allows</span><span> </span><span class="gd_word" id="S7.p1.1.1.w51">both</span><span> </span><span class="gd_word" id="S7.p1.1.1.w52">training</span><span> </span><span class="gd_word" id="S7.p1.1.1.w53">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w54">inference</span><span> </span><span class="gd_word" id="S7.p1.1.1.w55">to</span><span> </span><span class="gd_word" id="S7.p1.1.1.w56">scale</span><span> </span><span class="gd_word" id="S7.p1.1.1.w57">to</span><span> </span><span class="gd_word" id="S7.p1.1.1.w58">more</span><span> </span><span class="gd_word" id="S7.p1.1.1.w59">GPUs</span><span> </span><span class="gd_word" id="S7.p1.1.1.w60">thus</span><span> </span><span class="gd_word" id="S7.p1.1.1.w61">reducing</span><span> </span><span class="gd_word" id="S7.p1.1.1.w62">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w63">time</span><span> </span><span class="gd_word" id="S7.p1.1.1.w64">consumption</span><span> </span><span class="gd_word" id="S7.p1.1.1.w65">by</span><span> </span><span class="gd_word" id="S7.p1.1.1.w66">an</span><span> </span><span class="gd_word" id="S7.p1.1.1.w67">order</span><span> </span><span class="gd_word" id="S7.p1.1.1.w68">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w69">magnitude,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w70">exceeding</span><span> </span><span class="gd_word" id="S7.p1.1.1.w71">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w72">current</span><span> </span><span class="gd_word" id="S7.p1.1.1.w73">mainstream</span><span> </span><span class="gd_word" id="S7.p1.1.1.w74">model</span><span> </span><span class="gd_word" id="S7.p1.1.1.w75">parallelism</span><span> </span><span class="gd_word" id="S7.p1.1.1.w76">methods.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w77">With</span><span> </span><span class="gd_word" id="S7.p1.1.1.w78">these,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w79">FastFold</span><span> </span><span class="gd_word" id="S7.p1.1.1.w80">greatly</span><span> </span><span class="gd_word" id="S7.p1.1.1.w81">reduces</span><span> </span><span class="gd_word" id="S7.p1.1.1.w82">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w83">time</span><span> </span><span class="gd_word" id="S7.p1.1.1.w84">cost</span><span> </span><span class="gd_word" id="S7.p1.1.1.w85">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w86">economic</span><span> </span><span class="gd_word" id="S7.p1.1.1.w87">cost</span><span> </span><span class="gd_word" id="S7.p1.1.1.w88">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w89">protein</span><span> </span><span class="gd_word" id="S7.p1.1.1.w90">structure</span><span> </span><span class="gd_word" id="S7.p1.1.1.w91">prediction</span><span> </span><span class="gd_word" id="S7.p1.1.1.w92">model</span><span> </span><span class="gd_word" id="S7.p1.1.1.w93">training</span><span> </span><span class="gd_word" id="S7.p1.1.1.w94">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w95">inference.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w96">It</span><span> </span><span class="gd_word" id="S7.p1.1.1.w97">improves</span><span> </span><span class="gd_word" id="S7.p1.1.1.w98">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w99">efficiency</span><span> </span><span class="gd_word" id="S7.p1.1.1.w100">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w101">design</span><span> </span><span class="gd_word" id="S7.p1.1.1.w102">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w103">deployment</span><span> </span><span class="gd_word" id="S7.p1.1.1.w104">in</span><span> </span><span class="gd_word" id="S7.p1.1.1.w105">the</span><span> </span><span class="gd_word" id="S7.p1.1.1.w106">field</span><span> </span><span class="gd_word" id="S7.p1.1.1.w107">of</span><span> </span><span class="gd_word" id="S7.p1.1.1.w108">protein</span><span> </span><span class="gd_word" id="S7.p1.1.1.w109">structure</span><span> </span><span class="gd_word" id="S7.p1.1.1.w110">prediction</span><span> </span><span class="gd_word" id="S7.p1.1.1.w111">models.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w112">Meanwhile,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w113">Dynamic</span><span> </span><span class="gd_word" id="S7.p1.1.1.w114">Axial</span><span> </span><span class="gd_word" id="S7.p1.1.1.w115">Parallelism</span><span> </span><span class="gd_word" id="S7.p1.1.1.w116">makes</span><span> </span><span class="gd_word" id="S7.p1.1.1.w117">it</span><span> </span><span class="gd_word" id="S7.p1.1.1.w118">possible</span><span> </span><span class="gd_word" id="S7.p1.1.1.w119">to</span><span> </span><span class="gd_word" id="S7.p1.1.1.w120">design</span><span> </span><span class="gd_word" id="S7.p1.1.1.w121">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w122">train</span><span> </span><span class="gd_word" id="S7.p1.1.1.w123">larger</span><span> </span><span class="gd_word" id="S7.p1.1.1.w124">models</span><span> </span><span class="gd_word" id="S7.p1.1.1.w125">to</span><span> </span><span class="gd_word" id="S7.p1.1.1.w126">get</span><span> </span><span class="gd_word" id="S7.p1.1.1.w127">higher</span><span> </span><span class="gd_word" id="S7.p1.1.1.w128">performance.</span><span> </span><span class="gd_word" id="S7.p1.1.1.w129">Other</span><span> </span><span class="gd_word" id="S7.p1.1.1.w130">Protein</span><span> </span><span class="gd_word" id="S7.p1.1.1.w131">Structure</span><span> </span><span class="gd_word" id="S7.p1.1.1.w132">Prediction</span><span> </span><span class="gd_word" id="S7.p1.1.1.w133">Models,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w134">such</span><span> </span><span class="gd_word" id="S7.p1.1.1.w135">as</span><span> </span><span class="gd_word" id="S7.p1.1.1.w136">RoseTTAFold</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite><span class="gd_word" id="S7.p1.1.2.w1"/><span> </span><span class="gd_word" id="S7.p1.1.2.w2">and</span><span> </span><span class="gd_word" id="S7.p1.1.2.w3">MSA</span><span> </span><span class="gd_word" id="S7.p1.1.2.w4">Transformer</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite><span class="gd_word" id="S7.p1.1.3.w1">,</span><span> </span><span class="gd_word" id="S7.p1.1.3.w2">can</span><span> </span><span class="gd_word" id="S7.p1.1.3.w3">benefit</span><span> </span><span class="gd_word" id="S7.p1.1.3.w4">from</span><span> </span><span class="gd_word" id="S7.p1.1.3.w5">FastFold’s</span><span> </span><span class="gd_word" id="S7.p1.1.3.w6">optimization</span><span> </span><span class="gd_word" id="S7.p1.1.3.w7">technologies.</span><span> </span><span class="gd_word" id="S7.p1.1.3.w8">Also,</span><span> </span><span class="gd_word" id="S7.p1.1.3.w9">the</span><span> </span><span class="gd_word" id="S7.p1.1.3.w10">parallel</span><span> </span><span class="gd_word" id="S7.p1.1.3.w11">strategy</span><span> </span><span class="gd_word" id="S7.p1.1.3.w12">can</span><span> </span><span class="gd_word" id="S7.p1.1.3.w13">apply</span><span> </span><span class="gd_word" id="S7.p1.1.3.w14">to</span><span> </span><span class="gd_word" id="S7.p1.1.3.w15">Multidimensional</span><span> </span><span class="gd_word" id="S7.p1.1.3.w16">Transformers</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite><span class="gd_word" id="S7.p1.1.4.w1">,</span><span> </span><span class="gd_word" id="S7.p1.1.4.w2">such</span><span> </span><span class="gd_word" id="S7.p1.1.4.w3">as</span><span> </span><span class="gd_word" id="S7.p1.1.4.w4">Video</span><span> </span><span class="gd_word" id="S7.p1.1.4.w5">Vision</span><span> </span><span class="gd_word" id="S7.p1.1.4.w6">Transformer</span><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite><span class="gd_word" id="S7.p1.1.5.w1">.</span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
A. W. Senior, R. Evans, J. Jumper, J. Kirkpatrick, L. Sifre, T. Green, C. Qin,
A. Žídek, A. W. Nelson, A. Bridgland <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Improved
protein structure prediction using potentials from deep learning,”
<em id="bib.bib1.2.2" class="ltx_emph ltx_font_italic">Nature</em>, vol. 577, no. 7792, pp. 706–710, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
J. Xu, “Distance-based protein folding powered by deep learning,”
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the National Academy of Sciences</em>, vol. 116, no. 34, pp.
16 856–16 865, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez,
Ł. Kaiser, and I. Polosukhin, “Attention is all you need,”
<em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, vol. 30, 2017.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, and K. Toutanova, “Bert: Pre-training of deep
bidirectional transformers for language understanding,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1810.04805</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal,
A. Neelakantan, P. Shyam, G. Sastry, A. Askell <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Language
models are few-shot learners,” <em id="bib.bib5.2.2" class="ltx_emph ltx_font_italic">Advances in neural information
processing systems</em>, vol. 33, pp. 1877–1901, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. Dosovitskiy, L. Beyer, A. Kolesnikov, D. Weissenborn, X. Zhai,
T. Unterthiner, M. Dehghani, M. Minderer, G. Heigold, S. Gelly <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">et al.</em>,
“An image is worth 16x16 words: Transformers for image recognition at
scale,” <em id="bib.bib6.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.11929</em>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
J. Jumper, R. Evans, A. Pritzel, T. Green, M. Figurnov, O. Ronneberger,
K. Tunyasuvunakool, R. Bates, A. Žídek, A. Potapenko
<em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Highly accurate protein structure prediction with
alphafold,” <em id="bib.bib7.2.2" class="ltx_emph ltx_font_italic">Nature</em>, vol. 596, no. 7873, pp. 583–589, 2021.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
N. P. Jouppi, C. Young, N. Patil, D. Patterson, G. Agrawal, R. Bajwa, S. Bates,
S. Bhatia, N. Boden, A. Borchers <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “In-datacenter performance
analysis of a tensor processing unit,” in <em id="bib.bib8.2.2" class="ltx_emph ltx_font_italic">Proceedings of the 44th
annual international symposium on computer architecture</em>, 2017, pp. 1–12.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
D. Kalamkar, D. Mudigere, N. Mellempudi, D. Das, K. Banerjee, S. Avancha, D. T.
Vooturi, N. Jammalamadaka, J. Huang, H. Yuen <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “A study of
bfloat16 for deep learning training,” <em id="bib.bib9.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1905.12322</em>, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
D. Narayanan, M. Shoeybi, J. Casper, P. LeGresley, M. Patwary, V. Korthikanti,
D. Vainbrand, P. Kashinkunti, J. Bernauer, B. Catanzaro, A. Phanishayee, and
M. Zaharia, “Efficient large-scale language model training on gpu clusters
using megatron-lm,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for
High Performance Computing, Networking, Storage and Analysis</em>, ser. SC
’21.   Association for Computing
Machinery, 2021.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
T. Chen, B. Xu, C. Zhang, and C. Guestrin, “Training deep nets with sublinear
memory cost,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1604.06174</em>, 2016.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Fang, Y. Yu, C. Zhao, and J. Zhou, “Turbotransformers: an efficient gpu
serving system for transformer models,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 26th ACM
SIGPLAN Symposium on Principles and Practice of Parallel Programming</em>, 2021,
pp. 389–402.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
“Pytorch jit.” [Online]. Available:
<a href="https://pytorch.org/docs/stable/jit.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://pytorch.org/docs/stable/jit.html</a>

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
B. Welford, “Note on a method for calculating corrected sums of squares and
products,” <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Technometrics</em>, vol. 4, no. 3, pp. 419–420, 1962.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
S. Rajbhandari, C. Li, Z. Yao, M. Zhang, R. Y. Aminabadi, A. A. Awan,
J. Rasley, and Y. He, “Deepspeed-moe: Advancing mixture-of-experts inference
and training to power next-generation ai scale,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2201.05596</em>, 2022.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
G. Ahdritz, N. Bouatta, S. Kadyan, Q. Xia, W. Gerecke, and M. AlQuraishi,
“OpenFold,” 11 2021. [Online]. Available:
<a href="https://github.com/aqlaboratory/openfold" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/aqlaboratory/openfold</a>

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
“Apex: Tools for easy mixed precision and distributed training in pytorch.”
[Online]. Available: <a href="https://github.com/NVIDIA/apex" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/NVIDIA/apex</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
R. Frostig, M. J. Johnson, and C. Leary, “Compiling machine learning programs
via high-level tracing,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Systems for Machine Learning</em>, pp. 23–24,
2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
B. Zhong, X. Su, M. Wen, S. Zuo, L. Hong, and J. Lin, “Parafold: Paralleling
alphafold for large-scale predictions,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">International Conference on
High Performance Computing in Asia-Pacific Region Workshops</em>, 2022, pp. 1–9.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
K. Choromanski, V. Likhosherstov, D. Dohan, X. Song, A. Gane, T. Sarlos,
P. Hawkins, J. Davis, A. Mohiuddin, L. Kaiser <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Rethinking
attention with performers,” <em id="bib.bib20.2.2" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2009.14794</em>, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
N. Kitaev, Ł. Kaiser, and A. Levskaya, “Reformer: The efficient
transformer,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2001.04451</em>, 2020.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
S. Wang, B. Z. Li, M. Khabsa, H. Fang, and H. Ma, “Linformer: Self-attention
with linear complexity,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.04768</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
X. Wang, Y. Xiong, Y. Wei, M. Wang, and L. Li, “Lightseq: A high performance
inference library for transformers,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.13887</em>,
2020.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
X. Wang, Y. Xiong, X. Qian, Y. Wei, L. Li, and M. Wang, “Lightseq2:
Accelerated training for transformer-based models on gpus,” <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2110.05722</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Y. You, J. Li, S. Reddi, J. Hseu, S. Kumar, S. Bhojanapalli, X. Song,
J. Demmel, K. Keutzer, and C.-J. Hsieh, “Large batch optimization for deep
learning: Training bert in 76 minutes,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1904.00962</em>, 2019.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Y. You, I. Gitman, and B. Ginsburg, “Large batch training of convolutional
networks,” <em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1708.03888</em>, 2017.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
S. Rajbhandari, J. Rasley, O. Ruwase, and Y. He, “Zero: Memory optimizations
toward training trillion parameter models,” in <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">SC20: International
Conference for High Performance Computing, Networking, Storage and
Analysis</em>.   IEEE, 2020, pp. 1–16.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
S. Rajbhandari, O. Ruwase, J. Rasley, S. Smith, and Y. He, “Zero-infinity:
Breaking the gpu memory wall for extreme scale deep learning,” in
<em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference for High Performance
Computing, Networking, Storage and Analysis</em>, ser. SC ’21.   Association for Computing Machinery, 2021.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
M. Baek, F. DiMaio, I. Anishchenko, J. Dauparas, S. Ovchinnikov, G. R. Lee,
J. Wang, Q. Cong, L. N. Kinch, R. D. Schaeffer <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Accurate
prediction of protein structures and interactions using a 3-track network,”
<em id="bib.bib29.2.2" class="ltx_emph ltx_font_italic">bioRxiv</em>, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
R. Rao, J. Liu, R. Verkuil, J. Meier, J. F. Canny, P. Abbeel, T. Sercu, and
A. Rives, “Msa transformer,” <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">bioRxiv</em>, 2021. [Online]. Available:
<a href="https://www.biorxiv.org/content/10.1101/2021.02.12.430858v1" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://www.biorxiv.org/content/10.1101/2021.02.12.430858v1</a>

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
J. Ho, N. Kalchbrenner, D. Weissenborn, and T. Salimans, “Axial attention in
multidimensional transformers,” <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.12180</em>,
2019.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
A. Arnab, M. Dehghani, G. Heigold, C. Sun, M. Lučić, and C. Schmid,
“Vivit: A video vision transformer,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:2103.15691</em>, 2021.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu May 19 11:44:10 2022 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"/></a>
</div></footer>
</div>
</body>
</html>
