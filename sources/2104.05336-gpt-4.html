<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title>Machine Translation Decoding beyond Beam Search</title>
<!--Generated on Wed Dec  1 10:30:31 2021 by LaTeXML (version 0.8.6) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
<meta name="keywords" lang="en" content="Machine Translation,  MCTS,  Decoding"/>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Machine Translation Decoding beyond Beam Search</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rémi Leblond
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jean-Baptiste Alayrac
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Laurent Sifre
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Miruna Pislar
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jean-Baptiste Lespiau
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ioannis Antonoglou
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Karen Simonyan
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Oriol Vinyals
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p"><span class="gd_word" id="id1.id1.1.w1">Beam</span><span> </span><span class="gd_word" id="id1.id1.1.w2">search</span><span> </span><span class="gd_word" id="id1.id1.1.w3">is</span><span> </span><span class="gd_word" id="id1.id1.1.w4">the</span><span> </span><span class="gd_word" id="id1.id1.1.w5">go-to</span><span> </span><span class="gd_word" id="id1.id1.1.w6">method</span><span> </span><span class="gd_word" id="id1.id1.1.w7">for</span><span> </span><span class="gd_word" id="id1.id1.1.w8">decoding</span><span> </span><span class="gd_word" id="id1.id1.1.w9">auto-regressive</span><span> </span><span class="gd_word" id="id1.id1.1.w10">machine</span><span> </span><span class="gd_word" id="id1.id1.1.w11">translation</span><span> </span><span class="gd_word" id="id1.id1.1.w12">models.
While</span><span> </span><span class="gd_word" id="id1.id1.1.w13">it</span><span> </span><span class="gd_word" id="id1.id1.1.w14">yields</span><span> </span><span class="gd_word" id="id1.id1.1.w15">consistent</span><span> </span><span class="gd_word" id="id1.id1.1.w16">improvements</span><span> </span><span class="gd_word" id="id1.id1.1.w17">in</span><span> </span><span class="gd_word" id="id1.id1.1.w18">terms</span><span> </span><span class="gd_word" id="id1.id1.1.w19">of</span><span> </span><span class="gd_word" id="id1.id1.1.w20">BLEU,</span><span> </span><span class="gd_word" id="id1.id1.1.w21">it</span><span> </span><span class="gd_word" id="id1.id1.1.w22">is</span><span> </span><span class="gd_word" id="id1.id1.1.w23">only</span><span> </span><span class="gd_word" id="id1.id1.1.w24">concerned</span><span> </span><span class="gd_word" id="id1.id1.1.w25">with</span><span> </span><span class="gd_word" id="id1.id1.1.w26">finding</span><span> </span><span class="gd_word" id="id1.id1.1.w27">outputs</span><span> </span><span class="gd_word" id="id1.id1.1.w28">with</span><span> </span><span class="gd_word" id="id1.id1.1.w29">high</span><span> </span><span class="gd_word" id="id1.id1.1.w30">model</span><span> </span><span class="gd_word" id="id1.id1.1.w31">likelihood,</span><span> </span><span class="gd_word" id="id1.id1.1.w32">and</span><span> </span><span class="gd_word" id="id1.id1.1.w33">is</span><span> </span><span class="gd_word" id="id1.id1.1.w34">thus</span><span> </span><span class="gd_word" id="id1.id1.1.w35">agnostic</span><span> </span><span class="gd_word" id="id1.id1.1.w36">to</span><span> </span><span class="gd_word" id="id1.id1.1.w37">whatever</span><span> </span><span class="gd_word" id="id1.id1.1.w38">end</span><span> </span><span class="gd_word" id="id1.id1.1.w39">metric</span><span> </span><span class="gd_word" id="id1.id1.1.w40">or</span><span> </span><span class="gd_word" id="id1.id1.1.w41">score</span><span> </span><span class="gd_word" id="id1.id1.1.w42">practitioners</span><span> </span><span class="gd_word" id="id1.id1.1.w43">care</span><span> </span><span class="gd_word" id="id1.id1.1.w44">about.
Our</span><span> </span><span class="gd_word" id="id1.id1.1.w45">aim</span><span> </span><span class="gd_word" id="id1.id1.1.w46">is</span><span> </span><span class="gd_word" id="id1.id1.1.w47">to</span><span> </span><span class="gd_word" id="id1.id1.1.w48">establish</span><span> </span><span class="gd_word" id="id1.id1.1.w49">whether</span><span> </span><span class="gd_word" id="id1.id1.1.w50">beam</span><span> </span><span class="gd_word" id="id1.id1.1.w51">search</span><span> </span><span class="gd_word" id="id1.id1.1.w52">can</span><span> </span><span class="gd_word" id="id1.id1.1.w53">be</span><span> </span><span class="gd_word" id="id1.id1.1.w54">replaced</span><span> </span><span class="gd_word" id="id1.id1.1.w55">by</span><span> </span><span class="gd_word" id="id1.id1.1.w56">a</span><span> </span><span class="gd_word" id="id1.id1.1.w57">more</span><span> </span><span class="gd_word" id="id1.id1.1.w58">powerful</span><span> </span><span class="gd_word" id="id1.id1.1.w59">metric-driven</span><span> </span><span class="gd_word" id="id1.id1.1.w60">search</span><span> </span><span class="gd_word" id="id1.id1.1.w61">technique.
To</span><span> </span><span class="gd_word" id="id1.id1.1.w62">this</span><span> </span><span class="gd_word" id="id1.id1.1.w63">end,</span><span> </span><span class="gd_word" id="id1.id1.1.w64">we</span><span> </span><span class="gd_word" id="id1.id1.1.w65">explore</span><span> </span><span class="gd_word" id="id1.id1.1.w66">numerous</span><span> </span><span class="gd_word" id="id1.id1.1.w67">decoding</span><span> </span><span class="gd_word" id="id1.id1.1.w68">algorithms,</span><span> </span><span class="gd_word" id="id1.id1.1.w69">including</span><span> </span><span class="gd_word" id="id1.id1.1.w70">some</span><span> </span><span class="gd_word" id="id1.id1.1.w71">which</span><span> </span><span class="gd_word" id="id1.id1.1.w72">rely</span><span> </span><span class="gd_word" id="id1.id1.1.w73">on</span><span> </span><span class="gd_word" id="id1.id1.1.w74">a</span><span> </span><span class="gd_word" id="id1.id1.1.w75">value</span><span> </span><span class="gd_word" id="id1.id1.1.w76">function</span><span> </span><span class="gd_word" id="id1.id1.1.w77">parameterised</span><span> </span><span class="gd_word" id="id1.id1.1.w78">by</span><span> </span><span class="gd_word" id="id1.id1.1.w79">a</span><span> </span><span class="gd_word" id="id1.id1.1.w80">neural</span><span> </span><span class="gd_word" id="id1.id1.1.w81">network,</span><span> </span><span class="gd_word" id="id1.id1.1.w82">and</span><span> </span><span class="gd_word" id="id1.id1.1.w83">report</span><span> </span><span class="gd_word" id="id1.id1.1.w84">results</span><span> </span><span class="gd_word" id="id1.id1.1.w85">on</span><span> </span><span class="gd_word" id="id1.id1.1.w86">a</span><span> </span><span class="gd_word" id="id1.id1.1.w87">variety</span><span> </span><span class="gd_word" id="id1.id1.1.w88">of</span><span> </span><span class="gd_word" id="id1.id1.1.w89">metrics.
Notably,</span><span> </span><span class="gd_word" id="id1.id1.1.w90">we</span><span> </span><span class="gd_word" id="id1.id1.1.w91">introduce</span><span> </span><span class="gd_word" id="id1.id1.1.w92">a</span><span> </span><span class="gd_word" id="id1.id1.1.w93">Monte-Carlo</span><span> </span><span class="gd_word" id="id1.id1.1.w94">Tree</span><span> </span><span class="gd_word" id="id1.id1.1.w95">Search</span><span> </span><span class="gd_word" id="id1.id1.1.w96">(MCTS)</span><span> </span><span class="gd_word" id="id1.id1.1.w97">based</span><span> </span><span class="gd_word" id="id1.id1.1.w98">method</span><span> </span><span class="gd_word" id="id1.id1.1.w99">and</span><span> </span><span class="gd_word" id="id1.id1.1.w100">showcase</span><span> </span><span class="gd_word" id="id1.id1.1.w101">its</span><span> </span><span class="gd_word" id="id1.id1.1.w102">competitiveness.
We</span><span> </span><span class="gd_word" id="id1.id1.1.w103">provide</span><span> </span><span class="gd_word" id="id1.id1.1.w104">a</span><span> </span><span class="gd_word" id="id1.id1.1.w105">blueprint</span><span> </span><span class="gd_word" id="id1.id1.1.w106">for</span><span> </span><span class="gd_word" id="id1.id1.1.w107">how</span><span> </span><span class="gd_word" id="id1.id1.1.w108">to</span><span> </span><span class="gd_word" id="id1.id1.1.w109">use</span><span> </span><span class="gd_word" id="id1.id1.1.w110">MCTS</span><span> </span><span class="gd_word" id="id1.id1.1.w111">fruitfully</span><span> </span><span class="gd_word" id="id1.id1.1.w112">in</span><span> </span><span class="gd_word" id="id1.id1.1.w113">language</span><span> </span><span class="gd_word" id="id1.id1.1.w114">applications,</span><span> </span><span class="gd_word" id="id1.id1.1.w115">which</span><span> </span><span class="gd_word" id="id1.id1.1.w116">opens</span><span> </span><span class="gd_word" id="id1.id1.1.w117">promising</span><span> </span><span class="gd_word" id="id1.id1.1.w118">future</span><span> </span><span class="gd_word" id="id1.id1.1.w119">directions.
We</span><span> </span><span class="gd_word" id="id1.id1.1.w120">find</span><span> </span><span class="gd_word" id="id1.id1.1.w121">that</span><span> </span><span class="gd_word" id="id1.id1.1.w122">which</span><span> </span><span class="gd_word" id="id1.id1.1.w123">algorithm</span><span> </span><span class="gd_word" id="id1.id1.1.w124">is</span><span> </span><span class="gd_word" id="id1.id1.1.w125">best</span><span> </span><span class="gd_word" id="id1.id1.1.w126">heavily</span><span> </span><span class="gd_word" id="id1.id1.1.w127">depends</span><span> </span><span class="gd_word" id="id1.id1.1.w128">on</span><span> </span><span class="gd_word" id="id1.id1.1.w129">the</span><span> </span><span class="gd_word" id="id1.id1.1.w130">characteristics</span><span> </span><span class="gd_word" id="id1.id1.1.w131">of</span><span> </span><span class="gd_word" id="id1.id1.1.w132">the</span><span> </span><span class="gd_word" id="id1.id1.1.w133">goal</span><span> </span><span class="gd_word" id="id1.id1.1.w134">metric;</span><span> </span><span class="gd_word" id="id1.id1.1.w135">we</span><span> </span><span class="gd_word" id="id1.id1.1.w136">believe</span><span> </span><span class="gd_word" id="id1.id1.1.w137">that</span><span> </span><span class="gd_word" id="id1.id1.1.w138">our</span><span> </span><span class="gd_word" id="id1.id1.1.w139">extensive</span><span> </span><span class="gd_word" id="id1.id1.1.w140">experiments</span><span> </span><span class="gd_word" id="id1.id1.1.w141">and</span><span> </span><span class="gd_word" id="id1.id1.1.w142">analysis</span><span> </span><span class="gd_word" id="id1.id1.1.w143">will</span><span> </span><span class="gd_word" id="id1.id1.1.w144">inform</span><span> </span><span class="gd_word" id="id1.id1.1.w145">further</span><span> </span><span class="gd_word" id="id1.id1.1.w146">research</span><span> </span><span class="gd_word" id="id1.id1.1.w147">in</span><span> </span><span class="gd_word" id="id1.id1.1.w148">this</span><span> </span><span class="gd_word" id="id1.id1.1.w149">area.</span></p>
</div>
<div class="ltx_keywords">Machine Translation, MCTS, Decoding
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break"/>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p"><span class="gd_word" id="S1.p1.1.1.w1">Sequence</span><span> </span><span class="gd_word" id="S1.p1.1.1.w2">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w3">sequence</span><span> </span><span class="gd_word" id="S1.p1.1.1.w4">model</span><span> </span><span class="gd_word" id="S1.p1.1.1.w5">decoding</span><span> </span><span class="gd_word" id="S1.p1.1.1.w6">remains</span><span> </span><span class="gd_word" id="S1.p1.1.1.w7">something</span><span> </span><span class="gd_word" id="S1.p1.1.1.w8">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w9">a</span><span> </span><span class="gd_word" id="S1.p1.1.1.w10">paradox.
The</span><span> </span><span class="gd_word" id="S1.p1.1.1.w11">most</span><span> </span><span class="gd_word" id="S1.p1.1.1.w12">widely</span><span> </span><span class="gd_word" id="S1.p1.1.1.w13">adopted</span><span> </span><span class="gd_word" id="S1.p1.1.1.w14">training</span><span> </span><span class="gd_word" id="S1.p1.1.1.w15">method</span><span> </span><span class="gd_word" id="S1.p1.1.1.w16">for</span><span> </span><span class="gd_word" id="S1.p1.1.1.w17">these</span><span> </span><span class="gd_word" id="S1.p1.1.1.w18">models</span><span> </span><span class="gd_word" id="S1.p1.1.1.w19">is</span><span> </span><span class="gd_word" id="S1.p1.1.1.w20">maximum</span><span> </span><span class="gd_word" id="S1.p1.1.1.w21">likelihood</span><span> </span><span class="gd_word" id="S1.p1.1.1.w22">estimation</span><span> </span><span class="gd_word" id="S1.p1.1.1.w23">(MLE),</span><span> </span><span class="gd_word" id="S1.p1.1.1.w24">which</span><span> </span><span class="gd_word" id="S1.p1.1.1.w25">aims</span><span> </span><span class="gd_word" id="S1.p1.1.1.w26">at</span><span> </span><span class="gd_word" id="S1.p1.1.1.w27">maximising</span><span> </span><span class="gd_word" id="S1.p1.1.1.w28">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w29">probability</span><span> </span><span class="gd_word" id="S1.p1.1.1.w30">of</span><span> </span><span class="gd_word" id="S1.p1.1.1.w31">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w32">ground</span><span> </span><span class="gd_word" id="S1.p1.1.1.w33">truth</span><span> </span><span class="gd_word" id="S1.p1.1.1.w34">outputs</span><span> </span><span class="gd_word" id="S1.p1.1.1.w35">provided</span><span> </span><span class="gd_word" id="S1.p1.1.1.w36">in</span><span> </span><span class="gd_word" id="S1.p1.1.1.w37">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w38">training</span><span> </span><span class="gd_word" id="S1.p1.1.1.w39">datasets.
Consequently,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w40">decoding</span><span> </span><span class="gd_word" id="S1.p1.1.1.w41">from</span><span> </span><span class="gd_word" id="S1.p1.1.1.w42">MLE-trained</span><span> </span><span class="gd_word" id="S1.p1.1.1.w43">models</span><span> </span><span class="gd_word" id="S1.p1.1.1.w44">is</span><span> </span><span class="gd_word" id="S1.p1.1.1.w45">done</span><span> </span><span class="gd_word" id="S1.p1.1.1.w46">by</span><span> </span><span class="gd_word" id="S1.p1.1.1.w47">trying</span><span> </span><span class="gd_word" id="S1.p1.1.1.w48">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w49">find</span><span> </span><span class="gd_word" id="S1.p1.1.1.w50">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w51">output</span><span> </span><span class="gd_word" id="S1.p1.1.1.w52">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w53">which</span><span> </span><span class="gd_word" id="S1.p1.1.1.w54">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w55">model</span><span> </span><span class="gd_word" id="S1.p1.1.1.w56">assigns</span><span> </span><span class="gd_word" id="S1.p1.1.1.w57">maximum</span><span> </span><span class="gd_word" id="S1.p1.1.1.w58">likelihood.
Unfortunately,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w59">as</span><span> </span><span class="gd_word" id="S1.p1.1.1.w60">models</span><span> </span><span class="gd_word" id="S1.p1.1.1.w61">usually</span><span> </span><span class="gd_word" id="S1.p1.1.1.w62">predict</span><span> </span><span class="gd_word" id="S1.p1.1.1.w63">tokens</span><span> </span><span class="gd_word" id="S1.p1.1.1.w64">one</span><span> </span><span class="gd_word" id="S1.p1.1.1.w65">by</span><span> </span><span class="gd_word" id="S1.p1.1.1.w66">one,</span><span> </span><span class="gd_word" id="S1.p1.1.1.w67">exact</span><span> </span><span class="gd_word" id="S1.p1.1.1.w68">search</span><span> </span><span class="gd_word" id="S1.p1.1.1.w69">is</span><span> </span><span class="gd_word" id="S1.p1.1.1.w70">not</span><span> </span><span class="gd_word" id="S1.p1.1.1.w71">feasible</span><span> </span><span class="gd_word" id="S1.p1.1.1.w72">in</span><span> </span><span class="gd_word" id="S1.p1.1.1.w73">the</span><span> </span><span class="gd_word" id="S1.p1.1.1.w74">general</span><span> </span><span class="gd_word" id="S1.p1.1.1.w75">case</span><span> </span><span class="gd_word" id="S1.p1.1.1.w76">and</span><span> </span><span class="gd_word" id="S1.p1.1.1.w77">practitioners</span><span> </span><span class="gd_word" id="S1.p1.1.1.w78">resort</span><span> </span><span class="gd_word" id="S1.p1.1.1.w79">to</span><span> </span><span class="gd_word" id="S1.p1.1.1.w80">heuristic</span><span> </span><span class="gd_word" id="S1.p1.1.1.w81">mechanisms</span><span> </span><span class="gd_word" id="S1.p1.1.1.w82">instead.</span></p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p"><span class="gd_word" id="S1.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S1.p2.1.1.w2">most</span><span> </span><span class="gd_word" id="S1.p2.1.1.w3">popular</span><span> </span><span class="gd_word" id="S1.p2.1.1.w4">of</span><span> </span><span class="gd_word" id="S1.p2.1.1.w5">these</span><span> </span><span class="gd_word" id="S1.p2.1.1.w6">heuristics</span><span> </span><span class="gd_word" id="S1.p2.1.1.w7">is</span><span> </span><span class="gd_word" id="S1.p2.1.1.w8">beam</span><span> </span><span class="gd_word" id="S1.p2.1.1.w9">search </span><cite class="ltx_cite ltx_citemacro_citep">(Reddy, <a href="#bib.bib30" title="" class="ltx_ref">1977</a>)</cite><span class="gd_word" id="S1.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S1.p2.1.2.w2">which</span><span> </span><span class="gd_word" id="S1.p2.1.2.w3">maintains</span><span> </span><span class="gd_word" id="S1.p2.1.2.w4">several</span><span> </span><span class="gd_word" id="S1.p2.1.2.w5">hypotheses</span><span> </span><span class="gd_word" id="S1.p2.1.2.w6">in</span><span> </span><span class="gd_word" id="S1.p2.1.2.w7">parallel</span><span> </span><span class="gd_word" id="S1.p2.1.2.w8">and</span><span> </span><span class="gd_word" id="S1.p2.1.2.w9">is</span><span> </span><span class="gd_word" id="S1.p2.1.2.w10">guaranteed</span><span> </span><span class="gd_word" id="S1.p2.1.2.w11">to</span><span> </span><span class="gd_word" id="S1.p2.1.2.w12">find</span><span> </span><span class="gd_word" id="S1.p2.1.2.w13">a</span><span> </span><span class="gd_word" id="S1.p2.1.2.w14">more</span><span> </span><span class="gd_word" id="S1.p2.1.2.w15">likely</span><span> </span><span class="gd_word" id="S1.p2.1.2.w16">output</span><span> </span><span class="gd_word" id="S1.p2.1.2.w17">than</span><span> </span><span class="gd_word" id="S1.p2.1.2.w18">the</span><span> </span><span class="gd_word" id="S1.p2.1.2.w19">more</span><span> </span><span class="gd_word" id="S1.p2.1.2.w20">basic</span><span> </span><span class="gd_word" id="S1.p2.1.2.w21">greedy</span><span> </span><span class="gd_word" id="S1.p2.1.2.w22">decoding.
This</span><span> </span><span class="gd_word" id="S1.p2.1.2.w23">approach</span><span> </span><span class="gd_word" id="S1.p2.1.2.w24">has</span><span> </span><span class="gd_word" id="S1.p2.1.2.w25">some</span><span> </span><span class="gd_word" id="S1.p2.1.2.w26">obvious</span><span> </span><span class="gd_word" id="S1.p2.1.2.w27">flaws:</span><span> </span><span class="gd_word" id="S1.p2.1.2.w28">for</span><span> </span><span class="gd_word" id="S1.p2.1.2.w29">one,</span><span> </span><span class="gd_word" id="S1.p2.1.2.w30">it</span><span> </span><span class="gd_word" id="S1.p2.1.2.w31">is</span><span> </span><span class="gd_word" id="S1.p2.1.2.w32">completely</span><span> </span><span class="gd_word" id="S1.p2.1.2.w33">agnostic</span><span> </span><span class="gd_word" id="S1.p2.1.2.w34">to</span><span> </span><span class="gd_word" id="S1.p2.1.2.w35">the</span><span> </span><span class="gd_word" id="S1.p2.1.2.w36">actual</span><span> </span><span class="gd_word" id="S1.p2.1.2.w37">metrics</span><span> </span><span class="gd_word" id="S1.p2.1.2.w38">(or</span><span> </span><span class="gd_word" id="S1.p2.1.2.w39">scores)</span><span> </span><span class="gd_word" id="S1.p2.1.2.w40">practitioners</span><span> </span><span class="gd_word" id="S1.p2.1.2.w41">actually</span><span> </span><span class="gd_word" id="S1.p2.1.2.w42">want</span><span> </span><span class="gd_word" id="S1.p2.1.2.w43">to</span><span> </span><span class="gd_word" id="S1.p2.1.2.w44">optimise.</span></p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p"><span class="gd_word" id="S1.p3.1.1.w1">Even</span><span> </span><span class="gd_word" id="S1.p3.1.1.w2">more</span><span> </span><span class="gd_word" id="S1.p3.1.1.w3">crucially,</span><span> </span><span class="gd_word" id="S1.p3.1.1.w4">in</span><span> </span><span class="gd_word" id="S1.p3.1.1.w5">most</span><span> </span><span class="gd_word" id="S1.p3.1.1.w6">cases</span><span> </span><span class="gd_word" id="S1.p3.1.1.w7">beam</span><span> </span><span class="gd_word" id="S1.p3.1.1.w8">search</span><span> </span><span class="gd_word" id="S1.p3.1.1.w9">fails</span><span> </span><span class="gd_word" id="S1.p3.1.1.w10">at</span><span> </span><span class="gd_word" id="S1.p3.1.1.w11">the</span><span> </span><span class="gd_word" id="S1.p3.1.1.w12">one</span><span> </span><span class="gd_word" id="S1.p3.1.1.w13">thing</span><span> </span><span class="gd_word" id="S1.p3.1.1.w14">it</span><span> </span><span class="gd_word" id="S1.p3.1.1.w15">is</span><span> </span><span class="gd_word" id="S1.p3.1.1.w16">supposed</span><span> </span><span class="gd_word" id="S1.p3.1.1.w17">to</span><span> </span><span class="gd_word" id="S1.p3.1.1.w18">do:</span><span> </span><span class="gd_word" id="S1.p3.1.1.w19">finding</span><span> </span><span class="gd_word" id="S1.p3.1.1.w20">the</span><span> </span><span class="gd_word" id="S1.p3.1.1.w21">optimal</span><span> </span><span class="gd_word" id="S1.p3.1.1.w22">output</span><span> </span><span class="gd_word" id="S1.p3.1.1.w23">sequence</span><span> </span><span class="gd_word" id="S1.p3.1.1.w24">(w.r.t</span><span> </span><span class="gd_word" id="S1.p3.1.1.w25">the</span><span> </span><span class="gd_word" id="S1.p3.1.1.w26">model),</span><span> </span><span class="gd_word" id="S1.p3.1.1.w27">as</span><span> </span><span class="gd_word" id="S1.p3.1.1.w28">shown</span><span> </span><span class="gd_word" id="S1.p3.1.1.w29">by </span><cite class="ltx_cite ltx_citemacro_citet">Stahlberg &amp; Byrne (<a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p3.1.2.w1">.
Also</span><span> </span><span class="gd_word" id="S1.p3.1.2.w2">alarming</span><span> </span><span class="gd_word" id="S1.p3.1.2.w3">are</span><span> </span><span class="gd_word" id="S1.p3.1.2.w4">the</span><span> </span><span class="gd_word" id="S1.p3.1.2.w5">findings</span><span> </span><span class="gd_word" id="S1.p3.1.2.w6">of </span><cite class="ltx_cite ltx_citemacro_citet">Welleck et al. (<a href="#bib.bib41" title="" class="ltx_ref">2020</a>)</cite><span class="gd_word" id="S1.p3.1.3.w1">,</span><span> </span><span class="gd_word" id="S1.p3.1.3.w2">proving</span><span> </span><span class="gd_word" id="S1.p3.1.3.w3">that</span><span> </span><span class="gd_word" id="S1.p3.1.3.w4">traditional</span><span> </span><span class="gd_word" id="S1.p3.1.3.w5">search</span><span> </span><span class="gd_word" id="S1.p3.1.3.w6">mechanisms</span><span> </span><span class="gd_word" id="S1.p3.1.3.w7">can</span><span> </span><span class="gd_word" id="S1.p3.1.3.w8">yield</span><span> </span><span class="gd_word" id="S1.p3.1.3.w9">infinite-length</span><span> </span><span class="gd_word" id="S1.p3.1.3.w10">outputs,</span><span> </span><span class="gd_word" id="S1.p3.1.3.w11">to</span><span> </span><span class="gd_word" id="S1.p3.1.3.w12">which</span><span> </span><span class="gd_word" id="S1.p3.1.3.w13">the</span><span> </span><span class="gd_word" id="S1.p3.1.3.w14">model</span><span> </span><span class="gd_word" id="S1.p3.1.3.w15">assigns</span><span> </span><span class="gd_word" id="S1.p3.1.3.w16">zero</span><span> </span><span class="gd_word" id="S1.p3.1.3.w17">probability.
Interestingly,</span><span> </span><span class="gd_word" id="S1.p3.1.3.w18">the</span><span> </span><span class="gd_word" id="S1.p3.1.3.w19">use</span><span> </span><span class="gd_word" id="S1.p3.1.3.w20">of</span><span> </span><span class="gd_word" id="S1.p3.1.3.w21">likelihood</span><span> </span><span class="gd_word" id="S1.p3.1.3.w22">as</span><span> </span><span class="gd_word" id="S1.p3.1.3.w23">a</span><span> </span><span class="gd_word" id="S1.p3.1.3.w24">training</span><span> </span><span class="gd_word" id="S1.p3.1.3.w25">objective</span><span> </span><span class="gd_word" id="S1.p3.1.3.w26">has</span><span> </span><span class="gd_word" id="S1.p3.1.3.w27">a</span><span> </span><span class="gd_word" id="S1.p3.1.3.w28">spectacular</span><span> </span><span class="gd_word" id="S1.p3.1.3.w29">side-effect:</span><span> </span><span class="gd_word" id="S1.p3.1.3.w30">it</span><span> </span><span class="gd_word" id="S1.p3.1.3.w31">causes</span><span> </span><span class="gd_word" id="S1.p3.1.3.w32">trained</span><span> </span><span class="gd_word" id="S1.p3.1.3.w33">models</span><span> </span><span class="gd_word" id="S1.p3.1.3.w34">to</span><span> </span><span class="gd_word" id="S1.p3.1.3.w35">have</span><span> </span><span class="gd_word" id="S1.p3.1.3.w36">an</span><span> </span><span class="gd_word" id="S1.p3.1.3.w37">inordinate</span><span> </span><span class="gd_word" id="S1.p3.1.3.w38">fondness</span><span> </span><span class="gd_word" id="S1.p3.1.3.w39">for</span><span> </span><span class="gd_word" id="S1.p3.1.3.w40">empty</span><span> </span><span class="gd_word" id="S1.p3.1.3.w41">outputs.
By</span><span> </span><span class="gd_word" id="S1.p3.1.3.w42">using</span><span> </span><span class="gd_word" id="S1.p3.1.3.w43">exact</span><span> </span><span class="gd_word" id="S1.p3.1.3.w44">search</span><span> </span><span class="gd_word" id="S1.p3.1.3.w45">on</span><span> </span><span class="gd_word" id="S1.p3.1.3.w46">the</span><span> </span><span class="gd_word" id="S1.p3.1.3.w47">output</span><span> </span><span class="gd_word" id="S1.p3.1.3.w48">likelihood</span><span> </span><span class="gd_word" id="S1.p3.1.3.w49">in</span><span> </span><span class="gd_word" id="S1.p3.1.3.w50">machine</span><span> </span><span class="gd_word" id="S1.p3.1.3.w51">translation, </span><cite class="ltx_cite ltx_citemacro_citet">Stahlberg &amp; Byrne (<a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p3.1.4.w1"/><span> </span><span class="gd_word" id="S1.p3.1.4.w2">show</span><span> </span><span class="gd_word" id="S1.p3.1.4.w3">that</span><span> </span><span class="gd_word" id="S1.p3.1.4.w4">in</span><span> </span><span class="gd_word" id="S1.p3.1.4.w5">more</span><span> </span><span class="gd_word" id="S1.p3.1.4.w6">than</span><span> </span><span class="gd_word" id="S1.p3.1.4.w7">half</span><span> </span><span class="gd_word" id="S1.p3.1.4.w8">of</span><span> </span><span class="gd_word" id="S1.p3.1.4.w9">cases</span><span> </span><span class="gd_word" id="S1.p3.1.4.w10">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w11">highest</span><span> </span><span class="gd_word" id="S1.p3.1.4.w12">scoring</span><span> </span><span class="gd_word" id="S1.p3.1.4.w13">output</span><span> </span><span class="gd_word" id="S1.p3.1.4.w14">according</span><span> </span><span class="gd_word" id="S1.p3.1.4.w15">to</span><span> </span><span class="gd_word" id="S1.p3.1.4.w16">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w17">model</span><span> </span><span class="gd_word" id="S1.p3.1.4.w18">is</span><span> </span><span class="gd_word" id="S1.p3.1.4.w19">the</span><span> </span><span class="gd_word" id="S1.p3.1.4.w20">empty</span><span> </span><span class="gd_word" id="S1.p3.1.4.w21">sentence!</span></p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p"><span class="gd_word" id="S1.p4.1.1.w1">All</span><span> </span><span class="gd_word" id="S1.p4.1.1.w2">told,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w3">we</span><span> </span><span class="gd_word" id="S1.p4.1.1.w4">rely</span><span> </span><span class="gd_word" id="S1.p4.1.1.w5">on</span><span> </span><span class="gd_word" id="S1.p4.1.1.w6">models</span><span> </span><span class="gd_word" id="S1.p4.1.1.w7">placing</span><span> </span><span class="gd_word" id="S1.p4.1.1.w8">a</span><span> </span><span class="gd_word" id="S1.p4.1.1.w9">surprising</span><span> </span><span class="gd_word" id="S1.p4.1.1.w10">emphasis</span><span> </span><span class="gd_word" id="S1.p4.1.1.w11">on</span><span> </span><span class="gd_word" id="S1.p4.1.1.w12">empty</span><span> </span><span class="gd_word" id="S1.p4.1.1.w13">outputs,</span><span> </span><span class="gd_word" id="S1.p4.1.1.w14">and</span><span> </span><span class="gd_word" id="S1.p4.1.1.w15">on</span><span> </span><span class="gd_word" id="S1.p4.1.1.w16">a</span><span> </span><span class="gd_word" id="S1.p4.1.1.w17">decoding</span><span> </span><span class="gd_word" id="S1.p4.1.1.w18">mechanism</span><span> </span><span class="gd_word" id="S1.p4.1.1.w19">which</span><span> </span><span class="gd_word" id="S1.p4.1.1.w20">usually</span><span> </span><span class="gd_word" id="S1.p4.1.1.w21">fails</span><span> </span><span class="gd_word" id="S1.p4.1.1.w22">to</span><span> </span><span class="gd_word" id="S1.p4.1.1.w23">find</span><span> </span><span class="gd_word" id="S1.p4.1.1.w24">optimal</span><span> </span><span class="gd_word" id="S1.p4.1.1.w25">outputs;</span><span> </span><span class="gd_word" id="S1.p4.1.1.w26">and</span><span> </span><span class="gd_word" id="S1.p4.1.1.w27">both</span><span> </span><span class="gd_word" id="S1.p4.1.1.w28">ignore</span><span> </span><span class="gd_word" id="S1.p4.1.1.w29">the</span><span> </span><span class="gd_word" id="S1.p4.1.1.w30">relevant</span><span> </span><span class="gd_word" id="S1.p4.1.1.w31">metrics.
One</span><span> </span><span class="gd_word" id="S1.p4.1.1.w32">can</span><span> </span><span class="gd_word" id="S1.p4.1.1.w33">then</span><span> </span><span class="gd_word" id="S1.p4.1.1.w34">justifiably</span><span> </span><span class="gd_word" id="S1.p4.1.1.w35">wonder</span><span> </span><span class="gd_word" id="S1.p4.1.1.w36">why</span><span> </span><span class="gd_word" id="S1.p4.1.1.w37">we</span><span> </span><span class="gd_word" id="S1.p4.1.1.w38">observe</span><span> </span><span class="gd_word" id="S1.p4.1.1.w39">impressive</span><span> </span><span class="gd_word" id="S1.p4.1.1.w40">MT</span><span> </span><span class="gd_word" id="S1.p4.1.1.w41">results.
 </span><cite class="ltx_cite ltx_citemacro_citet">Stahlberg &amp; Byrne (<a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p4.1.2.w1"/><span> </span><span class="gd_word" id="S1.p4.1.2.w2">provide</span><span> </span><span class="gd_word" id="S1.p4.1.2.w3">an</span><span> </span><span class="gd_word" id="S1.p4.1.2.w4">apparently</span><span> </span><span class="gd_word" id="S1.p4.1.2.w5">paradoxical</span><span> </span><span class="gd_word" id="S1.p4.1.2.w6">explanation:</span><span> </span><span class="gd_word" id="S1.p4.1.2.w7">it</span><span> </span><span class="gd_word" id="S1.p4.1.2.w8">is</span><span> </span><span class="gd_word" id="S1.p4.1.2.w9">precisely</span><span> </span><span class="gd_word" id="S1.p4.1.2.w10">because</span><span> </span><span class="gd_word" id="S1.p4.1.2.w11">the</span><span> </span><span class="gd_word" id="S1.p4.1.2.w12">decoding</span><span> </span><span class="gd_word" id="S1.p4.1.2.w13">mechanisms</span><span> </span><span class="gd_word" id="S1.p4.1.2.w14">are</span><span> </span><span class="gd_word" id="S1.p4.1.2.w15">imperfect</span><span> </span><span class="gd_word" id="S1.p4.1.2.w16">that</span><span> </span><span class="gd_word" id="S1.p4.1.2.w17">models</span><span> </span><span class="gd_word" id="S1.p4.1.2.w18">produce</span><span> </span><span class="gd_word" id="S1.p4.1.2.w19">outputs</span><span> </span><span class="gd_word" id="S1.p4.1.2.w20">of</span><span> </span><span class="gd_word" id="S1.p4.1.2.w21">high</span><span> </span><span class="gd_word" id="S1.p4.1.2.w22">quality.
 </span><cite class="ltx_cite ltx_citemacro_citet">Meister et al. (<a href="#bib.bib25" title="" class="ltx_ref">2020a</a>)</cite><span class="gd_word" id="S1.p4.1.3.w1"/><span> </span><span class="gd_word" id="S1.p4.1.3.w2">elaborate</span><span> </span><span class="gd_word" id="S1.p4.1.3.w3">on</span><span> </span><span class="gd_word" id="S1.p4.1.3.w4">this</span><span> </span><span class="gd_word" id="S1.p4.1.3.w5">assumption;</span><span> </span><span class="gd_word" id="S1.p4.1.3.w6">they</span><span> </span><span class="gd_word" id="S1.p4.1.3.w7">show</span><span> </span><span class="gd_word" id="S1.p4.1.3.w8">that</span><span> </span><span class="gd_word" id="S1.p4.1.3.w9">beam</span><span> </span><span class="gd_word" id="S1.p4.1.3.w10">search</span><span> </span><span class="gd_word" id="S1.p4.1.3.w11">optimises</span><span> </span><span class="gd_word" id="S1.p4.1.3.w12">for</span><span> </span><span class="gd_word" id="S1.p4.1.3.w13">a</span><span> </span><span class="gd_word" id="S1.p4.1.3.w14">slightly</span><span> </span><span class="gd_word" id="S1.p4.1.3.w15">modified</span><span> </span><span class="gd_word" id="S1.p4.1.3.w16">likelihood</span><span> </span><span class="gd_word" id="S1.p4.1.3.w17">objective,</span><span> </span><span class="gd_word" id="S1.p4.1.3.w18">promoting</span><span> </span><span class="gd_word" id="S1.p4.1.3.w19">uniform</span><span> </span><span class="gd_word" id="S1.p4.1.3.w20">distribution</span><span> </span><span class="gd_word" id="S1.p4.1.3.w21">probability</span><span> </span><span class="gd_word" id="S1.p4.1.3.w22">inside</span><span> </span><span class="gd_word" id="S1.p4.1.3.w23">sentences.</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p"><span class="gd_word" id="S1.p5.1.1.w1">This</span><span> </span><span class="gd_word" id="S1.p5.1.1.w2">state</span><span> </span><span class="gd_word" id="S1.p5.1.1.w3">of</span><span> </span><span class="gd_word" id="S1.p5.1.1.w4">affairs</span><span> </span><span class="gd_word" id="S1.p5.1.1.w5">seems</span><span> </span><span class="gd_word" id="S1.p5.1.1.w6">highly</span><span> </span><span class="gd_word" id="S1.p5.1.1.w7">unsatisfactory.
While</span><span> </span><span class="gd_word" id="S1.p5.1.1.w8">a</span><span> </span><span class="gd_word" id="S1.p5.1.1.w9">whole</span><span> </span><span class="gd_word" id="S1.p5.1.1.w10">body</span><span> </span><span class="gd_word" id="S1.p5.1.1.w11">of</span><span> </span><span class="gd_word" id="S1.p5.1.1.w12">work</span><span> </span><span class="gd_word" id="S1.p5.1.1.w13">has</span><span> </span><span class="gd_word" id="S1.p5.1.1.w14">been</span><span> </span><span class="gd_word" id="S1.p5.1.1.w15">devoted</span><span> </span><span class="gd_word" id="S1.p5.1.1.w16">to</span><span> </span><span class="gd_word" id="S1.p5.1.1.w17">alleviating</span><span> </span><span class="gd_word" id="S1.p5.1.1.w18">these</span><span> </span><span class="gd_word" id="S1.p5.1.1.w19">issues,</span><span> </span><span class="gd_word" id="S1.p5.1.1.w20">most</span><span> </span><span class="gd_word" id="S1.p5.1.1.w21">approaches</span><span> </span><span class="gd_word" id="S1.p5.1.1.w22">have</span><span> </span><span class="gd_word" id="S1.p5.1.1.w23">been</span><span> </span><span class="gd_word" id="S1.p5.1.1.w24">concerned</span><span> </span><span class="gd_word" id="S1.p5.1.1.w25">with</span><span> </span><span class="gd_word" id="S1.p5.1.1.w26">training </span><cite class="ltx_cite ltx_citemacro_citep">(Bengio et al., <a href="#bib.bib3" title="" class="ltx_ref">2015</a>; Ranzato et al., <a href="#bib.bib29" title="" class="ltx_ref">2016</a>; Shen et al., <a href="#bib.bib34" title="" class="ltx_ref">2016</a>; Norouzi et al., <a href="#bib.bib27" title="" class="ltx_ref">2016</a>; Bahdanau et al., <a href="#bib.bib2" title="" class="ltx_ref">2017</a>; Edunov et al., <a href="#bib.bib12" title="" class="ltx_ref">2018</a>; Leblond et al., <a href="#bib.bib23" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S1.p5.1.2.w1">,</span><span> </span><span class="gd_word" id="S1.p5.1.2.w2">or</span><span> </span><span class="gd_word" id="S1.p5.1.2.w3">making</span><span> </span><span class="gd_word" id="S1.p5.1.2.w4">the</span><span> </span><span class="gd_word" id="S1.p5.1.2.w5">search</span><span> </span><span class="gd_word" id="S1.p5.1.2.w6">mechanism</span><span> </span><span class="gd_word" id="S1.p5.1.2.w7">differentiable </span><cite class="ltx_cite ltx_citemacro_citep">(Collobert et al., <a href="#bib.bib8" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p5.1.3.w1">.
These</span><span> </span><span class="gd_word" id="S1.p5.1.3.w2">have</span><span> </span><span class="gd_word" id="S1.p5.1.3.w3">resulted</span><span> </span><span class="gd_word" id="S1.p5.1.3.w4">in</span><span> </span><span class="gd_word" id="S1.p5.1.3.w5">performance</span><span> </span><span class="gd_word" id="S1.p5.1.3.w6">increase,</span><span> </span><span class="gd_word" id="S1.p5.1.3.w7">but</span><span> </span><span class="gd_word" id="S1.p5.1.3.w8">they</span><span> </span><span class="gd_word" id="S1.p5.1.3.w9">still</span><span> </span><span class="gd_word" id="S1.p5.1.3.w10">rely</span><span> </span><span class="gd_word" id="S1.p5.1.3.w11">on</span><span> </span><span class="gd_word" id="S1.p5.1.3.w12">likelihood</span><span> </span><span class="gd_word" id="S1.p5.1.3.w13">as</span><span> </span><span class="gd_word" id="S1.p5.1.3.w14">an</span><span> </span><span class="gd_word" id="S1.p5.1.3.w15">objective</span><span> </span><span class="gd_word" id="S1.p5.1.3.w16">for</span><span> </span><span class="gd_word" id="S1.p5.1.3.w17">decoding.
Further, </span><cite class="ltx_cite ltx_citemacro_citet">Choshen et al. (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p5.1.4.w1"/><span> </span><span class="gd_word" id="S1.p5.1.4.w2">shows</span><span> </span><span class="gd_word" id="S1.p5.1.4.w3">that</span><span> </span><span class="gd_word" id="S1.p5.1.4.w4">performance</span><span> </span><span class="gd_word" id="S1.p5.1.4.w5">improvements</span><span> </span><span class="gd_word" id="S1.p5.1.4.w6">using</span><span> </span><span class="gd_word" id="S1.p5.1.4.w7">RL</span><span> </span><span class="gd_word" id="S1.p5.1.4.w8">are</span><span> </span><span class="gd_word" id="S1.p5.1.4.w9">limited</span><span> </span><span class="gd_word" id="S1.p5.1.4.w10">and</span><span> </span><span class="gd_word" id="S1.p5.1.4.w11">poorly</span><span> </span><span class="gd_word" id="S1.p5.1.4.w12">understood.</span></p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p"><span class="gd_word" id="S1.p6.1.1.w1">In</span><span> </span><span class="gd_word" id="S1.p6.1.1.w2">this</span><span> </span><span class="gd_word" id="S1.p6.1.1.w3">paper,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w4">we</span><span> </span><span class="gd_word" id="S1.p6.1.1.w5">focus</span><span> </span><span class="gd_word" id="S1.p6.1.1.w6">instead</span><span> </span><span class="gd_word" id="S1.p6.1.1.w7">on</span><span> </span><span class="gd_word" id="S1.p6.1.1.w8">contrasting</span><span> </span><span class="gd_word" id="S1.p6.1.1.w9">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w10">performance</span><span> </span><span class="gd_word" id="S1.p6.1.1.w11">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w12">beam</span><span> </span><span class="gd_word" id="S1.p6.1.1.w13">search</span><span> </span><span class="gd_word" id="S1.p6.1.1.w14">to</span><span> </span><span class="gd_word" id="S1.p6.1.1.w15">alternative</span><span> </span><span class="gd_word" id="S1.p6.1.1.w16">decoding</span><span> </span><span class="gd_word" id="S1.p6.1.1.w17">algorithms</span><span> </span><span class="gd_word" id="S1.p6.1.1.w18">aimed</span><span> </span><span class="gd_word" id="S1.p6.1.1.w19">at</span><span> </span><span class="gd_word" id="S1.p6.1.1.w20">optimising</span><span> </span><span class="gd_word" id="S1.p6.1.1.w21">various</span><span> </span><span class="gd_word" id="S1.p6.1.1.w22">metrics</span><span> </span><span class="gd_word" id="S1.p6.1.1.w23">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w24">interest</span><span> </span><span class="gd_word" id="S1.p6.1.1.w25">directly,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w26">via</span><span> </span><span class="gd_word" id="S1.p6.1.1.w27">a</span><span> </span><span class="gd_word" id="S1.p6.1.1.w28">value</span><span> </span><span class="gd_word" id="S1.p6.1.1.w29">function</span><span> </span><span class="gd_word" id="S1.p6.1.1.w30">(or</span><span> </span><span class="gd_word" id="S1.p6.1.1.w31">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w32">metric</span><span> </span><span class="gd_word" id="S1.p6.1.1.w33">itself</span><span> </span><span class="gd_word" id="S1.p6.1.1.w34">when</span><span> </span><span class="gd_word" id="S1.p6.1.1.w35">available).
Notably,</span><span> </span><span class="gd_word" id="S1.p6.1.1.w36">we</span><span> </span><span class="gd_word" id="S1.p6.1.1.w37">experiment</span><span> </span><span class="gd_word" id="S1.p6.1.1.w38">with</span><span> </span><span class="gd_word" id="S1.p6.1.1.w39">variants</span><span> </span><span class="gd_word" id="S1.p6.1.1.w40">of</span><span> </span><span class="gd_word" id="S1.p6.1.1.w41">the</span><span> </span><span class="gd_word" id="S1.p6.1.1.w42">powerful</span><span> </span><span class="gd_word" id="S1.p6.1.1.w43">Monte</span><span> </span><span class="gd_word" id="S1.p6.1.1.w44">Carlo</span><span> </span><span class="gd_word" id="S1.p6.1.1.w45">Tree</span><span> </span><span class="gd_word" id="S1.p6.1.1.w46">Search</span><span> </span><span class="gd_word" id="S1.p6.1.1.w47">(MCTS) </span><cite class="ltx_cite ltx_citemacro_citep">(Coulom, <a href="#bib.bib9" title="" class="ltx_ref">2006</a>; Kocsis &amp; Szepesvári, <a href="#bib.bib21" title="" class="ltx_ref">2006</a>)</cite><span class="gd_word" id="S1.p6.1.2.w1"/><span> </span><span class="gd_word" id="S1.p6.1.2.w2">mechanism,</span><span> </span><span class="gd_word" id="S1.p6.1.2.w3">which</span><span> </span><span class="gd_word" id="S1.p6.1.2.w4">has</span><span> </span><span class="gd_word" id="S1.p6.1.2.w5">a</span><span> </span><span class="gd_word" id="S1.p6.1.2.w6">proven</span><span> </span><span class="gd_word" id="S1.p6.1.2.w7">track</span><span> </span><span class="gd_word" id="S1.p6.1.2.w8">record</span><span> </span><span class="gd_word" id="S1.p6.1.2.w9">in</span><span> </span><span class="gd_word" id="S1.p6.1.2.w10">other</span><span> </span><span class="gd_word" id="S1.p6.1.2.w11">sequential</span><span> </span><span class="gd_word" id="S1.p6.1.2.w12">applications </span><cite class="ltx_cite ltx_citemacro_citep">(Browne et al., <a href="#bib.bib5" title="" class="ltx_ref">2012</a>; Silver et al., <a href="#bib.bib35" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S1.p6.1.3.w1">.
We</span><span> </span><span class="gd_word" id="S1.p6.1.3.w2">investigate</span><span> </span><span class="gd_word" id="S1.p6.1.3.w3">whether,</span><span> </span><span class="gd_word" id="S1.p6.1.3.w4">by</span><span> </span><span class="gd_word" id="S1.p6.1.3.w5">optimising</span><span> </span><span class="gd_word" id="S1.p6.1.3.w6">the</span><span> </span><span class="gd_word" id="S1.p6.1.3.w7">metric</span><span> </span><span class="gd_word" id="S1.p6.1.3.w8">of</span><span> </span><span class="gd_word" id="S1.p6.1.3.w9">interest</span><span> </span><span class="gd_word" id="S1.p6.1.3.w10">at</span><span> </span><span class="gd_word" id="S1.p6.1.3.w11">test</span><span> </span><span class="gd_word" id="S1.p6.1.3.w12">time,</span><span> </span><span class="gd_word" id="S1.p6.1.3.w13">one</span><span> </span><span class="gd_word" id="S1.p6.1.3.w14">can</span><span> </span><span class="gd_word" id="S1.p6.1.3.w15">obtain</span><span> </span><span class="gd_word" id="S1.p6.1.3.w16">improved</span><span> </span><span class="gd_word" id="S1.p6.1.3.w17">performance</span><span> </span><span class="gd_word" id="S1.p6.1.3.w18">compared</span><span> </span><span class="gd_word" id="S1.p6.1.3.w19">to</span><span> </span><span class="gd_word" id="S1.p6.1.3.w20">likelihood-based</span><span> </span><span class="gd_word" id="S1.p6.1.3.w21">approaches,</span><span> </span><span class="gd_word" id="S1.p6.1.3.w22">and</span><span> </span><span class="gd_word" id="S1.p6.1.3.w23">whether</span><span> </span><span class="gd_word" id="S1.p6.1.3.w24">performance</span><span> </span><span class="gd_word" id="S1.p6.1.3.w25">scales</span><span> </span><span class="gd_word" id="S1.p6.1.3.w26">with</span><span> </span><span class="gd_word" id="S1.p6.1.3.w27">the</span><span> </span><span class="gd_word" id="S1.p6.1.3.w28">amount</span><span> </span><span class="gd_word" id="S1.p6.1.3.w29">of</span><span> </span><span class="gd_word" id="S1.p6.1.3.w30">computation</span><span> </span><span class="gd_word" id="S1.p6.1.3.w31">–</span><span> </span><span class="gd_word" id="S1.p6.1.3.w32">as</span><span> </span><span class="gd_word" id="S1.p6.1.3.w33">opposed</span><span> </span><span class="gd_word" id="S1.p6.1.3.w34">to</span><span> </span><span class="gd_word" id="S1.p6.1.3.w35">that</span><span> </span><span class="gd_word" id="S1.p6.1.3.w36">of</span><span> </span><span class="gd_word" id="S1.p6.1.3.w37">beam</span><span> </span><span class="gd_word" id="S1.p6.1.3.w38">search</span><span> </span><span class="gd_word" id="S1.p6.1.3.w39">which</span><span> </span><span class="gd_word" id="S1.p6.1.3.w40">has</span><span> </span><span class="gd_word" id="S1.p6.1.3.w41">been</span><span> </span><span class="gd_word" id="S1.p6.1.3.w42">shown</span><span> </span><span class="gd_word" id="S1.p6.1.3.w43">to</span><span> </span><span class="gd_word" id="S1.p6.1.3.w44">degrade</span><span> </span><span class="gd_word" id="S1.p6.1.3.w45">with</span><span> </span><span class="gd_word" id="S1.p6.1.3.w46">large</span><span> </span><span class="gd_word" id="S1.p6.1.3.w47">beam</span><span> </span><span class="gd_word" id="S1.p6.1.3.w48">sizes </span><cite class="ltx_cite ltx_citemacro_citep">(Cohen &amp; Beck, <a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S1.p6.1.4.w1">.</span></p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p"><span class="gd_word" id="S1.p7.1.1.w1">We</span><span> </span><span class="gd_word" id="S1.p7.1.1.w2">concentrate</span><span> </span><span class="gd_word" id="S1.p7.1.1.w3">on</span><span> </span><span class="gd_word" id="S1.p7.1.1.w4">machine</span><span> </span><span class="gd_word" id="S1.p7.1.1.w5">translation</span><span> </span><span class="gd_word" id="S1.p7.1.1.w6">(MT),</span><span> </span><span class="gd_word" id="S1.p7.1.1.w7">an</span><span> </span><span class="gd_word" id="S1.p7.1.1.w8">emblematic</span><span> </span><span class="gd_word" id="S1.p7.1.1.w9">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w10">well-studied</span><span> </span><span class="gd_word" id="S1.p7.1.1.w11">sequence</span><span> </span><span class="gd_word" id="S1.p7.1.1.w12">to</span><span> </span><span class="gd_word" id="S1.p7.1.1.w13">sequence</span><span> </span><span class="gd_word" id="S1.p7.1.1.w14">task,</span><span> </span><span class="gd_word" id="S1.p7.1.1.w15">which</span><span> </span><span class="gd_word" id="S1.p7.1.1.w16">comes</span><span> </span><span class="gd_word" id="S1.p7.1.1.w17">with</span><span> </span><span class="gd_word" id="S1.p7.1.1.w18">readily</span><span> </span><span class="gd_word" id="S1.p7.1.1.w19">available</span><span> </span><span class="gd_word" id="S1.p7.1.1.w20">data</span><span> </span><span class="gd_word" id="S1.p7.1.1.w21">and</span><span> </span><span class="gd_word" id="S1.p7.1.1.w22">well-defined</span><span> </span><span class="gd_word" id="S1.p7.1.1.w23">benchmarks.</span></p>
</div>
<div id="S1.p8" class="ltx_para ltx_noindent">
<p id="S1.p8.1" class="ltx_p"><span class="gd_word" id="S1.p8.1.1.w1">Contributions.
(i)</span><span> </span><span class="gd_word" id="S1.p8.1.1.w2">We</span><span> </span><span class="gd_word" id="S1.p8.1.1.w3">distinguish</span><span> </span><span class="gd_word" id="S1.p8.1.1.w4">two</span><span> </span><span class="gd_word" id="S1.p8.1.1.w5">different</span><span> </span><span class="gd_word" id="S1.p8.1.1.w6">types</span><span> </span><span class="gd_word" id="S1.p8.1.1.w7">of</span><span> </span><span class="gd_word" id="S1.p8.1.1.w8">metrics:</span><span> </span><em id="S1.p8.1.2" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="S1.p8.1.2.w1"/><span> </span><span class="gd_word" id="S1.p8.1.2.w2">scores,</span><span> </span><span class="gd_word" id="S1.p8.1.2.w3">which</span><span> </span><span class="gd_word" id="S1.p8.1.2.w4">rely</span><span> </span><span class="gd_word" id="S1.p8.1.2.w5">on</span><span> </span><span class="gd_word" id="S1.p8.1.2.w6">ground</span><span> </span><span class="gd_word" id="S1.p8.1.2.w7">truth</span><span> </span><span class="gd_word" id="S1.p8.1.2.w8">translations,</span><span> </span><span class="gd_word" id="S1.p8.1.2.w9">in</span><span> </span><span class="gd_word" id="S1.p8.1.2.w10">contrast</span><span> </span><span class="gd_word" id="S1.p8.1.2.w11">to</span><span> </span><em id="S1.p8.1.3" class="ltx_emph ltx_font_italic">unprivileged</em><span class="gd_word" id="S1.p8.1.3.w1"/><span> </span><span class="gd_word" id="S1.p8.1.3.w2">ones.
We</span><span> </span><span class="gd_word" id="S1.p8.1.3.w3">design</span><span> </span><span class="gd_word" id="S1.p8.1.3.w4">a</span><span> </span><span class="gd_word" id="S1.p8.1.3.w5">new</span><span> </span><span class="gd_word" id="S1.p8.1.3.w6">score,</span><span> </span><span class="gd_word" id="S1.p8.1.3.w7">Multilingual</span><span> </span><span class="gd_word" id="S1.p8.1.3.w8">BERTScore,</span><span> </span><span class="gd_word" id="S1.p8.1.3.w9">as</span><span> </span><span class="gd_word" id="S1.p8.1.3.w10">an</span><span> </span><span class="gd_word" id="S1.p8.1.3.w11">imperfect</span><span> </span><span class="gd_word" id="S1.p8.1.3.w12">but</span><span> </span><span class="gd_word" id="S1.p8.1.3.w13">illustrative</span><span> </span><span class="gd_word" id="S1.p8.1.3.w14">example</span><span> </span><span class="gd_word" id="S1.p8.1.3.w15">of</span><span> </span><span class="gd_word" id="S1.p8.1.3.w16">the</span><span> </span><span class="gd_word" id="S1.p8.1.3.w17">latter.
(ii)</span><span> </span><span class="gd_word" id="S1.p8.1.3.w18">We</span><span> </span><span class="gd_word" id="S1.p8.1.3.w19">introduce</span><span> </span><span class="gd_word" id="S1.p8.1.3.w20">several</span><span> </span><span class="gd_word" id="S1.p8.1.3.w21">new</span><span> </span><span class="gd_word" id="S1.p8.1.3.w22">decoding</span><span> </span><span class="gd_word" id="S1.p8.1.3.w23">algorithms,</span><span> </span><span class="gd_word" id="S1.p8.1.3.w24">detailing</span><span> </span><span class="gd_word" id="S1.p8.1.3.w25">their</span><span> </span><span class="gd_word" id="S1.p8.1.3.w26">implementation</span><span> </span><span class="gd_word" id="S1.p8.1.3.w27">and</span><span> </span><span class="gd_word" id="S1.p8.1.3.w28">how</span><span> </span><span class="gd_word" id="S1.p8.1.3.w29">best</span><span> </span><span class="gd_word" id="S1.p8.1.3.w30">to</span><span> </span><span class="gd_word" id="S1.p8.1.3.w31">use</span><span> </span><span class="gd_word" id="S1.p8.1.3.w32">them</span><span> </span><span class="gd_word" id="S1.p8.1.3.w33">for</span><span> </span><span class="gd_word" id="S1.p8.1.3.w34">MT.
In</span><span> </span><span class="gd_word" id="S1.p8.1.3.w35">particular,</span><span> </span><span class="gd_word" id="S1.p8.1.3.w36">we</span><span> </span><span class="gd_word" id="S1.p8.1.3.w37">provide</span><span> </span><span class="gd_word" id="S1.p8.1.3.w38">a</span><span> </span><span class="gd_word" id="S1.p8.1.3.w39">blueprint</span><span> </span><span class="gd_word" id="S1.p8.1.3.w40">for</span><span> </span><span class="gd_word" id="S1.p8.1.3.w41">how</span><span> </span><span class="gd_word" id="S1.p8.1.3.w42">to</span><span> </span><span class="gd_word" id="S1.p8.1.3.w43">use</span><span> </span><span class="gd_word" id="S1.p8.1.3.w44">MCTS</span><span> </span><span class="gd_word" id="S1.p8.1.3.w45">profitably</span><span> </span><span class="gd_word" id="S1.p8.1.3.w46">in</span><span> </span><span class="gd_word" id="S1.p8.1.3.w47">NLP</span><span> </span><span class="gd_word" id="S1.p8.1.3.w48">(as</span><span> </span><span class="gd_word" id="S1.p8.1.3.w49">well</span><span> </span><span class="gd_word" id="S1.p8.1.3.w50">as</span><span> </span><span class="gd_word" id="S1.p8.1.3.w51">pseudocode</span><span> </span><span class="gd_word" id="S1.p8.1.3.w52">for</span><span> </span><span class="gd_word" id="S1.p8.1.3.w53">a</span><span> </span><span class="gd_word" id="S1.p8.1.3.w54">batched</span><span> </span><span class="gd_word" id="S1.p8.1.3.w55">Numpy-based </span><cite class="ltx_cite ltx_citemacro_citep">(Harris et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite><span class="gd_word" id="S1.p8.1.4.w1"/><span> </span><span class="gd_word" id="S1.p8.1.4.w2">implementation),</span><span> </span><span class="gd_word" id="S1.p8.1.4.w3">which</span><span> </span><span class="gd_word" id="S1.p8.1.4.w4">opens</span><span> </span><span class="gd_word" id="S1.p8.1.4.w5">the</span><span> </span><span class="gd_word" id="S1.p8.1.4.w6">door</span><span> </span><span class="gd_word" id="S1.p8.1.4.w7">for</span><span> </span><span class="gd_word" id="S1.p8.1.4.w8">many</span><span> </span><span class="gd_word" id="S1.p8.1.4.w9">exciting</span><span> </span><span class="gd_word" id="S1.p8.1.4.w10">applications.
(iii)</span><span> </span><span class="gd_word" id="S1.p8.1.4.w11">We</span><span> </span><span class="gd_word" id="S1.p8.1.4.w12">run</span><span> </span><span class="gd_word" id="S1.p8.1.4.w13">extensive</span><span> </span><span class="gd_word" id="S1.p8.1.4.w14">experiments</span><span> </span><span class="gd_word" id="S1.p8.1.4.w15">to</span><span> </span><span class="gd_word" id="S1.p8.1.4.w16">study</span><span> </span><span class="gd_word" id="S1.p8.1.4.w17">the</span><span> </span><span class="gd_word" id="S1.p8.1.4.w18">performance</span><span> </span><span class="gd_word" id="S1.p8.1.4.w19">of</span><span> </span><span class="gd_word" id="S1.p8.1.4.w20">decoding</span><span> </span><span class="gd_word" id="S1.p8.1.4.w21">mechanisms</span><span> </span><span class="gd_word" id="S1.p8.1.4.w22">for</span><span> </span><span class="gd_word" id="S1.p8.1.4.w23">different</span><span> </span><span class="gd_word" id="S1.p8.1.4.w24">metrics.
We</span><span> </span><span class="gd_word" id="S1.p8.1.4.w25">show</span><span> </span><span class="gd_word" id="S1.p8.1.4.w26">that</span><span> </span><span class="gd_word" id="S1.p8.1.4.w27">beam</span><span> </span><span class="gd_word" id="S1.p8.1.4.w28">search</span><span> </span><span class="gd_word" id="S1.p8.1.4.w29">is</span><span> </span><span class="gd_word" id="S1.p8.1.4.w30">the</span><span> </span><span class="gd_word" id="S1.p8.1.4.w31">best</span><span> </span><span class="gd_word" id="S1.p8.1.4.w32">option</span><span> </span><span class="gd_word" id="S1.p8.1.4.w33">only</span><span> </span><span class="gd_word" id="S1.p8.1.4.w34">for</span><span> </span><em id="S1.p8.1.4" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="S1.p8.1.5.w1"/><span> </span><span class="gd_word" id="S1.p8.1.5.w2">metrics.
For</span><span> </span><span class="gd_word" id="S1.p8.1.5.w3">those,</span><span> </span><span class="gd_word" id="S1.p8.1.5.w4">value-based</span><span> </span><span class="gd_word" id="S1.p8.1.5.w5">alternatives</span><span> </span><span class="gd_word" id="S1.p8.1.5.w6">falter</span><span> </span><span class="gd_word" id="S1.p8.1.5.w7">as</span><span> </span><span class="gd_word" id="S1.p8.1.5.w8">the</span><span> </span><span class="gd_word" id="S1.p8.1.5.w9">value</span><span> </span><span class="gd_word" id="S1.p8.1.5.w10">problem</span><span> </span><span class="gd_word" id="S1.p8.1.5.w11">is</span><span> </span><span class="gd_word" id="S1.p8.1.5.w12">too</span><span> </span><span class="gd_word" id="S1.p8.1.5.w13">hard</span><span> </span><span class="gd_word" id="S1.p8.1.5.w14">–</span><span> </span><span class="gd_word" id="S1.p8.1.5.w15">since</span><span> </span><span class="gd_word" id="S1.p8.1.5.w16">it</span><span> </span><span class="gd_word" id="S1.p8.1.5.w17">ultimately</span><span> </span><span class="gd_word" id="S1.p8.1.5.w18">relies</span><span> </span><span class="gd_word" id="S1.p8.1.5.w19">on</span><span> </span><span class="gd_word" id="S1.p8.1.5.w20">reconstructing</span><span> </span><span class="gd_word" id="S1.p8.1.5.w21">hidden</span><span> </span><span class="gd_word" id="S1.p8.1.5.w22">information.
For</span><span> </span><span class="gd_word" id="S1.p8.1.5.w23">unprivileged</span><span> </span><span class="gd_word" id="S1.p8.1.5.w24">scores,</span><span> </span><span class="gd_word" id="S1.p8.1.5.w25">beam</span><span> </span><span class="gd_word" id="S1.p8.1.5.w26">search</span><span> </span><span class="gd_word" id="S1.p8.1.5.w27">is</span><span> </span><span class="gd_word" id="S1.p8.1.5.w28">outperformed</span><span> </span><span class="gd_word" id="S1.p8.1.5.w29">by</span><span> </span><span class="gd_word" id="S1.p8.1.5.w30">its</span><span> </span><span class="gd_word" id="S1.p8.1.5.w31">competitors,</span><span> </span><span class="gd_word" id="S1.p8.1.5.w32">including</span><span> </span><span class="gd_word" id="S1.p8.1.5.w33">MCTS.</span></p>
</div>
<div id="S1.p9" class="ltx_para ltx_noindent">
<p id="S1.p9.1" class="ltx_p"><span class="gd_word" id="S1.p9.1.1.w1">Outline.
We</span><span> </span><span class="gd_word" id="S1.p9.1.1.w2">go</span><span> </span><span class="gd_word" id="S1.p9.1.1.w3">over</span><span> </span><span class="gd_word" id="S1.p9.1.1.w4">the</span><span> </span><span class="gd_word" id="S1.p9.1.1.w5">related</span><span> </span><span class="gd_word" id="S1.p9.1.1.w6">work</span><span> </span><span class="gd_word" id="S1.p9.1.1.w7">thoroughly</span><span> </span><span class="gd_word" id="S1.p9.1.1.w8">in</span><span> </span><span class="gd_word" id="S1.p9.1.1.w9">Section </span><a href="#S2" title="2 Related Work ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">2</a><span class="gd_word" id="S1.p9.1.2.w1">.
In</span><span> </span><span class="gd_word" id="S1.p9.1.2.w2">Section </span><a href="#S3" title="3 Machine Translation metrics ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">3</a><span class="gd_word" id="S1.p9.1.3.w1">,</span><span> </span><span class="gd_word" id="S1.p9.1.3.w2">we</span><span> </span><span class="gd_word" id="S1.p9.1.3.w3">contrast</span><span> </span><span class="gd_word" id="S1.p9.1.3.w4">several</span><span> </span><span class="gd_word" id="S1.p9.1.3.w5">types</span><span> </span><span class="gd_word" id="S1.p9.1.3.w6">of</span><span> </span><span class="gd_word" id="S1.p9.1.3.w7">metrics,</span><span> </span><span class="gd_word" id="S1.p9.1.3.w8">and</span><span> </span><span class="gd_word" id="S1.p9.1.3.w9">introduce</span><span> </span><span class="gd_word" id="S1.p9.1.3.w10">illustrative</span><span> </span><span class="gd_word" id="S1.p9.1.3.w11">examples.
We</span><span> </span><span class="gd_word" id="S1.p9.1.3.w12">review</span><span> </span><span class="gd_word" id="S1.p9.1.3.w13">beam</span><span> </span><span class="gd_word" id="S1.p9.1.3.w14">search</span><span> </span><span class="gd_word" id="S1.p9.1.3.w15">and</span><span> </span><span class="gd_word" id="S1.p9.1.3.w16">introduce</span><span> </span><span class="gd_word" id="S1.p9.1.3.w17">alternative</span><span> </span><span class="gd_word" id="S1.p9.1.3.w18">algorithms</span><span> </span><span class="gd_word" id="S1.p9.1.3.w19">in</span><span> </span><span class="gd_word" id="S1.p9.1.3.w20">Section </span><a href="#S4" title="4 Decoding algorithms ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S1.p9.1.4.w1">.
We</span><span> </span><span class="gd_word" id="S1.p9.1.4.w2">explain</span><span> </span><span class="gd_word" id="S1.p9.1.4.w3">how</span><span> </span><span class="gd_word" id="S1.p9.1.4.w4">we</span><span> </span><span class="gd_word" id="S1.p9.1.4.w5">train</span><span> </span><span class="gd_word" id="S1.p9.1.4.w6">the</span><span> </span><span class="gd_word" id="S1.p9.1.4.w7">required</span><span> </span><span class="gd_word" id="S1.p9.1.4.w8">value</span><span> </span><span class="gd_word" id="S1.p9.1.4.w9">function</span><span> </span><span class="gd_word" id="S1.p9.1.4.w10">for</span><span> </span><span class="gd_word" id="S1.p9.1.4.w11">value-based</span><span> </span><span class="gd_word" id="S1.p9.1.4.w12">methods</span><span> </span><span class="gd_word" id="S1.p9.1.4.w13">in</span><span> </span><span class="gd_word" id="S1.p9.1.4.w14">Section </span><a href="#S5" title="5 Training a value network ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">5</a><span class="gd_word" id="S1.p9.1.5.w1">.
In</span><span> </span><span class="gd_word" id="S1.p9.1.5.w2">Section </span><a href="#S6" title="6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">6</a><span class="gd_word" id="S1.p9.1.6.w1"/><span> </span><span class="gd_word" id="S1.p9.1.6.w2">we</span><span> </span><span class="gd_word" id="S1.p9.1.6.w3">introduce</span><span> </span><span class="gd_word" id="S1.p9.1.6.w4">necessary</span><span> </span><span class="gd_word" id="S1.p9.1.6.w5">architecture</span><span> </span><span class="gd_word" id="S1.p9.1.6.w6">adaptations</span><span> </span><span class="gd_word" id="S1.p9.1.6.w7">for</span><span> </span><span class="gd_word" id="S1.p9.1.6.w8">inference-intensive</span><span> </span><span class="gd_word" id="S1.p9.1.6.w9">applications</span><span> </span><span class="gd_word" id="S1.p9.1.6.w10">and</span><span> </span><span class="gd_word" id="S1.p9.1.6.w11">then</span><span> </span><span class="gd_word" id="S1.p9.1.6.w12">go</span><span> </span><span class="gd_word" id="S1.p9.1.6.w13">over</span><span> </span><span class="gd_word" id="S1.p9.1.6.w14">experimental</span><span> </span><span class="gd_word" id="S1.p9.1.6.w15">details</span><span> </span><span class="gd_word" id="S1.p9.1.6.w16">and</span><span> </span><span class="gd_word" id="S1.p9.1.6.w17">results.
Finally,</span><span> </span><span class="gd_word" id="S1.p9.1.6.w18">we</span><span> </span><span class="gd_word" id="S1.p9.1.6.w19">discuss</span><span> </span><span class="gd_word" id="S1.p9.1.6.w20">our</span><span> </span><span class="gd_word" id="S1.p9.1.6.w21">results</span><span> </span><span class="gd_word" id="S1.p9.1.6.w22">and</span><span> </span><span class="gd_word" id="S1.p9.1.6.w23">their</span><span> </span><span class="gd_word" id="S1.p9.1.6.w24">limitations</span><span> </span><span class="gd_word" id="S1.p9.1.6.w25">as</span><span> </span><span class="gd_word" id="S1.p9.1.6.w26">well</span><span> </span><span class="gd_word" id="S1.p9.1.6.w27">as</span><span> </span><span class="gd_word" id="S1.p9.1.6.w28">possible</span><span> </span><span class="gd_word" id="S1.p9.1.6.w29">next</span><span> </span><span class="gd_word" id="S1.p9.1.6.w30">steps</span><span> </span><span class="gd_word" id="S1.p9.1.6.w31">in</span><span> </span><span class="gd_word" id="S1.p9.1.6.w32">Section </span><a href="#S7" title="7 Discussion ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">7</a><span class="gd_word" id="S1.p9.1.7.w1">.</span></p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.3" class="ltx_p"><span class="gd_word" id="S2.p1.3.1.w1">Incremental</span><span> </span><span class="gd_word" id="S2.p1.3.1.w2">models</span><span> </span><span class="gd_word" id="S2.p1.3.1.w3">for</span><span> </span><span class="gd_word" id="S2.p1.3.1.w4">sequence</span><span> </span><span class="gd_word" id="S2.p1.3.1.w5">generation</span><span> </span><span class="gd_word" id="S2.p1.3.1.w6">typically</span><span> </span><span class="gd_word" id="S2.p1.3.1.w7">output</span><span> </span><span class="gd_word" id="S2.p1.3.1.w8">more</span><span> </span><span class="gd_word" id="S2.p1.3.1.w9">coherent</span><span> </span><span class="gd_word" id="S2.p1.3.1.w10">sequences,</span><span> </span><span class="gd_word" id="S2.p1.3.1.w11">as</span><span> </span><span class="gd_word" id="S2.p1.3.1.w12">each</span><span> </span><span class="gd_word" id="S2.p1.3.1.w13">token</span><span> </span><span class="gd_word" id="S2.p1.3.1.w14">prediction</span><span> </span><span class="gd_word" id="S2.p1.3.1.w15">takes</span><span> </span><span class="gd_word" id="S2.p1.3.1.w16">into</span><span> </span><span class="gd_word" id="S2.p1.3.1.w17">account</span><span> </span><span class="gd_word" id="S2.p1.3.1.w18">its</span><span> </span><span class="gd_word" id="S2.p1.3.1.w19">predecessors </span><cite class="ltx_cite ltx_citemacro_citep">(Gu et al., <a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S2.p1.3.2.w1">.
However,</span><span> </span><span class="gd_word" id="S2.p1.3.2.w2">this</span><span> </span><span class="gd_word" id="S2.p1.3.2.w3">gain</span><span> </span><span class="gd_word" id="S2.p1.3.2.w4">comes</span><span> </span><span class="gd_word" id="S2.p1.3.2.w5">at</span><span> </span><span class="gd_word" id="S2.p1.3.2.w6">a</span><span> </span><span class="gd_word" id="S2.p1.3.2.w7">cost</span><span> </span><span class="gd_word" id="S2.p1.3.2.w8">in</span><span> </span><span class="gd_word" id="S2.p1.3.2.w9">terms</span><span> </span><span class="gd_word" id="S2.p1.3.2.w10">of</span><span> </span><span class="gd_word" id="S2.p1.3.2.w11">tractability:</span><span> </span><span class="gd_word" id="S2.p1.3.2.w12">finding</span><span> </span><span class="gd_word" id="S2.p1.3.2.w13">the</span><span> </span><span class="gd_word" id="S2.p1.3.2.w14">sequence</span><span> </span><span class="gd_word" id="S2.p1.3.2.w15">with</span><span> </span><span class="gd_word" id="S2.p1.3.2.w16">maximum</span><span> </span><span class="gd_word" id="S2.p1.3.2.w17">probability</span><span> </span><span class="gd_word" id="S2.p1.3.2.w18">according</span><span> </span><span class="gd_word" id="S2.p1.3.2.w19">to</span><span> </span><span class="gd_word" id="S2.p1.3.2.w20">the</span><span> </span><span class="gd_word" id="S2.p1.3.2.w21">model</span><span> </span><span class="gd_word" id="S2.p1.3.2.w22">–</span><span> </span><math id="S2.p1.1.m1.1" class="ltx_Math" alttext="\mathrm{argmax}_{y\in\mathcal{Y}}{\pi(y|x)}" display="inline"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml"><msub id="S2.p1.1.m1.1.1.3" xref="S2.p1.1.m1.1.1.3.cmml"><mi id="S2.p1.1.m1.1.1.3.2" xref="S2.p1.1.m1.1.1.3.2.cmml">argmax</mi><mrow id="S2.p1.1.m1.1.1.3.3" xref="S2.p1.1.m1.1.1.3.3.cmml"><mi id="S2.p1.1.m1.1.1.3.3.2" xref="S2.p1.1.m1.1.1.3.3.2.cmml">y</mi><mo id="S2.p1.1.m1.1.1.3.3.1" xref="S2.p1.1.m1.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1.3.3.3" xref="S2.p1.1.m1.1.1.3.3.3.cmml">𝒴</mi></mrow></msub><mo id="S2.p1.1.m1.1.1.2" xref="S2.p1.1.m1.1.1.2.cmml">⁢</mo><mi id="S2.p1.1.m1.1.1.4" xref="S2.p1.1.m1.1.1.4.cmml">π</mi><mo id="S2.p1.1.m1.1.1.2a" xref="S2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p1.1.m1.1.1.1.1" xref="S2.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p1.1.m1.1.1.1.1.2" xref="S2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p1.1.m1.1.1.1.1.1" xref="S2.p1.1.m1.1.1.1.1.1.cmml"><mi id="S2.p1.1.m1.1.1.1.1.1.2" xref="S2.p1.1.m1.1.1.1.1.1.2.cmml">y</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S2.p1.1.m1.1.1.1.1.1.1" xref="S2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p1.1.m1.1.1.1.1.1.3" xref="S2.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.p1.1.m1.1.1.1.1.3" xref="S2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S2.p1.3.3.w1"/><span> </span><span class="gd_word" id="S2.p1.3.3.w2">–</span><span> </span><span class="gd_word" id="S2.p1.3.3.w3">becomes</span><span> </span><span class="gd_word" id="S2.p1.3.3.w4">a</span><span> </span><span class="gd_word" id="S2.p1.3.3.w5">search</span><span> </span><span class="gd_word" id="S2.p1.3.3.w6">problem</span><span> </span><span class="gd_word" id="S2.p1.3.3.w7">over</span><span> </span><span class="gd_word" id="S2.p1.3.3.w8">the</span><span> </span><span class="gd_word" id="S2.p1.3.3.w9">combinatorial</span><span> </span><span class="gd_word" id="S2.p1.3.3.w10">space</span><span> </span><math id="S2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{Y}" display="inline"><semantics id="S2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝒴</mi></semantics></math><span class="gd_word" id="S2.p1.3.4.w1">.
Given</span><span> </span><span class="gd_word" id="S2.p1.3.4.w2">the</span><span> </span><span class="gd_word" id="S2.p1.3.4.w3">size</span><span> </span><span class="gd_word" id="S2.p1.3.4.w4">of</span><span> </span><span class="gd_word" id="S2.p1.3.4.w5">the</span><span> </span><span class="gd_word" id="S2.p1.3.4.w6">(token)</span><span> </span><span class="gd_word" id="S2.p1.3.4.w7">action</span><span> </span><span class="gd_word" id="S2.p1.3.4.w8">space</span><span> </span><math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝒜</mi></semantics></math><span class="gd_word" id="S2.p1.3.5.w1">,</span><span> </span><span class="gd_word" id="S2.p1.3.5.w2">exact</span><span> </span><span class="gd_word" id="S2.p1.3.5.w3">search</span><span> </span><span class="gd_word" id="S2.p1.3.5.w4">appears</span><span> </span><span class="gd_word" id="S2.p1.3.5.w5">out</span><span> </span><span class="gd_word" id="S2.p1.3.5.w6">of</span><span> </span><span class="gd_word" id="S2.p1.3.5.w7">the</span><span> </span><span class="gd_word" id="S2.p1.3.5.w8">realm</span><span> </span><span class="gd_word" id="S2.p1.3.5.w9">of</span><span> </span><span class="gd_word" id="S2.p1.3.5.w10">possibility.
So</span><span> </span><span class="gd_word" id="S2.p1.3.5.w11">we</span><span> </span><span class="gd_word" id="S2.p1.3.5.w12">have</span><span> </span><span class="gd_word" id="S2.p1.3.5.w13">to</span><span> </span><span class="gd_word" id="S2.p1.3.5.w14">resort</span><span> </span><span class="gd_word" id="S2.p1.3.5.w15">to</span><span> </span><span class="gd_word" id="S2.p1.3.5.w16">incremental</span><span> </span><span class="gd_word" id="S2.p1.3.5.w17">prediction;</span><span> </span><span class="gd_word" id="S2.p1.3.5.w18">but</span><span> </span><span class="gd_word" id="S2.p1.3.5.w19">then</span><span> </span><span class="gd_word" id="S2.p1.3.5.w20">how</span><span> </span><span class="gd_word" id="S2.p1.3.5.w21">do</span><span> </span><span class="gd_word" id="S2.p1.3.5.w22">we</span><span> </span><span class="gd_word" id="S2.p1.3.5.w23">pick</span><span> </span><span class="gd_word" id="S2.p1.3.5.w24">individual</span><span> </span><span class="gd_word" id="S2.p1.3.5.w25">tokens,</span><span> </span><span class="gd_word" id="S2.p1.3.5.w26">without</span><span> </span><span class="gd_word" id="S2.p1.3.5.w27">knowing</span><span> </span><span class="gd_word" id="S2.p1.3.5.w28">how</span><span> </span><span class="gd_word" id="S2.p1.3.5.w29">these</span><span> </span><span class="gd_word" id="S2.p1.3.5.w30">choices</span><span> </span><span class="gd_word" id="S2.p1.3.5.w31">will</span><span> </span><span class="gd_word" id="S2.p1.3.5.w32">impact</span><span> </span><span class="gd_word" id="S2.p1.3.5.w33">the</span><span> </span><span class="gd_word" id="S2.p1.3.5.w34">likelihood</span><span> </span><span class="gd_word" id="S2.p1.3.5.w35">of</span><span> </span><span class="gd_word" id="S2.p1.3.5.w36">the</span><span> </span><span class="gd_word" id="S2.p1.3.5.w37">final</span><span> </span><span class="gd_word" id="S2.p1.3.5.w38">sequence?
We</span><span> </span><span class="gd_word" id="S2.p1.3.5.w39">start</span><span> </span><span class="gd_word" id="S2.p1.3.5.w40">by</span><span> </span><span class="gd_word" id="S2.p1.3.5.w41">describing</span><span> </span><span class="gd_word" id="S2.p1.3.5.w42">the</span><span> </span><span class="gd_word" id="S2.p1.3.5.w43">three</span><span> </span><span class="gd_word" id="S2.p1.3.5.w44">most</span><span> </span><span class="gd_word" id="S2.p1.3.5.w45">widely</span><span> </span><span class="gd_word" id="S2.p1.3.5.w46">used</span><span> </span><span class="gd_word" id="S2.p1.3.5.w47">methods,</span><span> </span><span class="gd_word" id="S2.p1.3.5.w48">which</span><span> </span><span class="gd_word" id="S2.p1.3.5.w49">all</span><span> </span><span class="gd_word" id="S2.p1.3.5.w50">pick</span><span> </span><span class="gd_word" id="S2.p1.3.5.w51">tokens</span><span> </span><span class="gd_word" id="S2.p1.3.5.w52">one</span><span> </span><span class="gd_word" id="S2.p1.3.5.w53">by</span><span> </span><span class="gd_word" id="S2.p1.3.5.w54">one</span><span> </span><span class="gd_word" id="S2.p1.3.5.w55">from</span><span> </span><span class="gd_word" id="S2.p1.3.5.w56">left</span><span> </span><span class="gd_word" id="S2.p1.3.5.w57">to</span><span> </span><span class="gd_word" id="S2.p1.3.5.w58">right.</span></p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p"><span class="gd_word" id="S2.p2.3.1.w1">The</span><span> </span><span class="gd_word" id="S2.p2.3.1.w2">sampling</span><span> </span><span class="gd_word" id="S2.p2.3.1.w3">method</span><span> </span><span class="gd_word" id="S2.p2.3.1.w4">predicts</span><span> </span><span class="gd_word" id="S2.p2.3.1.w5">tokens</span><span> </span><span class="gd_word" id="S2.p2.3.1.w6">by</span><span> </span><span class="gd_word" id="S2.p2.3.1.w7">directly</span><span> </span><span class="gd_word" id="S2.p2.3.1.w8">sampling</span><span> </span><span class="gd_word" id="S2.p2.3.1.w9">from</span><span> </span><span class="gd_word" id="S2.p2.3.1.w10">the</span><span> </span><span class="gd_word" id="S2.p2.3.1.w11">model</span><span> </span><span class="gd_word" id="S2.p2.3.1.w12">policy</span><span> </span><math id="S2.p2.1.m1.2" class="ltx_Math" alttext="\pi(y_{t+1}|x,y_{1}...y_{t})" display="inline"><semantics id="S2.p2.1.m1.2a"><mrow id="S2.p2.1.m1.2.2" xref="S2.p2.1.m1.2.2.cmml"><mi id="S2.p2.1.m1.2.2.3" xref="S2.p2.1.m1.2.2.3.cmml">π</mi><mo id="S2.p2.1.m1.2.2.2" xref="S2.p2.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.2.2.1.1" xref="S2.p2.1.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.p2.1.m1.2.2.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.2.2.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.cmml"><msub id="S2.p2.1.m1.2.2.1.1.1.3" xref="S2.p2.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.3.2" xref="S2.p2.1.m1.2.2.1.1.1.3.2.cmml">y</mi><mrow id="S2.p2.1.m1.2.2.1.1.1.3.3" xref="S2.p2.1.m1.2.2.1.1.1.3.3.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.3.3.2" xref="S2.p2.1.m1.2.2.1.1.1.3.3.2.cmml">t</mi><mo id="S2.p2.1.m1.2.2.1.1.1.3.3.1" xref="S2.p2.1.m1.2.2.1.1.1.3.3.1.cmml">+</mo><mn id="S2.p2.1.m1.2.2.1.1.1.3.3.3" xref="S2.p2.1.m1.2.2.1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S2.p2.1.m1.2.2.1.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p2.1.m1.2.2.1.1.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.1.2.cmml"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">x</mi><mo id="S2.p2.1.m1.2.2.1.1.1.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.1.2.cmml">,</mo><mrow id="S2.p2.1.m1.2.2.1.1.1.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S2.p2.1.m1.2.2.1.1.1.1.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.1.1.1.2.2" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.2.2.cmml">y</mi><mn id="S2.p2.1.m1.2.2.1.1.1.1.1.1.2.3" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S2.p2.1.m1.2.2.1.1.1.1.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mi mathvariant="normal" id="S2.p2.1.m1.2.2.1.1.1.1.1.1.3" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.3.cmml">…</mi><mo id="S2.p2.1.m1.2.2.1.1.1.1.1.1.1a" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S2.p2.1.m1.2.2.1.1.1.1.1.1.4" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.4.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.1.1.1.4.2" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.4.2.cmml">y</mi><mi id="S2.p2.1.m1.2.2.1.1.1.1.1.1.4.3" xref="S2.p2.1.m1.2.2.1.1.1.1.1.1.4.3.cmml">t</mi></msub></mrow></mrow></mrow><mo stretchy="false" id="S2.p2.1.m1.2.2.1.1.3" xref="S2.p2.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S2.p2.3.2.w1">,</span><span> </span><span class="gd_word" id="S2.p2.3.2.w2">computed</span><span> </span><span class="gd_word" id="S2.p2.3.2.w3">via</span><span> </span><span class="gd_word" id="S2.p2.3.2.w4">a</span><span> </span><span class="gd_word" id="S2.p2.3.2.w5">softmax</span><span> </span><span class="gd_word" id="S2.p2.3.2.w6">operator</span><span> </span><span class="gd_word" id="S2.p2.3.2.w7">applied</span><span> </span><span class="gd_word" id="S2.p2.3.2.w8">to</span><span> </span><span class="gd_word" id="S2.p2.3.2.w9">the</span><span> </span><span class="gd_word" id="S2.p2.3.2.w10">model</span><span> </span><span class="gd_word" id="S2.p2.3.2.w11">logits </span><cite class="ltx_cite ltx_citemacro_citep">(Ackley et al., <a href="#bib.bib1" title="" class="ltx_ref">1985</a>)</cite><span class="gd_word" id="S2.p2.3.3.w1"/><span> </span><span class="gd_word" id="S2.p2.3.3.w2">–</span><span> </span><span class="gd_word" id="S2.p2.3.3.w3">possibly</span><span> </span><span class="gd_word" id="S2.p2.3.3.w4">after</span><span> </span><span class="gd_word" id="S2.p2.3.3.w5">applying</span><span> </span><span class="gd_word" id="S2.p2.3.3.w6">a</span><span> </span><span class="gd_word" id="S2.p2.3.3.w7">temperature</span><span> </span><span class="gd_word" id="S2.p2.3.3.w8">parameter.
The</span><span> </span><span class="gd_word" id="S2.p2.3.3.w9">greedy</span><span> </span><span class="gd_word" id="S2.p2.3.3.w10">search</span><span> </span><span class="gd_word" id="S2.p2.3.3.w11">method</span><span> </span><span class="gd_word" id="S2.p2.3.3.w12">incrementally</span><span> </span><span class="gd_word" id="S2.p2.3.3.w13">picks</span><span> </span><span class="gd_word" id="S2.p2.3.3.w14">the</span><span> </span><span class="gd_word" id="S2.p2.3.3.w15">tokens</span><span> </span><span class="gd_word" id="S2.p2.3.3.w16">with</span><span> </span><span class="gd_word" id="S2.p2.3.3.w17">highest</span><span> </span><span class="gd_word" id="S2.p2.3.3.w18">probability</span><span> </span><span class="gd_word" id="S2.p2.3.3.w19">according</span><span> </span><span class="gd_word" id="S2.p2.3.3.w20">to</span><span> </span><span class="gd_word" id="S2.p2.3.3.w21">the</span><span> </span><span class="gd_word" id="S2.p2.3.3.w22">model.
This</span><span> </span><span class="gd_word" id="S2.p2.3.3.w23">inexpensive</span><span> </span><span class="gd_word" id="S2.p2.3.3.w24">approach</span><span> </span><span class="gd_word" id="S2.p2.3.3.w25">can</span><span> </span><span class="gd_word" id="S2.p2.3.3.w26">be</span><span> </span><span class="gd_word" id="S2.p2.3.3.w27">seen</span><span> </span><span class="gd_word" id="S2.p2.3.3.w28">as</span><span> </span><span class="gd_word" id="S2.p2.3.3.w29">a</span><span> </span><span class="gd_word" id="S2.p2.3.3.w30">special</span><span> </span><span class="gd_word" id="S2.p2.3.3.w31">case</span><span> </span><span class="gd_word" id="S2.p2.3.3.w32">of</span><span> </span><span class="gd_word" id="S2.p2.3.3.w33">the</span><span> </span><span class="gd_word" id="S2.p2.3.3.w34">sampling</span><span> </span><span class="gd_word" id="S2.p2.3.3.w35">method,</span><span> </span><span class="gd_word" id="S2.p2.3.3.w36">with</span><span> </span><span class="gd_word" id="S2.p2.3.3.w37">very</span><span> </span><span class="gd_word" id="S2.p2.3.3.w38">low</span><span> </span><span class="gd_word" id="S2.p2.3.3.w39">temperature.
Finally,</span><span> </span><span class="gd_word" id="S2.p2.3.3.w40">beam</span><span> </span><span class="gd_word" id="S2.p2.3.3.w41">search</span><span> </span><span class="gd_word" id="S2.p2.3.3.w42">maintains</span><span> </span><span class="gd_word" id="S2.p2.3.3.w43">a</span><span> </span><span class="gd_word" id="S2.p2.3.3.w44">beam</span><span> </span><span class="gd_word" id="S2.p2.3.3.w45">of</span><span> </span><math id="S2.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S2.p2.3.4.w1"/><span> </span><span class="gd_word" id="S2.p2.3.4.w2">possible</span><span> </span><span class="gd_word" id="S2.p2.3.4.w3">translations,</span><span> </span><span class="gd_word" id="S2.p2.3.4.w4">updating</span><span> </span><span class="gd_word" id="S2.p2.3.4.w5">them</span><span> </span><span class="gd_word" id="S2.p2.3.4.w6">incrementally</span><span> </span><span class="gd_word" id="S2.p2.3.4.w7">by</span><span> </span><span class="gd_word" id="S2.p2.3.4.w8">ranking</span><span> </span><span class="gd_word" id="S2.p2.3.4.w9">their</span><span> </span><span class="gd_word" id="S2.p2.3.4.w10">extensions</span><span> </span><span class="gd_word" id="S2.p2.3.4.w11">via</span><span> </span><span class="gd_word" id="S2.p2.3.4.w12">the</span><span> </span><span class="gd_word" id="S2.p2.3.4.w13">model</span><span> </span><span class="gd_word" id="S2.p2.3.4.w14">likelihood.
While</span><span> </span><math id="S2.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S2.p2.3.5.w1"/><span> </span><span class="gd_word" id="S2.p2.3.5.w2">times</span><span> </span><span class="gd_word" id="S2.p2.3.5.w3">more</span><span> </span><span class="gd_word" id="S2.p2.3.5.w4">expensive</span><span> </span><span class="gd_word" id="S2.p2.3.5.w5">than</span><span> </span><span class="gd_word" id="S2.p2.3.5.w6">the</span><span> </span><span class="gd_word" id="S2.p2.3.5.w7">previous</span><span> </span><span class="gd_word" id="S2.p2.3.5.w8">approaches,</span><span> </span><span class="gd_word" id="S2.p2.3.5.w9">beam</span><span> </span><span class="gd_word" id="S2.p2.3.5.w10">search</span><span> </span><span class="gd_word" id="S2.p2.3.5.w11">has</span><span> </span><span class="gd_word" id="S2.p2.3.5.w12">stood</span><span> </span><span class="gd_word" id="S2.p2.3.5.w13">the</span><span> </span><span class="gd_word" id="S2.p2.3.5.w14">test</span><span> </span><span class="gd_word" id="S2.p2.3.5.w15">of</span><span> </span><span class="gd_word" id="S2.p2.3.5.w16">time,</span><span> </span><span class="gd_word" id="S2.p2.3.5.w17">resulting</span><span> </span><span class="gd_word" id="S2.p2.3.5.w18">in</span><span> </span><span class="gd_word" id="S2.p2.3.5.w19">steady</span><span> </span><span class="gd_word" id="S2.p2.3.5.w20">performance</span><span> </span><span class="gd_word" id="S2.p2.3.5.w21">improvements</span><span> </span><span class="gd_word" id="S2.p2.3.5.w22">on</span><span> </span><span class="gd_word" id="S2.p2.3.5.w23">MT</span><span> </span><span class="gd_word" id="S2.p2.3.5.w24">tasks.</span></p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span class="gd_word" id="S2.p3.1.1.w1">Building</span><span> </span><span class="gd_word" id="S2.p3.1.1.w2">on</span><span> </span><span class="gd_word" id="S2.p3.1.1.w3">these</span><span> </span><span class="gd_word" id="S2.p3.1.1.w4">methods,</span><span> </span><span class="gd_word" id="S2.p3.1.1.w5">a</span><span> </span><span class="gd_word" id="S2.p3.1.1.w6">number</span><span> </span><span class="gd_word" id="S2.p3.1.1.w7">of</span><span> </span><span class="gd_word" id="S2.p3.1.1.w8">improvements</span><span> </span><span class="gd_word" id="S2.p3.1.1.w9">have</span><span> </span><span class="gd_word" id="S2.p3.1.1.w10">been</span><span> </span><span class="gd_word" id="S2.p3.1.1.w11">proposed.
</span><cite class="ltx_cite ltx_citemacro_citet">Welleck et al. (<a href="#bib.bib40" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p3.1.2.w1"/><span> </span><span class="gd_word" id="S2.p3.1.2.w2">explore</span><span> </span><span class="gd_word" id="S2.p3.1.2.w3">out-of-order</span><span> </span><span class="gd_word" id="S2.p3.1.2.w4">decoding,</span><span> </span><span class="gd_word" id="S2.p3.1.2.w5">where</span><span> </span><span class="gd_word" id="S2.p3.1.2.w6">the</span><span> </span><span class="gd_word" id="S2.p3.1.2.w7">model</span><span> </span><span class="gd_word" id="S2.p3.1.2.w8">additionally</span><span> </span><span class="gd_word" id="S2.p3.1.2.w9">learns</span><span> </span><span class="gd_word" id="S2.p3.1.2.w10">the</span><span> </span><span class="gd_word" id="S2.p3.1.2.w11">order</span><span> </span><span class="gd_word" id="S2.p3.1.2.w12">in</span><span> </span><span class="gd_word" id="S2.p3.1.2.w13">which</span><span> </span><span class="gd_word" id="S2.p3.1.2.w14">to</span><span> </span><span class="gd_word" id="S2.p3.1.2.w15">decode</span><span> </span><span class="gd_word" id="S2.p3.1.2.w16">tokens.
This</span><span> </span><span class="gd_word" id="S2.p3.1.2.w17">provides</span><span> </span><span class="gd_word" id="S2.p3.1.2.w18">benefits</span><span> </span><span class="gd_word" id="S2.p3.1.2.w19">in</span><span> </span><span class="gd_word" id="S2.p3.1.2.w20">a</span><span> </span><span class="gd_word" id="S2.p3.1.2.w21">variety</span><span> </span><span class="gd_word" id="S2.p3.1.2.w22">of</span><span> </span><span class="gd_word" id="S2.p3.1.2.w23">tasks,</span><span> </span><span class="gd_word" id="S2.p3.1.2.w24">but</span><span> </span><span class="gd_word" id="S2.p3.1.2.w25">unfortunately</span><span> </span><span class="gd_word" id="S2.p3.1.2.w26">not</span><span> </span><span class="gd_word" id="S2.p3.1.2.w27">MT.
</span><cite class="ltx_cite ltx_citemacro_citet">Wang et al. (<a href="#bib.bib39" title="" class="ltx_ref">2020</a>)</cite><span class="gd_word" id="S2.p3.1.3.w1"/><span> </span><span class="gd_word" id="S2.p3.1.3.w2">use</span><span> </span><span class="gd_word" id="S2.p3.1.3.w3">look-ahead</span><span> </span><span class="gd_word" id="S2.p3.1.3.w4">in</span><span> </span><span class="gd_word" id="S2.p3.1.3.w5">the</span><span> </span><span class="gd_word" id="S2.p3.1.3.w6">beam</span><span> </span><span class="gd_word" id="S2.p3.1.3.w7">search</span><span> </span><span class="gd_word" id="S2.p3.1.3.w8">to</span><span> </span><span class="gd_word" id="S2.p3.1.3.w9">take</span><span> </span><span class="gd_word" id="S2.p3.1.3.w10">into</span><span> </span><span class="gd_word" id="S2.p3.1.3.w11">account</span><span> </span><span class="gd_word" id="S2.p3.1.3.w12">future</span><span> </span><span class="gd_word" id="S2.p3.1.3.w13">likelihood,</span><span> </span><span class="gd_word" id="S2.p3.1.3.w14">which</span><span> </span><span class="gd_word" id="S2.p3.1.3.w15">yields</span><span> </span><span class="gd_word" id="S2.p3.1.3.w16">improvements</span><span> </span><span class="gd_word" id="S2.p3.1.3.w17">on</span><span> </span><span class="gd_word" id="S2.p3.1.3.w18">low-data</span><span> </span><span class="gd_word" id="S2.p3.1.3.w19">tasks,</span><span> </span><span class="gd_word" id="S2.p3.1.3.w20">but</span><span> </span><span class="gd_word" id="S2.p3.1.3.w21">again</span><span> </span><span class="gd_word" id="S2.p3.1.3.w22">does</span><span> </span><span class="gd_word" id="S2.p3.1.3.w23">not</span><span> </span><span class="gd_word" id="S2.p3.1.3.w24">outperform</span><span> </span><span class="gd_word" id="S2.p3.1.3.w25">beam</span><span> </span><span class="gd_word" id="S2.p3.1.3.w26">search</span><span> </span><span class="gd_word" id="S2.p3.1.3.w27">on</span><span> </span><span class="gd_word" id="S2.p3.1.3.w28">MT.
</span><cite class="ltx_cite ltx_citemacro_citet">Meister et al. (<a href="#bib.bib26" title="" class="ltx_ref">2020b</a>)</cite><span class="gd_word" id="S2.p3.1.4.w1"/><span> </span><span class="gd_word" id="S2.p3.1.4.w2">speeds</span><span> </span><span class="gd_word" id="S2.p3.1.4.w3">up</span><span> </span><span class="gd_word" id="S2.p3.1.4.w4">beam</span><span> </span><span class="gd_word" id="S2.p3.1.4.w5">search</span><span> </span><span class="gd_word" id="S2.p3.1.4.w6">for</span><span> </span><span class="gd_word" id="S2.p3.1.4.w7">monotonous</span><span> </span><span class="gd_word" id="S2.p3.1.4.w8">scores.</span></p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.3" class="ltx_p"><span class="gd_word" id="S2.p4.3.1.w1">Several</span><span> </span><span class="gd_word" id="S2.p4.3.1.w2">works</span><span> </span><span class="gd_word" id="S2.p4.3.1.w3">focus</span><span> </span><span class="gd_word" id="S2.p4.3.1.w4">on</span><span> </span><span class="gd_word" id="S2.p4.3.1.w5">studying</span><span> </span><span class="gd_word" id="S2.p4.3.1.w6">the</span><span> </span><span class="gd_word" id="S2.p4.3.1.w7">interplay</span><span> </span><span class="gd_word" id="S2.p4.3.1.w8">between</span><span> </span><span class="gd_word" id="S2.p4.3.1.w9">the</span><span> </span><span class="gd_word" id="S2.p4.3.1.w10">incremental</span><span> </span><span class="gd_word" id="S2.p4.3.1.w11">models</span><span> </span><span class="gd_word" id="S2.p4.3.1.w12">and</span><span> </span><span class="gd_word" id="S2.p4.3.1.w13">beam</span><span> </span><span class="gd_word" id="S2.p4.3.1.w14">search.
</span><cite class="ltx_cite ltx_citemacro_citet">Cohen &amp; Beck (<a href="#bib.bib7" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p4.3.2.w1"/><span> </span><span class="gd_word" id="S2.p4.3.2.w2">shows</span><span> </span><span class="gd_word" id="S2.p4.3.2.w3">that</span><span> </span><span class="gd_word" id="S2.p4.3.2.w4">performance</span><span> </span><span class="gd_word" id="S2.p4.3.2.w5">is</span><span> </span><span class="gd_word" id="S2.p4.3.2.w6">not</span><span> </span><span class="gd_word" id="S2.p4.3.2.w7">monotonically</span><span> </span><span class="gd_word" id="S2.p4.3.2.w8">increasing</span><span> </span><span class="gd_word" id="S2.p4.3.2.w9">with</span><span> </span><span class="gd_word" id="S2.p4.3.2.w10">beam</span><span> </span><span class="gd_word" id="S2.p4.3.2.w11">size,</span><span> </span><span class="gd_word" id="S2.p4.3.2.w12">but</span><span> </span><span class="gd_word" id="S2.p4.3.2.w13">degrades</span><span> </span><span class="gd_word" id="S2.p4.3.2.w14">after</span><span> </span><span class="gd_word" id="S2.p4.3.2.w15">a</span><span> </span><span class="gd_word" id="S2.p4.3.2.w16">fairly</span><span> </span><span class="gd_word" id="S2.p4.3.2.w17">small</span><span> </span><span class="gd_word" id="S2.p4.3.2.w18">value</span><span> </span><span class="gd_word" id="S2.p4.3.2.w19">of</span><span> </span><math id="S2.p4.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p4.1.m1.1a"><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S2.p4.3.3.w1">.
</span><cite class="ltx_cite ltx_citemacro_citet">Stahlberg &amp; Byrne (<a href="#bib.bib37" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p4.3.4.w1"/><span> </span><span class="gd_word" id="S2.p4.3.4.w2">devise</span><span> </span><span class="gd_word" id="S2.p4.3.4.w3">a</span><span> </span><span class="gd_word" id="S2.p4.3.4.w4">clever</span><span> </span><span class="gd_word" id="S2.p4.3.4.w5">exact</span><span> </span><span class="gd_word" id="S2.p4.3.4.w6">search</span><span> </span><span class="gd_word" id="S2.p4.3.4.w7">mechanism,</span><span> </span><span class="gd_word" id="S2.p4.3.4.w8">relying</span><span> </span><span class="gd_word" id="S2.p4.3.4.w9">on</span><span> </span><span class="gd_word" id="S2.p4.3.4.w10">the</span><span> </span><span class="gd_word" id="S2.p4.3.4.w11">fact</span><span> </span><span class="gd_word" id="S2.p4.3.4.w12">that</span><span> </span><span class="gd_word" id="S2.p4.3.4.w13">likelihoods</span><span> </span><span class="gd_word" id="S2.p4.3.4.w14">are</span><span> </span><span class="gd_word" id="S2.p4.3.4.w15">monotonically</span><span> </span><span class="gd_word" id="S2.p4.3.4.w16">decreasing</span><span> </span><span class="gd_word" id="S2.p4.3.4.w17">with</span><span> </span><span class="gd_word" id="S2.p4.3.4.w18">size.
While</span><span> </span><span class="gd_word" id="S2.p4.3.4.w19">still</span><span> </span><span class="gd_word" id="S2.p4.3.4.w20">prohibitively</span><span> </span><span class="gd_word" id="S2.p4.3.4.w21">expensive,</span><span> </span><span class="gd_word" id="S2.p4.3.4.w22">this</span><span> </span><span class="gd_word" id="S2.p4.3.4.w23">approach</span><span> </span><span class="gd_word" id="S2.p4.3.4.w24">underlines</span><span> </span><span class="gd_word" id="S2.p4.3.4.w25">several</span><span> </span><span class="gd_word" id="S2.p4.3.4.w26">key</span><span> </span><span class="gd_word" id="S2.p4.3.4.w27">facts.
First,</span><span> </span><span class="gd_word" id="S2.p4.3.4.w28">beam</span><span> </span><span class="gd_word" id="S2.p4.3.4.w29">search</span><span> </span><span class="gd_word" id="S2.p4.3.4.w30">does</span><span> </span><span class="gd_word" id="S2.p4.3.4.w31">not</span><span> </span><span class="gd_word" id="S2.p4.3.4.w32">recover</span><span> </span><math id="S2.p4.2.m2.1" class="ltx_Math" alttext="\mathrm{argmax}_{y\in\mathcal{Y}}{\pi(y|x)}" display="inline"><semantics id="S2.p4.2.m2.1a"><mrow id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><msub id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml"><mi id="S2.p4.2.m2.1.1.3.2" xref="S2.p4.2.m2.1.1.3.2.cmml">argmax</mi><mrow id="S2.p4.2.m2.1.1.3.3" xref="S2.p4.2.m2.1.1.3.3.cmml"><mi id="S2.p4.2.m2.1.1.3.3.2" xref="S2.p4.2.m2.1.1.3.3.2.cmml">y</mi><mo id="S2.p4.2.m2.1.1.3.3.1" xref="S2.p4.2.m2.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p4.2.m2.1.1.3.3.3" xref="S2.p4.2.m2.1.1.3.3.3.cmml">𝒴</mi></mrow></msub><mo id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml">⁢</mo><mi id="S2.p4.2.m2.1.1.4" xref="S2.p4.2.m2.1.1.4.cmml">π</mi><mo id="S2.p4.2.m2.1.1.2a" xref="S2.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p4.2.m2.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p4.2.m2.1.1.1.1.2" xref="S2.p4.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.2.m2.1.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.cmml"><mi id="S2.p4.2.m2.1.1.1.1.1.2" xref="S2.p4.2.m2.1.1.1.1.1.2.cmml">y</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S2.p4.2.m2.1.1.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p4.2.m2.1.1.1.1.1.3" xref="S2.p4.2.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.p4.2.m2.1.1.1.1.3" xref="S2.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S2.p4.3.5.w1"/><span> </span><span class="gd_word" id="S2.p4.3.5.w2">in</span><span> </span><span class="gd_word" id="S2.p4.3.5.w3">a</span><span> </span><span class="gd_word" id="S2.p4.3.5.w4">most</span><span> </span><span class="gd_word" id="S2.p4.3.5.w5">cases,</span><span> </span><span class="gd_word" id="S2.p4.3.5.w6">even</span><span> </span><span class="gd_word" id="S2.p4.3.5.w7">with</span><span> </span><span class="gd_word" id="S2.p4.3.5.w8">increased</span><span> </span><span class="gd_word" id="S2.p4.3.5.w9">computational</span><span> </span><span class="gd_word" id="S2.p4.3.5.w10">budget.
Second,</span><span> </span><math id="S2.p4.3.m3.1" class="ltx_Math" alttext="\mathrm{argmax}_{y\in\mathcal{Y}}{\pi(y|x)}" display="inline"><semantics id="S2.p4.3.m3.1a"><mrow id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml"><msub id="S2.p4.3.m3.1.1.3" xref="S2.p4.3.m3.1.1.3.cmml"><mi id="S2.p4.3.m3.1.1.3.2" xref="S2.p4.3.m3.1.1.3.2.cmml">argmax</mi><mrow id="S2.p4.3.m3.1.1.3.3" xref="S2.p4.3.m3.1.1.3.3.cmml"><mi id="S2.p4.3.m3.1.1.3.3.2" xref="S2.p4.3.m3.1.1.3.3.2.cmml">y</mi><mo id="S2.p4.3.m3.1.1.3.3.1" xref="S2.p4.3.m3.1.1.3.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p4.3.m3.1.1.3.3.3" xref="S2.p4.3.m3.1.1.3.3.3.cmml">𝒴</mi></mrow></msub><mo id="S2.p4.3.m3.1.1.2" xref="S2.p4.3.m3.1.1.2.cmml">⁢</mo><mi id="S2.p4.3.m3.1.1.4" xref="S2.p4.3.m3.1.1.4.cmml">π</mi><mo id="S2.p4.3.m3.1.1.2a" xref="S2.p4.3.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p4.3.m3.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.p4.3.m3.1.1.1.1.2" xref="S2.p4.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p4.3.m3.1.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.1.cmml"><mi id="S2.p4.3.m3.1.1.1.1.1.2" xref="S2.p4.3.m3.1.1.1.1.1.2.cmml">y</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S2.p4.3.m3.1.1.1.1.1.1" xref="S2.p4.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p4.3.m3.1.1.1.1.1.3" xref="S2.p4.3.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo stretchy="false" id="S2.p4.3.m3.1.1.1.1.3" xref="S2.p4.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S2.p4.3.6.w1"/><span> </span><span class="gd_word" id="S2.p4.3.6.w2">is</span><span> </span><span class="gd_word" id="S2.p4.3.6.w3">the</span><span> </span><span class="gd_word" id="S2.p4.3.6.w4">empty</span><span> </span><span class="gd_word" id="S2.p4.3.6.w5">sequence</span><span> </span><span class="gd_word" id="S2.p4.3.6.w6">more</span><span> </span><span class="gd_word" id="S2.p4.3.6.w7">than</span><span> </span><span class="gd_word" id="S2.p4.3.6.w8">half</span><span> </span><span class="gd_word" id="S2.p4.3.6.w9">the</span><span> </span><span class="gd_word" id="S2.p4.3.6.w10">time</span><span> </span><span class="gd_word" id="S2.p4.3.6.w11">in</span><span> </span><span class="gd_word" id="S2.p4.3.6.w12">MT.
</span><cite class="ltx_cite ltx_citemacro_citet">Eikema &amp; Aziz (<a href="#bib.bib13" title="" class="ltx_ref">2020</a>)</cite><span class="gd_word" id="S2.p4.3.7.w1"/><span> </span><span class="gd_word" id="S2.p4.3.7.w2">propose</span><span> </span><span class="gd_word" id="S2.p4.3.7.w3">an</span><span> </span><span class="gd_word" id="S2.p4.3.7.w4">interesting</span><span> </span><span class="gd_word" id="S2.p4.3.7.w5">explanation</span><span> </span><span class="gd_word" id="S2.p4.3.7.w6">for</span><span> </span><span class="gd_word" id="S2.p4.3.7.w7">this</span><span> </span><span class="gd_word" id="S2.p4.3.7.w8">observation:</span><span> </span><span class="gd_word" id="S2.p4.3.7.w9">while</span><span> </span><span class="gd_word" id="S2.p4.3.7.w10">models</span><span> </span><span class="gd_word" id="S2.p4.3.7.w11">are</span><span> </span><span class="gd_word" id="S2.p4.3.7.w12">good</span><span> </span><span class="gd_word" id="S2.p4.3.7.w13">at</span><span> </span><span class="gd_word" id="S2.p4.3.7.w14">spreading</span><span> </span><span class="gd_word" id="S2.p4.3.7.w15">probability</span><span> </span><span class="gd_word" id="S2.p4.3.7.w16">mass</span><span> </span><span class="gd_word" id="S2.p4.3.7.w17">over</span><span> </span><span class="gd_word" id="S2.p4.3.7.w18">a</span><span> </span><span class="gd_word" id="S2.p4.3.7.w19">large</span><span> </span><span class="gd_word" id="S2.p4.3.7.w20">quantity</span><span> </span><span class="gd_word" id="S2.p4.3.7.w21">of</span><span> </span><span class="gd_word" id="S2.p4.3.7.w22">acceptable</span><span> </span><span class="gd_word" id="S2.p4.3.7.w23">outputs,</span><span> </span><span class="gd_word" id="S2.p4.3.7.w24">they</span><span> </span><span class="gd_word" id="S2.p4.3.7.w25">are</span><span> </span><span class="gd_word" id="S2.p4.3.7.w26">unable</span><span> </span><span class="gd_word" id="S2.p4.3.7.w27">to</span><span> </span><span class="gd_word" id="S2.p4.3.7.w28">effectively</span><span> </span><span class="gd_word" id="S2.p4.3.7.w29">pick</span><span> </span><span class="gd_word" id="S2.p4.3.7.w30">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w31">best</span><span> </span><span class="gd_word" id="S2.p4.3.7.w32">one.
Indeed,</span><span> </span><span class="gd_word" id="S2.p4.3.7.w33">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w34">mode</span><span> </span><span class="gd_word" id="S2.p4.3.7.w35">of</span><span> </span><span class="gd_word" id="S2.p4.3.7.w36">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w37">distribution</span><span> </span><span class="gd_word" id="S2.p4.3.7.w38">might</span><span> </span><span class="gd_word" id="S2.p4.3.7.w39">even</span><span> </span><span class="gd_word" id="S2.p4.3.7.w40">be</span><span> </span><span class="gd_word" id="S2.p4.3.7.w41">disjoint</span><span> </span><span class="gd_word" id="S2.p4.3.7.w42">from</span><span> </span><span class="gd_word" id="S2.p4.3.7.w43">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w44">area</span><span> </span><span class="gd_word" id="S2.p4.3.7.w45">where</span><span> </span><span class="gd_word" id="S2.p4.3.7.w46">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w47">models</span><span> </span><span class="gd_word" id="S2.p4.3.7.w48">assigns</span><span> </span><span class="gd_word" id="S2.p4.3.7.w49">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w50">majority</span><span> </span><span class="gd_word" id="S2.p4.3.7.w51">of</span><span> </span><span class="gd_word" id="S2.p4.3.7.w52">probability</span><span> </span><span class="gd_word" id="S2.p4.3.7.w53">mass.
They</span><span> </span><span class="gd_word" id="S2.p4.3.7.w54">propose</span><span> </span><span class="gd_word" id="S2.p4.3.7.w55">minimum</span><span> </span><span class="gd_word" id="S2.p4.3.7.w56">Bayes</span><span> </span><span class="gd_word" id="S2.p4.3.7.w57">risk</span><span> </span><span class="gd_word" id="S2.p4.3.7.w58">decoding,</span><span> </span><span class="gd_word" id="S2.p4.3.7.w59">which</span><span> </span><span class="gd_word" id="S2.p4.3.7.w60">leverages</span><span> </span><span class="gd_word" id="S2.p4.3.7.w61">the</span><span> </span><span class="gd_word" id="S2.p4.3.7.w62">whole</span><span> </span><span class="gd_word" id="S2.p4.3.7.w63">distribution</span><span> </span><span class="gd_word" id="S2.p4.3.7.w64">rather</span><span> </span><span class="gd_word" id="S2.p4.3.7.w65">than</span><span> </span><span class="gd_word" id="S2.p4.3.7.w66">only</span><span> </span><span class="gd_word" id="S2.p4.3.7.w67">its</span><span> </span><span class="gd_word" id="S2.p4.3.7.w68">mode,</span><span> </span><span class="gd_word" id="S2.p4.3.7.w69">and</span><span> </span><span class="gd_word" id="S2.p4.3.7.w70">can</span><span> </span><span class="gd_word" id="S2.p4.3.7.w71">outperform</span><span> </span><span class="gd_word" id="S2.p4.3.7.w72">vanilla</span><span> </span><span class="gd_word" id="S2.p4.3.7.w73">beam</span><span> </span><span class="gd_word" id="S2.p4.3.7.w74">search</span><span> </span><span class="gd_word" id="S2.p4.3.7.w75">in</span><span> </span><span class="gd_word" id="S2.p4.3.7.w76">low-resource</span><span> </span><span class="gd_word" id="S2.p4.3.7.w77">scenarios.</span></p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.3" class="ltx_p"><span class="gd_word" id="S2.p5.3.1.w1">A</span><span> </span><span class="gd_word" id="S2.p5.3.1.w2">large</span><span> </span><span class="gd_word" id="S2.p5.3.1.w3">body</span><span> </span><span class="gd_word" id="S2.p5.3.1.w4">of</span><span> </span><span class="gd_word" id="S2.p5.3.1.w5">work</span><span> </span><span class="gd_word" id="S2.p5.3.1.w6">has</span><span> </span><span class="gd_word" id="S2.p5.3.1.w7">been</span><span> </span><span class="gd_word" id="S2.p5.3.1.w8">dedicated</span><span> </span><span class="gd_word" id="S2.p5.3.1.w9">to</span><span> </span><span class="gd_word" id="S2.p5.3.1.w10">improving</span><span> </span><span class="gd_word" id="S2.p5.3.1.w11">sampling</span><span> </span><span class="gd_word" id="S2.p5.3.1.w12">diversity,</span><span> </span><span class="gd_word" id="S2.p5.3.1.w13">which</span><span> </span><span class="gd_word" id="S2.p5.3.1.w14">plays</span><span> </span><span class="gd_word" id="S2.p5.3.1.w15">a</span><span> </span><span class="gd_word" id="S2.p5.3.1.w16">key</span><span> </span><span class="gd_word" id="S2.p5.3.1.w17">role</span><span> </span><span class="gd_word" id="S2.p5.3.1.w18">in</span><span> </span><span class="gd_word" id="S2.p5.3.1.w19">many</span><span> </span><span class="gd_word" id="S2.p5.3.1.w20">NLP</span><span> </span><span class="gd_word" id="S2.p5.3.1.w21">applications</span><span> </span><span class="gd_word" id="S2.p5.3.1.w22">–</span><span> </span><span class="gd_word" id="S2.p5.3.1.w23">though</span><span> </span><span class="gd_word" id="S2.p5.3.1.w24">not</span><span> </span><span class="gd_word" id="S2.p5.3.1.w25">usually</span><span> </span><span class="gd_word" id="S2.p5.3.1.w26">in</span><span> </span><span class="gd_word" id="S2.p5.3.1.w27">machine</span><span> </span><span class="gd_word" id="S2.p5.3.1.w28">translation.
</span><cite class="ltx_cite ltx_citemacro_citet">Fan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S2.p5.3.2.w1"/><span> </span><span class="gd_word" id="S2.p5.3.2.w2">propose</span><span> </span><span class="gd_word" id="S2.p5.3.2.w3">only</span><span> </span><span class="gd_word" id="S2.p5.3.2.w4">sampling</span><span> </span><span class="gd_word" id="S2.p5.3.2.w5">from</span><span> </span><span class="gd_word" id="S2.p5.3.2.w6">the</span><span> </span><span class="gd_word" id="S2.p5.3.2.w7">top</span><span> </span><math id="S2.p5.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p5.1.m1.1a"><mi id="S2.p5.1.m1.1.1" xref="S2.p5.1.m1.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S2.p5.3.3.w1"/><span> </span><span class="gd_word" id="S2.p5.3.3.w2">tokens</span><span> </span><span class="gd_word" id="S2.p5.3.3.w3">according</span><span> </span><span class="gd_word" id="S2.p5.3.3.w4">to</span><span> </span><span class="gd_word" id="S2.p5.3.3.w5">the</span><span> </span><span class="gd_word" id="S2.p5.3.3.w6">policy</span><span> </span><span class="gd_word" id="S2.p5.3.3.w7">to</span><span> </span><span class="gd_word" id="S2.p5.3.3.w8">avoid</span><span> </span><span class="gd_word" id="S2.p5.3.3.w9">sampling</span><span> </span><span class="gd_word" id="S2.p5.3.3.w10">from</span><span> </span><span class="gd_word" id="S2.p5.3.3.w11">the</span><span> </span><span class="gd_word" id="S2.p5.3.3.w12">tail</span><span> </span><span class="gd_word" id="S2.p5.3.3.w13">of</span><span> </span><span class="gd_word" id="S2.p5.3.3.w14">the</span><span> </span><span class="gd_word" id="S2.p5.3.3.w15">distribution.
</span><cite class="ltx_cite ltx_citemacro_citet">Holtzman et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p5.3.4.w1"/><span> </span><span class="gd_word" id="S2.p5.3.4.w2">adopt</span><span> </span><span class="gd_word" id="S2.p5.3.4.w3">a</span><span> </span><span class="gd_word" id="S2.p5.3.4.w4">similar</span><span> </span><span class="gd_word" id="S2.p5.3.4.w5">approach,</span><span> </span><span class="gd_word" id="S2.p5.3.4.w6">but</span><span> </span><span class="gd_word" id="S2.p5.3.4.w7">instead</span><span> </span><span class="gd_word" id="S2.p5.3.4.w8">of</span><span> </span><span class="gd_word" id="S2.p5.3.4.w9">fixing</span><span> </span><math id="S2.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S2.p5.2.m2.1a"><mi id="S2.p5.2.m2.1.1" xref="S2.p5.2.m2.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S2.p5.3.5.w1"/><span> </span><span class="gd_word" id="S2.p5.3.5.w2">they</span><span> </span><span class="gd_word" id="S2.p5.3.5.w3">fix</span><span> </span><math id="S2.p5.3.m3.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.p5.3.m3.1a"><mi id="S2.p5.3.m3.1.1" xref="S2.p5.3.m3.1.1.cmml">p</mi></semantics></math><span class="gd_word" id="S2.p5.3.6.w1">,</span><span> </span><span class="gd_word" id="S2.p5.3.6.w2">the</span><span> </span><span class="gd_word" id="S2.p5.3.6.w3">size</span><span> </span><span class="gd_word" id="S2.p5.3.6.w4">of</span><span> </span><span class="gd_word" id="S2.p5.3.6.w5">the</span><span> </span><span class="gd_word" id="S2.p5.3.6.w6">‘nucleus’</span><span> </span><span class="gd_word" id="S2.p5.3.6.w7">of</span><span> </span><span class="gd_word" id="S2.p5.3.6.w8">the</span><span> </span><span class="gd_word" id="S2.p5.3.6.w9">distribution</span><span> </span><span class="gd_word" id="S2.p5.3.6.w10">from</span><span> </span><span class="gd_word" id="S2.p5.3.6.w11">which</span><span> </span><span class="gd_word" id="S2.p5.3.6.w12">sampling</span><span> </span><span class="gd_word" id="S2.p5.3.6.w13">is</span><span> </span><span class="gd_word" id="S2.p5.3.6.w14">allowed</span><span> </span><span class="gd_word" id="S2.p5.3.6.w15">to</span><span> </span><span class="gd_word" id="S2.p5.3.6.w16">select</span><span> </span><span class="gd_word" id="S2.p5.3.6.w17">tokens.
This</span><span> </span><span class="gd_word" id="S2.p5.3.6.w18">performs</span><span> </span><span class="gd_word" id="S2.p5.3.6.w19">better</span><span> </span><span class="gd_word" id="S2.p5.3.6.w20">on</span><span> </span><span class="gd_word" id="S2.p5.3.6.w21">open-ended</span><span> </span><span class="gd_word" id="S2.p5.3.6.w22">tasks.
</span><cite class="ltx_cite ltx_citemacro_citet">Kool et al. (<a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S2.p5.3.7.w1"/><span> </span><span class="gd_word" id="S2.p5.3.7.w2">propose</span><span> </span><span class="gd_word" id="S2.p5.3.7.w3">a</span><span> </span><span class="gd_word" id="S2.p5.3.7.w4">search</span><span> </span><span class="gd_word" id="S2.p5.3.7.w5">mechanism</span><span> </span><span class="gd_word" id="S2.p5.3.7.w6">in-between</span><span> </span><span class="gd_word" id="S2.p5.3.7.w7">sampling</span><span> </span><span class="gd_word" id="S2.p5.3.7.w8">and</span><span> </span><span class="gd_word" id="S2.p5.3.7.w9">beam</span><span> </span><span class="gd_word" id="S2.p5.3.7.w10">search,</span><span> </span><span class="gd_word" id="S2.p5.3.7.w11">which</span><span> </span><span class="gd_word" id="S2.p5.3.7.w12">produces</span><span> </span><span class="gd_word" id="S2.p5.3.7.w13">provably</span><span> </span><span class="gd_word" id="S2.p5.3.7.w14">unique</span><span> </span><span class="gd_word" id="S2.p5.3.7.w15">samples</span><span> </span><span class="gd_word" id="S2.p5.3.7.w16">by</span><span> </span><span class="gd_word" id="S2.p5.3.7.w17">leveraging</span><span> </span><span class="gd_word" id="S2.p5.3.7.w18">the</span><span> </span><span class="gd_word" id="S2.p5.3.7.w19">Gumbel-Max</span><span> </span><span class="gd_word" id="S2.p5.3.7.w20">trick </span><cite class="ltx_cite ltx_citemacro_citep">(Gumbel, <a href="#bib.bib16" title="" class="ltx_ref">1954</a>)</cite><span class="gd_word" id="S2.p5.3.8.w1">.
</span><cite class="ltx_cite ltx_citemacro_citet">Yu et al. (<a href="#bib.bib43" title="" class="ltx_ref">2020</a>)</cite><span class="gd_word" id="S2.p5.3.9.w1"/><span> </span><span class="gd_word" id="S2.p5.3.9.w2">use</span><span> </span><span class="gd_word" id="S2.p5.3.9.w3">a</span><span> </span><span class="gd_word" id="S2.p5.3.9.w4">different,</span><span> </span><span class="gd_word" id="S2.p5.3.9.w5">much</span><span> </span><span class="gd_word" id="S2.p5.3.9.w6">more</span><span> </span><span class="gd_word" id="S2.p5.3.9.w7">expensive</span><span> </span><span class="gd_word" id="S2.p5.3.9.w8">flavor</span><span> </span><span class="gd_word" id="S2.p5.3.9.w9">of</span><span> </span><span class="gd_word" id="S2.p5.3.9.w10">MCTS</span><span> </span><span class="gd_word" id="S2.p5.3.9.w11">to</span><span> </span><span class="gd_word" id="S2.p5.3.9.w12">add</span><span> </span><span class="gd_word" id="S2.p5.3.9.w13">diverse</span><span> </span><span class="gd_word" id="S2.p5.3.9.w14">samples</span><span> </span><span class="gd_word" id="S2.p5.3.9.w15">to</span><span> </span><span class="gd_word" id="S2.p5.3.9.w16">a</span><span> </span><span class="gd_word" id="S2.p5.3.9.w17">larger</span><span> </span><span class="gd_word" id="S2.p5.3.9.w18">NMT</span><span> </span><span class="gd_word" id="S2.p5.3.9.w19">system:</span><span> </span><span class="gd_word" id="S2.p5.3.9.w20">instead</span><span> </span><span class="gd_word" id="S2.p5.3.9.w21">of</span><span> </span><span class="gd_word" id="S2.p5.3.9.w22">relying</span><span> </span><span class="gd_word" id="S2.p5.3.9.w23">on</span><span> </span><span class="gd_word" id="S2.p5.3.9.w24">direct</span><span> </span><span class="gd_word" id="S2.p5.3.9.w25">value</span><span> </span><span class="gd_word" id="S2.p5.3.9.w26">estimation,</span><span> </span><span class="gd_word" id="S2.p5.3.9.w27">they</span><span> </span><span class="gd_word" id="S2.p5.3.9.w28">rely</span><span> </span><span class="gd_word" id="S2.p5.3.9.w29">on</span><span> </span><span class="gd_word" id="S2.p5.3.9.w30">(expensive)</span><span> </span><span class="gd_word" id="S2.p5.3.9.w31">rollouts</span><span> </span><span class="gd_word" id="S2.p5.3.9.w32">to</span><span> </span><span class="gd_word" id="S2.p5.3.9.w33">estimate</span><span> </span><span class="gd_word" id="S2.p5.3.9.w34">node</span><span> </span><span class="gd_word" id="S2.p5.3.9.w35">values.</span></p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p"><span class="gd_word" id="S2.p6.1.1.w1">Finally,</span><span> </span><span class="gd_word" id="S2.p6.1.1.w2">the</span><span> </span><span class="gd_word" id="S2.p6.1.1.w3">most</span><span> </span><span class="gd_word" id="S2.p6.1.1.w4">pertinent</span><span> </span><span class="gd_word" id="S2.p6.1.1.w5">approach</span><span> </span><span class="gd_word" id="S2.p6.1.1.w6">to</span><span> </span><span class="gd_word" id="S2.p6.1.1.w7">optimise</span><span> </span><span class="gd_word" id="S2.p6.1.1.w8">various</span><span> </span><span class="gd_word" id="S2.p6.1.1.w9">metrics</span><span> </span><span class="gd_word" id="S2.p6.1.1.w10">–</span><span> </span><span class="gd_word" id="S2.p6.1.1.w11">and</span><span> </span><span class="gd_word" id="S2.p6.1.1.w12">most</span><span> </span><span class="gd_word" id="S2.p6.1.1.w13">closely</span><span> </span><span class="gd_word" id="S2.p6.1.1.w14">related</span><span> </span><span class="gd_word" id="S2.p6.1.1.w15">to</span><span> </span><span class="gd_word" id="S2.p6.1.1.w16">our</span><span> </span><span class="gd_word" id="S2.p6.1.1.w17">proposed</span><span> </span><span class="gd_word" id="S2.p6.1.1.w18">MCTS</span><span> </span><span class="gd_word" id="S2.p6.1.1.w19">decoding</span><span> </span><span class="gd_word" id="S2.p6.1.1.w20">–</span><span> </span><span class="gd_word" id="S2.p6.1.1.w21">is</span><span> </span><span class="gd_word" id="S2.p6.1.1.w22">value-guided</span><span> </span><span class="gd_word" id="S2.p6.1.1.w23">beam</span><span> </span><span class="gd_word" id="S2.p6.1.1.w24">search,</span><span> </span><span class="gd_word" id="S2.p6.1.1.w25">as</span><span> </span><span class="gd_word" id="S2.p6.1.1.w26">developed</span><span> </span><span class="gd_word" id="S2.p6.1.1.w27">by </span><cite class="ltx_cite ltx_citemacro_citet">He et al. (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>); Ren et al. (<a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S2.p6.1.2.w1"/><span> </span><span class="gd_word" id="S2.p6.1.2.w2">for</span><span> </span><span class="gd_word" id="S2.p6.1.2.w3">MT</span><span> </span><span class="gd_word" id="S2.p6.1.2.w4">and</span><span> </span><span class="gd_word" id="S2.p6.1.2.w5">image</span><span> </span><span class="gd_word" id="S2.p6.1.2.w6">captioning.
Contrary</span><span> </span><span class="gd_word" id="S2.p6.1.2.w7">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w8">all</span><span> </span><span class="gd_word" id="S2.p6.1.2.w9">other</span><span> </span><span class="gd_word" id="S2.p6.1.2.w10">methods</span><span> </span><span class="gd_word" id="S2.p6.1.2.w11">presented</span><span> </span><span class="gd_word" id="S2.p6.1.2.w12">in</span><span> </span><span class="gd_word" id="S2.p6.1.2.w13">this</span><span> </span><span class="gd_word" id="S2.p6.1.2.w14">section,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w15">this</span><span> </span><span class="gd_word" id="S2.p6.1.2.w16">approach</span><span> </span><span class="gd_word" id="S2.p6.1.2.w17">does</span><span> </span><span class="gd_word" id="S2.p6.1.2.w18">not</span><span> </span><span class="gd_word" id="S2.p6.1.2.w19">solely</span><span> </span><span class="gd_word" id="S2.p6.1.2.w20">rely</span><span> </span><span class="gd_word" id="S2.p6.1.2.w21">on</span><span> </span><span class="gd_word" id="S2.p6.1.2.w22">model</span><span> </span><span class="gd_word" id="S2.p6.1.2.w23">likelihood.
In</span><span> </span><span class="gd_word" id="S2.p6.1.2.w24">both</span><span> </span><span class="gd_word" id="S2.p6.1.2.w25">papers</span><span> </span><span class="gd_word" id="S2.p6.1.2.w26">a</span><span> </span><span class="gd_word" id="S2.p6.1.2.w27">value</span><span> </span><span class="gd_word" id="S2.p6.1.2.w28">network</span><span> </span><span class="gd_word" id="S2.p6.1.2.w29">–</span><span> </span><span class="gd_word" id="S2.p6.1.2.w30">estimating</span><span> </span><span class="gd_word" id="S2.p6.1.2.w31">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w32">eventual</span><span> </span><span class="gd_word" id="S2.p6.1.2.w33">score</span><span> </span><span class="gd_word" id="S2.p6.1.2.w34">from</span><span> </span><span class="gd_word" id="S2.p6.1.2.w35">an</span><span> </span><span class="gd_word" id="S2.p6.1.2.w36">unfinished</span><span> </span><span class="gd_word" id="S2.p6.1.2.w37">sample</span><span> </span><span class="gd_word" id="S2.p6.1.2.w38">–</span><span> </span><span class="gd_word" id="S2.p6.1.2.w39">is</span><span> </span><span class="gd_word" id="S2.p6.1.2.w40">trained</span><span> </span><span class="gd_word" id="S2.p6.1.2.w41">in</span><span> </span><span class="gd_word" id="S2.p6.1.2.w42">addition</span><span> </span><span class="gd_word" id="S2.p6.1.2.w43">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w44">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w45">policy</span><span> </span><span class="gd_word" id="S2.p6.1.2.w46">network.
Then</span><span> </span><span class="gd_word" id="S2.p6.1.2.w47">instead</span><span> </span><span class="gd_word" id="S2.p6.1.2.w48">of</span><span> </span><span class="gd_word" id="S2.p6.1.2.w49">following</span><span> </span><span class="gd_word" id="S2.p6.1.2.w50">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w51">likelihood</span><span> </span><span class="gd_word" id="S2.p6.1.2.w52">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w53">select</span><span> </span><span class="gd_word" id="S2.p6.1.2.w54">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w55">hypotheses</span><span> </span><span class="gd_word" id="S2.p6.1.2.w56">on</span><span> </span><span class="gd_word" id="S2.p6.1.2.w57">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w58">beam,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w59">one</span><span> </span><span class="gd_word" id="S2.p6.1.2.w60">uses</span><span> </span><span class="gd_word" id="S2.p6.1.2.w61">a</span><span> </span><span class="gd_word" id="S2.p6.1.2.w62">linear</span><span> </span><span class="gd_word" id="S2.p6.1.2.w63">combination</span><span> </span><span class="gd_word" id="S2.p6.1.2.w64">of</span><span> </span><span class="gd_word" id="S2.p6.1.2.w65">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w66">policy</span><span> </span><span class="gd_word" id="S2.p6.1.2.w67">logits</span><span> </span><span class="gd_word" id="S2.p6.1.2.w68">and</span><span> </span><span class="gd_word" id="S2.p6.1.2.w69">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w70">value.
This</span><span> </span><span class="gd_word" id="S2.p6.1.2.w71">approach</span><span> </span><span class="gd_word" id="S2.p6.1.2.w72">has</span><span> </span><span class="gd_word" id="S2.p6.1.2.w73">shown</span><span> </span><span class="gd_word" id="S2.p6.1.2.w74">improved</span><span> </span><span class="gd_word" id="S2.p6.1.2.w75">performance</span><span> </span><span class="gd_word" id="S2.p6.1.2.w76">compared</span><span> </span><span class="gd_word" id="S2.p6.1.2.w77">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w78">vanilla</span><span> </span><span class="gd_word" id="S2.p6.1.2.w79">beam</span><span> </span><span class="gd_word" id="S2.p6.1.2.w80">search;</span><span> </span><span class="gd_word" id="S2.p6.1.2.w81">notably,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w82">it</span><span> </span><span class="gd_word" id="S2.p6.1.2.w83">is</span><span> </span><span class="gd_word" id="S2.p6.1.2.w84">less</span><span> </span><span class="gd_word" id="S2.p6.1.2.w85">sensitive</span><span> </span><span class="gd_word" id="S2.p6.1.2.w86">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w87">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w88">chosen</span><span> </span><span class="gd_word" id="S2.p6.1.2.w89">beam</span><span> </span><span class="gd_word" id="S2.p6.1.2.w90">size.
While</span><span> </span><span class="gd_word" id="S2.p6.1.2.w91">this</span><span> </span><span class="gd_word" id="S2.p6.1.2.w92">method</span><span> </span><span class="gd_word" id="S2.p6.1.2.w93">uses</span><span> </span><span class="gd_word" id="S2.p6.1.2.w94">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w95">value</span><span> </span><span class="gd_word" id="S2.p6.1.2.w96">exclusively</span><span> </span><span class="gd_word" id="S2.p6.1.2.w97">for</span><span> </span><span class="gd_word" id="S2.p6.1.2.w98">one-step</span><span> </span><span class="gd_word" id="S2.p6.1.2.w99">look-aheads,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w100">MCTS</span><span> </span><span class="gd_word" id="S2.p6.1.2.w101">can</span><span> </span><span class="gd_word" id="S2.p6.1.2.w102">be</span><span> </span><span class="gd_word" id="S2.p6.1.2.w103">leveraged</span><span> </span><span class="gd_word" id="S2.p6.1.2.w104">to</span><span> </span><span class="gd_word" id="S2.p6.1.2.w105">explore</span><span> </span><span class="gd_word" id="S2.p6.1.2.w106">further</span><span> </span><span class="gd_word" id="S2.p6.1.2.w107">in</span><span> </span><span class="gd_word" id="S2.p6.1.2.w108">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w109">future.
Additionally,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w110">it</span><span> </span><span class="gd_word" id="S2.p6.1.2.w111">requires</span><span> </span><span class="gd_word" id="S2.p6.1.2.w112">evaluating</span><span> </span><span class="gd_word" id="S2.p6.1.2.w113">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w114">value</span><span> </span><span class="gd_word" id="S2.p6.1.2.w115">score</span><span> </span><span class="gd_word" id="S2.p6.1.2.w116">of</span><span> </span><span class="gd_word" id="S2.p6.1.2.w117">all</span><span> </span><span class="gd_word" id="S2.p6.1.2.w118">tokens</span><span> </span><span class="gd_word" id="S2.p6.1.2.w119">at</span><span> </span><span class="gd_word" id="S2.p6.1.2.w120">each</span><span> </span><span class="gd_word" id="S2.p6.1.2.w121">step,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w122">which</span><span> </span><span class="gd_word" id="S2.p6.1.2.w123">can</span><span> </span><span class="gd_word" id="S2.p6.1.2.w124">be</span><span> </span><span class="gd_word" id="S2.p6.1.2.w125">prohibitively</span><span> </span><span class="gd_word" id="S2.p6.1.2.w126">expensive</span><span> </span><span class="gd_word" id="S2.p6.1.2.w127">if</span><span> </span><span class="gd_word" id="S2.p6.1.2.w128">the</span><span> </span><span class="gd_word" id="S2.p6.1.2.w129">action</span><span> </span><span class="gd_word" id="S2.p6.1.2.w130">space</span><span> </span><span class="gd_word" id="S2.p6.1.2.w131">is</span><span> </span><span class="gd_word" id="S2.p6.1.2.w132">big</span><span> </span><span class="gd_word" id="S2.p6.1.2.w133">(in</span><span> </span><span class="gd_word" id="S2.p6.1.2.w134">MT,</span><span> </span><span class="gd_word" id="S2.p6.1.2.w135">one</span><span> </span><span class="gd_word" id="S2.p6.1.2.w136">routinely</span><span> </span><span class="gd_word" id="S2.p6.1.2.w137">uses</span><span> </span><span class="gd_word" id="S2.p6.1.2.w138">vocabularies</span><span> </span><span class="gd_word" id="S2.p6.1.2.w139">of</span><span> </span><span class="gd_word" id="S2.p6.1.2.w140">size</span><span> </span><span class="gd_word" id="S2.p6.1.2.w141">larger</span><span> </span><span class="gd_word" id="S2.p6.1.2.w142">than</span><span> </span><span class="gd_word" id="S2.p6.1.2.w143">30000).</span></p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Machine Translation metrics</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.3" class="ltx_p"><span class="gd_word" id="S3.p1.3.1.w1">There</span><span> </span><span class="gd_word" id="S3.p1.3.1.w2">are</span><span> </span><span class="gd_word" id="S3.p1.3.1.w3">two</span><span> </span><span class="gd_word" id="S3.p1.3.1.w4">main</span><span> </span><span class="gd_word" id="S3.p1.3.1.w5">evaluation</span><span> </span><span class="gd_word" id="S3.p1.3.1.w6">strategies</span><span> </span><span class="gd_word" id="S3.p1.3.1.w7">for</span><span> </span><span class="gd_word" id="S3.p1.3.1.w8">MT</span><span> </span><span class="gd_word" id="S3.p1.3.1.w9">outputs.
The</span><span> </span><span class="gd_word" id="S3.p1.3.1.w10">first</span><span> </span><span class="gd_word" id="S3.p1.3.1.w11">one</span><span> </span><span class="gd_word" id="S3.p1.3.1.w12">crucially</span><span> </span><span class="gd_word" id="S3.p1.3.1.w13">relies</span><span> </span><span class="gd_word" id="S3.p1.3.1.w14">on</span><span> </span><span class="gd_word" id="S3.p1.3.1.w15">having</span><span> </span><span class="gd_word" id="S3.p1.3.1.w16">access</span><span> </span><span class="gd_word" id="S3.p1.3.1.w17">to</span><span> </span><span class="gd_word" id="S3.p1.3.1.w18">a</span><span> </span><span class="gd_word" id="S3.p1.3.1.w19">held-out</span><span> </span><span class="gd_word" id="S3.p1.3.1.w20">test</span><span> </span><span class="gd_word" id="S3.p1.3.1.w21">set</span><span> </span><span class="gd_word" id="S3.p1.3.1.w22">of</span><span> </span><span class="gd_word" id="S3.p1.3.1.w23">high</span><span> </span><span class="gd_word" id="S3.p1.3.1.w24">quality</span><span> </span><span class="gd_word" id="S3.p1.3.1.w25">(input,</span><span> </span><span class="gd_word" id="S3.p1.3.1.w26">output)</span><span> </span><span class="gd_word" id="S3.p1.3.1.w27">sentence</span><span> </span><span class="gd_word" id="S3.p1.3.1.w28">pairs</span><span> </span><math id="S3.p1.1.m1.2" class="ltx_Math" alttext="(x,y_{x})_{x\in\mathcal{X}}" display="inline"><semantics id="S3.p1.1.m1.2a"><msub id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml"><mrow id="S3.p1.1.m1.2.2.1.1" xref="S3.p1.1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.p1.1.m1.2.2.1.1.2" xref="S3.p1.1.m1.2.2.1.2.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">x</mi><mo id="S3.p1.1.m1.2.2.1.1.3" xref="S3.p1.1.m1.2.2.1.2.cmml">,</mo><msub id="S3.p1.1.m1.2.2.1.1.1" xref="S3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.p1.1.m1.2.2.1.1.1.2" xref="S3.p1.1.m1.2.2.1.1.1.2.cmml">y</mi><mi id="S3.p1.1.m1.2.2.1.1.1.3" xref="S3.p1.1.m1.2.2.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S3.p1.1.m1.2.2.1.1.4" xref="S3.p1.1.m1.2.2.1.2.cmml">)</mo></mrow><mrow id="S3.p1.1.m1.2.2.3" xref="S3.p1.1.m1.2.2.3.cmml"><mi id="S3.p1.1.m1.2.2.3.2" xref="S3.p1.1.m1.2.2.3.2.cmml">x</mi><mo id="S3.p1.1.m1.2.2.3.1" xref="S3.p1.1.m1.2.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.2.2.3.3" xref="S3.p1.1.m1.2.2.3.3.cmml">𝒳</mi></mrow></msub></semantics></math><span class="gd_word" id="S3.p1.3.2.w1">.
One</span><span> </span><span class="gd_word" id="S3.p1.3.2.w2">can</span><span> </span><span class="gd_word" id="S3.p1.3.2.w3">then</span><span> </span><span class="gd_word" id="S3.p1.3.2.w4">compute</span><span> </span><span class="gd_word" id="S3.p1.3.2.w5">a</span><span> </span><span class="gd_word" id="S3.p1.3.2.w6">monolingual</span><span> </span><span class="gd_word" id="S3.p1.3.2.w7">similarity</span><span> </span><span class="gd_word" id="S3.p1.3.2.w8">score</span><span> </span><span class="gd_word" id="S3.p1.3.2.w9">between</span><span> </span><span class="gd_word" id="S3.p1.3.2.w10">the</span><span> </span><span class="gd_word" id="S3.p1.3.2.w11">system’s</span><span> </span><span class="gd_word" id="S3.p1.3.2.w12">outputs</span><span> </span><math id="S3.p1.2.m2.1" class="ltx_Math" alttext="(\hat{y}_{x})_{x\in\mathcal{X}}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mrow id="S3.p1.2.m2.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.1.1.1.1.2" xref="S3.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.2.m2.1.1.1.1.1" xref="S3.p1.2.m2.1.1.1.1.1.cmml"><mover accent="true" id="S3.p1.2.m2.1.1.1.1.1.2" xref="S3.p1.2.m2.1.1.1.1.1.2.cmml"><mi id="S3.p1.2.m2.1.1.1.1.1.2.2" xref="S3.p1.2.m2.1.1.1.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S3.p1.2.m2.1.1.1.1.1.2.1" xref="S3.p1.2.m2.1.1.1.1.1.2.1.cmml">^</mo></mover><mi id="S3.p1.2.m2.1.1.1.1.1.3" xref="S3.p1.2.m2.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S3.p1.2.m2.1.1.1.1.3" xref="S3.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">x</mi><mo id="S3.p1.2.m2.1.1.3.1" xref="S3.p1.2.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">𝒳</mi></mrow></msub></semantics></math><span class="gd_word" id="S3.p1.3.3.w1"/><span> </span><span class="gd_word" id="S3.p1.3.3.w2">and</span><span> </span><span class="gd_word" id="S3.p1.3.3.w3">the</span><span> </span><span class="gd_word" id="S3.p1.3.3.w4">ground</span><span> </span><span class="gd_word" id="S3.p1.3.3.w5">truth</span><span> </span><span class="gd_word" id="S3.p1.3.3.w6">outputs</span><span> </span><math id="S3.p1.3.m3.1" class="ltx_Math" alttext="(y_{x})_{x\in\mathcal{X}}" display="inline"><semantics id="S3.p1.3.m3.1a"><msub id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml"><mrow id="S3.p1.3.m3.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p1.3.m3.1.1.1.1.2" xref="S3.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.p1.3.m3.1.1.1.1.1" xref="S3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S3.p1.3.m3.1.1.1.1.1.2" xref="S3.p1.3.m3.1.1.1.1.1.2.cmml">y</mi><mi id="S3.p1.3.m3.1.1.1.1.1.3" xref="S3.p1.3.m3.1.1.1.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S3.p1.3.m3.1.1.1.1.3" xref="S3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.p1.3.m3.1.1.3" xref="S3.p1.3.m3.1.1.3.cmml"><mi id="S3.p1.3.m3.1.1.3.2" xref="S3.p1.3.m3.1.1.3.2.cmml">x</mi><mo id="S3.p1.3.m3.1.1.3.1" xref="S3.p1.3.m3.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m3.1.1.3.3" xref="S3.p1.3.m3.1.1.3.3.cmml">𝒳</mi></mrow></msub></semantics></math><span class="gd_word" id="S3.p1.3.4.w1">.
Common</span><span> </span><span class="gd_word" id="S3.p1.3.4.w2">metrics</span><span> </span><span class="gd_word" id="S3.p1.3.4.w3">include</span><span> </span><span class="gd_word" id="S3.p1.3.4.w4">BLEU </span><cite class="ltx_cite ltx_citemacro_citep">(Papineni et al., <a href="#bib.bib28" title="" class="ltx_ref">2002</a>)</cite><span class="gd_word" id="S3.p1.3.5.w1">,</span><span> </span><span class="gd_word" id="S3.p1.3.5.w2">METEOR </span><cite class="ltx_cite ltx_citemacro_citep">(Denkowski &amp; Lavie, <a href="#bib.bib10" title="" class="ltx_ref">2014</a>)</cite><span class="gd_word" id="S3.p1.3.6.w1"/><span> </span><span class="gd_word" id="S3.p1.3.6.w2">which</span><span> </span><span class="gd_word" id="S3.p1.3.6.w3">takes</span><span> </span><span class="gd_word" id="S3.p1.3.6.w4">into</span><span> </span><span class="gd_word" id="S3.p1.3.6.w5">account</span><span> </span><span class="gd_word" id="S3.p1.3.6.w6">synonyms;</span><span> </span><span class="gd_word" id="S3.p1.3.6.w7">or</span><span> </span><span class="gd_word" id="S3.p1.3.6.w8">BERTScore </span><cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S3.p1.3.7.w1">.
We</span><span> </span><span class="gd_word" id="S3.p1.3.7.w2">refer</span><span> </span><span class="gd_word" id="S3.p1.3.7.w3">to</span><span> </span><span class="gd_word" id="S3.p1.3.7.w4">this</span><span> </span><span class="gd_word" id="S3.p1.3.7.w5">type</span><span> </span><span class="gd_word" id="S3.p1.3.7.w6">of</span><span> </span><span class="gd_word" id="S3.p1.3.7.w7">metrics</span><span> </span><span class="gd_word" id="S3.p1.3.7.w8">as</span><span> </span><em id="S3.p1.3.1" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="S3.p1.3.8.w1">,</span><span> </span><span class="gd_word" id="S3.p1.3.8.w2">as</span><span> </span><span class="gd_word" id="S3.p1.3.8.w3">they</span><span> </span><span class="gd_word" id="S3.p1.3.8.w4">require</span><span> </span><span class="gd_word" id="S3.p1.3.8.w5">access</span><span> </span><span class="gd_word" id="S3.p1.3.8.w6">to</span><span> </span><span class="gd_word" id="S3.p1.3.8.w7">ground</span><span> </span><span class="gd_word" id="S3.p1.3.8.w8">truth</span><span> </span><span class="gd_word" id="S3.p1.3.8.w9">translations.</span></p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p"><span class="gd_word" id="S3.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S3.p2.1.1.w2">second</span><span> </span><span class="gd_word" id="S3.p2.1.1.w3">is</span><span> </span><span class="gd_word" id="S3.p2.1.1.w4">concerned</span><span> </span><span class="gd_word" id="S3.p2.1.1.w5">with</span><span> </span><span class="gd_word" id="S3.p2.1.1.w6">assessing</span><span> </span><span class="gd_word" id="S3.p2.1.1.w7">translation</span><span> </span><span class="gd_word" id="S3.p2.1.1.w8">quality</span><span> </span><span class="gd_word" id="S3.p2.1.1.w9">for</span><span> </span><span class="gd_word" id="S3.p2.1.1.w10">source</span><span> </span><span class="gd_word" id="S3.p2.1.1.w11">sentences</span><span> </span><span class="gd_word" id="S3.p2.1.1.w12">for</span><span> </span><span class="gd_word" id="S3.p2.1.1.w13">which</span><span> </span><span class="gd_word" id="S3.p2.1.1.w14">one</span><span> </span><span class="gd_word" id="S3.p2.1.1.w15">does</span><span> </span><span class="gd_word" id="S3.p2.1.1.w16">not</span><span> </span><span class="gd_word" id="S3.p2.1.1.w17">have</span><span> </span><span class="gd_word" id="S3.p2.1.1.w18">reference</span><span> </span><span class="gd_word" id="S3.p2.1.1.w19">translations.
To</span><span> </span><span class="gd_word" id="S3.p2.1.1.w20">determine</span><span> </span><span class="gd_word" id="S3.p2.1.1.w21">whether</span><span> </span><span class="gd_word" id="S3.p2.1.1.w22">machine-generated</span><span> </span><span class="gd_word" id="S3.p2.1.1.w23">outputs</span><span> </span><span class="gd_word" id="S3.p2.1.1.w24">are</span><span> </span><span class="gd_word" id="S3.p2.1.1.w25">accurate</span><span> </span><span class="gd_word" id="S3.p2.1.1.w26">enough</span><span> </span><span class="gd_word" id="S3.p2.1.1.w27">or</span><span> </span><span class="gd_word" id="S3.p2.1.1.w28">require</span><span> </span><span class="gd_word" id="S3.p2.1.1.w29">human</span><span> </span><span class="gd_word" id="S3.p2.1.1.w30">modification,</span><span> </span><span class="gd_word" id="S3.p2.1.1.w31">one</span><span> </span><span class="gd_word" id="S3.p2.1.1.w32">relies</span><span> </span><span class="gd_word" id="S3.p2.1.1.w33">on</span><span> </span><span class="gd_word" id="S3.p2.1.1.w34">multilingual</span><span> </span><span class="gd_word" id="S3.p2.1.1.w35">quality</span><span> </span><span class="gd_word" id="S3.p2.1.1.w36">estimation</span><span> </span><span class="gd_word" id="S3.p2.1.1.w37">metrics </span><cite class="ltx_cite ltx_citemacro_citep">(Specia et al., <a href="#bib.bib36" title="" class="ltx_ref">2018</a>)</cite><span class="gd_word" id="S3.p2.1.2.w1">.
These</span><span> </span><span class="gd_word" id="S3.p2.1.2.w2">do</span><span> </span><span class="gd_word" id="S3.p2.1.2.w3">not</span><span> </span><span class="gd_word" id="S3.p2.1.2.w4">rely</span><span> </span><span class="gd_word" id="S3.p2.1.2.w5">on</span><span> </span><span class="gd_word" id="S3.p2.1.2.w6">ground</span><span> </span><span class="gd_word" id="S3.p2.1.2.w7">truth</span><span> </span><span class="gd_word" id="S3.p2.1.2.w8">sequences;</span><span> </span><span class="gd_word" id="S3.p2.1.2.w9">instead</span><span> </span><span class="gd_word" id="S3.p2.1.2.w10">comparing</span><span> </span><span class="gd_word" id="S3.p2.1.2.w11">produced</span><span> </span><span class="gd_word" id="S3.p2.1.2.w12">samples</span><span> </span><span class="gd_word" id="S3.p2.1.2.w13">to</span><span> </span><span class="gd_word" id="S3.p2.1.2.w14">sources</span><span> </span><span class="gd_word" id="S3.p2.1.2.w15">sentences</span><span> </span><span class="gd_word" id="S3.p2.1.2.w16">directly.
Expert</span><span> </span><span class="gd_word" id="S3.p2.1.2.w17">human</span><span> </span><span class="gd_word" id="S3.p2.1.2.w18">evaluation</span><span> </span><span class="gd_word" id="S3.p2.1.2.w19">is</span><span> </span><span class="gd_word" id="S3.p2.1.2.w20">perhaps</span><span> </span><span class="gd_word" id="S3.p2.1.2.w21">the</span><span> </span><span class="gd_word" id="S3.p2.1.2.w22">most</span><span> </span><span class="gd_word" id="S3.p2.1.2.w23">relevant</span><span> </span><span class="gd_word" id="S3.p2.1.2.w24">such</span><span> </span><span class="gd_word" id="S3.p2.1.2.w25">score,</span><span> </span><span class="gd_word" id="S3.p2.1.2.w26">but</span><span> </span><span class="gd_word" id="S3.p2.1.2.w27">many</span><span> </span><span class="gd_word" id="S3.p2.1.2.w28">automated</span><span> </span><span class="gd_word" id="S3.p2.1.2.w29">alternatives</span><span> </span><span class="gd_word" id="S3.p2.1.2.w30">exist </span><cite class="ltx_cite ltx_citemacro_citep">(Martins et al., <a href="#bib.bib24" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S3.p2.1.3.w1">;</span><span> </span><span class="gd_word" id="S3.p2.1.3.w2">see</span><span> </span><span class="gd_word" id="S3.p2.1.3.w3">e.g. </span><cite class="ltx_cite ltx_citemacro_citet">Bhattacharyya et al. (<a href="#bib.bib4" title="" class="ltx_ref">2021</a>)</cite><span class="gd_word" id="S3.p2.1.4.w1">.
We</span><span> </span><span class="gd_word" id="S3.p2.1.4.w2">refer</span><span> </span><span class="gd_word" id="S3.p2.1.4.w3">to</span><span> </span><span class="gd_word" id="S3.p2.1.4.w4">these</span><span> </span><span class="gd_word" id="S3.p2.1.4.w5">metrics</span><span> </span><span class="gd_word" id="S3.p2.1.4.w6">as</span><span> </span><em id="S3.p2.1.1" class="ltx_emph ltx_font_italic">unprivileged</em><span class="gd_word" id="S3.p2.1.5.w1">.</span></p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p"><span class="gd_word" id="S3.p3.1.1.w1">Privileged</span><span> </span><span class="gd_word" id="S3.p3.1.1.w2">metrics</span><span> </span><span class="gd_word" id="S3.p3.1.1.w3">provide</span><span> </span><span class="gd_word" id="S3.p3.1.1.w4">high</span><span> </span><span class="gd_word" id="S3.p3.1.1.w5">quality</span><span> </span><span class="gd_word" id="S3.p3.1.1.w6">evaluation</span><span> </span><span class="gd_word" id="S3.p3.1.1.w7">signal,</span><span> </span><span class="gd_word" id="S3.p3.1.1.w8">and</span><span> </span><span class="gd_word" id="S3.p3.1.1.w9">are</span><span> </span><span class="gd_word" id="S3.p3.1.1.w10">well-suited</span><span> </span><span class="gd_word" id="S3.p3.1.1.w11">to</span><span> </span><span class="gd_word" id="S3.p3.1.1.w12">comparing</span><span> </span><span class="gd_word" id="S3.p3.1.1.w13">average</span><span> </span><span class="gd_word" id="S3.p3.1.1.w14">model</span><span> </span><span class="gd_word" id="S3.p3.1.1.w15">performance</span><span> </span><span class="gd_word" id="S3.p3.1.1.w16">(trusting</span><span> </span><span class="gd_word" id="S3.p3.1.1.w17">that</span><span> </span><span class="gd_word" id="S3.p3.1.1.w18">results</span><span> </span><span class="gd_word" id="S3.p3.1.1.w19">on</span><span> </span><span class="gd_word" id="S3.p3.1.1.w20">the</span><span> </span><span class="gd_word" id="S3.p3.1.1.w21">unseen</span><span> </span><span class="gd_word" id="S3.p3.1.1.w22">test</span><span> </span><span class="gd_word" id="S3.p3.1.1.w23">set</span><span> </span><span class="gd_word" id="S3.p3.1.1.w24">generalise</span><span> </span><span class="gd_word" id="S3.p3.1.1.w25">to</span><span> </span><span class="gd_word" id="S3.p3.1.1.w26">other</span><span> </span><span class="gd_word" id="S3.p3.1.1.w27">domains</span><span> </span><span class="gd_word" id="S3.p3.1.1.w28">of</span><span> </span><span class="gd_word" id="S3.p3.1.1.w29">interest).
However,</span><span> </span><span class="gd_word" id="S3.p3.1.1.w30">they</span><span> </span><span class="gd_word" id="S3.p3.1.1.w31">rely</span><span> </span><span class="gd_word" id="S3.p3.1.1.w32">on</span><span> </span><span class="gd_word" id="S3.p3.1.1.w33">the</span><span> </span><span class="gd_word" id="S3.p3.1.1.w34">quality</span><span> </span><span class="gd_word" id="S3.p3.1.1.w35">of</span><span> </span><span class="gd_word" id="S3.p3.1.1.w36">the</span><span> </span><span class="gd_word" id="S3.p3.1.1.w37">test</span><span> </span><span class="gd_word" id="S3.p3.1.1.w38">set</span><span> </span><span class="gd_word" id="S3.p3.1.1.w39">translations</span><span> </span><span class="gd_word" id="S3.p3.1.1.w40">(which</span><span> </span><span class="gd_word" id="S3.p3.1.1.w41">are</span><span> </span><span class="gd_word" id="S3.p3.1.1.w42">usually</span><span> </span><span class="gd_word" id="S3.p3.1.1.w43">unique,</span><span> </span><span class="gd_word" id="S3.p3.1.1.w44">hence</span><span> </span><span class="gd_word" id="S3.p3.1.1.w45">somewhat</span><span> </span><span class="gd_word" id="S3.p3.1.1.w46">arbitrary),</span><span> </span><span class="gd_word" id="S3.p3.1.1.w47">and</span><span> </span><span class="gd_word" id="S3.p3.1.1.w48">cannot</span><span> </span><span class="gd_word" id="S3.p3.1.1.w49">be</span><span> </span><span class="gd_word" id="S3.p3.1.1.w50">used</span><span> </span><span class="gd_word" id="S3.p3.1.1.w51">to</span><span> </span><span class="gd_word" id="S3.p3.1.1.w52">evaluate</span><span> </span><span class="gd_word" id="S3.p3.1.1.w53">the</span><span> </span><span class="gd_word" id="S3.p3.1.1.w54">quality</span><span> </span><span class="gd_word" id="S3.p3.1.1.w55">of</span><span> </span><span class="gd_word" id="S3.p3.1.1.w56">models’</span><span> </span><span class="gd_word" id="S3.p3.1.1.w57">prediction</span><span> </span><span class="gd_word" id="S3.p3.1.1.w58">for</span><span> </span><span class="gd_word" id="S3.p3.1.1.w59">specific</span><span> </span><span class="gd_word" id="S3.p3.1.1.w60">unseen</span><span> </span><span class="gd_word" id="S3.p3.1.1.w61">inputs.
In</span><span> </span><span class="gd_word" id="S3.p3.1.1.w62">contrast,</span><span> </span><span class="gd_word" id="S3.p3.1.1.w63">unprivileged</span><span> </span><span class="gd_word" id="S3.p3.1.1.w64">metrics</span><span> </span><span class="gd_word" id="S3.p3.1.1.w65">are</span><span> </span><span class="gd_word" id="S3.p3.1.1.w66">harder</span><span> </span><span class="gd_word" id="S3.p3.1.1.w67">to</span><span> </span><span class="gd_word" id="S3.p3.1.1.w68">access</span><span> </span><span class="gd_word" id="S3.p3.1.1.w69">or</span><span> </span><span class="gd_word" id="S3.p3.1.1.w70">approximate</span><span> </span><span class="gd_word" id="S3.p3.1.1.w71">but</span><span> </span><span class="gd_word" id="S3.p3.1.1.w72">can</span><span> </span><span class="gd_word" id="S3.p3.1.1.w73">be</span><span> </span><span class="gd_word" id="S3.p3.1.1.w74">used</span><span> </span><span class="gd_word" id="S3.p3.1.1.w75">without</span><span> </span><span class="gd_word" id="S3.p3.1.1.w76">ground</span><span> </span><span class="gd_word" id="S3.p3.1.1.w77">truth</span><span> </span><span class="gd_word" id="S3.p3.1.1.w78">translations.</span></p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p"><span class="gd_word" id="S3.p4.1.1.w1">We</span><span> </span><span class="gd_word" id="S3.p4.1.1.w2">use</span><span> </span><span class="gd_word" id="S3.p4.1.1.w3">two</span><span> </span><span class="gd_word" id="S3.p4.1.1.w4">privileged</span><span> </span><span class="gd_word" id="S3.p4.1.1.w5">metrics</span><span> </span><span class="gd_word" id="S3.p4.1.1.w6">in</span><span> </span><span class="gd_word" id="S3.p4.1.1.w7">our</span><span> </span><span class="gd_word" id="S3.p4.1.1.w8">experiments:</span><span> </span><span class="gd_word" id="S3.p4.1.1.w9">BLEU</span><span> </span><span class="gd_word" id="S3.p4.1.1.w10">and</span><span> </span><span class="gd_word" id="S3.p4.1.1.w11">BERTScore.
We</span><span> </span><span class="gd_word" id="S3.p4.1.1.w12">introduce</span><span> </span><span class="gd_word" id="S3.p4.1.1.w13">another,</span><span> </span><span class="gd_word" id="S3.p4.1.1.w14">unprivileged</span><span> </span><span class="gd_word" id="S3.p4.1.1.w15">metric:</span><span> </span><span class="gd_word" id="S3.p4.1.1.w16">Multilingual</span><span> </span><span class="gd_word" id="S3.p4.1.1.w17">BERTScore.
Note</span><span> </span><span class="gd_word" id="S3.p4.1.1.w18">that</span><span> </span><span class="gd_word" id="S3.p4.1.1.w19">while</span><span> </span><span class="gd_word" id="S3.p4.1.1.w20">a</span><span> </span><span class="gd_word" id="S3.p4.1.1.w21">translation</span><span> </span><span class="gd_word" id="S3.p4.1.1.w22">model</span><span> </span><span class="gd_word" id="S3.p4.1.1.w23">likelihood</span><span> </span><span class="gd_word" id="S3.p4.1.1.w24">can</span><span> </span><span class="gd_word" id="S3.p4.1.1.w25">be</span><span> </span><span class="gd_word" id="S3.p4.1.1.w26">considered</span><span> </span><span class="gd_word" id="S3.p4.1.1.w27">an</span><span> </span><span class="gd_word" id="S3.p4.1.1.w28">unprivileged</span><span> </span><span class="gd_word" id="S3.p4.1.1.w29">metric,</span><span> </span><span class="gd_word" id="S3.p4.1.1.w30">it</span><span> </span><span class="gd_word" id="S3.p4.1.1.w31">comes</span><span> </span><span class="gd_word" id="S3.p4.1.1.w32">with</span><span> </span><span class="gd_word" id="S3.p4.1.1.w33">the</span><span> </span><span class="gd_word" id="S3.p4.1.1.w34">unusual</span><span> </span><span class="gd_word" id="S3.p4.1.1.w35">property</span><span> </span><span class="gd_word" id="S3.p4.1.1.w36">that</span><span> </span><span class="gd_word" id="S3.p4.1.1.w37">it</span><span> </span><span class="gd_word" id="S3.p4.1.1.w38">is</span><span> </span><span class="gd_word" id="S3.p4.1.1.w39">decomposable.
We</span><span> </span><span class="gd_word" id="S3.p4.1.1.w40">thus</span><span> </span><span class="gd_word" id="S3.p4.1.1.w41">treat</span><span> </span><span class="gd_word" id="S3.p4.1.1.w42">it</span><span> </span><span class="gd_word" id="S3.p4.1.1.w43">as</span><span> </span><span class="gd_word" id="S3.p4.1.1.w44">a</span><span> </span><span class="gd_word" id="S3.p4.1.1.w45">special</span><span> </span><span class="gd_word" id="S3.p4.1.1.w46">case.</span></p>
</div>
<div id="S3.p5" class="ltx_para ltx_noindent">
<p id="S3.p5.1" class="ltx_p"><span class="gd_word" id="S3.p5.1.1.w1">BLEU </span><cite class="ltx_cite ltx_citemacro_citep">(Papineni et al., <a href="#bib.bib28" title="" class="ltx_ref">2002</a>)</cite><span class="gd_word" id="S3.p5.1.2.w1">.
The</span><span> </span><span class="gd_word" id="S3.p5.1.2.w2">BLEU</span><span> </span><span class="gd_word" id="S3.p5.1.2.w3">score</span><span> </span><span class="gd_word" id="S3.p5.1.2.w4">computes</span><span> </span><span class="gd_word" id="S3.p5.1.2.w5">modified</span><span> </span><span class="gd_word" id="S3.p5.1.2.w6">precisions</span><span> </span><span class="gd_word" id="S3.p5.1.2.w7">for</span><span> </span><span class="gd_word" id="S3.p5.1.2.w8">n-grams</span><span> </span><span class="gd_word" id="S3.p5.1.2.w9">(typically</span><span> </span><span class="gd_word" id="S3.p5.1.2.w10">with</span><span> </span><span class="gd_word" id="S3.p5.1.2.w11">n</span><span> </span><span class="gd_word" id="S3.p5.1.2.w12">ranging</span><span> </span><span class="gd_word" id="S3.p5.1.2.w13">from</span><span> </span><span class="gd_word" id="S3.p5.1.2.w14">1</span><span> </span><span class="gd_word" id="S3.p5.1.2.w15">to</span><span> </span><span class="gd_word" id="S3.p5.1.2.w16">4)</span><span> </span><span class="gd_word" id="S3.p5.1.2.w17">between</span><span> </span><span class="gd_word" id="S3.p5.1.2.w18">a</span><span> </span><span class="gd_word" id="S3.p5.1.2.w19">corpus</span><span> </span><span class="gd_word" id="S3.p5.1.2.w20">of</span><span> </span><span class="gd_word" id="S3.p5.1.2.w21">candidate</span><span> </span><span class="gd_word" id="S3.p5.1.2.w22">sentences</span><span> </span><span class="gd_word" id="S3.p5.1.2.w23">and</span><span> </span><span class="gd_word" id="S3.p5.1.2.w24">a</span><span> </span><span class="gd_word" id="S3.p5.1.2.w25">reference</span><span> </span><span class="gd_word" id="S3.p5.1.2.w26">corpus.
These</span><span> </span><span class="gd_word" id="S3.p5.1.2.w27">precisions</span><span> </span><span class="gd_word" id="S3.p5.1.2.w28">are</span><span> </span><span class="gd_word" id="S3.p5.1.2.w29">then</span><span> </span><span class="gd_word" id="S3.p5.1.2.w30">averaged</span><span> </span><span class="gd_word" id="S3.p5.1.2.w31">geometrically,</span><span> </span><span class="gd_word" id="S3.p5.1.2.w32">and</span><span> </span><span class="gd_word" id="S3.p5.1.2.w33">multiplied</span><span> </span><span class="gd_word" id="S3.p5.1.2.w34">by</span><span> </span><span class="gd_word" id="S3.p5.1.2.w35">a</span><span> </span><span class="gd_word" id="S3.p5.1.2.w36">brevity</span><span> </span><span class="gd_word" id="S3.p5.1.2.w37">penalty.
This</span><span> </span><span class="gd_word" id="S3.p5.1.2.w38">metric</span><span> </span><span class="gd_word" id="S3.p5.1.2.w39">is</span><span> </span><span class="gd_word" id="S3.p5.1.2.w40">meant</span><span> </span><span class="gd_word" id="S3.p5.1.2.w41">to</span><span> </span><span class="gd_word" id="S3.p5.1.2.w42">be</span><span> </span><span class="gd_word" id="S3.p5.1.2.w43">used</span><span> </span><span class="gd_word" id="S3.p5.1.2.w44">at</span><span> </span><span class="gd_word" id="S3.p5.1.2.w45">the</span><span> </span><span class="gd_word" id="S3.p5.1.2.w46">corpus</span><span> </span><span class="gd_word" id="S3.p5.1.2.w47">level;</span><span> </span><span class="gd_word" id="S3.p5.1.2.w48">it</span><span> </span><span class="gd_word" id="S3.p5.1.2.w49">is</span><span> </span><span class="gd_word" id="S3.p5.1.2.w50">unstable</span><span> </span><span class="gd_word" id="S3.p5.1.2.w51">at</span><span> </span><span class="gd_word" id="S3.p5.1.2.w52">the</span><span> </span><span class="gd_word" id="S3.p5.1.2.w53">sentence</span><span> </span><span class="gd_word" id="S3.p5.1.2.w54">level.
It</span><span> </span><span class="gd_word" id="S3.p5.1.2.w55">is</span><span> </span><span class="gd_word" id="S3.p5.1.2.w56">the</span><span> </span><span class="gd_word" id="S3.p5.1.2.w57">de</span><span> </span><span class="gd_word" id="S3.p5.1.2.w58">facto</span><span> </span><span class="gd_word" id="S3.p5.1.2.w59">golden</span><span> </span><span class="gd_word" id="S3.p5.1.2.w60">standard</span><span> </span><span class="gd_word" id="S3.p5.1.2.w61">for</span><span> </span><span class="gd_word" id="S3.p5.1.2.w62">comparing</span><span> </span><span class="gd_word" id="S3.p5.1.2.w63">MT</span><span> </span><span class="gd_word" id="S3.p5.1.2.w64">algorithms,</span><span> </span><span class="gd_word" id="S3.p5.1.2.w65">though</span><span> </span><span class="gd_word" id="S3.p5.1.2.w66">as</span><span> </span><span class="gd_word" id="S3.p5.1.2.w67">it</span><span> </span><span class="gd_word" id="S3.p5.1.2.w68">crucially</span><span> </span><span class="gd_word" id="S3.p5.1.2.w69">relies</span><span> </span><span class="gd_word" id="S3.p5.1.2.w70">on</span><span> </span><span class="gd_word" id="S3.p5.1.2.w71">access</span><span> </span><span class="gd_word" id="S3.p5.1.2.w72">to</span><span> </span><span class="gd_word" id="S3.p5.1.2.w73">a</span><span> </span><span class="gd_word" id="S3.p5.1.2.w74">dataset</span><span> </span><span class="gd_word" id="S3.p5.1.2.w75">of</span><span> </span><span class="gd_word" id="S3.p5.1.2.w76">reference</span><span> </span><span class="gd_word" id="S3.p5.1.2.w77">translations,</span><span> </span><span class="gd_word" id="S3.p5.1.2.w78">it</span><span> </span><span class="gd_word" id="S3.p5.1.2.w79">is</span><span> </span><span class="gd_word" id="S3.p5.1.2.w80">not</span><span> </span><span class="gd_word" id="S3.p5.1.2.w81">available</span><span> </span><span class="gd_word" id="S3.p5.1.2.w82">to</span><span> </span><span class="gd_word" id="S3.p5.1.2.w83">assess</span><span> </span><span class="gd_word" id="S3.p5.1.2.w84">translation</span><span> </span><span class="gd_word" id="S3.p5.1.2.w85">quality</span><span> </span><span class="gd_word" id="S3.p5.1.2.w86">at</span><span> </span><span class="gd_word" id="S3.p5.1.2.w87">decoding</span><span> </span><span class="gd_word" id="S3.p5.1.2.w88">time.</span></p>
</div>
<div id="S3.p6" class="ltx_para ltx_noindent">
<p id="S3.p6.1" class="ltx_p"><span class="gd_word" id="S3.p6.1.1.w1">BERTScore </span><cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib44" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S3.p6.1.2.w1">.
By</span><span> </span><span class="gd_word" id="S3.p6.1.2.w2">contrast,</span><span> </span><span class="gd_word" id="S3.p6.1.2.w3">BERTScore</span><span> </span><span class="gd_word" id="S3.p6.1.2.w4">is</span><span> </span><span class="gd_word" id="S3.p6.1.2.w5">a</span><span> </span><span class="gd_word" id="S3.p6.1.2.w6">sentence-level</span><span> </span><span class="gd_word" id="S3.p6.1.2.w7">metric</span><span> </span><span class="gd_word" id="S3.p6.1.2.w8">to</span><span> </span><span class="gd_word" id="S3.p6.1.2.w9">compare</span><span> </span><span class="gd_word" id="S3.p6.1.2.w10">a</span><span> </span><span class="gd_word" id="S3.p6.1.2.w11">candidate</span><span> </span><span class="gd_word" id="S3.p6.1.2.w12">sentence</span><span> </span><span class="gd_word" id="S3.p6.1.2.w13">to</span><span> </span><span class="gd_word" id="S3.p6.1.2.w14">a</span><span> </span><span class="gd_word" id="S3.p6.1.2.w15">reference</span><span> </span><span class="gd_word" id="S3.p6.1.2.w16">translation.
It</span><span> </span><span class="gd_word" id="S3.p6.1.2.w17">relies</span><span> </span><span class="gd_word" id="S3.p6.1.2.w18">on</span><span> </span><span class="gd_word" id="S3.p6.1.2.w19">several</span><span> </span><span class="gd_word" id="S3.p6.1.2.w20">consecutive</span><span> </span><span class="gd_word" id="S3.p6.1.2.w21">steps:</span><span> </span><span class="gd_word" id="S3.p6.1.2.w22">first,</span><span> </span><span class="gd_word" id="S3.p6.1.2.w23">computing</span><span> </span><span class="gd_word" id="S3.p6.1.2.w24">contextual</span><span> </span><span class="gd_word" id="S3.p6.1.2.w25">embeddings</span><span> </span><span class="gd_word" id="S3.p6.1.2.w26">for</span><span> </span><span class="gd_word" id="S3.p6.1.2.w27">each</span><span> </span><span class="gd_word" id="S3.p6.1.2.w28">token</span><span> </span><span class="gd_word" id="S3.p6.1.2.w29">in</span><span> </span><span class="gd_word" id="S3.p6.1.2.w30">both</span><span> </span><span class="gd_word" id="S3.p6.1.2.w31">sentences</span><span> </span><span class="gd_word" id="S3.p6.1.2.w32">with</span><span> </span><span class="gd_word" id="S3.p6.1.2.w33">a</span><span> </span><span class="gd_word" id="S3.p6.1.2.w34">shared</span><span> </span><span class="gd_word" id="S3.p6.1.2.w35">BERT </span><cite class="ltx_cite ltx_citemacro_citep">(Devlin et al., <a href="#bib.bib11" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S3.p6.1.3.w1"/><span> </span><span class="gd_word" id="S3.p6.1.3.w2">model;</span><span> </span><span class="gd_word" id="S3.p6.1.3.w3">second,</span><span> </span><span class="gd_word" id="S3.p6.1.3.w4">computing</span><span> </span><span class="gd_word" id="S3.p6.1.3.w5">all</span><span> </span><span class="gd_word" id="S3.p6.1.3.w6">pairwise</span><span> </span><span class="gd_word" id="S3.p6.1.3.w7">cosine</span><span> </span><span class="gd_word" id="S3.p6.1.3.w8">similarities</span><span> </span><span class="gd_word" id="S3.p6.1.3.w9">between</span><span> </span><span class="gd_word" id="S3.p6.1.3.w10">embeddings</span><span> </span><span class="gd_word" id="S3.p6.1.3.w11">of</span><span> </span><span class="gd_word" id="S3.p6.1.3.w12">the</span><span> </span><span class="gd_word" id="S3.p6.1.3.w13">two</span><span> </span><span class="gd_word" id="S3.p6.1.3.w14">sentences;</span><span> </span><span class="gd_word" id="S3.p6.1.3.w15">third,</span><span> </span><span class="gd_word" id="S3.p6.1.3.w16">greedily</span><span> </span><span class="gd_word" id="S3.p6.1.3.w17">aligning</span><span> </span><span class="gd_word" id="S3.p6.1.3.w18">tokens</span><span> </span><span class="gd_word" id="S3.p6.1.3.w19">based</span><span> </span><span class="gd_word" id="S3.p6.1.3.w20">on</span><span> </span><span class="gd_word" id="S3.p6.1.3.w21">these</span><span> </span><span class="gd_word" id="S3.p6.1.3.w22">similarities;</span><span> </span><span class="gd_word" id="S3.p6.1.3.w23">finally,</span><span> </span><span class="gd_word" id="S3.p6.1.3.w24">averaging</span><span> </span><span class="gd_word" id="S3.p6.1.3.w25">the</span><span> </span><span class="gd_word" id="S3.p6.1.3.w26">similarities</span><span> </span><span class="gd_word" id="S3.p6.1.3.w27">of</span><span> </span><span class="gd_word" id="S3.p6.1.3.w28">the</span><span> </span><span class="gd_word" id="S3.p6.1.3.w29">aligned</span><span> </span><span class="gd_word" id="S3.p6.1.3.w30">tokens.
Compared</span><span> </span><span class="gd_word" id="S3.p6.1.3.w31">to</span><span> </span><span class="gd_word" id="S3.p6.1.3.w32">BLEU,</span><span> </span><span class="gd_word" id="S3.p6.1.3.w33">BERTScore</span><span> </span><span class="gd_word" id="S3.p6.1.3.w34">is</span><span> </span><span class="gd_word" id="S3.p6.1.3.w35">found</span><span> </span><span class="gd_word" id="S3.p6.1.3.w36">to</span><span> </span><span class="gd_word" id="S3.p6.1.3.w37">correlate</span><span> </span><span class="gd_word" id="S3.p6.1.3.w38">slightly</span><span> </span><span class="gd_word" id="S3.p6.1.3.w39">better</span><span> </span><span class="gd_word" id="S3.p6.1.3.w40">with</span><span> </span><span class="gd_word" id="S3.p6.1.3.w41">human</span><span> </span><span class="gd_word" id="S3.p6.1.3.w42">judgement.
Importantly</span><span> </span><span class="gd_word" id="S3.p6.1.3.w43">for</span><span> </span><span class="gd_word" id="S3.p6.1.3.w44">decoding</span><span> </span><span class="gd_word" id="S3.p6.1.3.w45">purposes,</span><span> </span><span class="gd_word" id="S3.p6.1.3.w46">it</span><span> </span><span class="gd_word" id="S3.p6.1.3.w47">is</span><span> </span><span class="gd_word" id="S3.p6.1.3.w48">a</span><span> </span><span class="gd_word" id="S3.p6.1.3.w49">sentence-level</span><span> </span><span class="gd_word" id="S3.p6.1.3.w50">metric</span><span> </span><span class="gd_word" id="S3.p6.1.3.w51">(which</span><span> </span><span class="gd_word" id="S3.p6.1.3.w52">is</span><span> </span><span class="gd_word" id="S3.p6.1.3.w53">averaged</span><span> </span><span class="gd_word" id="S3.p6.1.3.w54">to</span><span> </span><span class="gd_word" id="S3.p6.1.3.w55">produce</span><span> </span><span class="gd_word" id="S3.p6.1.3.w56">a</span><span> </span><span class="gd_word" id="S3.p6.1.3.w57">corpus-level</span><span> </span><span class="gd_word" id="S3.p6.1.3.w58">statistic).</span></p>
</div>
<div id="S3.p7" class="ltx_para ltx_noindent">
<p id="S3.p7.1" class="ltx_p"><span class="gd_word" id="S3.p7.1.1.w1">Multilingual</span><span> </span><span class="gd_word" id="S3.p7.1.1.w2">BERTScore.
While</span><span> </span><span class="gd_word" id="S3.p7.1.1.w3">BERTScore</span><span> </span><span class="gd_word" id="S3.p7.1.1.w4">is</span><span> </span><span class="gd_word" id="S3.p7.1.1.w5">designed</span><span> </span><span class="gd_word" id="S3.p7.1.1.w6">as</span><span> </span><span class="gd_word" id="S3.p7.1.1.w7">a</span><span> </span><span class="gd_word" id="S3.p7.1.1.w8">monolingual</span><span> </span><span class="gd_word" id="S3.p7.1.1.w9">metric,</span><span> </span><span class="gd_word" id="S3.p7.1.1.w10">we</span><span> </span><span class="gd_word" id="S3.p7.1.1.w11">repurpose</span><span> </span><span class="gd_word" id="S3.p7.1.1.w12">it</span><span> </span><span class="gd_word" id="S3.p7.1.1.w13">as</span><span> </span><span class="gd_word" id="S3.p7.1.1.w14">a</span><span> </span><span class="gd_word" id="S3.p7.1.1.w15">multilingual</span><span> </span><span class="gd_word" id="S3.p7.1.1.w16">one</span><span> </span><span class="gd_word" id="S3.p7.1.1.w17">by</span><span> </span><span class="gd_word" id="S3.p7.1.1.w18">using</span><span> </span><span class="gd_word" id="S3.p7.1.1.w19">it</span><span> </span><span class="gd_word" id="S3.p7.1.1.w20">to</span><span> </span><span class="gd_word" id="S3.p7.1.1.w21">compare</span><span> </span><span class="gd_word" id="S3.p7.1.1.w22">a</span><span> </span><span class="gd_word" id="S3.p7.1.1.w23">candidate</span><span> </span><span class="gd_word" id="S3.p7.1.1.w24">to</span><span> </span><span class="gd_word" id="S3.p7.1.1.w25">its</span><span> </span><em id="S3.p7.1.2" class="ltx_emph ltx_font_italic">source sentence</em><span class="gd_word" id="S3.p7.1.2.w1"/><span> </span><span class="gd_word" id="S3.p7.1.2.w2">(instead</span><span> </span><span class="gd_word" id="S3.p7.1.2.w3">of</span><span> </span><span class="gd_word" id="S3.p7.1.2.w4">reference</span><span> </span><span class="gd_word" id="S3.p7.1.2.w5">translation).
Both</span><span> </span><span class="gd_word" id="S3.p7.1.2.w6">sentences</span><span> </span><span class="gd_word" id="S3.p7.1.2.w7">are</span><span> </span><span class="gd_word" id="S3.p7.1.2.w8">in</span><span> </span><span class="gd_word" id="S3.p7.1.2.w9">different</span><span> </span><span class="gd_word" id="S3.p7.1.2.w10">languages,</span><span> </span><span class="gd_word" id="S3.p7.1.2.w11">but</span><span> </span><span class="gd_word" id="S3.p7.1.2.w12">this</span><span> </span><span class="gd_word" id="S3.p7.1.2.w13">is</span><span> </span><span class="gd_word" id="S3.p7.1.2.w14">fine</span><span> </span><span class="gd_word" id="S3.p7.1.2.w15">as</span><span> </span><span class="gd_word" id="S3.p7.1.2.w16">long</span><span> </span><span class="gd_word" id="S3.p7.1.2.w17">as</span><span> </span><span class="gd_word" id="S3.p7.1.2.w18">the</span><span> </span><span class="gd_word" id="S3.p7.1.2.w19">underlying</span><span> </span><span class="gd_word" id="S3.p7.1.2.w20">BERT</span><span> </span><span class="gd_word" id="S3.p7.1.2.w21">model</span><span> </span><span class="gd_word" id="S3.p7.1.2.w22">is</span><span> </span><span class="gd_word" id="S3.p7.1.2.w23">itself</span><span> </span><span class="gd_word" id="S3.p7.1.2.w24">multilingual.</span><span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="gd_word" id="footnote1.3.w1">We</span><span> </span><span class="gd_word" id="footnote1.3.w2">use</span><span> </span><span class="gd_word" id="footnote1.3.w3">the</span><span> </span><span class="gd_word" id="footnote1.3.w4">multilingual,</span><span> </span><span class="gd_word" id="footnote1.3.w5">12-layer,</span><span> </span><span class="gd_word" id="footnote1.3.w6">768</span><span> </span><span class="gd_word" id="footnote1.3.w7">hidden</span><span> </span><span class="gd_word" id="footnote1.3.w8">dimensionality</span><span> </span><span class="gd_word" id="footnote1.3.w9">BERT</span><span> </span><span class="gd_word" id="footnote1.3.w10">model</span><span> </span><span class="gd_word" id="footnote1.3.w11">available</span><span> </span><span class="gd_word" id="footnote1.3.w12">at</span><span> </span><a href="https://github.com/google-research/bert" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/google-research/bert</a><span class="gd_word" id="footnote1.4.w1"/><span> </span><span class="gd_word" id="footnote1.4.w2">(23/11/2018</span><span> </span><span class="gd_word" id="footnote1.4.w3">entry).</span></span></span></span><span class="gd_word" id="S3.p7.1.3.w1">
We</span><span> </span><span class="gd_word" id="S3.p7.1.3.w2">call</span><span> </span><span class="gd_word" id="S3.p7.1.3.w3">this</span><span> </span><span class="gd_word" id="S3.p7.1.3.w4">new</span><span> </span><span class="gd_word" id="S3.p7.1.3.w5">metric</span><span> </span><span class="gd_word" id="S3.p7.1.3.w6">Multilingual</span><span> </span><span class="gd_word" id="S3.p7.1.3.w7">BERTScore.
Its</span><span> </span><span class="gd_word" id="S3.p7.1.3.w8">performance</span><span> </span><span class="gd_word" id="S3.p7.1.3.w9">relies</span><span> </span><span class="gd_word" id="S3.p7.1.3.w10">on</span><span> </span><span class="gd_word" id="S3.p7.1.3.w11">the</span><span> </span><span class="gd_word" id="S3.p7.1.3.w12">underlying</span><span> </span><span class="gd_word" id="S3.p7.1.3.w13">BERT</span><span> </span><span class="gd_word" id="S3.p7.1.3.w14">model’s</span><span> </span><span class="gd_word" id="S3.p7.1.3.w15">ability</span><span> </span><span class="gd_word" id="S3.p7.1.3.w16">to</span><span> </span><span class="gd_word" id="S3.p7.1.3.w17">map</span><span> </span><span class="gd_word" id="S3.p7.1.3.w18">related</span><span> </span><span class="gd_word" id="S3.p7.1.3.w19">tokens</span><span> </span><span class="gd_word" id="S3.p7.1.3.w20">in</span><span> </span><span class="gd_word" id="S3.p7.1.3.w21">different</span><span> </span><span class="gd_word" id="S3.p7.1.3.w22">languages</span><span> </span><span class="gd_word" id="S3.p7.1.3.w23">to</span><span> </span><span class="gd_word" id="S3.p7.1.3.w24">similar</span><span> </span><span class="gd_word" id="S3.p7.1.3.w25">embeddings.
Because</span><span> </span><span class="gd_word" id="S3.p7.1.3.w26">of</span><span> </span><span class="gd_word" id="S3.p7.1.3.w27">the</span><span> </span><span class="gd_word" id="S3.p7.1.3.w28">one-to-one</span><span> </span><span class="gd_word" id="S3.p7.1.3.w29">nature</span><span> </span><span class="gd_word" id="S3.p7.1.3.w30">of</span><span> </span><span class="gd_word" id="S3.p7.1.3.w31">the</span><span> </span><span class="gd_word" id="S3.p7.1.3.w32">alignment</span><span> </span><span class="gd_word" id="S3.p7.1.3.w33">phase,</span><span> </span><span class="gd_word" id="S3.p7.1.3.w34">we</span><span> </span><span class="gd_word" id="S3.p7.1.3.w35">expect</span><span> </span><span class="gd_word" id="S3.p7.1.3.w36">it</span><span> </span><span class="gd_word" id="S3.p7.1.3.w37">to</span><span> </span><span class="gd_word" id="S3.p7.1.3.w38">score</span><span> </span><span class="gd_word" id="S3.p7.1.3.w39">more</span><span> </span><span class="gd_word" id="S3.p7.1.3.w40">highly</span><span> </span><span class="gd_word" id="S3.p7.1.3.w41">translation</span><span> </span><span class="gd_word" id="S3.p7.1.3.w42">pairs</span><span> </span><span class="gd_word" id="S3.p7.1.3.w43">that</span><span> </span><span class="gd_word" id="S3.p7.1.3.w44">have</span><span> </span><span class="gd_word" id="S3.p7.1.3.w45">a</span><span> </span><span class="gd_word" id="S3.p7.1.3.w46">one-to-one</span><span> </span><span class="gd_word" id="S3.p7.1.3.w47">token</span><span> </span><span class="gd_word" id="S3.p7.1.3.w48">correspondence,</span><span> </span><span class="gd_word" id="S3.p7.1.3.w49">rather</span><span> </span><span class="gd_word" id="S3.p7.1.3.w50">than</span><span> </span><span class="gd_word" id="S3.p7.1.3.w51">syntactically</span><span> </span><span class="gd_word" id="S3.p7.1.3.w52">different</span><span> </span><span class="gd_word" id="S3.p7.1.3.w53">pairs.
We</span><span> </span><span class="gd_word" id="S3.p7.1.3.w54">thus</span><span> </span><span class="gd_word" id="S3.p7.1.3.w55">expect</span><span> </span><span class="gd_word" id="S3.p7.1.3.w56">it</span><span> </span><span class="gd_word" id="S3.p7.1.3.w57">to</span><span> </span><span class="gd_word" id="S3.p7.1.3.w58">make</span><span> </span><span class="gd_word" id="S3.p7.1.3.w59">sense</span><span> </span><span class="gd_word" id="S3.p7.1.3.w60">for</span><span> </span><span class="gd_word" id="S3.p7.1.3.w61">pairs</span><span> </span><span class="gd_word" id="S3.p7.1.3.w62">of</span><span> </span><span class="gd_word" id="S3.p7.1.3.w63">syntactically</span><span> </span><span class="gd_word" id="S3.p7.1.3.w64">similar</span><span> </span><span class="gd_word" id="S3.p7.1.3.w65">languages.
We</span><span> </span><span class="gd_word" id="S3.p7.1.3.w66">stress</span><span> </span><span class="gd_word" id="S3.p7.1.3.w67">that</span><span> </span><span class="gd_word" id="S3.p7.1.3.w68">we</span><span> </span><span class="gd_word" id="S3.p7.1.3.w69">do</span><span> </span><span class="gd_word" id="S3.p7.1.3.w70">not</span><span> </span><span class="gd_word" id="S3.p7.1.3.w71">advocate</span><span> </span><span class="gd_word" id="S3.p7.1.3.w72">widespread</span><span> </span><span class="gd_word" id="S3.p7.1.3.w73">adoption</span><span> </span><span class="gd_word" id="S3.p7.1.3.w74">of</span><span> </span><span class="gd_word" id="S3.p7.1.3.w75">this</span><span> </span><span class="gd_word" id="S3.p7.1.3.w76">imperfect</span><span> </span><span class="gd_word" id="S3.p7.1.3.w77">score</span><span> </span><span class="gd_word" id="S3.p7.1.3.w78">for</span><span> </span><span class="gd_word" id="S3.p7.1.3.w79">MT;</span><span> </span><span class="gd_word" id="S3.p7.1.3.w80">we</span><span> </span><span class="gd_word" id="S3.p7.1.3.w81">consider</span><span> </span><span class="gd_word" id="S3.p7.1.3.w82">it</span><span> </span><span class="gd_word" id="S3.p7.1.3.w83">however</span><span> </span><span class="gd_word" id="S3.p7.1.3.w84">a</span><span> </span><span class="gd_word" id="S3.p7.1.3.w85">convenient</span><span> </span><span class="gd_word" id="S3.p7.1.3.w86">illustrative</span><span> </span><span class="gd_word" id="S3.p7.1.3.w87">example</span><span> </span><span class="gd_word" id="S3.p7.1.3.w88">of</span><span> </span><span class="gd_word" id="S3.p7.1.3.w89">an</span><span> </span><span class="gd_word" id="S3.p7.1.3.w90">unprivileged</span><span> </span><span class="gd_word" id="S3.p7.1.3.w91">metric.
In</span><span> </span><span class="gd_word" id="S3.p7.1.3.w92">practice,</span><span> </span><span class="gd_word" id="S3.p7.1.3.w93">we</span><span> </span><span class="gd_word" id="S3.p7.1.3.w94">observe</span><span> </span><span class="gd_word" id="S3.p7.1.3.w95">that</span><span> </span><span class="gd_word" id="S3.p7.1.3.w96">it</span><span> </span><span class="gd_word" id="S3.p7.1.3.w97">behaves</span><span> </span><span class="gd_word" id="S3.p7.1.3.w98">reasonably</span><span> </span><span class="gd_word" id="S3.p7.1.3.w99">for</span><span> </span><span class="gd_word" id="S3.p7.1.3.w100">our</span><span> </span><span class="gd_word" id="S3.p7.1.3.w101">two</span><span> </span><span class="gd_word" id="S3.p7.1.3.w102">evaluation</span><span> </span><span class="gd_word" id="S3.p7.1.3.w103">language</span><span> </span><span class="gd_word" id="S3.p7.1.3.w104">pairs</span><span> </span><span class="gd_word" id="S3.p7.1.3.w105">(WMT</span><span> </span><span class="gd_word" id="S3.p7.1.3.w106">’14</span><span> </span><span class="gd_word" id="S3.p7.1.3.w107">English/German</span><span> </span><span class="gd_word" id="S3.p7.1.3.w108">and</span><span> </span><span class="gd_word" id="S3.p7.1.3.w109">English/French)</span><span> </span><span class="gd_word" id="S3.p7.1.3.w110">as</span><span> </span><span class="gd_word" id="S3.p7.1.3.w111">shown</span><span> </span><span class="gd_word" id="S3.p7.1.3.w112">in</span><span> </span><span class="gd_word" id="S3.p7.1.3.w113">Table </span><a href="#S3.T1" title="Table 1 ‣ 3 Machine Translation metrics ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">1</a><span class="gd_word" id="S3.p7.1.4.w1">.
Interestingly,</span><span> </span><span class="gd_word" id="S3.p7.1.4.w2">it</span><span> </span><span class="gd_word" id="S3.p7.1.4.w3">scores</span><span> </span><span class="gd_word" id="S3.p7.1.4.w4">trained</span><span> </span><span class="gd_word" id="S3.p7.1.4.w5">model</span><span> </span><span class="gd_word" id="S3.p7.1.4.w6">outputs</span><span> </span><span class="gd_word" id="S3.p7.1.4.w7">higher</span><span> </span><span class="gd_word" id="S3.p7.1.4.w8">than</span><span> </span><span class="gd_word" id="S3.p7.1.4.w9">ground</span><span> </span><span class="gd_word" id="S3.p7.1.4.w10">truth</span><span> </span><span class="gd_word" id="S3.p7.1.4.w11">outputs.
We</span><span> </span><span class="gd_word" id="S3.p7.1.4.w12">hypothesise</span><span> </span><span class="gd_word" id="S3.p7.1.4.w13">that</span><span> </span><span class="gd_word" id="S3.p7.1.4.w14">the</span><span> </span><span class="gd_word" id="S3.p7.1.4.w15">former</span><span> </span><span class="gd_word" id="S3.p7.1.4.w16">follow</span><span> </span><span class="gd_word" id="S3.p7.1.4.w17">the</span><span> </span><span class="gd_word" id="S3.p7.1.4.w18">source</span><span> </span><span class="gd_word" id="S3.p7.1.4.w19">sentence</span><span> </span><span class="gd_word" id="S3.p7.1.4.w20">more</span><span> </span><span class="gd_word" id="S3.p7.1.4.w21">closely</span><span> </span><span class="gd_word" id="S3.p7.1.4.w22">than</span><span> </span><span class="gd_word" id="S3.p7.1.4.w23">the</span><span> </span><span class="gd_word" id="S3.p7.1.4.w24">latter.</span></p>
</div>
<figure id="S3.T1" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/S3_T1.png" alt="/static/img/2104.05336-gpt-4/S3_T1.png"/><figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 1: </span><span class="gd_word" id="S3.T1.2.w1">Multilingual</span><span> </span><span class="gd_word" id="S3.T1.2.w2">BERTScore</span><span> </span><span class="gd_word" id="S3.T1.2.w3">for</span><span> </span><span class="gd_word" id="S3.T1.2.w4">random</span><span> </span><span class="gd_word" id="S3.T1.2.w5">text,</span><span> </span><span class="gd_word" id="S3.T1.2.w6">ground</span><span> </span><span class="gd_word" id="S3.T1.2.w7">truth</span><span> </span><span class="gd_word" id="S3.T1.2.w8">sentences</span><span> </span><span class="gd_word" id="S3.T1.2.w9">(GT),</span><span> </span><span class="gd_word" id="S3.T1.2.w10">greedy</span><span> </span><span class="gd_word" id="S3.T1.2.w11">and</span><span> </span><span class="gd_word" id="S3.T1.2.w12">beam</span><span> </span><span class="gd_word" id="S3.T1.2.w13">search</span><span> </span><span class="gd_word" id="S3.T1.2.w14">decoding</span><span> </span><span class="gd_word" id="S3.T1.2.w15">from</span><span> </span><span class="gd_word" id="S3.T1.2.w16">a</span><span> </span><span class="gd_word" id="S3.T1.2.w17">supervised</span><span> </span><span class="gd_word" id="S3.T1.2.w18">model</span><span> </span><span class="gd_word" id="S3.T1.2.w19">(guided</span><span> </span><span class="gd_word" id="S3.T1.2.w20">by</span><span> </span><span class="gd_word" id="S3.T1.2.w21">likelihood).</span><span> </span><span class="gd_word" id="S3.T1.2.w22">We</span><span> </span><span class="gd_word" id="S3.T1.2.w23">see</span><span> </span><span class="gd_word" id="S3.T1.2.w24">that</span><span> </span><span class="gd_word" id="S3.T1.2.w25">(i)</span><span> </span><span class="gd_word" id="S3.T1.2.w26">random</span><span> </span><span class="gd_word" id="S3.T1.2.w27">translation</span><span> </span><span class="gd_word" id="S3.T1.2.w28">scores</span><span> </span><span class="gd_word" id="S3.T1.2.w29">are</span><span> </span><span class="gd_word" id="S3.T1.2.w30">lower</span><span> </span><span class="gd_word" id="S3.T1.2.w31">than</span><span> </span><span class="gd_word" id="S3.T1.2.w32">those</span><span> </span><span class="gd_word" id="S3.T1.2.w33">of</span><span> </span><span class="gd_word" id="S3.T1.2.w34">reference</span><span> </span><span class="gd_word" id="S3.T1.2.w35">translations</span><span> </span><span class="gd_word" id="S3.T1.2.w36">or</span><span> </span><span class="gd_word" id="S3.T1.2.w37">that</span><span> </span><span class="gd_word" id="S3.T1.2.w38">of</span><span> </span><span class="gd_word" id="S3.T1.2.w39">supervised</span><span> </span><span class="gd_word" id="S3.T1.2.w40">policy</span><span> </span><span class="gd_word" id="S3.T1.2.w41">samples</span><span> </span><span class="gd_word" id="S3.T1.2.w42">(though</span><span> </span><span class="gd_word" id="S3.T1.2.w43">it</span><span> </span><span class="gd_word" id="S3.T1.2.w44">is</span><span> </span><span class="gd_word" id="S3.T1.2.w45">not</span><span> </span><span class="gd_word" id="S3.T1.2.w46">0,</span><span> </span><span class="gd_word" id="S3.T1.2.w47">as</span><span> </span><span class="gd_word" id="S3.T1.2.w48">for</span><span> </span><span class="gd_word" id="S3.T1.2.w49">standard</span><span> </span><span class="gd_word" id="S3.T1.2.w50">BERTScore,</span><span> </span><span class="gd_word" id="S3.T1.2.w51">as</span><span> </span><span class="gd_word" id="S3.T1.2.w52">both</span><span> </span><span class="gd_word" id="S3.T1.2.w53">rely</span><span> </span><span class="gd_word" id="S3.T1.2.w54">on</span><span> </span><span class="gd_word" id="S3.T1.2.w55">continuous</span><span> </span><span class="gd_word" id="S3.T1.2.w56">embeddings</span><span> </span><span class="gd_word" id="S3.T1.2.w57">similarities);</span><span> </span><span class="gd_word" id="S3.T1.2.w58">(ii)</span><span> </span><span class="gd_word" id="S3.T1.2.w59">the</span><span> </span><span class="gd_word" id="S3.T1.2.w60">scores</span><span> </span><span class="gd_word" id="S3.T1.2.w61">are</span><span> </span><span class="gd_word" id="S3.T1.2.w62">smaller</span><span> </span><span class="gd_word" id="S3.T1.2.w63">than</span><span> </span><span class="gd_word" id="S3.T1.2.w64">the</span><span> </span><span class="gd_word" id="S3.T1.2.w65">corresponding</span><span> </span><span class="gd_word" id="S3.T1.2.w66">monolingual</span><span> </span><span class="gd_word" id="S3.T1.2.w67">BERTScore</span><span> </span><span class="gd_word" id="S3.T1.2.w68">(87.88</span><span> </span><span class="gd_word" id="S3.T1.2.w69">and</span><span> </span><span class="gd_word" id="S3.T1.2.w70">90.55</span><span> </span><span class="gd_word" id="S3.T1.2.w71">for</span><span> </span><span class="gd_word" id="S3.T1.2.w72">greedy</span><span> </span><span class="gd_word" id="S3.T1.2.w73">decoding</span><span> </span><span class="gd_word" id="S3.T1.2.w74">from</span><span> </span><span class="gd_word" id="S3.T1.2.w75">a</span><span> </span><span class="gd_word" id="S3.T1.2.w76">supervised</span><span> </span><span class="gd_word" id="S3.T1.2.w77">model,</span><span> </span><span class="gd_word" id="S3.T1.2.w78">respectively)</span><span> </span><span class="gd_word" id="S3.T1.2.w79">and</span><span> </span><span class="gd_word" id="S3.T1.2.w80">(iii)</span><span> </span><span class="gd_word" id="S3.T1.2.w81">beam</span><span> </span><span class="gd_word" id="S3.T1.2.w82">search</span><span> </span><span class="gd_word" id="S3.T1.2.w83">outputs</span><span> </span><span class="gd_word" id="S3.T1.2.w84">outperform</span><span> </span><span class="gd_word" id="S3.T1.2.w85">greedy</span><span> </span><span class="gd_word" id="S3.T1.2.w86">outputs</span><span> </span><span class="gd_word" id="S3.T1.2.w87">consistently</span><span> </span><span class="gd_word" id="S3.T1.2.w88">(as</span><span> </span><span class="gd_word" id="S3.T1.2.w89">is</span><span> </span><span class="gd_word" id="S3.T1.2.w90">the</span><span> </span><span class="gd_word" id="S3.T1.2.w91">case</span><span> </span><span class="gd_word" id="S3.T1.2.w92">for</span><span> </span><span class="gd_word" id="S3.T1.2.w93">BLEU).</span></figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Decoding algorithms</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span class="gd_word" id="S4.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="S4.p1.1.1.w2">this</span><span> </span><span class="gd_word" id="S4.p1.1.1.w3">section,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="S4.p1.1.1.w5">go</span><span> </span><span class="gd_word" id="S4.p1.1.1.w6">over</span><span> </span><span class="gd_word" id="S4.p1.1.1.w7">the</span><span> </span><span class="gd_word" id="S4.p1.1.1.w8">details</span><span> </span><span class="gd_word" id="S4.p1.1.1.w9">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w10">each</span><span> </span><span class="gd_word" id="S4.p1.1.1.w11">algorithm,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w12">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w13">its</span><span> </span><span class="gd_word" id="S4.p1.1.1.w14">adaptations</span><span> </span><span class="gd_word" id="S4.p1.1.1.w15">to</span><span> </span><span class="gd_word" id="S4.p1.1.1.w16">better</span><span> </span><span class="gd_word" id="S4.p1.1.1.w17">suit</span><span> </span><span class="gd_word" id="S4.p1.1.1.w18">privileged</span><span> </span><span class="gd_word" id="S4.p1.1.1.w19">or</span><span> </span><span class="gd_word" id="S4.p1.1.1.w20">unprivileged</span><span> </span><span class="gd_word" id="S4.p1.1.1.w21">metrics.
We</span><span> </span><span class="gd_word" id="S4.p1.1.1.w22">separate</span><span> </span><span class="gd_word" id="S4.p1.1.1.w23">them</span><span> </span><span class="gd_word" id="S4.p1.1.1.w24">in</span><span> </span><span class="gd_word" id="S4.p1.1.1.w25">three</span><span> </span><span class="gd_word" id="S4.p1.1.1.w26">categories:</span><span> </span><span class="gd_word" id="S4.p1.1.1.w27">(i)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w28">algorithms</span><span> </span><span class="gd_word" id="S4.p1.1.1.w29">based</span><span> </span><span class="gd_word" id="S4.p1.1.1.w30">on</span><span> </span><span class="gd_word" id="S4.p1.1.1.w31">likelihood</span><span> </span><span class="gd_word" id="S4.p1.1.1.w32">maximisation,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w33">(ii)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w34">value-based</span><span> </span><span class="gd_word" id="S4.p1.1.1.w35">mechanisms</span><span> </span><span class="gd_word" id="S4.p1.1.1.w36">which</span><span> </span><span class="gd_word" id="S4.p1.1.1.w37">rely</span><span> </span><span class="gd_word" id="S4.p1.1.1.w38">on</span><span> </span><span class="gd_word" id="S4.p1.1.1.w39">approximating</span><span> </span><span class="gd_word" id="S4.p1.1.1.w40">metrics</span><span> </span><span class="gd_word" id="S4.p1.1.1.w41">via</span><span> </span><span class="gd_word" id="S4.p1.1.1.w42">a</span><span> </span><span class="gd_word" id="S4.p1.1.1.w43">value</span><span> </span><span class="gd_word" id="S4.p1.1.1.w44">function,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w45">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w46">(iii)</span><span> </span><span class="gd_word" id="S4.p1.1.1.w47">ranking-based</span><span> </span><span class="gd_word" id="S4.p1.1.1.w48">methods</span><span> </span><span class="gd_word" id="S4.p1.1.1.w49">which</span><span> </span><span class="gd_word" id="S4.p1.1.1.w50">access</span><span> </span><span class="gd_word" id="S4.p1.1.1.w51">the</span><span> </span><span class="gd_word" id="S4.p1.1.1.w52">metrics</span><span> </span><span class="gd_word" id="S4.p1.1.1.w53">directly</span><span> </span><span class="gd_word" id="S4.p1.1.1.w54">and</span><span> </span><span class="gd_word" id="S4.p1.1.1.w55">pick</span><span> </span><span class="gd_word" id="S4.p1.1.1.w56">the</span><span> </span><span class="gd_word" id="S4.p1.1.1.w57">highest-scoring</span><span> </span><span class="gd_word" id="S4.p1.1.1.w58">example</span><span> </span><span class="gd_word" id="S4.p1.1.1.w59">out</span><span> </span><span class="gd_word" id="S4.p1.1.1.w60">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w61">a</span><span> </span><span class="gd_word" id="S4.p1.1.1.w62">pool</span><span> </span><span class="gd_word" id="S4.p1.1.1.w63">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w64">finished</span><span> </span><span class="gd_word" id="S4.p1.1.1.w65">candidates.
Of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w66">course,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w67">ranking-based</span><span> </span><span class="gd_word" id="S4.p1.1.1.w68">methods</span><span> </span><span class="gd_word" id="S4.p1.1.1.w69">are</span><span> </span><span class="gd_word" id="S4.p1.1.1.w70">only</span><span> </span><span class="gd_word" id="S4.p1.1.1.w71">usable</span><span> </span><span class="gd_word" id="S4.p1.1.1.w72">for</span><span> </span><span class="gd_word" id="S4.p1.1.1.w73">unprivileged</span><span> </span><span class="gd_word" id="S4.p1.1.1.w74">metrics,</span><span> </span><span class="gd_word" id="S4.p1.1.1.w75">as</span><span> </span><span class="gd_word" id="S4.p1.1.1.w76">privileged</span><span> </span><span class="gd_word" id="S4.p1.1.1.w77">metrics</span><span> </span><span class="gd_word" id="S4.p1.1.1.w78">are</span><span> </span><span class="gd_word" id="S4.p1.1.1.w79">not</span><span> </span><span class="gd_word" id="S4.p1.1.1.w80">computable</span><span> </span><span class="gd_word" id="S4.p1.1.1.w81">at</span><span> </span><span class="gd_word" id="S4.p1.1.1.w82">test</span><span> </span><span class="gd_word" id="S4.p1.1.1.w83">time.
We</span><span> </span><span class="gd_word" id="S4.p1.1.1.w84">provide</span><span> </span><span class="gd_word" id="S4.p1.1.1.w85">a</span><span> </span><span class="gd_word" id="S4.p1.1.1.w86">high-level</span><span> </span><span class="gd_word" id="S4.p1.1.1.w87">comparison</span><span> </span><span class="gd_word" id="S4.p1.1.1.w88">of</span><span> </span><span class="gd_word" id="S4.p1.1.1.w89">all</span><span> </span><span class="gd_word" id="S4.p1.1.1.w90">algorithms</span><span> </span><span class="gd_word" id="S4.p1.1.1.w91">in</span><span> </span><span class="gd_word" id="S4.p1.1.1.w92">Table </span><a href="#S4.T2" title="Table 2 ‣ 4.3 Reranking-based decoding ‣ 4 Decoding algorithms ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">2</a><span class="gd_word" id="S4.p1.1.2.w1">.</span></p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Likelihood-based decoding</h3>

<div id="S4.SS1.p1" class="ltx_para ltx_noindent">
<p id="S4.SS1.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS1.p1.1.1.w1">Greedy</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w2">decoding</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w3">(GD)</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w5">our</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w6">first</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w7">baseline;</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w8">it</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w9">consists</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w10">in</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w11">picking</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w12">the</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w13">token</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w14">with</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w15">maximum</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w16">likelihood</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w17">at</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w18">each</span><span> </span><span class="gd_word" id="S4.SS1.p1.1.1.w19">step.</span></p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.9" class="ltx_p"><span class="gd_word" id="S4.SS1.p2.9.1.w1">Beam</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w2">search</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w3">(BS)</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w4">maintains</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w5">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w6">beam</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.1.w7">of</span><span> </span><math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S4.SS1.p2.9.2.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w2">possible</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w3">translations</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w4">prefixes</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w5">at</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w6">each</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w7">time</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.2.w8">step</span><span> </span><math id="S4.SS1.p2.2.m2.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S4.SS1.p2.2.m2.1a"><mi id="S4.SS1.p2.2.m2.1.1" xref="S4.SS1.p2.2.m2.1.1.cmml">t</mi></semantics></math><span class="gd_word" id="S4.SS1.p2.9.3.w1">,</span><span> </span><math id="S4.SS1.p2.3.m3.1" class="ltx_Math" alttext="(p^{i}_{t})_{i=1}^{k}" display="inline"><semantics id="S4.SS1.p2.3.m3.1a"><msubsup id="S4.SS1.p2.3.m3.1.1" xref="S4.SS1.p2.3.m3.1.1.cmml"><mrow id="S4.SS1.p2.3.m3.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.3.m3.1.1.1.1.1.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p2.3.m3.1.1.1.1.1.1" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.2.cmml">p</mi><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.3.cmml">t</mi><mi id="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.SS1.p2.3.m3.1.1.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p2.3.m3.1.1.1.3" xref="S4.SS1.p2.3.m3.1.1.1.3.cmml"><mi id="S4.SS1.p2.3.m3.1.1.1.3.2" xref="S4.SS1.p2.3.m3.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p2.3.m3.1.1.1.3.1" xref="S4.SS1.p2.3.m3.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p2.3.m3.1.1.1.3.3" xref="S4.SS1.p2.3.m3.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.3.m3.1.1.3" xref="S4.SS1.p2.3.m3.1.1.3.cmml">k</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p2.9.4.w1">.
Prefixes</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w2">are</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w3">updated</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w4">incrementally</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w5">as</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w6">follows:</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w7">for</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w8">each</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.4.w9">prefix</span><span> </span><math id="S4.SS1.p2.4.m4.1" class="ltx_Math" alttext="p^{i}_{t}" display="inline"><semantics id="S4.SS1.p2.4.m4.1a"><msubsup id="S4.SS1.p2.4.m4.1.1" xref="S4.SS1.p2.4.m4.1.1.cmml"><mi id="S4.SS1.p2.4.m4.1.1.2.2" xref="S4.SS1.p2.4.m4.1.1.2.2.cmml">p</mi><mi id="S4.SS1.p2.4.m4.1.1.3" xref="S4.SS1.p2.4.m4.1.1.3.cmml">t</mi><mi id="S4.SS1.p2.4.m4.1.1.2.3" xref="S4.SS1.p2.4.m4.1.1.2.3.cmml">i</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p2.9.5.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w2">one</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w3">adds</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w4">each</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w5">of</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w6">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.5.w7">corresponding</span><span> </span><math id="S4.SS1.p2.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.5.m5.1a"><mi id="S4.SS1.p2.5.m5.1.1" xref="S4.SS1.p2.5.m5.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S4.SS1.p2.9.6.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.9.6.w2">most</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.6.w3">probable</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.6.w4">tokens</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.6.w5">(given</span><span> </span><math id="S4.SS1.p2.6.m6.1" class="ltx_Math" alttext="p^{i}_{t}" display="inline"><semantics id="S4.SS1.p2.6.m6.1a"><msubsup id="S4.SS1.p2.6.m6.1.1" xref="S4.SS1.p2.6.m6.1.1.cmml"><mi id="S4.SS1.p2.6.m6.1.1.2.2" xref="S4.SS1.p2.6.m6.1.1.2.2.cmml">p</mi><mi id="S4.SS1.p2.6.m6.1.1.3" xref="S4.SS1.p2.6.m6.1.1.3.cmml">t</mi><mi id="S4.SS1.p2.6.m6.1.1.2.3" xref="S4.SS1.p2.6.m6.1.1.2.3.cmml">i</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p2.9.7.w1">),</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.7.w2">resulting</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.7.w3">in</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.7.w4">at</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.7.w5">most</span><span> </span><math id="S4.SS1.p2.7.m7.1" class="ltx_Math" alttext="k\times k" display="inline"><semantics id="S4.SS1.p2.7.m7.1a"><mrow id="S4.SS1.p2.7.m7.1.1" xref="S4.SS1.p2.7.m7.1.1.cmml"><mi id="S4.SS1.p2.7.m7.1.1.2" xref="S4.SS1.p2.7.m7.1.1.2.cmml">k</mi><mo id="S4.SS1.p2.7.m7.1.1.1" xref="S4.SS1.p2.7.m7.1.1.1.cmml">×</mo><mi id="S4.SS1.p2.7.m7.1.1.3" xref="S4.SS1.p2.7.m7.1.1.3.cmml">k</mi></mrow></semantics></math><span class="gd_word" id="S4.SS1.p2.9.8.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w2">new</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w3">prefixes</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w4">of</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w5">size</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w6">increased</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w7">by</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w8">1.
Then</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w9">among</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w10">these</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.8.w11">the</span><span> </span><math id="S4.SS1.p2.8.m8.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.8.m8.1a"><mi id="S4.SS1.p2.8.m8.1.1" xref="S4.SS1.p2.8.m8.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S4.SS1.p2.9.9.w1"/><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w2">prefixes</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w3">with</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w4">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w5">highest</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w6">likelihood</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w7">are</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w8">selected,</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w9">thus</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.9.w10">obtaining</span><span> </span><math id="S4.SS1.p2.9.m9.1" class="ltx_Math" alttext="(p^{i}_{t+1})_{i=1}^{k}" display="inline"><semantics id="S4.SS1.p2.9.m9.1a"><msubsup id="S4.SS1.p2.9.m9.1.1" xref="S4.SS1.p2.9.m9.1.1.cmml"><mrow id="S4.SS1.p2.9.m9.1.1.1.1.1" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p2.9.m9.1.1.1.1.1.2" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p2.9.m9.1.1.1.1.1.1" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p2.9.m9.1.1.1.1.1.1.2.2" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.2.2.cmml">p</mi><mrow id="S4.SS1.p2.9.m9.1.1.1.1.1.1.3" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.2" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.2.cmml">t</mi><mo id="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.1" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.1.cmml">+</mo><mn id="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.3" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.9.m9.1.1.1.1.1.1.2.3" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.2.3.cmml">i</mi></msubsup><mo stretchy="false" id="S4.SS1.p2.9.m9.1.1.1.1.1.3" xref="S4.SS1.p2.9.m9.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p2.9.m9.1.1.1.3" xref="S4.SS1.p2.9.m9.1.1.1.3.cmml"><mi id="S4.SS1.p2.9.m9.1.1.1.3.2" xref="S4.SS1.p2.9.m9.1.1.1.3.2.cmml">i</mi><mo id="S4.SS1.p2.9.m9.1.1.1.3.1" xref="S4.SS1.p2.9.m9.1.1.1.3.1.cmml">=</mo><mn id="S4.SS1.p2.9.m9.1.1.1.3.3" xref="S4.SS1.p2.9.m9.1.1.1.3.3.cmml">1</mn></mrow><mi id="S4.SS1.p2.9.m9.1.1.3" xref="S4.SS1.p2.9.m9.1.1.3.cmml">k</mi></msubsup></semantics></math><span class="gd_word" id="S4.SS1.p2.9.10.w1">.
This</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w2">method</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w3">aims</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w4">at</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w5">optimising</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w6">likelihood,</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w7">and</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w8">is</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w9">agnostic</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w10">to</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w11">any</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w12">metric</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w13">of</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w14">interest.
It</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w15">is</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w16">therefore</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w17">at</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w18">a</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w19">disadvantage</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w20">if</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w21">we</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w22">change</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w23">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w24">objective</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w25">of</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w26">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w27">search.
Consequently,</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w28">we</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w29">also</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w30">study</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w31">the</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w32">performance</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w33">of</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w34">value-</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w35">or</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w36">score-based</span><span> </span><span class="gd_word" id="S4.SS1.p2.9.10.w37">variants.</span></p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Value-based decoding</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.3" class="ltx_p"><span class="gd_word" id="S4.SS2.p1.3.1.w1">To</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w2">motivate</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w4">introduction</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w5">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w6">value</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w7">functions</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w8">in</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w9">our</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w10">decoding</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w11">mechanisms,</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w12">it</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w13">is</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w14">helpful</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w15">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w16">understand</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w17">how</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w18">machine</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w19">translation</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w20">can</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w21">be</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w22">construed</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w23">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w24">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w25">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w26">Reinforcement</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w27">Learning</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w28">task,</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w29">with</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w30">an</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w31">underlying</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w32">Markov</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w33">Decision</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w34">Process</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w35">(MDP).
In</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w36">MT,</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w37">we</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w38">work</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w39">with</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w40">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.1.w41">vocabulary</span><span> </span><math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.3.2.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w3">tokens,</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w4">and</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w5">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w6">dataset</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w7">contains</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w8">pairs</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w9">of</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.2.w10">sentences</span><span> </span><math id="S4.SS2.p1.2.m2.2" class="ltx_Math" alttext="(x,y_{x})" display="inline"><semantics id="S4.SS2.p1.2.m2.2a"><mrow id="S4.SS2.p1.2.m2.2.2.1" xref="S4.SS2.p1.2.m2.2.2.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.2.2.1.2" xref="S4.SS2.p1.2.m2.2.2.2.cmml">(</mo><mi id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml">x</mi><mo id="S4.SS2.p1.2.m2.2.2.1.3" xref="S4.SS2.p1.2.m2.2.2.2.cmml">,</mo><msub id="S4.SS2.p1.2.m2.2.2.1.1" xref="S4.SS2.p1.2.m2.2.2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.2.2.1.1.2" xref="S4.SS2.p1.2.m2.2.2.1.1.2.cmml">y</mi><mi id="S4.SS2.p1.2.m2.2.2.1.1.3" xref="S4.SS2.p1.2.m2.2.2.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S4.SS2.p1.2.m2.2.2.1.4" xref="S4.SS2.p1.2.m2.2.2.2.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S4.SS2.p1.3.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.3.3.w2">where</span><span> </span><math id="S4.SS2.p1.3.m3.2" class="ltx_Math" alttext="x,y_{x}\in\mathcal{V}^{+}" display="inline"><semantics id="S4.SS2.p1.3.m3.2a"><mrow id="S4.SS2.p1.3.m3.2.2" xref="S4.SS2.p1.3.m3.2.2.cmml"><mrow id="S4.SS2.p1.3.m3.2.2.1.1" xref="S4.SS2.p1.3.m3.2.2.1.2.cmml"><mi id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml">x</mi><mo id="S4.SS2.p1.3.m3.2.2.1.1.2" xref="S4.SS2.p1.3.m3.2.2.1.2.cmml">,</mo><msub id="S4.SS2.p1.3.m3.2.2.1.1.1" xref="S4.SS2.p1.3.m3.2.2.1.1.1.cmml"><mi id="S4.SS2.p1.3.m3.2.2.1.1.1.2" xref="S4.SS2.p1.3.m3.2.2.1.1.1.2.cmml">y</mi><mi id="S4.SS2.p1.3.m3.2.2.1.1.1.3" xref="S4.SS2.p1.3.m3.2.2.1.1.1.3.cmml">x</mi></msub></mrow><mo id="S4.SS2.p1.3.m3.2.2.2" xref="S4.SS2.p1.3.m3.2.2.2.cmml">∈</mo><msup id="S4.SS2.p1.3.m3.2.2.3" xref="S4.SS2.p1.3.m3.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.3.m3.2.2.3.2" xref="S4.SS2.p1.3.m3.2.2.3.2.cmml">𝒱</mi><mo id="S4.SS2.p1.3.m3.2.2.3.3" xref="S4.SS2.p1.3.m3.2.2.3.3.cmml">+</mo></msup></mrow></semantics></math><span class="gd_word" id="S4.SS2.p1.3.4.w1">.
We</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w2">can</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w3">define</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w4">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w5">somewhat</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w6">trivial</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w7">MDP,</span><span> </span><span class="gd_word" id="S4.SS2.p1.3.4.w8">where:</span></p>
<ul id="S4.I1" class="ltx_itemize">
<li id="S4.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i1.p1" class="ltx_para">
<p id="S4.I1.i1.p1.2" class="ltx_p"><span class="gd_word" id="S4.I1.i1.p1.2.1.w1">the</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w2">states</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w3">consist</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w4">in</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w5">a</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w6">pair</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w7">containing</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w8">a</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w9">source</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.1.w10">sentence</span><span> </span><math id="S4.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="x\in\mathcal{V}^{+}" display="inline"><semantics id="S4.I1.i1.p1.1.m1.1a"><mrow id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">x</mi><mo id="S4.I1.i1.p1.1.m1.1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.1.m1.1.1.3.2" xref="S4.I1.i1.p1.1.m1.1.1.3.2.cmml">𝒱</mi><mo id="S4.I1.i1.p1.1.m1.1.1.3.3" xref="S4.I1.i1.p1.1.m1.1.1.3.3.cmml">+</mo></msup></mrow></semantics></math><span class="gd_word" id="S4.I1.i1.p1.2.2.w1"/><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.2.w2">and</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.2.w3">a</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.2.w4">sample</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.2.w5">in</span><span> </span><span class="gd_word" id="S4.I1.i1.p1.2.2.w6">construction</span><span> </span><math id="S4.I1.i1.p1.2.m2.1" class="ltx_Math" alttext="\hat{y}_{1}...\hat{y}_{t}\in\mathcal{V}^{+}" display="inline"><semantics id="S4.I1.i1.p1.2.m2.1a"><mrow id="S4.I1.i1.p1.2.m2.1.1" xref="S4.I1.i1.p1.2.m2.1.1.cmml"><mrow id="S4.I1.i1.p1.2.m2.1.1.2" xref="S4.I1.i1.p1.2.m2.1.1.2.cmml"><msub id="S4.I1.i1.p1.2.m2.1.1.2.2" xref="S4.I1.i1.p1.2.m2.1.1.2.2.cmml"><mover accent="true" id="S4.I1.i1.p1.2.m2.1.1.2.2.2" xref="S4.I1.i1.p1.2.m2.1.1.2.2.2.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2.2.2.2" xref="S4.I1.i1.p1.2.m2.1.1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i1.p1.2.m2.1.1.2.2.2.1" xref="S4.I1.i1.p1.2.m2.1.1.2.2.2.1.cmml">^</mo></mover><mn id="S4.I1.i1.p1.2.m2.1.1.2.2.3" xref="S4.I1.i1.p1.2.m2.1.1.2.2.3.cmml">1</mn></msub><mo id="S4.I1.i1.p1.2.m2.1.1.2.1" xref="S4.I1.i1.p1.2.m2.1.1.2.1.cmml">⁢</mo><mi mathvariant="normal" id="S4.I1.i1.p1.2.m2.1.1.2.3" xref="S4.I1.i1.p1.2.m2.1.1.2.3.cmml">…</mi><mo id="S4.I1.i1.p1.2.m2.1.1.2.1a" xref="S4.I1.i1.p1.2.m2.1.1.2.1.cmml">⁢</mo><msub id="S4.I1.i1.p1.2.m2.1.1.2.4" xref="S4.I1.i1.p1.2.m2.1.1.2.4.cmml"><mover accent="true" id="S4.I1.i1.p1.2.m2.1.1.2.4.2" xref="S4.I1.i1.p1.2.m2.1.1.2.4.2.cmml"><mi id="S4.I1.i1.p1.2.m2.1.1.2.4.2.2" xref="S4.I1.i1.p1.2.m2.1.1.2.4.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i1.p1.2.m2.1.1.2.4.2.1" xref="S4.I1.i1.p1.2.m2.1.1.2.4.2.1.cmml">^</mo></mover><mi id="S4.I1.i1.p1.2.m2.1.1.2.4.3" xref="S4.I1.i1.p1.2.m2.1.1.2.4.3.cmml">t</mi></msub></mrow><mo id="S4.I1.i1.p1.2.m2.1.1.1" xref="S4.I1.i1.p1.2.m2.1.1.1.cmml">∈</mo><msup id="S4.I1.i1.p1.2.m2.1.1.3" xref="S4.I1.i1.p1.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.2.m2.1.1.3.2" xref="S4.I1.i1.p1.2.m2.1.1.3.2.cmml">𝒱</mi><mo id="S4.I1.i1.p1.2.m2.1.1.3.3" xref="S4.I1.i1.p1.2.m2.1.1.3.3.cmml">+</mo></msup></mrow></semantics></math><span class="gd_word" id="S4.I1.i1.p1.2.3.w1">,</span></p>
</div>
</li>
<li id="S4.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i2.p1" class="ltx_para">
<p id="S4.I1.i2.p1.2" class="ltx_p"><span class="gd_word" id="S4.I1.i2.p1.2.1.w1">the</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.1.w2">action</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.1.w3">space</span><span> </span><math id="S4.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{A}" display="inline"><semantics id="S4.I1.i2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml">𝒜</mi></semantics></math><span class="gd_word" id="S4.I1.i2.p1.2.2.w1"/><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.2.w2">is</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.2.w3">the</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.2.w4">output</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.2.w5">vocabulary</span><span> </span><math id="S4.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{V}" display="inline"><semantics id="S4.I1.i2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">𝒱</mi></semantics></math><span class="gd_word" id="S4.I1.i2.p1.2.3.w1"/><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w2">(taking</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w3">an</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w4">action</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w5">means</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w6">adding</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w7">a</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w8">specific</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w9">token</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w10">to</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w11">the</span><span> </span><span class="gd_word" id="S4.I1.i2.p1.2.3.w12">sample),
</span></p>
</div>
</li>
<li id="S4.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i3.p1" class="ltx_para">
<p id="S4.I1.i3.p1.3" class="ltx_p"><span class="gd_word" id="S4.I1.i3.p1.3.1.w1">the</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.1.w2">transitions</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.1.w3">are</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.1.w4">deterministic:</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.1.w5">picking</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.1.w6">token</span><span> </span><math id="S4.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\hat{y}_{t+1}\in\mathcal{A}" display="inline"><semantics id="S4.I1.i3.p1.1.m1.1a"><mrow id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><msub id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml"><mover accent="true" id="S4.I1.i3.p1.1.m1.1.1.2.2" xref="S4.I1.i3.p1.1.m1.1.1.2.2.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2.2.2" xref="S4.I1.i3.p1.1.m1.1.1.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.1.m1.1.1.2.2.1" xref="S4.I1.i3.p1.1.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="S4.I1.i3.p1.1.m1.1.1.2.3" xref="S4.I1.i3.p1.1.m1.1.1.2.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.2.3.2" xref="S4.I1.i3.p1.1.m1.1.1.2.3.2.cmml">t</mi><mo id="S4.I1.i3.p1.1.m1.1.1.2.3.1" xref="S4.I1.i3.p1.1.m1.1.1.2.3.1.cmml">+</mo><mn id="S4.I1.i3.p1.1.m1.1.1.2.3.3" xref="S4.I1.i3.p1.1.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.I1.i3.p1.1.m1.1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml">𝒜</mi></mrow></semantics></math><span class="gd_word" id="S4.I1.i3.p1.3.2.w1"/><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.2.w2">in</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.2.w3">state</span><span> </span><math id="S4.I1.i3.p1.2.m2.2" class="ltx_Math" alttext="s_{t}=(x,\hat{y}_{1}...\hat{y}_{t})" display="inline"><semantics id="S4.I1.i3.p1.2.m2.2a"><mrow id="S4.I1.i3.p1.2.m2.2.2" xref="S4.I1.i3.p1.2.m2.2.2.cmml"><msub id="S4.I1.i3.p1.2.m2.2.2.3" xref="S4.I1.i3.p1.2.m2.2.2.3.cmml"><mi id="S4.I1.i3.p1.2.m2.2.2.3.2" xref="S4.I1.i3.p1.2.m2.2.2.3.2.cmml">s</mi><mi id="S4.I1.i3.p1.2.m2.2.2.3.3" xref="S4.I1.i3.p1.2.m2.2.2.3.3.cmml">t</mi></msub><mo id="S4.I1.i3.p1.2.m2.2.2.2" xref="S4.I1.i3.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S4.I1.i3.p1.2.m2.2.2.1.1" xref="S4.I1.i3.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.I1.i3.p1.2.m2.2.2.1.1.2" xref="S4.I1.i3.p1.2.m2.2.2.1.2.cmml">(</mo><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">x</mi><mo id="S4.I1.i3.p1.2.m2.2.2.1.1.3" xref="S4.I1.i3.p1.2.m2.2.2.1.2.cmml">,</mo><mrow id="S4.I1.i3.p1.2.m2.2.2.1.1.1" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.cmml"><msub id="S4.I1.i3.p1.2.m2.2.2.1.1.1.2" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.cmml"><mover accent="true" id="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2.cmml"><mi id="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2.2" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2.1" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.3" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.I1.i3.p1.2.m2.2.2.1.1.1.1" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.1.cmml">⁢</mo><mi mathvariant="normal" id="S4.I1.i3.p1.2.m2.2.2.1.1.1.3" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.3.cmml">…</mi><mo id="S4.I1.i3.p1.2.m2.2.2.1.1.1.1a" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.I1.i3.p1.2.m2.2.2.1.1.1.4" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.cmml"><mover accent="true" id="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2.cmml"><mi id="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2.2" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2.1" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.3" xref="S4.I1.i3.p1.2.m2.2.2.1.1.1.4.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S4.I1.i3.p1.2.m2.2.2.1.1.4" xref="S4.I1.i3.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I1.i3.p1.3.3.w1"/><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w2">leads</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w3">to</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w4">the</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w5">unique</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w6">possible</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w7">successor</span><span> </span><span class="gd_word" id="S4.I1.i3.p1.3.3.w8">state</span><span> </span><math id="S4.I1.i3.p1.3.m3.2" class="ltx_Math" alttext="s_{t+1}=(x,\hat{y}_{1}...\hat{y}_{t}\hat{y}_{t+1})" display="inline"><semantics id="S4.I1.i3.p1.3.m3.2a"><mrow id="S4.I1.i3.p1.3.m3.2.2" xref="S4.I1.i3.p1.3.m3.2.2.cmml"><msub id="S4.I1.i3.p1.3.m3.2.2.3" xref="S4.I1.i3.p1.3.m3.2.2.3.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.3.2" xref="S4.I1.i3.p1.3.m3.2.2.3.2.cmml">s</mi><mrow id="S4.I1.i3.p1.3.m3.2.2.3.3" xref="S4.I1.i3.p1.3.m3.2.2.3.3.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.3.3.2" xref="S4.I1.i3.p1.3.m3.2.2.3.3.2.cmml">t</mi><mo id="S4.I1.i3.p1.3.m3.2.2.3.3.1" xref="S4.I1.i3.p1.3.m3.2.2.3.3.1.cmml">+</mo><mn id="S4.I1.i3.p1.3.m3.2.2.3.3.3" xref="S4.I1.i3.p1.3.m3.2.2.3.3.3.cmml">1</mn></mrow></msub><mo id="S4.I1.i3.p1.3.m3.2.2.2" xref="S4.I1.i3.p1.3.m3.2.2.2.cmml">=</mo><mrow id="S4.I1.i3.p1.3.m3.2.2.1.1" xref="S4.I1.i3.p1.3.m3.2.2.1.2.cmml"><mo stretchy="false" id="S4.I1.i3.p1.3.m3.2.2.1.1.2" xref="S4.I1.i3.p1.3.m3.2.2.1.2.cmml">(</mo><mi id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml">x</mi><mo id="S4.I1.i3.p1.3.m3.2.2.1.1.3" xref="S4.I1.i3.p1.3.m3.2.2.1.2.cmml">,</mo><mrow id="S4.I1.i3.p1.3.m3.2.2.1.1.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.cmml"><msub id="S4.I1.i3.p1.3.m3.2.2.1.1.1.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.cmml"><mover accent="true" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.2.1.cmml">^</mo></mover><mn id="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.3" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.2.3.cmml">1</mn></msub><mo id="S4.I1.i3.p1.3.m3.2.2.1.1.1.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.1.cmml">⁢</mo><mi mathvariant="normal" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.3" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.3.cmml">…</mi><mo id="S4.I1.i3.p1.3.m3.2.2.1.1.1.1a" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.I1.i3.p1.3.m3.2.2.1.1.1.4" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.cmml"><mover accent="true" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.2.1.cmml">^</mo></mover><mi id="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.3" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.4.3.cmml">t</mi></msub><mo id="S4.I1.i3.p1.3.m3.2.2.1.1.1.1b" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.1.cmml">⁢</mo><msub id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.cmml"><mover accent="true" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.2.1.cmml">^</mo></mover><mrow id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.cmml"><mi id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.2" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.2.cmml">t</mi><mo id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.1" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.1.cmml">+</mo><mn id="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.3" xref="S4.I1.i3.p1.3.m3.2.2.1.1.1.5.3.3.cmml">1</mn></mrow></msub></mrow><mo stretchy="false" id="S4.I1.i3.p1.3.m3.2.2.1.1.4" xref="S4.I1.i3.p1.3.m3.2.2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I1.i3.p1.3.4.w1">,</span></p>
</div>
</li>
<li id="S4.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I1.i4.p1" class="ltx_para">
<p id="S4.I1.i4.p1.3" class="ltx_p"><span class="gd_word" id="S4.I1.i4.p1.3.1.w1">the</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.1.w2">reward</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.1.w3">is</span><span> </span><math id="S4.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S4.I1.i4.p1.1.m1.1a"><mn id="S4.I1.i4.p1.1.m1.1.1" xref="S4.I1.i4.p1.1.m1.1.1.cmml">0</mn></semantics></math><span class="gd_word" id="S4.I1.i4.p1.3.2.w1"/><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w2">for</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w3">any</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w4">non-terminal</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w5">state;</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w6">for</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w7">terminal</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w8">states,</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w9">it</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.2.w10">is</span><span> </span><math id="S4.I1.i4.p1.2.m2.2" class="ltx_Math" alttext="m(y_{x},\hat{y})" display="inline"><semantics id="S4.I1.i4.p1.2.m2.2a"><mrow id="S4.I1.i4.p1.2.m2.2.2" xref="S4.I1.i4.p1.2.m2.2.2.cmml"><mi id="S4.I1.i4.p1.2.m2.2.2.3" xref="S4.I1.i4.p1.2.m2.2.2.3.cmml">m</mi><mo id="S4.I1.i4.p1.2.m2.2.2.2" xref="S4.I1.i4.p1.2.m2.2.2.2.cmml">⁢</mo><mrow id="S4.I1.i4.p1.2.m2.2.2.1.1" xref="S4.I1.i4.p1.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.I1.i4.p1.2.m2.2.2.1.1.2" xref="S4.I1.i4.p1.2.m2.2.2.1.2.cmml">(</mo><msub id="S4.I1.i4.p1.2.m2.2.2.1.1.1" xref="S4.I1.i4.p1.2.m2.2.2.1.1.1.cmml"><mi id="S4.I1.i4.p1.2.m2.2.2.1.1.1.2" xref="S4.I1.i4.p1.2.m2.2.2.1.1.1.2.cmml">y</mi><mi id="S4.I1.i4.p1.2.m2.2.2.1.1.1.3" xref="S4.I1.i4.p1.2.m2.2.2.1.1.1.3.cmml">x</mi></msub><mo id="S4.I1.i4.p1.2.m2.2.2.1.1.3" xref="S4.I1.i4.p1.2.m2.2.2.1.2.cmml">,</mo><mover accent="true" id="S4.I1.i4.p1.2.m2.1.1" xref="S4.I1.i4.p1.2.m2.1.1.cmml"><mi id="S4.I1.i4.p1.2.m2.1.1.2" xref="S4.I1.i4.p1.2.m2.1.1.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i4.p1.2.m2.1.1.1" xref="S4.I1.i4.p1.2.m2.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S4.I1.i4.p1.2.m2.2.2.1.1.4" xref="S4.I1.i4.p1.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I1.i4.p1.3.3.w1"/><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.3.w2">for</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.3.w3">privileged</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.3.w4">metrics</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.3.w5">and</span><span> </span><math id="S4.I1.i4.p1.3.m3.2" class="ltx_Math" alttext="m(x,\hat{y})" display="inline"><semantics id="S4.I1.i4.p1.3.m3.2a"><mrow id="S4.I1.i4.p1.3.m3.2.3" xref="S4.I1.i4.p1.3.m3.2.3.cmml"><mi id="S4.I1.i4.p1.3.m3.2.3.2" xref="S4.I1.i4.p1.3.m3.2.3.2.cmml">m</mi><mo id="S4.I1.i4.p1.3.m3.2.3.1" xref="S4.I1.i4.p1.3.m3.2.3.1.cmml">⁢</mo><mrow id="S4.I1.i4.p1.3.m3.2.3.3.2" xref="S4.I1.i4.p1.3.m3.2.3.3.1.cmml"><mo stretchy="false" id="S4.I1.i4.p1.3.m3.2.3.3.2.1" xref="S4.I1.i4.p1.3.m3.2.3.3.1.cmml">(</mo><mi id="S4.I1.i4.p1.3.m3.1.1" xref="S4.I1.i4.p1.3.m3.1.1.cmml">x</mi><mo id="S4.I1.i4.p1.3.m3.2.3.3.2.2" xref="S4.I1.i4.p1.3.m3.2.3.3.1.cmml">,</mo><mover accent="true" id="S4.I1.i4.p1.3.m3.2.2" xref="S4.I1.i4.p1.3.m3.2.2.cmml"><mi id="S4.I1.i4.p1.3.m3.2.2.2" xref="S4.I1.i4.p1.3.m3.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.I1.i4.p1.3.m3.2.2.1" xref="S4.I1.i4.p1.3.m3.2.2.1.cmml">^</mo></mover><mo stretchy="false" id="S4.I1.i4.p1.3.m3.2.3.3.2.3" xref="S4.I1.i4.p1.3.m3.2.3.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I1.i4.p1.3.4.w1"/><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w2">for</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w3">unprivileged</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w4">metrics</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w5">of</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w6">interest.
Entering</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w7">a</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w8">terminal</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w9">state</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w10">is</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w11">done</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w12">by</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w13">picking</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w14">a</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w15">special</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w16">&lt;EOS&gt;</span><span> </span><span class="gd_word" id="S4.I1.i4.p1.3.4.w17">token.</span></p>
</div>
</li>
</ul>
<p id="S4.SS2.p1.7" class="ltx_p"><span class="gd_word" id="S4.SS2.p1.7.1.w1">A</span><span> </span><em id="S4.SS2.p1.7.1" class="ltx_emph ltx_font_italic">value function</em><span class="gd_word" id="S4.SS2.p1.7.2.w1"/><span> </span><math id="S4.SS2.p1.4.m1.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS2.p1.4.m1.1a"><mi id="S4.SS2.p1.4.m1.1.1" xref="S4.SS2.p1.4.m1.1.1.cmml">v</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.3.w2">for</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.3.w3">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.3.w4">policy</span><span> </span><math id="S4.SS2.p1.5.m2.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS2.p1.5.m2.1a"><mi id="S4.SS2.p1.5.m2.1.1" xref="S4.SS2.p1.5.m2.1.1.cmml">π</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.4.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w2">approximates</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w4">final</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w5">score</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w6">one</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w7">might</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w8">expect</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w9">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w10">obtain,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w11">starting</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w12">from</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w13">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w14">non-terminal</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.4.w15">state</span><span> </span><math id="S4.SS2.p1.6.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS2.p1.6.m3.1a"><mi id="S4.SS2.p1.6.m3.1.1" xref="S4.SS2.p1.6.m3.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.5.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.5.w2">and</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.5.w3">following</span><span> </span><math id="S4.SS2.p1.7.m4.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS2.p1.7.m4.1a"><mi id="S4.SS2.p1.7.m4.1.1" xref="S4.SS2.p1.7.m4.1.1.cmml">π</mi></semantics></math><span class="gd_word" id="S4.SS2.p1.7.6.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w2">thereafter.
It</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w3">thus</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.6.w4">provides</span><span> </span><em id="S4.SS2.p1.7.2" class="ltx_emph ltx_font_italic">forward-looking</em><span class="gd_word" id="S4.SS2.p1.7.7.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.7.w2">guidance</span><span> </span><em id="S4.SS2.p1.7.3" class="ltx_emph ltx_font_italic">during</em><span class="gd_word" id="S4.SS2.p1.7.8.w1"/><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w2">decoding,</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w3">as</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w4">opposed</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w5">to</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w6">likelihood</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w7">(accessible</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w8">during</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w9">decoding</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w10">but</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w11">myopic)</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w12">or</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w13">a</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w14">score</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w15">(only</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w16">computable</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w17">on</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w18">finished</span><span> </span><span class="gd_word" id="S4.SS2.p1.7.8.w19">sentences).</span></p>
</div>
<div id="S4.SS2.p2" class="ltx_para ltx_noindent">
<p id="S4.SS2.p2.5" class="ltx_p"><span class="gd_word" id="S4.SS2.p2.5.1.w1">Value-guided</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w2">beam</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w3">search</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w4">(VGBS),</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w5">as</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w6">developed</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.1.w7">by </span><cite class="ltx_cite ltx_citemacro_citet">He et al. (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>); Ren et al. (<a href="#bib.bib31" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S4.SS2.p2.5.2.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w2">augments</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w4">decision</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w5">mechanism</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w6">in</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w7">beam</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w8">search</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w9">(when</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w10">picking</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w11">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.2.w12">top</span><span> </span><math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="S4.SS2.p2.5.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p2.5.3.w2">prefixes</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.3.w3">amongst</span><span> </span><math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="k\times k" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml">k</mi><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">×</mo><mi id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">k</mi></mrow></semantics></math><span class="gd_word" id="S4.SS2.p2.5.4.w1"/><span> </span><span class="gd_word" id="S4.SS2.p2.5.4.w2">candidates)</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.4.w3">with</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.4.w4">a</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.4.w5">value</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.4.w6">network</span><span> </span><math id="S4.SS2.p2.3.m3.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS2.p2.3.m3.1a"><mi id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml">v</mi></semantics></math><span class="gd_word" id="S4.SS2.p2.5.5.w1">.
The</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w2">internal</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w3">score</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w4">is</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w5">a</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w6">linear</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w7">combination</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w8">between</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w9">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w10">(length-normalised)</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w11">log-likelihood</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w12">of</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w13">a</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w14">prefix</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w15">and</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w16">its</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w17">value</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w18">approximated</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w19">by</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w20">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w21">value</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w22">network,</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w23">with</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w24">a</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w25">contribution</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.5.w26">factor</span><span> </span><math id="S4.SS2.p2.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS2.p2.4.m4.1a"><mi id="S4.SS2.p2.4.m4.1.1" xref="S4.SS2.p2.4.m4.1.1.cmml">α</mi></semantics></math><span class="gd_word" id="S4.SS2.p2.5.6.w1">:</span><span> </span><math id="S4.SS2.p2.5.m5.7" class="ltx_Math" alttext="bs(s_{t},a_{t})=\frac{\alpha}{t}\log\big{(}\pi(s_{t},a_{t})\big{)}+(1-\alpha)v%&#10;(s_{t},a_{t})" display="inline"><semantics id="S4.SS2.p2.5.m5.7a"><mrow id="S4.SS2.p2.5.m5.7.7" xref="S4.SS2.p2.5.m5.7.7.cmml"><mrow id="S4.SS2.p2.5.m5.3.3.2" xref="S4.SS2.p2.5.m5.3.3.2.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.4" xref="S4.SS2.p2.5.m5.3.3.2.4.cmml">bs</mi><mo id="S4.SS2.p2.5.m5.3.3.2.3a" xref="S4.SS2.p2.5.m5.3.3.2.3.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.3.3.2.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.3.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.3.3.2.2.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.3.cmml">(</mo><msub id="S4.SS2.p2.5.m5.2.2.1.1.1.1" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.1.2" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.5.m5.2.2.1.1.1.1.3" xref="S4.SS2.p2.5.m5.2.2.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS2.p2.5.m5.3.3.2.2.2.4" xref="S4.SS2.p2.5.m5.3.3.2.2.3.cmml">,</mo><msub id="S4.SS2.p2.5.m5.3.3.2.2.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.2.2" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.2.cmml">a</mi><mi id="S4.SS2.p2.5.m5.3.3.2.2.2.2.3" xref="S4.SS2.p2.5.m5.3.3.2.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS2.p2.5.m5.3.3.2.2.2.5" xref="S4.SS2.p2.5.m5.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p2.5.m5.7.7.7" xref="S4.SS2.p2.5.m5.7.7.7.cmml">=</mo><mrow id="S4.SS2.p2.5.m5.7.7.6" xref="S4.SS2.p2.5.m5.7.7.6.cmml"><mrow id="S4.SS2.p2.5.m5.4.4.3.1" xref="S4.SS2.p2.5.m5.4.4.3.1.cmml"><mfrac id="S4.SS2.p2.5.m5.4.4.3.1.3" xref="S4.SS2.p2.5.m5.4.4.3.1.3.cmml"><mi id="S4.SS2.p2.5.m5.4.4.3.1.3.2" xref="S4.SS2.p2.5.m5.4.4.3.1.3.2.cmml">α</mi><mi id="S4.SS2.p2.5.m5.4.4.3.1.3.3" xref="S4.SS2.p2.5.m5.4.4.3.1.3.3.cmml">t</mi></mfrac><mo id="S4.SS2.p2.5.m5.4.4.3.1.2" xref="S4.SS2.p2.5.m5.4.4.3.1.2.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.4.4.3.1.1.1" xref="S4.SS2.p2.5.m5.4.4.3.1.1.2.cmml"><mi id="S4.SS2.p2.5.m5.1.1" xref="S4.SS2.p2.5.m5.1.1.cmml">log</mi><mo id="S4.SS2.p2.5.m5.4.4.3.1.1.1a" xref="S4.SS2.p2.5.m5.4.4.3.1.1.2.cmml">⁡</mo><mrow id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1" xref="S4.SS2.p2.5.m5.4.4.3.1.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.2" xref="S4.SS2.p2.5.m5.4.4.3.1.1.2.cmml">(</mo><mrow id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.4" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.4.cmml">π</mi><mo id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.3" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.3.cmml">(</mo><msub id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.1.1.1.3.cmml">t</mi></msub><mo id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.4" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.3.cmml">,</mo><msub id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2.cmml"><mi id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2.2" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2.2.cmml">a</mi><mi id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2.3" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.2.5" xref="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo maxsize="120%" minsize="120%" id="S4.SS2.p2.5.m5.4.4.3.1.1.1.1.3" xref="S4.SS2.p2.5.m5.4.4.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S4.SS2.p2.5.m5.7.7.6.5" xref="S4.SS2.p2.5.m5.7.7.6.5.cmml">+</mo><mrow id="S4.SS2.p2.5.m5.7.7.6.4" xref="S4.SS2.p2.5.m5.7.7.6.4.cmml"><mrow id="S4.SS2.p2.5.m5.5.5.4.2.1.1" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.5.5.4.2.1.1.2" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.cmml">(</mo><mrow id="S4.SS2.p2.5.m5.5.5.4.2.1.1.1" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.cmml"><mn id="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.2" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.2.cmml">1</mn><mo id="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.1" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.1.cmml">-</mo><mi id="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.3" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S4.SS2.p2.5.m5.5.5.4.2.1.1.3" xref="S4.SS2.p2.5.m5.5.5.4.2.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.p2.5.m5.7.7.6.4.4" xref="S4.SS2.p2.5.m5.7.7.6.4.4.cmml">⁢</mo><mi id="S4.SS2.p2.5.m5.7.7.6.4.5" xref="S4.SS2.p2.5.m5.7.7.6.4.5.cmml">v</mi><mo id="S4.SS2.p2.5.m5.7.7.6.4.4a" xref="S4.SS2.p2.5.m5.7.7.6.4.4.cmml">⁢</mo><mrow id="S4.SS2.p2.5.m5.7.7.6.4.3.2" xref="S4.SS2.p2.5.m5.7.7.6.4.3.3.cmml"><mo stretchy="false" id="S4.SS2.p2.5.m5.7.7.6.4.3.2.3" xref="S4.SS2.p2.5.m5.7.7.6.4.3.3.cmml">(</mo><msub id="S4.SS2.p2.5.m5.6.6.5.3.2.1.1" xref="S4.SS2.p2.5.m5.6.6.5.3.2.1.1.cmml"><mi id="S4.SS2.p2.5.m5.6.6.5.3.2.1.1.2" xref="S4.SS2.p2.5.m5.6.6.5.3.2.1.1.2.cmml">s</mi><mi id="S4.SS2.p2.5.m5.6.6.5.3.2.1.1.3" xref="S4.SS2.p2.5.m5.6.6.5.3.2.1.1.3.cmml">t</mi></msub><mo id="S4.SS2.p2.5.m5.7.7.6.4.3.2.4" xref="S4.SS2.p2.5.m5.7.7.6.4.3.3.cmml">,</mo><msub id="S4.SS2.p2.5.m5.7.7.6.4.3.2.2" xref="S4.SS2.p2.5.m5.7.7.6.4.3.2.2.cmml"><mi id="S4.SS2.p2.5.m5.7.7.6.4.3.2.2.2" xref="S4.SS2.p2.5.m5.7.7.6.4.3.2.2.2.cmml">a</mi><mi id="S4.SS2.p2.5.m5.7.7.6.4.3.2.2.3" xref="S4.SS2.p2.5.m5.7.7.6.4.3.2.2.3.cmml">t</mi></msub><mo stretchy="false" id="S4.SS2.p2.5.m5.7.7.6.4.3.2.5" xref="S4.SS2.p2.5.m5.7.7.6.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS2.p2.5.7.w1">.</span><span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="gd_word" id="footnote2.3.w1">Using</span><span> </span><span class="gd_word" id="footnote2.3.w2">the</span><span> </span><span class="gd_word" id="footnote2.3.w3">logarithm</span><span> </span><span class="gd_word" id="footnote2.3.w4">of</span><span> </span><span class="gd_word" id="footnote2.3.w5">the</span><span> </span><span class="gd_word" id="footnote2.3.w6">value</span><span> </span><span class="gd_word" id="footnote2.3.w7">instead,</span><span> </span><span class="gd_word" id="footnote2.3.w8">as</span><span> </span><span class="gd_word" id="footnote2.3.w9">in </span><cite class="ltx_cite ltx_citemacro_citet">He et al. (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="footnote2.4.w1">,</span><span> </span><span class="gd_word" id="footnote2.4.w2">yields</span><span> </span><span class="gd_word" id="footnote2.4.w3">no</span><span> </span><span class="gd_word" id="footnote2.4.w4">practical</span><span> </span><span class="gd_word" id="footnote2.4.w5">gains.</span><span> </span><span class="gd_word" id="footnote2.4.w6">So</span><span> </span><span class="gd_word" id="footnote2.4.w7">we</span><span> </span><span class="gd_word" id="footnote2.4.w8">opt</span><span> </span><span class="gd_word" id="footnote2.4.w9">for</span><span> </span><span class="gd_word" id="footnote2.4.w10">the</span><span> </span><span class="gd_word" id="footnote2.4.w11">simpler</span><span> </span><span class="gd_word" id="footnote2.4.w12">formulation.</span></span></span></span><span class="gd_word" id="S4.SS2.p2.5.8.w1">
Note</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w2">that</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w3">this</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w4">method</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w5">does</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w6">not</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w7">use</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w8">the</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w9">score;</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w10">thus</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w11">it</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w12">is</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w13">applicable</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w14">to</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w15">both</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w16">unprivileged</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w17">and</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w18">privileged</span><span> </span><span class="gd_word" id="S4.SS2.p2.5.8.w19">metrics.</span></p>
</div>
<div id="S4.SS2.p3" class="ltx_para ltx_noindent">
<p id="S4.SS2.p3.2" class="ltx_p"><span class="gd_word" id="S4.SS2.p3.2.1.w1">Value-guided</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w2">MCTS</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w3">(V-MCTS)</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w4">indicates</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w5">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w6">version</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w7">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w8">Monte</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w9">Carlo</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w10">Tree</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w11">Search</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w12">as</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w13">used</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.1.w14">by </span><cite class="ltx_cite ltx_citemacro_citet">Silver et al. (<a href="#bib.bib35" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S4.SS2.p3.2.2.w1">.
This</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w2">search</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w3">method</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w4">combines</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w5">both</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w6">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.2.w7">policy</span><span> </span><math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">π</mi></semantics></math><span class="gd_word" id="S4.SS2.p3.2.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.2.3.w2">and</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.3.w3">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.3.w4">value</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.3.w5">network</span><span> </span><math id="S4.SS2.p3.2.m2.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S4.SS2.p3.2.m2.1a"><mi id="S4.SS2.p3.2.m2.1.1" xref="S4.SS2.p3.2.m2.1.1.cmml">v</mi></semantics></math><span class="gd_word" id="S4.SS2.p3.2.4.w1">.
For</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w2">every</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w3">decoding</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w4">step,</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w5">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w6">fixed</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w7">budget</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w8">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w9">simulations</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w10">is</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w11">allocated</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w12">to</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w13">build</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w14">a</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w15">tree</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w16">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w17">possible</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w18">future</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w19">trajectories.
Each</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w20">simulation</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w21">consists</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w22">in</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w23">3</span><span> </span><span class="gd_word" id="S4.SS2.p3.2.4.w24">steps:</span></p>
<ul id="S4.I2" class="ltx_itemize">
<li id="S4.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i1.p1" class="ltx_para">
<p id="S4.I2.i1.p1.1" class="ltx_p"><span class="gd_word" id="S4.I2.i1.p1.1.1.w1">selection:</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w2">recursively</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w3">picking</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w4">children</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w5">nodes</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w6">according</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w7">to</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w8">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w9">pUCT</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w10">formula,</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w11">starting</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w12">at</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w13">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w14">root</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w15">and</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w16">until</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w17">reaching</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w18">an</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w19">unopened</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w20">(i.e.</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w21">not</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w22">expanded</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w23">yet)</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.1.1.w24">node</span><span> </span><math id="S4.I2.i1.p1.1.m1.1" class="ltx_Math" alttext="s_{o}" display="inline"><semantics id="S4.I2.i1.p1.1.m1.1a"><msub id="S4.I2.i1.p1.1.m1.1.1" xref="S4.I2.i1.p1.1.m1.1.1.cmml"><mi id="S4.I2.i1.p1.1.m1.1.1.2" xref="S4.I2.i1.p1.1.m1.1.1.2.cmml">s</mi><mi id="S4.I2.i1.p1.1.m1.1.1.3" xref="S4.I2.i1.p1.1.m1.1.1.3.cmml">o</mi></msub></semantics></math><span class="gd_word" id="S4.I2.i1.p1.1.2.w1">:</span></p>
<table id="S4.Ex1" class="ltx_equationgroup ltx_eqn_table">

<tbody id="S4.Ex1X"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.Ex1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle a" display="inline"><semantics id="S4.Ex1X.2.1.1.m1.1a"><mi id="S4.Ex1X.2.1.1.m1.1.1" xref="S4.Ex1X.2.1.1.m1.1.1.cmml">a</mi></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.Ex1X.3.2.2.m1.7" class="ltx_Math" alttext="\displaystyle=\underset{{a\in\mathcal{A}}}{\mathrm{argmax}}\Bigg{(}Q(s,a)+c_{%&#10;\text{puct}}\pi_{\tau}(a|s)\frac{\sqrt{\sum_{b}N(s,b)}}{1+N(s,a)}\Bigg{)}" display="inline"><semantics id="S4.Ex1X.3.2.2.m1.7a"><mrow id="S4.Ex1X.3.2.2.m1.7.7" xref="S4.Ex1X.3.2.2.m1.7.7.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.3" xref="S4.Ex1X.3.2.2.m1.7.7.3.cmml"/><mo id="S4.Ex1X.3.2.2.m1.7.7.2" xref="S4.Ex1X.3.2.2.m1.7.7.2.cmml">=</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.cmml"><munder accentunder="true" id="S4.Ex1X.3.2.2.m1.7.7.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.3.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.2.cmml">argmax</mi><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.3.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.1.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.3.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.1.2.cmml">a</mi><mo id="S4.Ex1X.3.2.2.m1.7.7.1.3.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.Ex1X.3.2.2.m1.7.7.1.3.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.3.1.3.cmml">𝒜</mi></mrow></munder><mo id="S4.Ex1X.3.2.2.m1.7.7.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.2.cmml">⁢</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.cmml"><mo maxsize="260%" minsize="260%" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.cmml"><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.2.cmml">Q</mi><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.1.cmml"><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.2.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.1.cmml">(</mo><mi id="S4.Ex1X.3.2.2.m1.5.5" xref="S4.Ex1X.3.2.2.m1.5.5.cmml">s</mi><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.2.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.1.cmml">,</mo><mi id="S4.Ex1X.3.2.2.m1.6.6" xref="S4.Ex1X.3.2.2.m1.6.6.cmml">a</mi><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.2.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.2.cmml">+</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.cmml"><msub id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3.2.cmml">c</mi><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.3.3a.cmml">puct</mi></msub><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><msub id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4.2.cmml">π</mi><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.4.3.cmml">τ</mi></msub><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2a" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2b" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mstyle displaystyle="true" id="S4.Ex1X.3.2.2.m1.4.4" xref="S4.Ex1X.3.2.2.m1.4.4.cmml"><mfrac id="S4.Ex1X.3.2.2.m1.4.4a" xref="S4.Ex1X.3.2.2.m1.4.4.cmml"><msqrt id="S4.Ex1X.3.2.2.m1.2.2.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.cmml"><mrow id="S4.Ex1X.3.2.2.m1.2.2.2.2.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.cmml"><msub id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3.cmml"><mo largeop="true" symmetric="true" id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3.2.cmml">∑</mo><mi id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3.3" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.3.3.cmml">b</mi></msub><mrow id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.cmml"><mi id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.2.cmml">N</mi><mo id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.1" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.1.cmml"><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.2.1" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.1.cmml">(</mo><mi id="S4.Ex1X.3.2.2.m1.1.1.1.1.1.1" xref="S4.Ex1X.3.2.2.m1.1.1.1.1.1.1.cmml">s</mi><mo id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.2.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.1.cmml">,</mo><mi id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.2" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.2.cmml">b</mi><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.2.3" xref="S4.Ex1X.3.2.2.m1.2.2.2.2.2.4.3.1.cmml">)</mo></mrow></mrow></mrow></msqrt><mrow id="S4.Ex1X.3.2.2.m1.4.4.4" xref="S4.Ex1X.3.2.2.m1.4.4.4.cmml"><mn id="S4.Ex1X.3.2.2.m1.4.4.4.4" xref="S4.Ex1X.3.2.2.m1.4.4.4.4.cmml">1</mn><mo id="S4.Ex1X.3.2.2.m1.4.4.4.3" xref="S4.Ex1X.3.2.2.m1.4.4.4.3.cmml">+</mo><mrow id="S4.Ex1X.3.2.2.m1.4.4.4.5" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.cmml"><mi id="S4.Ex1X.3.2.2.m1.4.4.4.5.2" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.2.cmml">N</mi><mo id="S4.Ex1X.3.2.2.m1.4.4.4.5.1" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.1.cmml">⁢</mo><mrow id="S4.Ex1X.3.2.2.m1.4.4.4.5.3.2" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.3.1.cmml"><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.4.4.4.5.3.2.1" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.3.1.cmml">(</mo><mi id="S4.Ex1X.3.2.2.m1.3.3.3.1" xref="S4.Ex1X.3.2.2.m1.3.3.3.1.cmml">s</mi><mo id="S4.Ex1X.3.2.2.m1.4.4.4.5.3.2.2" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.3.1.cmml">,</mo><mi id="S4.Ex1X.3.2.2.m1.4.4.4.2" xref="S4.Ex1X.3.2.2.m1.4.4.4.2.cmml">a</mi><mo stretchy="false" id="S4.Ex1X.3.2.2.m1.4.4.4.5.3.2.3" xref="S4.Ex1X.3.2.2.m1.4.4.4.5.3.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle></mrow></mrow><mo maxsize="260%" minsize="260%" id="S4.Ex1X.3.2.2.m1.7.7.1.1.1.3" xref="S4.Ex1X.3.2.2.m1.7.7.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr></tbody>
</table>
<p id="S4.I2.i1.p1.10" class="ltx_p"><span class="gd_word" id="S4.I2.i1.p1.10.1.w1">where</span><span> </span><math id="S4.I2.i1.p1.2.m1.2" class="ltx_Math" alttext="Q(s,a)" display="inline"><semantics id="S4.I2.i1.p1.2.m1.2a"><mrow id="S4.I2.i1.p1.2.m1.2.3" xref="S4.I2.i1.p1.2.m1.2.3.cmml"><mi id="S4.I2.i1.p1.2.m1.2.3.2" xref="S4.I2.i1.p1.2.m1.2.3.2.cmml">Q</mi><mo id="S4.I2.i1.p1.2.m1.2.3.1" xref="S4.I2.i1.p1.2.m1.2.3.1.cmml">⁢</mo><mrow id="S4.I2.i1.p1.2.m1.2.3.3.2" xref="S4.I2.i1.p1.2.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.I2.i1.p1.2.m1.2.3.3.2.1" xref="S4.I2.i1.p1.2.m1.2.3.3.1.cmml">(</mo><mi id="S4.I2.i1.p1.2.m1.1.1" xref="S4.I2.i1.p1.2.m1.1.1.cmml">s</mi><mo id="S4.I2.i1.p1.2.m1.2.3.3.2.2" xref="S4.I2.i1.p1.2.m1.2.3.3.1.cmml">,</mo><mi id="S4.I2.i1.p1.2.m1.2.2" xref="S4.I2.i1.p1.2.m1.2.2.cmml">a</mi><mo stretchy="false" id="S4.I2.i1.p1.2.m1.2.3.3.2.3" xref="S4.I2.i1.p1.2.m1.2.3.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.2.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w2">is</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w3">a</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w4">statistic</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w5">representing</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w6">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w7">value</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w8">of</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w9">taking</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.2.w10">action</span><span> </span><math id="S4.I2.i1.p1.3.m2.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.I2.i1.p1.3.m2.1a"><mi id="S4.I2.i1.p1.3.m2.1.1" xref="S4.I2.i1.p1.3.m2.1.1.cmml">a</mi></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.3.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.3.w2">in</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.3.w3">state</span><span> </span><math id="S4.I2.i1.p1.4.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.I2.i1.p1.4.m3.1a"><mi id="S4.I2.i1.p1.4.m3.1.1" xref="S4.I2.i1.p1.4.m3.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.4.w1">,</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.4.w2">updated</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.4.w3">online</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.4.w4">during</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.4.w5">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.4.w6">search,</span><span> </span><math id="S4.I2.i1.p1.5.m4.1" class="ltx_Math" alttext="c_{\text{puct}}" display="inline"><semantics id="S4.I2.i1.p1.5.m4.1a"><msub id="S4.I2.i1.p1.5.m4.1.1" xref="S4.I2.i1.p1.5.m4.1.1.cmml"><mi id="S4.I2.i1.p1.5.m4.1.1.2" xref="S4.I2.i1.p1.5.m4.1.1.2.cmml">c</mi><mi id="S4.I2.i1.p1.5.m4.1.1.3" xref="S4.I2.i1.p1.5.m4.1.1.3a.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.5.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.5.w2">is</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.5.w3">a</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.5.w4">tunable</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.5.w5">constant,</span><span> </span><math id="S4.I2.i1.p1.6.m5.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.I2.i1.p1.6.m5.1a"><mi id="S4.I2.i1.p1.6.m5.1.1" xref="S4.I2.i1.p1.6.m5.1.1.cmml">τ</mi></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.6.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w2">is</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w3">a</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w4">temperature</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w5">parameter</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w6">applied</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w7">to</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w8">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.6.w9">policy</span><span> </span><math id="S4.I2.i1.p1.7.m6.3" class="ltx_Math" alttext="\pi_{\tau}(a|s)=\nicefrac{{\pi(a|s)^{1/\tau}}}{{\sum_{b}\pi(b|s)^{1/\tau}}}" display="inline"><semantics id="S4.I2.i1.p1.7.m6.3a"><mrow id="S4.I2.i1.p1.7.m6.3.3" xref="S4.I2.i1.p1.7.m6.3.3.cmml"><mrow id="S4.I2.i1.p1.7.m6.3.3.1" xref="S4.I2.i1.p1.7.m6.3.3.1.cmml"><msub id="S4.I2.i1.p1.7.m6.3.3.1.3" xref="S4.I2.i1.p1.7.m6.3.3.1.3.cmml"><mi id="S4.I2.i1.p1.7.m6.3.3.1.3.2" xref="S4.I2.i1.p1.7.m6.3.3.1.3.2.cmml">π</mi><mi id="S4.I2.i1.p1.7.m6.3.3.1.3.3" xref="S4.I2.i1.p1.7.m6.3.3.1.3.3.cmml">τ</mi></msub><mo id="S4.I2.i1.p1.7.m6.3.3.1.2" xref="S4.I2.i1.p1.7.m6.3.3.1.2.cmml">⁢</mo><mrow id="S4.I2.i1.p1.7.m6.3.3.1.1.1" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.I2.i1.p1.7.m6.3.3.1.1.1.2" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i1.p1.7.m6.3.3.1.1.1.1" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.cmml"><mi id="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.2" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.2.cmml">a</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.1.cmml">|</mo><mi id="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.3.cmml">s</mi></mrow><mo stretchy="false" id="S4.I2.i1.p1.7.m6.3.3.1.1.1.3" xref="S4.I2.i1.p1.7.m6.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.I2.i1.p1.7.m6.3.3.2" xref="S4.I2.i1.p1.7.m6.3.3.2.cmml">=</mo><mrow id="S4.I2.i1.p1.7.m6.2.2" xref="S4.I2.i1.p1.7.m6.2.2.cmml"><mpadded depth="-0.3em" height="+0.3em" voffset="0.3em" id="S4.I2.i1.p1.7.m6.1.1.1" xref="S4.I2.i1.p1.7.m6.1.1.1.cmml"><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.1.1.1.3" xref="S4.I2.i1.p1.7.m6.1.1.1.3.cmml">π</mi><mo id="S4.I2.i1.p1.7.m6.1.1.1.2" xref="S4.I2.i1.p1.7.m6.1.1.1.2.cmml">⁢</mo><msup id="S4.I2.i1.p1.7.m6.1.1.1.1" xref="S4.I2.i1.p1.7.m6.1.1.1.1.cmml"><mrow id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.2" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.2" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="2.5pt" mathsize="70%" rspace="2.5pt" stretchy="false" id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.1.cmml">|</mo><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.3.cmml">s</mi></mrow><mo maxsize="70%" minsize="70%" id="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.I2.i1.p1.7.m6.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.1.1.1.1.3.cmml"><mn mathsize="71%" id="S4.I2.i1.p1.7.m6.1.1.1.1.3.2" xref="S4.I2.i1.p1.7.m6.1.1.1.1.3.2.cmml">1</mn><mo mathsize="71%" stretchy="false" id="S4.I2.i1.p1.7.m6.1.1.1.1.3.1" xref="S4.I2.i1.p1.7.m6.1.1.1.1.3.1.cmml">/</mo><mi mathsize="71%" id="S4.I2.i1.p1.7.m6.1.1.1.1.3.3" xref="S4.I2.i1.p1.7.m6.1.1.1.1.3.3.cmml">τ</mi></mrow></msup></mpadded><mpadded lspace="-0.1em" width="-0.15em" id="S4.I2.i1.p1.7.m6.2.2.3" xref="S4.I2.i1.p1.7.m6.2.2.3.cmml"><mo stretchy="true" id="S4.I2.i1.p1.7.m6.2.2.3a" xref="S4.I2.i1.p1.7.m6.2.2.3.cmml">/</mo></mpadded><mrow id="S4.I2.i1.p1.7.m6.2.2.2" xref="S4.I2.i1.p1.7.m6.2.2.2.cmml"><msub id="S4.I2.i1.p1.7.m6.2.2.2.2" xref="S4.I2.i1.p1.7.m6.2.2.2.2.cmml"><mo largeop="true" mathsize="70%" stretchy="false" symmetric="true" id="S4.I2.i1.p1.7.m6.2.2.2.2.2" xref="S4.I2.i1.p1.7.m6.2.2.2.2.2.cmml">∑</mo><mi mathsize="71%" id="S4.I2.i1.p1.7.m6.2.2.2.2.3" xref="S4.I2.i1.p1.7.m6.2.2.2.2.3.cmml">b</mi></msub><mrow id="S4.I2.i1.p1.7.m6.2.2.2.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.cmml"><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.2.2.2.1.3" xref="S4.I2.i1.p1.7.m6.2.2.2.1.3.cmml">π</mi><mo id="S4.I2.i1.p1.7.m6.2.2.2.1.2" xref="S4.I2.i1.p1.7.m6.2.2.2.1.2.cmml">⁢</mo><msup id="S4.I2.i1.p1.7.m6.2.2.2.1.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.cmml"><mrow id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.2" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.cmml"><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.2" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.2.cmml">b</mi><mo lspace="2.5pt" mathsize="70%" rspace="2.5pt" stretchy="false" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.1.cmml">|</mo><mi mathsize="70%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.3.cmml">s</mi></mrow><mo maxsize="70%" minsize="70%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.3" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.I2.i1.p1.7.m6.2.2.2.1.1.3" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.cmml"><mn mathsize="71%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.2" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.2.cmml">1</mn><mo mathsize="71%" stretchy="false" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.1" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.1.cmml">/</mo><mi mathsize="71%" id="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.3" xref="S4.I2.i1.p1.7.m6.2.2.2.1.1.3.3.cmml">τ</mi></mrow></msup></mrow></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.7.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.7.w2">and</span><span> </span><math id="S4.I2.i1.p1.8.m7.2" class="ltx_Math" alttext="N(s,a)" display="inline"><semantics id="S4.I2.i1.p1.8.m7.2a"><mrow id="S4.I2.i1.p1.8.m7.2.3" xref="S4.I2.i1.p1.8.m7.2.3.cmml"><mi id="S4.I2.i1.p1.8.m7.2.3.2" xref="S4.I2.i1.p1.8.m7.2.3.2.cmml">N</mi><mo id="S4.I2.i1.p1.8.m7.2.3.1" xref="S4.I2.i1.p1.8.m7.2.3.1.cmml">⁢</mo><mrow id="S4.I2.i1.p1.8.m7.2.3.3.2" xref="S4.I2.i1.p1.8.m7.2.3.3.1.cmml"><mo stretchy="false" id="S4.I2.i1.p1.8.m7.2.3.3.2.1" xref="S4.I2.i1.p1.8.m7.2.3.3.1.cmml">(</mo><mi id="S4.I2.i1.p1.8.m7.1.1" xref="S4.I2.i1.p1.8.m7.1.1.cmml">s</mi><mo id="S4.I2.i1.p1.8.m7.2.3.3.2.2" xref="S4.I2.i1.p1.8.m7.2.3.3.1.cmml">,</mo><mi id="S4.I2.i1.p1.8.m7.2.2" xref="S4.I2.i1.p1.8.m7.2.2.cmml">a</mi><mo stretchy="false" id="S4.I2.i1.p1.8.m7.2.3.3.2.3" xref="S4.I2.i1.p1.8.m7.2.3.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.8.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w2">is</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w3">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w4">number</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w5">of</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w6">times</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.8.w7">action</span><span> </span><math id="S4.I2.i1.p1.9.m8.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.I2.i1.p1.9.m8.1a"><mi id="S4.I2.i1.p1.9.m8.1.1" xref="S4.I2.i1.p1.9.m8.1.1.cmml">a</mi></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.9.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.9.w2">has</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.9.w3">been</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.9.w4">chosen</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.9.w5">from</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.9.w6">state</span><span> </span><math id="S4.I2.i1.p1.10.m9.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.I2.i1.p1.10.m9.1a"><mi id="S4.I2.i1.p1.10.m9.1.1" xref="S4.I2.i1.p1.10.m9.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.I2.i1.p1.10.10.w1"/><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w2">while</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w3">building</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w4">the</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w5">tree</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w6">(also</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w7">called</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w8">visit</span><span> </span><span class="gd_word" id="S4.I2.i1.p1.10.10.w9">count);</span></p>
</div>
</li>
<li id="S4.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i2.p1" class="ltx_para">
<p id="S4.I2.i2.p1.3" class="ltx_p"><span class="gd_word" id="S4.I2.i2.p1.3.1.w1">expansion:</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.1.w2">opening</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.1.w3">the</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.1.w4">selected</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.1.w5">node</span><span> </span><math id="S4.I2.i2.p1.1.m1.1" class="ltx_Math" alttext="s_{o}" display="inline"><semantics id="S4.I2.i2.p1.1.m1.1a"><msub id="S4.I2.i2.p1.1.m1.1.1" xref="S4.I2.i2.p1.1.m1.1.1.cmml"><mi id="S4.I2.i2.p1.1.m1.1.1.2" xref="S4.I2.i2.p1.1.m1.1.1.2.cmml">s</mi><mi id="S4.I2.i2.p1.1.m1.1.1.3" xref="S4.I2.i2.p1.1.m1.1.1.3.cmml">o</mi></msub></semantics></math><span class="gd_word" id="S4.I2.i2.p1.3.2.w1"/><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.2.w2">by</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.2.w3">computing</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.2.w4">the</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.2.w5">policy</span><span> </span><math id="S4.I2.i2.p1.2.m2.1" class="ltx_Math" alttext="\pi(a|s_{o})_{a\in\mathcal{A}}" display="inline"><semantics id="S4.I2.i2.p1.2.m2.1a"><mrow id="S4.I2.i2.p1.2.m2.1.1" xref="S4.I2.i2.p1.2.m2.1.1.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.3.cmml">π</mi><mo id="S4.I2.i2.p1.2.m2.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.2.cmml">⁢</mo><msub id="S4.I2.i2.p1.2.m2.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.cmml"><mrow id="S4.I2.i2.p1.2.m2.1.1.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I2.i2.p1.2.m2.1.1.1.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.2" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.2.cmml">a</mi><mo lspace="2.5pt" rspace="2.5pt" stretchy="false" id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.1" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.1.cmml">|</mo><msub id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3.2" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3.2.cmml">s</mi><mi id="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3.3" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.3.3.cmml">o</mi></msub></mrow><mo stretchy="false" id="S4.I2.i2.p1.2.m2.1.1.1.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.I2.i2.p1.2.m2.1.1.1.3" xref="S4.I2.i2.p1.2.m2.1.1.1.3.cmml"><mi id="S4.I2.i2.p1.2.m2.1.1.1.3.2" xref="S4.I2.i2.p1.2.m2.1.1.1.3.2.cmml">a</mi><mo id="S4.I2.i2.p1.2.m2.1.1.1.3.1" xref="S4.I2.i2.p1.2.m2.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.I2.i2.p1.2.m2.1.1.1.3.3" xref="S4.I2.i2.p1.2.m2.1.1.1.3.3.cmml">𝒜</mi></mrow></msub></mrow></semantics></math><span class="gd_word" id="S4.I2.i2.p1.3.3.w1"/><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w2">at</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w3">the</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w4">associated</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w5">new</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w6">state,</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w7">as</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w8">well</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w9">as</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w10">the</span><span> </span><span class="gd_word" id="S4.I2.i2.p1.3.3.w11">value</span><span> </span><math id="S4.I2.i2.p1.3.m3.1" class="ltx_Math" alttext="v(s_{o})" display="inline"><semantics id="S4.I2.i2.p1.3.m3.1a"><mrow id="S4.I2.i2.p1.3.m3.1.1" xref="S4.I2.i2.p1.3.m3.1.1.cmml"><mi id="S4.I2.i2.p1.3.m3.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.3.cmml">v</mi><mo id="S4.I2.i2.p1.3.m3.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i2.p1.3.m3.1.1.1.1" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I2.i2.p1.3.m3.1.1.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i2.p1.3.m3.1.1.1.1.1" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.I2.i2.p1.3.m3.1.1.1.1.1.2" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S4.I2.i2.p1.3.m3.1.1.1.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.3.cmml">o</mi></msub><mo stretchy="false" id="S4.I2.i2.p1.3.m3.1.1.1.1.3" xref="S4.I2.i2.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i2.p1.3.4.w1">;</span></p>
</div>
</li>
<li id="S4.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S4.I2.i3.p1" class="ltx_para">
<p id="S4.I2.i3.p1.4" class="ltx_p"><span class="gd_word" id="S4.I2.i3.p1.4.1.w1">backup:</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.1.w2">updating</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.1.w3">the</span><span> </span><math id="S4.I2.i3.p1.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.I2.i3.p1.1.m1.1a"><mi id="S4.I2.i3.p1.1.m1.1.1" xref="S4.I2.i3.p1.1.m1.1.1.cmml">Q</mi></semantics></math><span class="gd_word" id="S4.I2.i3.p1.4.2.w1"/><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w2">statistics</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w3">encountered</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w4">during</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w5">the</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w6">tree</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w7">traversal</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w8">leading</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.2.w9">to</span><span> </span><math id="S4.I2.i3.p1.2.m2.1" class="ltx_Math" alttext="s_{o}" display="inline"><semantics id="S4.I2.i3.p1.2.m2.1a"><msub id="S4.I2.i3.p1.2.m2.1.1" xref="S4.I2.i3.p1.2.m2.1.1.cmml"><mi id="S4.I2.i3.p1.2.m2.1.1.2" xref="S4.I2.i3.p1.2.m2.1.1.2.cmml">s</mi><mi id="S4.I2.i3.p1.2.m2.1.1.3" xref="S4.I2.i3.p1.2.m2.1.1.3.cmml">o</mi></msub></semantics></math><span class="gd_word" id="S4.I2.i3.p1.4.3.w1"/><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w2">via</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w3">an</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w4">aggregation</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w5">mechanism</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w6">(such</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.3.w7">as</span><span> </span><em id="S4.I2.i3.p1.4.1" class="ltx_emph ltx_font_italic">averaging</em><span class="gd_word" id="S4.I2.i3.p1.4.4.w1"/><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.4.w2">the</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.4.w3">previous</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.4.w4">statistic</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.4.w5">with</span><span> </span><math id="S4.I2.i3.p1.3.m3.1" class="ltx_Math" alttext="v(s_{o})" display="inline"><semantics id="S4.I2.i3.p1.3.m3.1a"><mrow id="S4.I2.i3.p1.3.m3.1.1" xref="S4.I2.i3.p1.3.m3.1.1.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.3" xref="S4.I2.i3.p1.3.m3.1.1.3.cmml">v</mi><mo id="S4.I2.i3.p1.3.m3.1.1.2" xref="S4.I2.i3.p1.3.m3.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.3.m3.1.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I2.i3.p1.3.m3.1.1.1.1.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i3.p1.3.m3.1.1.1.1.1" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.2" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.2.cmml">s</mi><mi id="S4.I2.i3.p1.3.m3.1.1.1.1.1.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.3.cmml">o</mi></msub><mo stretchy="false" id="S4.I2.i3.p1.3.m3.1.1.1.1.3" xref="S4.I2.i3.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i3.p1.4.5.w1">,</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.5.w2">or</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.5.w3">taking</span><span> </span><span class="gd_word" id="S4.I2.i3.p1.4.5.w4">their</span><span> </span><em id="S4.I2.i3.p1.4.2" class="ltx_emph ltx_font_italic">maximum</em><span class="gd_word" id="S4.I2.i3.p1.4.6.w1">:</span><span> </span><math id="S4.I2.i3.p1.4.m4.2" class="ltx_Math" alttext="{Q\leftarrow\mathrm{max}(Q,v(s_{o}))}" display="inline"><semantics id="S4.I2.i3.p1.4.m4.2a"><mrow id="S4.I2.i3.p1.4.m4.2.2" xref="S4.I2.i3.p1.4.m4.2.2.cmml"><mi id="S4.I2.i3.p1.4.m4.2.2.3" xref="S4.I2.i3.p1.4.m4.2.2.3.cmml">Q</mi><mo id="S4.I2.i3.p1.4.m4.2.2.2" xref="S4.I2.i3.p1.4.m4.2.2.2.cmml">←</mo><mrow id="S4.I2.i3.p1.4.m4.2.2.1" xref="S4.I2.i3.p1.4.m4.2.2.1.cmml"><mi id="S4.I2.i3.p1.4.m4.2.2.1.3" xref="S4.I2.i3.p1.4.m4.2.2.1.3.cmml">max</mi><mo id="S4.I2.i3.p1.4.m4.2.2.1.2" xref="S4.I2.i3.p1.4.m4.2.2.1.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.4.m4.2.2.1.1.1" xref="S4.I2.i3.p1.4.m4.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.I2.i3.p1.4.m4.2.2.1.1.1.2" xref="S4.I2.i3.p1.4.m4.2.2.1.1.2.cmml">(</mo><mi id="S4.I2.i3.p1.4.m4.1.1" xref="S4.I2.i3.p1.4.m4.1.1.cmml">Q</mi><mo id="S4.I2.i3.p1.4.m4.2.2.1.1.1.3" xref="S4.I2.i3.p1.4.m4.2.2.1.1.2.cmml">,</mo><mrow id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.3" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.3.cmml">v</mi><mo id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.2" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml">(</mo><msub id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.2" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.3.cmml">o</mi></msub><mo stretchy="false" id="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.3" xref="S4.I2.i3.p1.4.m4.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.I2.i3.p1.4.m4.2.2.1.1.1.4" xref="S4.I2.i3.p1.4.m4.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow></semantics></math><span class="gd_word" id="S4.I2.i3.p1.4.7.w1">).</span></p>
</div>
</li>
</ul>
<p id="S4.SS2.p3.3" class="ltx_p"><span class="gd_word" id="S4.SS2.p3.3.1.w1">Once</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w2">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w3">tree</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w4">is</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w5">finished,</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w6">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w7">decision</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w8">for</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w9">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w10">current</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w11">decoding</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w12">step</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w13">is</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w14">made</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w15">according</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w16">to</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w17">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w18">statistics</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w19">of</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w20">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w21">root’s</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w22">children</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w23">nodes.
A</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w24">popular</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w25">option</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w26">consists</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w27">in</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w28">picking</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w29">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w30">root</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w31">child</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w32">with</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.1.w33">the</span><span> </span><em id="S4.SS2.p3.3.1" class="ltx_emph ltx_font_italic">most visit counts</em><span class="gd_word" id="S4.SS2.p3.3.2.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w2">but</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w3">one</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w4">may</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w5">also</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w6">select</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w7">the</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w8">one</span><span> </span><span class="gd_word" id="S4.SS2.p3.3.2.w9">with</span><span> </span><em id="S4.SS2.p3.3.2" class="ltx_emph ltx_font_italic">maximum aggregated value</em><span class="gd_word" id="S4.SS2.p3.3.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p3.3.3.w2">instead.</span></p>
</div>
<div id="S4.SS2.p4" class="ltx_para">
<p id="S4.SS2.p4.1" class="ltx_p"><span class="gd_word" id="S4.SS2.p4.1.1.w1">While</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w2">it</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w3">is</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w4">customary</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w5">to</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w6">allow</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w7">MCTS</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w8">to</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w9">use</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w10">the</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w11">score</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w12">directly</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w13">when</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w14">encountering</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w15">a</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w16">terminal</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w17">state,</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w18">we</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w19">opt</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w20">for</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w21">a</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w22">pure</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w23">value</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w24">implementation</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w25">instead</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w26">(i.e.</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w27">using</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w28">the</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w29">value</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w30">instead</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w31">of</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w32">the</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w33">score</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w34">on</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w35">terminal</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w36">nodes).
This</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w37">makes</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w38">V-MCTS</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w39">applicable</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w40">to</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w41">privileged</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w42">metrics,</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w43">which</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w44">it</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w45">wouldn’t</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w46">be</span><span> </span><span class="gd_word" id="S4.SS2.p4.1.1.w47">otherwise.</span></p>
</div>
<div id="S4.SS2.p5" class="ltx_para">
<p id="S4.SS2.p5.7" class="ltx_p"><span class="gd_word" id="S4.SS2.p5.7.1.w1">One</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w2">of</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w3">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w4">keys</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w5">to</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w6">successful</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w7">MCTS</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w8">performance</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w9">is</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w10">properly</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w11">balancing</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w12">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w13">breadth</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w14">and</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w15">depth</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w16">of</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w17">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w18">exploratory</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w19">trees.
We</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w20">found</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w21">two</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w22">adaptations</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w23">to</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w24">be</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w25">helpful.
First,</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w26">we</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w27">used</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w28">an</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w29">adaptive</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w30">value</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w31">scale</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w32">as</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w33">described</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.1.w34">by </span><cite class="ltx_cite ltx_citemacro_citet">Schrittwieser et al. (<a href="#bib.bib32" title="" class="ltx_ref">2020</a>, Appendix B)</cite><span class="gd_word" id="S4.SS2.p5.7.2.w1">:
in</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.2.w2">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.2.w3">selection</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.2.w4">phase,</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.2.w5">we</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.2.w6">rescale</span><span> </span><math id="S4.SS2.p5.1.m1.2" class="ltx_Math" alttext="Q(s,a)" display="inline"><semantics id="S4.SS2.p5.1.m1.2a"><mrow id="S4.SS2.p5.1.m1.2.3" xref="S4.SS2.p5.1.m1.2.3.cmml"><mi id="S4.SS2.p5.1.m1.2.3.2" xref="S4.SS2.p5.1.m1.2.3.2.cmml">Q</mi><mo id="S4.SS2.p5.1.m1.2.3.1" xref="S4.SS2.p5.1.m1.2.3.1.cmml">⁢</mo><mrow id="S4.SS2.p5.1.m1.2.3.3.2" xref="S4.SS2.p5.1.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.SS2.p5.1.m1.2.3.3.2.1" xref="S4.SS2.p5.1.m1.2.3.3.1.cmml">(</mo><mi id="S4.SS2.p5.1.m1.1.1" xref="S4.SS2.p5.1.m1.1.1.cmml">s</mi><mo id="S4.SS2.p5.1.m1.2.3.3.2.2" xref="S4.SS2.p5.1.m1.2.3.3.1.cmml">,</mo><mi id="S4.SS2.p5.1.m1.2.2" xref="S4.SS2.p5.1.m1.2.2.cmml">a</mi><mo stretchy="false" id="S4.SS2.p5.1.m1.2.3.3.2.3" xref="S4.SS2.p5.1.m1.2.3.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS2.p5.7.3.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.3.w2">in</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.3.w3">the</span><span> </span><math id="S4.SS2.p5.2.m2.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="S4.SS2.p5.2.m2.2a"><mrow id="S4.SS2.p5.2.m2.2.3.2" xref="S4.SS2.p5.2.m2.2.3.1.cmml"><mo stretchy="false" id="S4.SS2.p5.2.m2.2.3.2.1" xref="S4.SS2.p5.2.m2.2.3.1.cmml">[</mo><mn id="S4.SS2.p5.2.m2.1.1" xref="S4.SS2.p5.2.m2.1.1.cmml">0</mn><mo id="S4.SS2.p5.2.m2.2.3.2.2" xref="S4.SS2.p5.2.m2.2.3.1.cmml">,</mo><mn id="S4.SS2.p5.2.m2.2.2" xref="S4.SS2.p5.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="S4.SS2.p5.2.m2.2.3.2.3" xref="S4.SS2.p5.2.m2.2.3.1.cmml">]</mo></mrow></semantics></math><span class="gd_word" id="S4.SS2.p5.7.4.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.4.w2">interval</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.4.w3">by</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.4.w4">replacing</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.4.w5">it</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.4.w6">with</span><span> </span><math id="S4.SS2.p5.3.m3.2" class="ltx_Math" alttext="\frac{Q(s,a)-\min Q}{\max Q-\min Q}" display="inline"><semantics id="S4.SS2.p5.3.m3.2a"><mfrac id="S4.SS2.p5.3.m3.2.2" xref="S4.SS2.p5.3.m3.2.2.cmml"><mrow id="S4.SS2.p5.3.m3.2.2.2" xref="S4.SS2.p5.3.m3.2.2.2.cmml"><mrow id="S4.SS2.p5.3.m3.2.2.2.4" xref="S4.SS2.p5.3.m3.2.2.2.4.cmml"><mi id="S4.SS2.p5.3.m3.2.2.2.4.2" xref="S4.SS2.p5.3.m3.2.2.2.4.2.cmml">Q</mi><mo id="S4.SS2.p5.3.m3.2.2.2.4.1" xref="S4.SS2.p5.3.m3.2.2.2.4.1.cmml">⁢</mo><mrow id="S4.SS2.p5.3.m3.2.2.2.4.3.2" xref="S4.SS2.p5.3.m3.2.2.2.4.3.1.cmml"><mo stretchy="false" id="S4.SS2.p5.3.m3.2.2.2.4.3.2.1" xref="S4.SS2.p5.3.m3.2.2.2.4.3.1.cmml">(</mo><mi id="S4.SS2.p5.3.m3.1.1.1.1" xref="S4.SS2.p5.3.m3.1.1.1.1.cmml">s</mi><mo id="S4.SS2.p5.3.m3.2.2.2.4.3.2.2" xref="S4.SS2.p5.3.m3.2.2.2.4.3.1.cmml">,</mo><mi id="S4.SS2.p5.3.m3.2.2.2.2" xref="S4.SS2.p5.3.m3.2.2.2.2.cmml">a</mi><mo stretchy="false" id="S4.SS2.p5.3.m3.2.2.2.4.3.2.3" xref="S4.SS2.p5.3.m3.2.2.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.p5.3.m3.2.2.2.3" xref="S4.SS2.p5.3.m3.2.2.2.3.cmml">-</mo><mrow id="S4.SS2.p5.3.m3.2.2.2.5" xref="S4.SS2.p5.3.m3.2.2.2.5.cmml"><mi id="S4.SS2.p5.3.m3.2.2.2.5.1" xref="S4.SS2.p5.3.m3.2.2.2.5.1.cmml">min</mi><mo id="S4.SS2.p5.3.m3.2.2.2.5a" xref="S4.SS2.p5.3.m3.2.2.2.5.cmml">⁡</mo><mi id="S4.SS2.p5.3.m3.2.2.2.5.2" xref="S4.SS2.p5.3.m3.2.2.2.5.2.cmml">Q</mi></mrow></mrow><mrow id="S4.SS2.p5.3.m3.2.2.4" xref="S4.SS2.p5.3.m3.2.2.4.cmml"><mrow id="S4.SS2.p5.3.m3.2.2.4.2" xref="S4.SS2.p5.3.m3.2.2.4.2.cmml"><mi id="S4.SS2.p5.3.m3.2.2.4.2.1" xref="S4.SS2.p5.3.m3.2.2.4.2.1.cmml">max</mi><mo id="S4.SS2.p5.3.m3.2.2.4.2a" xref="S4.SS2.p5.3.m3.2.2.4.2.cmml">⁡</mo><mi id="S4.SS2.p5.3.m3.2.2.4.2.2" xref="S4.SS2.p5.3.m3.2.2.4.2.2.cmml">Q</mi></mrow><mo id="S4.SS2.p5.3.m3.2.2.4.1" xref="S4.SS2.p5.3.m3.2.2.4.1.cmml">-</mo><mrow id="S4.SS2.p5.3.m3.2.2.4.3" xref="S4.SS2.p5.3.m3.2.2.4.3.cmml"><mi id="S4.SS2.p5.3.m3.2.2.4.3.1" xref="S4.SS2.p5.3.m3.2.2.4.3.1.cmml">min</mi><mo id="S4.SS2.p5.3.m3.2.2.4.3a" xref="S4.SS2.p5.3.m3.2.2.4.3.cmml">⁡</mo><mi id="S4.SS2.p5.3.m3.2.2.4.3.2" xref="S4.SS2.p5.3.m3.2.2.4.3.2.cmml">Q</mi></mrow></mrow></mfrac></semantics></math><span class="gd_word" id="S4.SS2.p5.7.5.w1">,</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.5.w2">where</span><span> </span><math id="S4.SS2.p5.4.m4.1" class="ltx_Math" alttext="\min Q" display="inline"><semantics id="S4.SS2.p5.4.m4.1a"><mrow id="S4.SS2.p5.4.m4.1.1" xref="S4.SS2.p5.4.m4.1.1.cmml"><mi id="S4.SS2.p5.4.m4.1.1.1" xref="S4.SS2.p5.4.m4.1.1.1.cmml">min</mi><mo id="S4.SS2.p5.4.m4.1.1a" xref="S4.SS2.p5.4.m4.1.1.cmml">⁡</mo><mi id="S4.SS2.p5.4.m4.1.1.2" xref="S4.SS2.p5.4.m4.1.1.2.cmml">Q</mi></mrow></semantics></math><span class="gd_word" id="S4.SS2.p5.7.6.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.6.w2">and</span><span> </span><math id="S4.SS2.p5.5.m5.1" class="ltx_Math" alttext="\max Q" display="inline"><semantics id="S4.SS2.p5.5.m5.1a"><mrow id="S4.SS2.p5.5.m5.1.1" xref="S4.SS2.p5.5.m5.1.1.cmml"><mi id="S4.SS2.p5.5.m5.1.1.1" xref="S4.SS2.p5.5.m5.1.1.1.cmml">max</mi><mo id="S4.SS2.p5.5.m5.1.1a" xref="S4.SS2.p5.5.m5.1.1.cmml">⁡</mo><mi id="S4.SS2.p5.5.m5.1.1.2" xref="S4.SS2.p5.5.m5.1.1.2.cmml">Q</mi></mrow></semantics></math><span class="gd_word" id="S4.SS2.p5.7.7.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w2">correspond</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w3">to</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w4">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w5">minimum</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w6">and</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w7">maximum</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w8">value</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w9">observed</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w10">in</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w11">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w12">tree,</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w13">updated</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w14">online.
Second,</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w15">we</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w16">tune</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w17">the</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w18">logits</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.7.w19">temperature</span><span> </span><math id="S4.SS2.p5.6.m6.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS2.p5.6.m6.1a"><mi id="S4.SS2.p5.6.m6.1.1" xref="S4.SS2.p5.6.m6.1.1.cmml">τ</mi></semantics></math><span class="gd_word" id="S4.SS2.p5.7.8.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.8.w2">jointly</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.8.w3">with</span><span> </span><span class="gd_word" id="S4.SS2.p5.7.8.w4">the</span><span> </span><math id="S4.SS2.p5.7.m7.1" class="ltx_Math" alttext="c_{\text{puct}}" display="inline"><semantics id="S4.SS2.p5.7.m7.1a"><msub id="S4.SS2.p5.7.m7.1.1" xref="S4.SS2.p5.7.m7.1.1.cmml"><mi id="S4.SS2.p5.7.m7.1.1.2" xref="S4.SS2.p5.7.m7.1.1.2.cmml">c</mi><mi id="S4.SS2.p5.7.m7.1.1.3" xref="S4.SS2.p5.7.m7.1.1.3a.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="S4.SS2.p5.7.9.w1"/><span> </span><span class="gd_word" id="S4.SS2.p5.7.9.w2">hyper-parameter.</span></p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Reranking-based decoding</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S4.SS3.p1.1.1.w1">Value-driven</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w2">decoding</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w3">methods</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w4">are</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w5">well-suited</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w6">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w7">optimise</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w8">metrics</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w9">which</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w10">we</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w11">cannot</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w12">evaluate</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w13">at</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w14">test</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w15">time,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w16">such</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w17">as</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w18">privileged</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w19">metrics.
One</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w20">might</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w21">also</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w22">prefer</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w23">them</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w24">for</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w25">especially</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w26">expensive</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w27">unprivileged</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w28">metrics,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w29">e.g.</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w30">expert</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w31">human</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w32">evaluation.
For</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w33">tractable</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w34">unprivileged</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w35">metrics</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w36">though,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w37">we</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w38">can</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w39">directly</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w40">compute</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w41">the</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w42">scores</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w43">of</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w44">finished</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w45">candidate</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w46">sentences,</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w47">without</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w48">having</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w49">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w50">resort</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w51">to</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w52">approximation.
We</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w53">study</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w54">two</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w55">specific</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w56">decoding</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w57">mechanisms</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w58">that</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w59">take</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w60">advantage</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w61">of</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w62">this</span><span> </span><span class="gd_word" id="S4.SS3.p1.1.1.w63">option.</span></p>
</div>
<div id="S4.SS3.p2" class="ltx_para ltx_noindent">
<p id="S4.SS3.p2.2" class="ltx_p"><span class="gd_word" id="S4.SS3.p2.2.1.w1">Sampling</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w3">reranking</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w4">(S+R,</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w5">S+RV)</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w6">simply</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w7">consists</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w8">in</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w9">sampling</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w10">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w11">fixed</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w12">number</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w13">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w14">finished</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w15">candidate</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.1.w16">sentences</span><span> </span><math id="S4.SS3.p2.1.m1.3" class="ltx_Math" alttext="\hat{y}^{1},...,\hat{y}^{n}" display="inline"><semantics id="S4.SS3.p2.1.m1.3a"><mrow id="S4.SS3.p2.1.m1.3.3.2" xref="S4.SS3.p2.1.m1.3.3.3.cmml"><msup id="S4.SS3.p2.1.m1.2.2.1.1" xref="S4.SS3.p2.1.m1.2.2.1.1.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.2.2.1.1.2" xref="S4.SS3.p2.1.m1.2.2.1.1.2.cmml"><mi id="S4.SS3.p2.1.m1.2.2.1.1.2.2" xref="S4.SS3.p2.1.m1.2.2.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS3.p2.1.m1.2.2.1.1.2.1" xref="S4.SS3.p2.1.m1.2.2.1.1.2.1.cmml">^</mo></mover><mn id="S4.SS3.p2.1.m1.2.2.1.1.3" xref="S4.SS3.p2.1.m1.2.2.1.1.3.cmml">1</mn></msup><mo id="S4.SS3.p2.1.m1.3.3.2.3" xref="S4.SS3.p2.1.m1.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">…</mi><mo id="S4.SS3.p2.1.m1.3.3.2.4" xref="S4.SS3.p2.1.m1.3.3.3.cmml">,</mo><msup id="S4.SS3.p2.1.m1.3.3.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.cmml"><mover accent="true" id="S4.SS3.p2.1.m1.3.3.2.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.2.cmml"><mi id="S4.SS3.p2.1.m1.3.3.2.2.2.2" xref="S4.SS3.p2.1.m1.3.3.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS3.p2.1.m1.3.3.2.2.2.1" xref="S4.SS3.p2.1.m1.3.3.2.2.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.1.m1.3.3.2.2.3" xref="S4.SS3.p2.1.m1.3.3.2.2.3.cmml">n</mi></msup></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.2.2.w1"/><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w2">from</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w3">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w4">policy</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w5">(with</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w6">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w7">carefully</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w8">tuned</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w9">temperature</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w10">applied</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w11">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w12">its</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w13">logits),</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w14">scoring</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w15">all</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w16">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w17">them</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w18">and</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w19">picking</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w20">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w21">highest-performing</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.2.w22">one:</span><span> </span><math id="S4.SS3.p2.2.m2.2" class="ltx_Math" alttext="\mathrm{argmax}_{i=1}^{n}m(x,\hat{y}^{i})" display="inline"><semantics id="S4.SS3.p2.2.m2.2a"><mrow id="S4.SS3.p2.2.m2.2.2" xref="S4.SS3.p2.2.m2.2.2.cmml"><msubsup id="S4.SS3.p2.2.m2.2.2.3" xref="S4.SS3.p2.2.m2.2.2.3.cmml"><mi id="S4.SS3.p2.2.m2.2.2.3.2.2" xref="S4.SS3.p2.2.m2.2.2.3.2.2.cmml">argmax</mi><mrow id="S4.SS3.p2.2.m2.2.2.3.2.3" xref="S4.SS3.p2.2.m2.2.2.3.2.3.cmml"><mi id="S4.SS3.p2.2.m2.2.2.3.2.3.2" xref="S4.SS3.p2.2.m2.2.2.3.2.3.2.cmml">i</mi><mo id="S4.SS3.p2.2.m2.2.2.3.2.3.1" xref="S4.SS3.p2.2.m2.2.2.3.2.3.1.cmml">=</mo><mn id="S4.SS3.p2.2.m2.2.2.3.2.3.3" xref="S4.SS3.p2.2.m2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S4.SS3.p2.2.m2.2.2.3.3" xref="S4.SS3.p2.2.m2.2.2.3.3.cmml">n</mi></msubsup><mo id="S4.SS3.p2.2.m2.2.2.2" xref="S4.SS3.p2.2.m2.2.2.2.cmml">⁢</mo><mi id="S4.SS3.p2.2.m2.2.2.4" xref="S4.SS3.p2.2.m2.2.2.4.cmml">m</mi><mo id="S4.SS3.p2.2.m2.2.2.2a" xref="S4.SS3.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S4.SS3.p2.2.m2.2.2.1.1" xref="S4.SS3.p2.2.m2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p2.2.m2.2.2.1.1.2" xref="S4.SS3.p2.2.m2.2.2.1.2.cmml">(</mo><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">x</mi><mo id="S4.SS3.p2.2.m2.2.2.1.1.3" xref="S4.SS3.p2.2.m2.2.2.1.2.cmml">,</mo><msup id="S4.SS3.p2.2.m2.2.2.1.1.1" xref="S4.SS3.p2.2.m2.2.2.1.1.1.cmml"><mover accent="true" id="S4.SS3.p2.2.m2.2.2.1.1.1.2" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.cmml"><mi id="S4.SS3.p2.2.m2.2.2.1.1.1.2.2" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S4.SS3.p2.2.m2.2.2.1.1.1.2.1" xref="S4.SS3.p2.2.m2.2.2.1.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS3.p2.2.m2.2.2.1.1.1.3" xref="S4.SS3.p2.2.m2.2.2.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S4.SS3.p2.2.m2.2.2.1.1.4" xref="S4.SS3.p2.2.m2.2.2.1.2.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S4.SS3.p2.2.3.w1">.
To</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w2">measure</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w3">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w4">loss</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w5">of</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w6">performance</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w7">associated</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w8">with</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w9">using</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w10">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w11">value,</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w12">we</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w13">also</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w14">introduce</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w15">a</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w16">variant,</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w17">S+RV</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w18">that</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w19">ranks</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w20">candidates</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w21">according</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w22">to</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w23">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w24">value</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w25">(rather</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w26">than</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w27">the</span><span> </span><span class="gd_word" id="S4.SS3.p2.2.3.w28">score).</span></p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.5" class="ltx_p"><span class="gd_word" id="S4.SS3.p3.5.1.w1">MCTS</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w2">with</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w3">rollouts</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w4">(MCTS+Roll)</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w5">is</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w6">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w7">variant</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w8">of</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w9">V-MCTS</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w10">where</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w11">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w12">replace</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w13">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w14">value</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w15">approximation</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w16">for</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w17">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w18">given</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.1.w19">node</span><span> </span><math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.SS3.p3.5.2.w1"/><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w2">by</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w3">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w4">more</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w5">expensive</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w6">one</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w7">based</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w8">off</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w9">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w10">actual</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.2.w11">score.
From</span><span> </span><math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mi id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.SS3.p3.5.3.w1">,</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w2">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w3">perform</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w4">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w5">greedy</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w6">rollout</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w7">(w.r.t.</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w8">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.3.w9">policy</span><span> </span><math id="S4.SS3.p3.3.m3.1" class="ltx_Math" alttext="\pi" display="inline"><semantics id="S4.SS3.p3.3.m3.1a"><mi id="S4.SS3.p3.3.m3.1.1" xref="S4.SS3.p3.3.m3.1.1.cmml">π</mi></semantics></math><span class="gd_word" id="S4.SS3.p3.5.4.w1">)</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w2">until</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w3">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w4">arrive</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w5">at</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w6">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w7">terminal</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.4.w8">node</span><span> </span><math id="S4.SS3.p3.4.m4.1" class="ltx_Math" alttext="s_{T}" display="inline"><semantics id="S4.SS3.p3.4.m4.1a"><msub id="S4.SS3.p3.4.m4.1.1" xref="S4.SS3.p3.4.m4.1.1.cmml"><mi id="S4.SS3.p3.4.m4.1.1.2" xref="S4.SS3.p3.4.m4.1.1.2.cmml">s</mi><mi id="S4.SS3.p3.4.m4.1.1.3" xref="S4.SS3.p3.4.m4.1.1.3.cmml">T</mi></msub></semantics></math><span class="gd_word" id="S4.SS3.p3.5.5.w1">.
We</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w2">then</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w3">compute</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w4">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w5">score</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w6">with</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w7">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w8">finished</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w9">sample</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w10">and</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w11">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w12">source</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w13">as</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w14">inputs,</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w15">use</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w16">this</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w17">scalar</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w18">as</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w19">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w20">value</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w21">of</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.5.w22">node</span><span> </span><math id="S4.SS3.p3.5.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S4.SS3.p3.5.m5.1a"><mi id="S4.SS3.p3.5.m5.1.1" xref="S4.SS3.p3.5.m5.1.1.cmml">s</mi></semantics></math><span class="gd_word" id="S4.SS3.p3.5.6.w1">,</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w2">and</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w3">continue</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w4">as</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w5">in</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w6">V-MCTS.
Of</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w7">course</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w8">greedy</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w9">rollouts</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w10">are</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w11">expensive</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w12">in</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w13">MT,</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w14">so</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w15">this</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w16">method</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w17">is</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w18">not</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w19">directly</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w20">comparable</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w21">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w22">V-MCTS.
It</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w23">is</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w24">however</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w25">useful</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w26">as</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w27">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w28">proof</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w29">of</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w30">concept</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w31">which</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w32">enables</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w33">us</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w34">to</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w35">measure</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w36">how</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w37">much</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w38">performance</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w39">we</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w40">lose</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w41">by</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w42">relying</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w43">on</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w44">a</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w45">value</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w46">function</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w47">rather</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w48">than</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w49">directly</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w50">on</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w51">the</span><span> </span><span class="gd_word" id="S4.SS3.p3.5.6.w52">score.</span></p>
</div>
<figure id="S4.T2" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/S4_T2.png" alt="/static/img/2104.05336-gpt-4/S4_T2.png"/><figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 2: </span><span class="gd_word" id="S4.T2.2.w1">Decoding</span><span> </span><span class="gd_word" id="S4.T2.2.w2">algorithms</span><span> </span><span class="gd_word" id="S4.T2.2.w3">characteristics.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Training a value network</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.4" class="ltx_p"><span class="gd_word" id="S5.p1.4.1.w1">Several</span><span> </span><span class="gd_word" id="S5.p1.4.1.w2">of</span><span> </span><span class="gd_word" id="S5.p1.4.1.w3">the</span><span> </span><span class="gd_word" id="S5.p1.4.1.w4">algorithms</span><span> </span><span class="gd_word" id="S5.p1.4.1.w5">we</span><span> </span><span class="gd_word" id="S5.p1.4.1.w6">detail</span><span> </span><span class="gd_word" id="S5.p1.4.1.w7">in</span><span> </span><span class="gd_word" id="S5.p1.4.1.w8">Section </span><a href="#S4" title="4 Decoding algorithms ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S5.p1.4.2.w1"/><span> </span><span class="gd_word" id="S5.p1.4.2.w2">make</span><span> </span><span class="gd_word" id="S5.p1.4.2.w3">use</span><span> </span><span class="gd_word" id="S5.p1.4.2.w4">of</span><span> </span><span class="gd_word" id="S5.p1.4.2.w5">a</span><span> </span><span class="gd_word" id="S5.p1.4.2.w6">value</span><span> </span><span class="gd_word" id="S5.p1.4.2.w7">network.
We</span><span> </span><span class="gd_word" id="S5.p1.4.2.w8">train</span><span> </span><span class="gd_word" id="S5.p1.4.2.w9">such</span><span> </span><span class="gd_word" id="S5.p1.4.2.w10">models</span><span> </span><span class="gd_word" id="S5.p1.4.2.w11">in</span><span> </span><span class="gd_word" id="S5.p1.4.2.w12">several</span><span> </span><span class="gd_word" id="S5.p1.4.2.w13">steps.</span></p>
<ul id="S5.I1" class="ltx_itemize">
<li id="S5.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i1.p1" class="ltx_para">
<p id="S5.I1.i1.p1.1" class="ltx_p"><span class="gd_word" id="S5.I1.i1.p1.1.1.w1">First,</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w2">we</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w3">train</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w4">a</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w5">plain</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w6">supervised</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w7">policy</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.1.w8">model</span><span> </span><math id="S5.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\pi_{\text{sup}}" display="inline"><semantics id="S5.I1.i1.p1.1.m1.1a"><msub id="S5.I1.i1.p1.1.m1.1.1" xref="S5.I1.i1.p1.1.m1.1.1.cmml"><mi id="S5.I1.i1.p1.1.m1.1.1.2" xref="S5.I1.i1.p1.1.m1.1.1.2.cmml">π</mi><mi id="S5.I1.i1.p1.1.m1.1.1.3" xref="S5.I1.i1.p1.1.m1.1.1.3a.cmml">sup</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i1.p1.1.2.w1"/><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.2.w2">on</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.2.w3">our</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.2.w4">bilingual</span><span> </span><span class="gd_word" id="S5.I1.i1.p1.1.2.w5">datasets.</span></p>
</div>
</li>
<li id="S5.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i2.p1" class="ltx_para">
<p id="S5.I1.i2.p1.11" class="ltx_p"><span class="gd_word" id="S5.I1.i2.p1.11.1.w1">Second,</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.1.w2">we</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.1.w3">update</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.1.w4">each</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.1.w5">data</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.1.w6">item</span><span> </span><math id="S5.I1.i2.p1.1.m1.2" class="ltx_Math" alttext="(x,y_{x})" display="inline"><semantics id="S5.I1.i2.p1.1.m1.2a"><mrow id="S5.I1.i2.p1.1.m1.2.2.1" xref="S5.I1.i2.p1.1.m1.2.2.2.cmml"><mo stretchy="false" id="S5.I1.i2.p1.1.m1.2.2.1.2" xref="S5.I1.i2.p1.1.m1.2.2.2.cmml">(</mo><mi id="S5.I1.i2.p1.1.m1.1.1" xref="S5.I1.i2.p1.1.m1.1.1.cmml">x</mi><mo id="S5.I1.i2.p1.1.m1.2.2.1.3" xref="S5.I1.i2.p1.1.m1.2.2.2.cmml">,</mo><msub id="S5.I1.i2.p1.1.m1.2.2.1.1" xref="S5.I1.i2.p1.1.m1.2.2.1.1.cmml"><mi id="S5.I1.i2.p1.1.m1.2.2.1.1.2" xref="S5.I1.i2.p1.1.m1.2.2.1.1.2.cmml">y</mi><mi id="S5.I1.i2.p1.1.m1.2.2.1.1.3" xref="S5.I1.i2.p1.1.m1.2.2.1.1.3.cmml">x</mi></msub><mo stretchy="false" id="S5.I1.i2.p1.1.m1.2.2.1.4" xref="S5.I1.i2.p1.1.m1.2.2.2.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.2.w1">,</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.2.w2">which</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.2.w3">contains</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.2.w4">a</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.2.w5">source</span><span> </span><math id="S5.I1.i2.p1.2.m2.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.I1.i2.p1.2.m2.1a"><mi id="S5.I1.i2.p1.2.m2.1.1" xref="S5.I1.i2.p1.2.m2.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.3.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.3.w2">and</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.3.w3">a</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.3.w4">reference</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.3.w5">sentence</span><span> </span><math id="S5.I1.i2.p1.3.m3.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.I1.i2.p1.3.m3.1a"><msub id="S5.I1.i2.p1.3.m3.1.1" xref="S5.I1.i2.p1.3.m3.1.1.cmml"><mi id="S5.I1.i2.p1.3.m3.1.1.2" xref="S5.I1.i2.p1.3.m3.1.1.2.cmml">y</mi><mi id="S5.I1.i2.p1.3.m3.1.1.3" xref="S5.I1.i2.p1.3.m3.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.4.w1">,</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.4.w2">by</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.4.w3">replacing</span><span> </span><math id="S5.I1.i2.p1.4.m4.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.I1.i2.p1.4.m4.1a"><msub id="S5.I1.i2.p1.4.m4.1.1" xref="S5.I1.i2.p1.4.m4.1.1.cmml"><mi id="S5.I1.i2.p1.4.m4.1.1.2" xref="S5.I1.i2.p1.4.m4.1.1.2.cmml">y</mi><mi id="S5.I1.i2.p1.4.m4.1.1.3" xref="S5.I1.i2.p1.4.m4.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.5.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.5.w2">with</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.5.w3">a</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.5.w4">sample</span><span> </span><math id="S5.I1.i2.p1.5.m5.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.I1.i2.p1.5.m5.1a"><msub id="S5.I1.i2.p1.5.m5.1.1" xref="S5.I1.i2.p1.5.m5.1.1.cmml"><mover accent="true" id="S5.I1.i2.p1.5.m5.1.1.2" xref="S5.I1.i2.p1.5.m5.1.1.2.cmml"><mi id="S5.I1.i2.p1.5.m5.1.1.2.2" xref="S5.I1.i2.p1.5.m5.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.I1.i2.p1.5.m5.1.1.2.1" xref="S5.I1.i2.p1.5.m5.1.1.2.1.cmml">^</mo></mover><mi id="S5.I1.i2.p1.5.m5.1.1.3" xref="S5.I1.i2.p1.5.m5.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.6.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.6.w2">obtained</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.6.w3">via</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.6.w4">greedy</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.6.w5">decoding</span><span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="gd_word" id="footnote3.3.w1">We</span><span> </span><span class="gd_word" id="footnote3.3.w2">also</span><span> </span><span class="gd_word" id="footnote3.3.w3">tried</span><span> </span><span class="gd_word" id="footnote3.3.w4">sampling</span><span> </span><span class="gd_word" id="footnote3.3.w5">one</span><span> </span><span class="gd_word" id="footnote3.3.w6">or</span><span> </span><span class="gd_word" id="footnote3.3.w7">more</span><span> </span><span class="gd_word" id="footnote3.3.w8">sentences</span><span> </span><span class="gd_word" id="footnote3.3.w9">instead,</span><span> </span><span class="gd_word" id="footnote3.3.w10">but</span><span> </span><span class="gd_word" id="footnote3.3.w11">did</span><span> </span><span class="gd_word" id="footnote3.3.w12">not</span><span> </span><span class="gd_word" id="footnote3.3.w13">detect</span><span> </span><span class="gd_word" id="footnote3.3.w14">any</span><span> </span><span class="gd_word" id="footnote3.3.w15">improvements</span><span> </span><span class="gd_word" id="footnote3.3.w16">from</span><span> </span><span class="gd_word" id="footnote3.3.w17">doing</span><span> </span><span class="gd_word" id="footnote3.3.w18">so.</span></span></span></span><span class="gd_word" id="S5.I1.i2.p1.11.7.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.7.w2">from</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.7.w3">our</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.7.w4">trained</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.7.w5">policy</span><span> </span><math id="S5.I1.i2.p1.6.m6.1" class="ltx_Math" alttext="\pi_{\text{sup}}" display="inline"><semantics id="S5.I1.i2.p1.6.m6.1a"><msub id="S5.I1.i2.p1.6.m6.1.1" xref="S5.I1.i2.p1.6.m6.1.1.cmml"><mi id="S5.I1.i2.p1.6.m6.1.1.2" xref="S5.I1.i2.p1.6.m6.1.1.2.cmml">π</mi><mi id="S5.I1.i2.p1.6.m6.1.1.3" xref="S5.I1.i2.p1.6.m6.1.1.3a.cmml">sup</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.8.w1">,</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.8.w2">and</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.8.w3">adding</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.8.w4">a</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.8.w5">score</span><span> </span><math id="S5.I1.i2.p1.7.m7.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S5.I1.i2.p1.7.m7.1a"><mi id="S5.I1.i2.p1.7.m7.1.1" xref="S5.I1.i2.p1.7.m7.1.1.cmml">m</mi></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.9.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.9.w2">comparing</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.9.w3">either</span><span> </span><math id="S5.I1.i2.p1.8.m8.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.I1.i2.p1.8.m8.1a"><msub id="S5.I1.i2.p1.8.m8.1.1" xref="S5.I1.i2.p1.8.m8.1.1.cmml"><mover accent="true" id="S5.I1.i2.p1.8.m8.1.1.2" xref="S5.I1.i2.p1.8.m8.1.1.2.cmml"><mi id="S5.I1.i2.p1.8.m8.1.1.2.2" xref="S5.I1.i2.p1.8.m8.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.I1.i2.p1.8.m8.1.1.2.1" xref="S5.I1.i2.p1.8.m8.1.1.2.1.cmml">^</mo></mover><mi id="S5.I1.i2.p1.8.m8.1.1.3" xref="S5.I1.i2.p1.8.m8.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.10.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.10.w2">to</span><span> </span><math id="S5.I1.i2.p1.9.m9.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.I1.i2.p1.9.m9.1a"><msub id="S5.I1.i2.p1.9.m9.1.1" xref="S5.I1.i2.p1.9.m9.1.1.cmml"><mi id="S5.I1.i2.p1.9.m9.1.1.2" xref="S5.I1.i2.p1.9.m9.1.1.2.cmml">y</mi><mi id="S5.I1.i2.p1.9.m9.1.1.3" xref="S5.I1.i2.p1.9.m9.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.11.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.11.w2">(for</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.11.w3">privileged</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.11.w4">metrics)</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.11.w5">or</span><span> </span><math id="S5.I1.i2.p1.10.m10.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.I1.i2.p1.10.m10.1a"><msub id="S5.I1.i2.p1.10.m10.1.1" xref="S5.I1.i2.p1.10.m10.1.1.cmml"><mover accent="true" id="S5.I1.i2.p1.10.m10.1.1.2" xref="S5.I1.i2.p1.10.m10.1.1.2.cmml"><mi id="S5.I1.i2.p1.10.m10.1.1.2.2" xref="S5.I1.i2.p1.10.m10.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.I1.i2.p1.10.m10.1.1.2.1" xref="S5.I1.i2.p1.10.m10.1.1.2.1.cmml">^</mo></mover><mi id="S5.I1.i2.p1.10.m10.1.1.3" xref="S5.I1.i2.p1.10.m10.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.12.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.12.w2">to</span><span> </span><math id="S5.I1.i2.p1.11.m11.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.I1.i2.p1.11.m11.1a"><mi id="S5.I1.i2.p1.11.m11.1.1" xref="S5.I1.i2.p1.11.m11.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.I1.i2.p1.11.13.w1"/><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.13.w2">(for</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.13.w3">unprivileged</span><span> </span><span class="gd_word" id="S5.I1.i2.p1.11.13.w4">metrics).
</span></p>
</div>
</li>
<li id="S5.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S5.I1.i3.p1" class="ltx_para">
<p id="S5.I1.i3.p1.4" class="ltx_p"><span class="gd_word" id="S5.I1.i3.p1.4.1.w1">Finally,</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w2">we</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w3">train</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w4">a</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w5">dual-headed</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w6">network</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w7">on</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w8">the</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w9">augmented</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w10">dataset,</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w11">with</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w12">a</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w13">shared</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w14">transformer</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w15">encoder-decoder</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.1.w16">torso </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S5.I1.i3.p1.4.2.w1"/><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.2.w2">taking</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.2.w3">source</span><span> </span><math id="S5.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.I1.i3.p1.1.m1.1a"><mi id="S5.I1.i3.p1.1.m1.1.1" xref="S5.I1.i3.p1.1.m1.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.I1.i3.p1.4.3.w1"/><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.3.w2">and</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.3.w3">sample</span><span> </span><math id="S5.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.I1.i3.p1.2.m2.1a"><msub id="S5.I1.i3.p1.2.m2.1.1" xref="S5.I1.i3.p1.2.m2.1.1.cmml"><mover accent="true" id="S5.I1.i3.p1.2.m2.1.1.2" xref="S5.I1.i3.p1.2.m2.1.1.2.cmml"><mi id="S5.I1.i3.p1.2.m2.1.1.2.2" xref="S5.I1.i3.p1.2.m2.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.I1.i3.p1.2.m2.1.1.2.1" xref="S5.I1.i3.p1.2.m2.1.1.2.1.cmml">^</mo></mover><mi id="S5.I1.i3.p1.2.m2.1.1.3" xref="S5.I1.i3.p1.2.m2.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i3.p1.4.4.w1"/><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w2">as</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w3">inputs,</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w4">and</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w5">two</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w6">heads,</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w7">one</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w8">predicting</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w9">the</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.4.w10">policy</span><span> </span><math id="S5.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="\pi_{d}" display="inline"><semantics id="S5.I1.i3.p1.3.m3.1a"><msub id="S5.I1.i3.p1.3.m3.1.1" xref="S5.I1.i3.p1.3.m3.1.1.cmml"><mi id="S5.I1.i3.p1.3.m3.1.1.2" xref="S5.I1.i3.p1.3.m3.1.1.2.cmml">π</mi><mi id="S5.I1.i3.p1.3.m3.1.1.3" xref="S5.I1.i3.p1.3.m3.1.1.3.cmml">d</mi></msub></semantics></math><span class="gd_word" id="S5.I1.i3.p1.4.5.w1"/><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.5.w2">and</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.5.w3">the</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.5.w4">other</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.5.w5">the</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.5.w6">value</span><span> </span><math id="S5.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="v" display="inline"><semantics id="S5.I1.i3.p1.4.m4.1a"><mi id="S5.I1.i3.p1.4.m4.1.1" xref="S5.I1.i3.p1.4.m4.1.1.cmml">v</mi></semantics></math><span class="gd_word" id="S5.I1.i3.p1.4.6.w1">.</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w2">This</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w3">approach</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w4">provides</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w5">a</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w6">powerful</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w7">regulariser</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w8">for</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w9">the</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w10">value,</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w11">greatly</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w12">reducing</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w13">its</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w14">tendency</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w15">to</span><span> </span><span class="gd_word" id="S5.I1.i3.p1.4.6.w16">overfitting </span><cite class="ltx_cite ltx_citemacro_citep">(Silver et al., <a href="#bib.bib35" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S5.I1.i3.p1.4.7.w1">.</span></p>
</div>
</li>
</ul>
<p id="S5.p1.3" class="ltx_p"><span class="gd_word" id="S5.p1.3.1.w1">The</span><span> </span><span class="gd_word" id="S5.p1.3.1.w2">second</span><span> </span><span class="gd_word" id="S5.p1.3.1.w3">step</span><span> </span><span class="gd_word" id="S5.p1.3.1.w4">is</span><span> </span><span class="gd_word" id="S5.p1.3.1.w5">mandatory</span><span> </span><span class="gd_word" id="S5.p1.3.1.w6">to</span><span> </span><span class="gd_word" id="S5.p1.3.1.w7">obtain</span><span> </span><span class="gd_word" id="S5.p1.3.1.w8">a</span><span> </span><span class="gd_word" id="S5.p1.3.1.w9">score</span><span> </span><span class="gd_word" id="S5.p1.3.1.w10">distribution</span><span> </span><span class="gd_word" id="S5.p1.3.1.w11">to</span><span> </span><span class="gd_word" id="S5.p1.3.1.w12">train</span><span> </span><span class="gd_word" id="S5.p1.3.1.w13">the</span><span> </span><span class="gd_word" id="S5.p1.3.1.w14">value</span><span> </span><span class="gd_word" id="S5.p1.3.1.w15">model</span><span> </span><span class="gd_word" id="S5.p1.3.1.w16">on,</span><span> </span><span class="gd_word" id="S5.p1.3.1.w17">in</span><span> </span><span class="gd_word" id="S5.p1.3.1.w18">the</span><span> </span><span class="gd_word" id="S5.p1.3.1.w19">case</span><span> </span><span class="gd_word" id="S5.p1.3.1.w20">of</span><span> </span><span class="gd_word" id="S5.p1.3.1.w21">privileged</span><span> </span><span class="gd_word" id="S5.p1.3.1.w22">metrics.
Indeed,</span><span> </span><span class="gd_word" id="S5.p1.3.1.w23">the</span><span> </span><span class="gd_word" id="S5.p1.3.1.w24">scores</span><span> </span><span class="gd_word" id="S5.p1.3.1.w25">of</span><span> </span><span class="gd_word" id="S5.p1.3.1.w26">the</span><span> </span><span class="gd_word" id="S5.p1.3.1.w27">optimal</span><span> </span><span class="gd_word" id="S5.p1.3.1.w28">supervised</span><span> </span><span class="gd_word" id="S5.p1.3.1.w29">policy</span><span> </span><span class="gd_word" id="S5.p1.3.1.w30">are</span><span> </span><span class="gd_word" id="S5.p1.3.1.w31">all</span><span> </span><span class="gd_word" id="S5.p1.3.1.w32">perfect</span><span> </span><span class="gd_word" id="S5.p1.3.1.w33">(comparing</span><span> </span><math id="S5.p1.1.m1.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">y</mi><mi id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p1.3.2.w1"/><span> </span><span class="gd_word" id="S5.p1.3.2.w2">to</span><span> </span><math id="S5.p1.2.m2.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.p1.2.m2.1a"><msub id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi id="S5.p1.2.m2.1.1.2" xref="S5.p1.2.m2.1.1.2.cmml">y</mi><mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p1.3.3.w1">),</span><span> </span><span class="gd_word" id="S5.p1.3.3.w2">thus</span><span> </span><span class="gd_word" id="S5.p1.3.3.w3">uninformative,</span><span> </span><span class="gd_word" id="S5.p1.3.3.w4">making</span><span> </span><span class="gd_word" id="S5.p1.3.3.w5">it</span><span> </span><span class="gd_word" id="S5.p1.3.3.w6">impossible</span><span> </span><span class="gd_word" id="S5.p1.3.3.w7">to</span><span> </span><span class="gd_word" id="S5.p1.3.3.w8">train</span><span> </span><span class="gd_word" id="S5.p1.3.3.w9">a</span><span> </span><span class="gd_word" id="S5.p1.3.3.w10">value</span><span> </span><span class="gd_word" id="S5.p1.3.3.w11">network</span><span> </span><span class="gd_word" id="S5.p1.3.3.w12">on.
Relying</span><span> </span><span class="gd_word" id="S5.p1.3.3.w13">on</span><span> </span><span class="gd_word" id="S5.p1.3.3.w14">a</span><span> </span><span class="gd_word" id="S5.p1.3.3.w15">sample</span><span> </span><span class="gd_word" id="S5.p1.3.3.w16">rather</span><span> </span><span class="gd_word" id="S5.p1.3.3.w17">than</span><span> </span><span class="gd_word" id="S5.p1.3.3.w18">on</span><span> </span><span class="gd_word" id="S5.p1.3.3.w19">the</span><span> </span><span class="gd_word" id="S5.p1.3.3.w20">ground</span><span> </span><span class="gd_word" id="S5.p1.3.3.w21">truth</span><span> </span><span class="gd_word" id="S5.p1.3.3.w22">sentence</span><span> </span><span class="gd_word" id="S5.p1.3.3.w23">to</span><span> </span><span class="gd_word" id="S5.p1.3.3.w24">compute</span><span> </span><span class="gd_word" id="S5.p1.3.3.w25">the</span><span> </span><span class="gd_word" id="S5.p1.3.3.w26">score</span><span> </span><span class="gd_word" id="S5.p1.3.3.w27">has</span><span> </span><span class="gd_word" id="S5.p1.3.3.w28">another</span><span> </span><span class="gd_word" id="S5.p1.3.3.w29">advantage:</span><span> </span><span class="gd_word" id="S5.p1.3.3.w30">the</span><span> </span><span class="gd_word" id="S5.p1.3.3.w31">samples</span><span> </span><span class="gd_word" id="S5.p1.3.3.w32">follow</span><span> </span><span class="gd_word" id="S5.p1.3.3.w33">the</span><span> </span><span class="gd_word" id="S5.p1.3.3.w34">policy</span><span> </span><math id="S5.p1.3.m3.1" class="ltx_Math" alttext="\pi_{\text{sup}}" display="inline"><semantics id="S5.p1.3.m3.1a"><msub id="S5.p1.3.m3.1.1" xref="S5.p1.3.m3.1.1.cmml"><mi id="S5.p1.3.m3.1.1.2" xref="S5.p1.3.m3.1.1.2.cmml">π</mi><mi id="S5.p1.3.m3.1.1.3" xref="S5.p1.3.m3.1.1.3a.cmml">sup</mi></msub></semantics></math><span class="gd_word" id="S5.p1.3.4.w1"/><span> </span><span class="gd_word" id="S5.p1.3.4.w2">so</span><span> </span><span class="gd_word" id="S5.p1.3.4.w3">the</span><span> </span><span class="gd_word" id="S5.p1.3.4.w4">value</span><span> </span><span class="gd_word" id="S5.p1.3.4.w5">will</span><span> </span><span class="gd_word" id="S5.p1.3.4.w6">be</span><span> </span><span class="gd_word" id="S5.p1.3.4.w7">the</span><span> </span><span class="gd_word" id="S5.p1.3.4.w8">one</span><span> </span><span class="gd_word" id="S5.p1.3.4.w9">associated</span><span> </span><span class="gd_word" id="S5.p1.3.4.w10">with</span><span> </span><span class="gd_word" id="S5.p1.3.4.w11">a</span><span> </span><span class="gd_word" id="S5.p1.3.4.w12">trained</span><span> </span><span class="gd_word" id="S5.p1.3.4.w13">policy,</span><span> </span><span class="gd_word" id="S5.p1.3.4.w14">as</span><span> </span><span class="gd_word" id="S5.p1.3.4.w15">the</span><span> </span><span class="gd_word" id="S5.p1.3.4.w16">one</span><span> </span><span class="gd_word" id="S5.p1.3.4.w17">we</span><span> </span><span class="gd_word" id="S5.p1.3.4.w18">use</span><span> </span><span class="gd_word" id="S5.p1.3.4.w19">during</span><span> </span><span class="gd_word" id="S5.p1.3.4.w20">decoding,</span><span> </span><span class="gd_word" id="S5.p1.3.4.w21">rather</span><span> </span><span class="gd_word" id="S5.p1.3.4.w22">than</span><span> </span><span class="gd_word" id="S5.p1.3.4.w23">with</span><span> </span><span class="gd_word" id="S5.p1.3.4.w24">the</span><span> </span><span class="gd_word" id="S5.p1.3.4.w25">optimal</span><span> </span><span class="gd_word" id="S5.p1.3.4.w26">supervised</span><span> </span><span class="gd_word" id="S5.p1.3.4.w27">policy.</span></p>
</div>
<div id="S5.p2" class="ltx_para ltx_noindent">
<p id="S5.p2.2" class="ltx_p"><span class="gd_word" id="S5.p2.2.1.w1">Losses.</span><span> </span><span class="gd_word" id="S5.p2.2.1.w2">We</span><span> </span><span class="gd_word" id="S5.p2.2.1.w3">train</span><span> </span><span class="gd_word" id="S5.p2.2.1.w4">the</span><span> </span><span class="gd_word" id="S5.p2.2.1.w5">policy</span><span> </span><span class="gd_word" id="S5.p2.2.1.w6">by</span><span> </span><span class="gd_word" id="S5.p2.2.1.w7">minimising</span><span> </span><span class="gd_word" id="S5.p2.2.1.w8">its</span><span> </span><span class="gd_word" id="S5.p2.2.1.w9">Kullback-Leibler</span><span> </span><span class="gd_word" id="S5.p2.2.1.w10">divergence</span><span> </span><span class="gd_word" id="S5.p2.2.1.w11">with</span><span> </span><span class="gd_word" id="S5.p2.2.1.w12">the</span><span> </span><span class="gd_word" id="S5.p2.2.1.w13">initial</span><span> </span><span class="gd_word" id="S5.p2.2.1.w14">supervised</span><span> </span><span class="gd_word" id="S5.p2.2.1.w15">policy</span><span> </span><math id="S5.p2.1.m1.1" class="ltx_Math" alttext="\pi_{\text{sup}}" display="inline"><semantics id="S5.p2.1.m1.1a"><msub id="S5.p2.1.m1.1.1" xref="S5.p2.1.m1.1.1.cmml"><mi id="S5.p2.1.m1.1.1.2" xref="S5.p2.1.m1.1.1.2.cmml">π</mi><mi id="S5.p2.1.m1.1.1.3" xref="S5.p2.1.m1.1.1.3a.cmml">sup</mi></msub></semantics></math><span class="gd_word" id="S5.p2.2.2.w1">:</span><span> </span><math id="S5.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\pi}=D_{\text{KL}}(\pi||\pi_{\text{sup}})" display="inline"><semantics id="S5.p2.2.m2.1a"><mrow id="S5.p2.2.m2.1b"><msub id="S5.p2.2.m2.1.1" xref="S5.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p2.2.m2.1.1.2" xref="S5.p2.2.m2.1.1.2.cmml">ℒ</mi><mi id="S5.p2.2.m2.1.1.3" xref="S5.p2.2.m2.1.1.3.cmml">π</mi></msub><mo id="S5.p2.2.m2.1.2" xref="S5.p2.2.m2.1.2.cmml">=</mo><msub id="S5.p2.2.m2.1.3" xref="S5.p2.2.m2.1.3.cmml"><mi id="S5.p2.2.m2.1.3.2" xref="S5.p2.2.m2.1.3.2.cmml">D</mi><mi id="S5.p2.2.m2.1.3.3" xref="S5.p2.2.m2.1.3.3a.cmml">KL</mi></msub><mrow id="S5.p2.2.m2.1.4" xref="S5.p2.2.m2.1.4.cmml"><mo stretchy="false" id="S5.p2.2.m2.1.4.1" xref="S5.p2.2.m2.1.4.1.cmml">(</mo><mi id="S5.p2.2.m2.1.4.2" xref="S5.p2.2.m2.1.4.2.cmml">π</mi><mo stretchy="false" id="S5.p2.2.m2.1.4.3" xref="S5.p2.2.m2.1.4.3.cmml">|</mo><mo stretchy="false" id="S5.p2.2.m2.1.4.4" xref="S5.p2.2.m2.1.4.4.cmml">|</mo><msub id="S5.p2.2.m2.1.4.5" xref="S5.p2.2.m2.1.4.5.cmml"><mi id="S5.p2.2.m2.1.4.5.2" xref="S5.p2.2.m2.1.4.5.2.cmml">π</mi><mi id="S5.p2.2.m2.1.4.5.3" xref="S5.p2.2.m2.1.4.5.3a.cmml">sup</mi></msub><mo stretchy="false" id="S5.p2.2.m2.1.4.6" xref="S5.p2.2.m2.1.4.6.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="S5.p2.2.3.w1">.
We</span><span> </span><span class="gd_word" id="S5.p2.2.3.w2">reframe</span><span> </span><span class="gd_word" id="S5.p2.2.3.w3">the</span><span> </span><span class="gd_word" id="S5.p2.2.3.w4">value</span><span> </span><span class="gd_word" id="S5.p2.2.3.w5">regression</span><span> </span><span class="gd_word" id="S5.p2.2.3.w6">problem</span><span> </span><span class="gd_word" id="S5.p2.2.3.w7">as</span><span> </span><span class="gd_word" id="S5.p2.2.3.w8">classification</span><span> </span><span class="gd_word" id="S5.p2.2.3.w9">by</span><span> </span><span class="gd_word" id="S5.p2.2.3.w10">discretising</span><span> </span><span class="gd_word" id="S5.p2.2.3.w11">the</span><span> </span><span class="gd_word" id="S5.p2.2.3.w12">score</span><span> </span><span class="gd_word" id="S5.p2.2.3.w13">interval</span><span> </span><span class="gd_word" id="S5.p2.2.3.w14">into</span><span> </span><span class="gd_word" id="S5.p2.2.3.w15">buckets.
We</span><span> </span><span class="gd_word" id="S5.p2.2.3.w16">emulate</span><span> </span><span class="gd_word" id="S5.p2.2.3.w17">training</span><span> </span><span class="gd_word" id="S5.p2.2.3.w18">our</span><span> </span><span class="gd_word" id="S5.p2.2.3.w19">value</span><span> </span><span class="gd_word" id="S5.p2.2.3.w20">function</span><span> </span><span class="gd_word" id="S5.p2.2.3.w21">on</span><span> </span><span class="gd_word" id="S5.p2.2.3.w22">unfinished</span><span> </span><span class="gd_word" id="S5.p2.2.3.w23">samples</span><span> </span><span class="gd_word" id="S5.p2.2.3.w24">by</span><span> </span><span class="gd_word" id="S5.p2.2.3.w25">adding</span><span> </span><span class="gd_word" id="S5.p2.2.3.w26">a</span><span> </span><span class="gd_word" id="S5.p2.2.3.w27">value</span><span> </span><span class="gd_word" id="S5.p2.2.3.w28">loss</span><span> </span><span class="gd_word" id="S5.p2.2.3.w29">term</span><span> </span><span class="gd_word" id="S5.p2.2.3.w30">at</span><span> </span><span class="gd_word" id="S5.p2.2.3.w31">every</span><span> </span><span class="gd_word" id="S5.p2.2.3.w32">step,</span><span> </span><span class="gd_word" id="S5.p2.2.3.w33">and</span><span> </span><span class="gd_word" id="S5.p2.2.3.w34">reusing</span><span> </span><span class="gd_word" id="S5.p2.2.3.w35">the</span><span> </span><span class="gd_word" id="S5.p2.2.3.w36">transformer</span><span> </span><span class="gd_word" id="S5.p2.2.3.w37">decoder</span><span> </span><span class="gd_word" id="S5.p2.2.3.w38">causality</span><span> </span><span class="gd_word" id="S5.p2.2.3.w39">mask.
</span></p>
</div>
<div id="S5.p3" class="ltx_para ltx_noindent">
<p id="S5.p3.1" class="ltx_p"><span class="gd_word" id="S5.p3.1.1.w1">The</span><span> </span><span class="gd_word" id="S5.p3.1.1.w2">trouble</span><span> </span><span class="gd_word" id="S5.p3.1.1.w3">with</span><span> </span><span class="gd_word" id="S5.p3.1.1.w4">privileged</span><span> </span><span class="gd_word" id="S5.p3.1.1.w5">metrics.
In</span><span> </span><span class="gd_word" id="S5.p3.1.1.w6">practice,</span><span> </span><span class="gd_word" id="S5.p3.1.1.w7">we</span><span> </span><span class="gd_word" id="S5.p3.1.1.w8">find</span><span> </span><span class="gd_word" id="S5.p3.1.1.w9">that</span><span> </span><span class="gd_word" id="S5.p3.1.1.w10">learning</span><span> </span><span class="gd_word" id="S5.p3.1.1.w11">a</span><span> </span><span class="gd_word" id="S5.p3.1.1.w12">value</span><span> </span><span class="gd_word" id="S5.p3.1.1.w13">function</span><span> </span><span class="gd_word" id="S5.p3.1.1.w14">for</span><span> </span><span class="gd_word" id="S5.p3.1.1.w15">privileged</span><span> </span><span class="gd_word" id="S5.p3.1.1.w16">metrics</span><span> </span><span class="gd_word" id="S5.p3.1.1.w17">(such</span><span> </span><span class="gd_word" id="S5.p3.1.1.w18">as</span><span> </span><span class="gd_word" id="S5.p3.1.1.w19">BLEU</span><span> </span><span class="gd_word" id="S5.p3.1.1.w20">or</span><span> </span><span class="gd_word" id="S5.p3.1.1.w21">BERTScore)</span><span> </span><span class="gd_word" id="S5.p3.1.1.w22">is</span><span> </span><span class="gd_word" id="S5.p3.1.1.w23">difficult.
To</span><span> </span><span class="gd_word" id="S5.p3.1.1.w24">understand</span><span> </span><span class="gd_word" id="S5.p3.1.1.w25">why,</span><span> </span><span class="gd_word" id="S5.p3.1.1.w26">we</span><span> </span><span class="gd_word" id="S5.p3.1.1.w27">run</span><span> </span><span class="gd_word" id="S5.p3.1.1.w28">an</span><span> </span><span class="gd_word" id="S5.p3.1.1.w29">ablation</span><span> </span><span class="gd_word" id="S5.p3.1.1.w30">to</span><span> </span><span class="gd_word" id="S5.p3.1.1.w31">distinguish</span><span> </span><span class="gd_word" id="S5.p3.1.1.w32">between</span><span> </span><span class="gd_word" id="S5.p3.1.1.w33">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w34">three</span><span> </span><span class="gd_word" id="S5.p3.1.1.w35">subtasks</span><span> </span><span class="gd_word" id="S5.p3.1.1.w36">a</span><span> </span><span class="gd_word" id="S5.p3.1.1.w37">value</span><span> </span><span class="gd_word" id="S5.p3.1.1.w38">function</span><span> </span><span class="gd_word" id="S5.p3.1.1.w39">must</span><span> </span><span class="gd_word" id="S5.p3.1.1.w40">perform:</span><span> </span><span class="gd_word" id="S5.p3.1.1.w41">(i)</span><span> </span><span class="gd_word" id="S5.p3.1.1.w42">approximate</span><span> </span><span class="gd_word" id="S5.p3.1.1.w43">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w44">score,</span><span> </span><span class="gd_word" id="S5.p3.1.1.w45">(ii)</span><span> </span><span class="gd_word" id="S5.p3.1.1.w46">predict</span><span> </span><span class="gd_word" id="S5.p3.1.1.w47">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w48">end</span><span> </span><span class="gd_word" id="S5.p3.1.1.w49">of</span><span> </span><span class="gd_word" id="S5.p3.1.1.w50">a</span><span> </span><span class="gd_word" id="S5.p3.1.1.w51">trajectory</span><span> </span><span class="gd_word" id="S5.p3.1.1.w52">from</span><span> </span><span class="gd_word" id="S5.p3.1.1.w53">an</span><span> </span><span class="gd_word" id="S5.p3.1.1.w54">unfinished</span><span> </span><span class="gd_word" id="S5.p3.1.1.w55">prefix,</span><span> </span><span class="gd_word" id="S5.p3.1.1.w56">and</span><span> </span><span class="gd_word" id="S5.p3.1.1.w57">(iii)</span><span> </span><span class="gd_word" id="S5.p3.1.1.w58">assess</span><span> </span><span class="gd_word" id="S5.p3.1.1.w59">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w60">translation</span><span> </span><span class="gd_word" id="S5.p3.1.1.w61">quality</span><span> </span><span class="gd_word" id="S5.p3.1.1.w62">of</span><span> </span><span class="gd_word" id="S5.p3.1.1.w63">a</span><span> </span><span class="gd_word" id="S5.p3.1.1.w64">pair</span><span> </span><span class="gd_word" id="S5.p3.1.1.w65">of</span><span> </span><span class="gd_word" id="S5.p3.1.1.w66">finished</span><span> </span><span class="gd_word" id="S5.p3.1.1.w67">sentences</span><span> </span><span class="gd_word" id="S5.p3.1.1.w68">in</span><span> </span><span class="gd_word" id="S5.p3.1.1.w69">different</span><span> </span><span class="gd_word" id="S5.p3.1.1.w70">languages.
To</span><span> </span><span class="gd_word" id="S5.p3.1.1.w71">separate</span><span> </span><span class="gd_word" id="S5.p3.1.1.w72">concerns,</span><span> </span><span class="gd_word" id="S5.p3.1.1.w73">we</span><span> </span><span class="gd_word" id="S5.p3.1.1.w74">run</span><span> </span><span class="gd_word" id="S5.p3.1.1.w75">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w76">following</span><span> </span><span class="gd_word" id="S5.p3.1.1.w77">experiments:</span><span> </span><span class="gd_word" id="S5.p3.1.1.w78">for</span><span> </span><span class="gd_word" id="S5.p3.1.1.w79">(i),</span><span> </span><span class="gd_word" id="S5.p3.1.1.w80">we</span><span> </span><span class="gd_word" id="S5.p3.1.1.w81">train</span><span> </span><span class="gd_word" id="S5.p3.1.1.w82">our</span><span> </span><span class="gd_word" id="S5.p3.1.1.w83">network</span><span> </span><span class="gd_word" id="S5.p3.1.1.w84">to</span><span> </span><span class="gd_word" id="S5.p3.1.1.w85">predict</span><span> </span><span class="gd_word" id="S5.p3.1.1.w86">BLEU</span><span> </span><span class="gd_word" id="S5.p3.1.1.w87">given</span><span> </span><span class="gd_word" id="S5.p3.1.1.w88">ground</span><span> </span><span class="gd_word" id="S5.p3.1.1.w89">truth</span><span> </span><span class="gd_word" id="S5.p3.1.1.w90">targets</span><span> </span><span class="gd_word" id="S5.p3.1.1.w91">(rather</span><span> </span><span class="gd_word" id="S5.p3.1.1.w92">than</span><span> </span><span class="gd_word" id="S5.p3.1.1.w93">source</span><span> </span><span class="gd_word" id="S5.p3.1.1.w94">sentences)</span><span> </span><span class="gd_word" id="S5.p3.1.1.w95">and</span><span> </span><span class="gd_word" id="S5.p3.1.1.w96">finished</span><span> </span><span class="gd_word" id="S5.p3.1.1.w97">samples</span><span> </span><span class="gd_word" id="S5.p3.1.1.w98">(instead</span><span> </span><span class="gd_word" id="S5.p3.1.1.w99">of</span><span> </span><span class="gd_word" id="S5.p3.1.1.w100">prefixes).
For</span><span> </span><span class="gd_word" id="S5.p3.1.1.w101">(ii),</span><span> </span><span class="gd_word" id="S5.p3.1.1.w102">we</span><span> </span><span class="gd_word" id="S5.p3.1.1.w103">give</span><span> </span><span class="gd_word" id="S5.p3.1.1.w104">the</span><span> </span><span class="gd_word" id="S5.p3.1.1.w105">network</span><span> </span><span class="gd_word" id="S5.p3.1.1.w106">ground</span><span> </span><span class="gd_word" id="S5.p3.1.1.w107">truth</span><span> </span><span class="gd_word" id="S5.p3.1.1.w108">targets</span><span> </span><span class="gd_word" id="S5.p3.1.1.w109">and</span><span> </span><em id="S5.p3.1.2" class="ltx_emph ltx_font_italic">unfinished samples</em><span class="gd_word" id="S5.p3.1.2.w1">.
Finally,</span><span> </span><span class="gd_word" id="S5.p3.1.2.w2">for</span><span> </span><span class="gd_word" id="S5.p3.1.2.w3">(iii),</span><span> </span><span class="gd_word" id="S5.p3.1.2.w4">we</span><span> </span><span class="gd_word" id="S5.p3.1.2.w5">give</span><span> </span><span class="gd_word" id="S5.p3.1.2.w6">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w7">network</span><span> </span><span class="gd_word" id="S5.p3.1.2.w8">source</span><span> </span><span class="gd_word" id="S5.p3.1.2.w9">sentences</span><span> </span><span class="gd_word" id="S5.p3.1.2.w10">and</span><span> </span><span class="gd_word" id="S5.p3.1.2.w11">finished</span><span> </span><span class="gd_word" id="S5.p3.1.2.w12">samples</span><span> </span><span class="gd_word" id="S5.p3.1.2.w13">(thus</span><span> </span><span class="gd_word" id="S5.p3.1.2.w14">removing</span><span> </span><span class="gd_word" id="S5.p3.1.2.w15">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w16">need</span><span> </span><span class="gd_word" id="S5.p3.1.2.w17">to</span><span> </span><span class="gd_word" id="S5.p3.1.2.w18">predict</span><span> </span><span class="gd_word" id="S5.p3.1.2.w19">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w20">future</span><span> </span><span class="gd_word" id="S5.p3.1.2.w21">of</span><span> </span><span class="gd_word" id="S5.p3.1.2.w22">trajectories).
We</span><span> </span><span class="gd_word" id="S5.p3.1.2.w23">observe</span><span> </span><span class="gd_word" id="S5.p3.1.2.w24">that:</span><span> </span><span class="gd_word" id="S5.p3.1.2.w25">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w26">error</span><span> </span><span class="gd_word" id="S5.p3.1.2.w27">is</span><span> </span><span class="gd_word" id="S5.p3.1.2.w28">very</span><span> </span><span class="gd_word" id="S5.p3.1.2.w29">low</span><span> </span><span class="gd_word" id="S5.p3.1.2.w30">for</span><span> </span><span class="gd_word" id="S5.p3.1.2.w31">(i);</span><span> </span><span class="gd_word" id="S5.p3.1.2.w32">higher,</span><span> </span><span class="gd_word" id="S5.p3.1.2.w33">but</span><span> </span><span class="gd_word" id="S5.p3.1.2.w34">significantly</span><span> </span><span class="gd_word" id="S5.p3.1.2.w35">improved</span><span> </span><span class="gd_word" id="S5.p3.1.2.w36">over</span><span> </span><span class="gd_word" id="S5.p3.1.2.w37">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w38">full</span><span> </span><span class="gd_word" id="S5.p3.1.2.w39">setup</span><span> </span><span class="gd_word" id="S5.p3.1.2.w40">for</span><span> </span><span class="gd_word" id="S5.p3.1.2.w41">(ii);</span><span> </span><span class="gd_word" id="S5.p3.1.2.w42">and</span><span> </span><span class="gd_word" id="S5.p3.1.2.w43">surprisingly,</span><span> </span><span class="gd_word" id="S5.p3.1.2.w44">roughly</span><span> </span><span class="gd_word" id="S5.p3.1.2.w45">identical</span><span> </span><span class="gd_word" id="S5.p3.1.2.w46">to</span><span> </span><span class="gd_word" id="S5.p3.1.2.w47">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w48">full</span><span> </span><span class="gd_word" id="S5.p3.1.2.w49">setup</span><span> </span><span class="gd_word" id="S5.p3.1.2.w50">for</span><span> </span><span class="gd_word" id="S5.p3.1.2.w51">(iii).
Thus</span><span> </span><span class="gd_word" id="S5.p3.1.2.w52">the</span><span> </span><span class="gd_word" id="S5.p3.1.2.w53">real</span><span> </span><span class="gd_word" id="S5.p3.1.2.w54">difficulty</span><span> </span><span class="gd_word" id="S5.p3.1.2.w55">lies</span><span> </span><span class="gd_word" id="S5.p3.1.2.w56">in</span><span> </span><span class="gd_word" id="S5.p3.1.2.w57">(iii).</span></p>
</div>
<figure id="S5.T3" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/S5_T3.png" alt="/static/img/2104.05336-gpt-4/S5_T3.png"/><figcaption class="ltx_caption ltx_centering" style="font-size:80%;"><span class="ltx_tag ltx_tag_table">Table 3: </span><math id="S5.T3.3.m1.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S5.T3.3.m1.1b"><msub id="S5.T3.3.m1.1.1" xref="S5.T3.3.m1.1.1.cmml"><mi mathvariant="normal" id="S5.T3.3.m1.1.1.2" xref="S5.T3.3.m1.1.1.2.cmml">ℓ</mi><mn id="S5.T3.3.m1.1.1.3" xref="S5.T3.3.m1.1.1.3.cmml">1</mn></msub></semantics></math><span class="gd_word" id="S5.T3.3.w1"/><span> </span><span class="gd_word" id="S5.T3.3.w2">error</span><span> </span><span class="gd_word" id="S5.T3.3.w3">of</span><span> </span><span class="gd_word" id="S5.T3.3.w4">BLEU</span><span> </span><span class="gd_word" id="S5.T3.3.w5">value</span><span> </span><span class="gd_word" id="S5.T3.3.w6">networks</span><span> </span><span class="gd_word" id="S5.T3.3.w7">trained</span><span> </span><span class="gd_word" id="S5.T3.3.w8">on</span><span> </span><span class="gd_word" id="S5.T3.3.w9">different</span><span> </span><span class="gd_word" id="S5.T3.3.w10">encoder</span><span> </span><span class="gd_word" id="S5.T3.3.w11">inputs</span><span> </span><span class="gd_word" id="S5.T3.3.w12">and</span><span> </span><span class="gd_word" id="S5.T3.3.w13">outputs</span><span> </span><span class="gd_word" id="S5.T3.3.w14">on</span><span> </span><span class="gd_word" id="S5.T3.3.w15">our</span><span> </span><span class="gd_word" id="S5.T3.3.w16">sample</span><span> </span><span class="gd_word" id="S5.T3.3.w17">dataset</span><span> </span><span class="gd_word" id="S5.T3.3.w18">based</span><span> </span><span class="gd_word" id="S5.T3.3.w19">on</span><span> </span><span class="gd_word" id="S5.T3.3.w20">WMT14</span><span> </span><span class="gd_word" id="S5.T3.3.w21">ENDE.</span><span> </span><span class="gd_word" id="S5.T3.3.w22">Scores</span><span> </span><span class="gd_word" id="S5.T3.3.w23">(and</span><span> </span><span class="gd_word" id="S5.T3.3.w24">hence</span><span> </span><math id="S5.T3.4.m2.1" class="ltx_Math" alttext="\ell_{1}" display="inline"><semantics id="S5.T3.4.m2.1b"><msub id="S5.T3.4.m2.1.1" xref="S5.T3.4.m2.1.1.cmml"><mi mathvariant="normal" id="S5.T3.4.m2.1.1.2" xref="S5.T3.4.m2.1.1.2.cmml">ℓ</mi><mn id="S5.T3.4.m2.1.1.3" xref="S5.T3.4.m2.1.1.3.cmml">1</mn></msub></semantics></math><span class="gd_word" id="S5.T3.4.w1"/><span> </span><span class="gd_word" id="S5.T3.4.w2">error)</span><span> </span><span class="gd_word" id="S5.T3.4.w3">are</span><span> </span><span class="gd_word" id="S5.T3.4.w4">between</span><span> </span><span class="gd_word" id="S5.T3.4.w5">0</span><span> </span><span class="gd_word" id="S5.T3.4.w6">and</span><span> </span><span class="gd_word" id="S5.T3.4.w7">1.</span></figcaption>
</figure>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.8" class="ltx_p"><span class="gd_word" id="S5.p4.8.1.w1">One</span><span> </span><span class="gd_word" id="S5.p4.8.1.w2">possible</span><span> </span><span class="gd_word" id="S5.p4.8.1.w3">explanation</span><span> </span><span class="gd_word" id="S5.p4.8.1.w4">for</span><span> </span><span class="gd_word" id="S5.p4.8.1.w5">this</span><span> </span><span class="gd_word" id="S5.p4.8.1.w6">result</span><span> </span><span class="gd_word" id="S5.p4.8.1.w7">is</span><span> </span><span class="gd_word" id="S5.p4.8.1.w8">that</span><span> </span><span class="gd_word" id="S5.p4.8.1.w9">the</span><span> </span><span class="gd_word" id="S5.p4.8.1.w10">value</span><span> </span><span class="gd_word" id="S5.p4.8.1.w11">network</span><span> </span><span class="gd_word" id="S5.p4.8.1.w12">is</span><span> </span><span class="gd_word" id="S5.p4.8.1.w13">missing</span><span> </span><span class="gd_word" id="S5.p4.8.1.w14">a</span><span> </span><span class="gd_word" id="S5.p4.8.1.w15">key</span><span> </span><span class="gd_word" id="S5.p4.8.1.w16">input.
Indeed,</span><span> </span><span class="gd_word" id="S5.p4.8.1.w17">in</span><span> </span><span class="gd_word" id="S5.p4.8.1.w18">the</span><span> </span><span class="gd_word" id="S5.p4.8.1.w19">case</span><span> </span><span class="gd_word" id="S5.p4.8.1.w20">of</span><span> </span><span class="gd_word" id="S5.p4.8.1.w21">privileged</span><span> </span><span class="gd_word" id="S5.p4.8.1.w22">metrics,</span><span> </span><span class="gd_word" id="S5.p4.8.1.w23">the</span><span> </span><span class="gd_word" id="S5.p4.8.1.w24">score</span><span> </span><span class="gd_word" id="S5.p4.8.1.w25">is</span><span> </span><span class="gd_word" id="S5.p4.8.1.w26">computed</span><span> </span><span class="gd_word" id="S5.p4.8.1.w27">between</span><span> </span><span class="gd_word" id="S5.p4.8.1.w28">a</span><span> </span><span class="gd_word" id="S5.p4.8.1.w29">sample</span><span> </span><math id="S5.p4.1.m1.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.p4.1.m1.1a"><msub id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml"><mover accent="true" id="S5.p4.1.m1.1.1.2" xref="S5.p4.1.m1.1.1.2.cmml"><mi id="S5.p4.1.m1.1.1.2.2" xref="S5.p4.1.m1.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.p4.1.m1.1.1.2.1" xref="S5.p4.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S5.p4.1.m1.1.1.3" xref="S5.p4.1.m1.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p4.8.2.w1"/><span> </span><span class="gd_word" id="S5.p4.8.2.w2">and</span><span> </span><span class="gd_word" id="S5.p4.8.2.w3">a</span><span> </span><span class="gd_word" id="S5.p4.8.2.w4">ground</span><span> </span><span class="gd_word" id="S5.p4.8.2.w5">truth</span><span> </span><span class="gd_word" id="S5.p4.8.2.w6">reference</span><span> </span><math id="S5.p4.2.m2.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.p4.2.m2.1a"><msub id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml"><mi id="S5.p4.2.m2.1.1.2" xref="S5.p4.2.m2.1.1.2.cmml">y</mi><mi id="S5.p4.2.m2.1.1.3" xref="S5.p4.2.m2.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p4.8.3.w1">;</span><span> </span><span class="gd_word" id="S5.p4.8.3.w2">but</span><span> </span><span class="gd_word" id="S5.p4.8.3.w3">the</span><span> </span><span class="gd_word" id="S5.p4.8.3.w4">value</span><span> </span><span class="gd_word" id="S5.p4.8.3.w5">network</span><span> </span><span class="gd_word" id="S5.p4.8.3.w6">only</span><span> </span><span class="gd_word" id="S5.p4.8.3.w7">has</span><span> </span><span class="gd_word" id="S5.p4.8.3.w8">access</span><span> </span><span class="gd_word" id="S5.p4.8.3.w9">to</span><span> </span><span class="gd_word" id="S5.p4.8.3.w10">the</span><span> </span><span class="gd_word" id="S5.p4.8.3.w11">source</span><span> </span><span class="gd_word" id="S5.p4.8.3.w12">sentence</span><span> </span><math id="S5.p4.3.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.p4.3.m3.1a"><mi id="S5.p4.3.m3.1.1" xref="S5.p4.3.m3.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.p4.8.4.w1"/><span> </span><span class="gd_word" id="S5.p4.8.4.w2">and</span><span> </span><span class="gd_word" id="S5.p4.8.4.w3">a</span><span> </span><span class="gd_word" id="S5.p4.8.4.w4">prefix</span><span> </span><span class="gd_word" id="S5.p4.8.4.w5">of</span><span> </span><math id="S5.p4.4.m4.1" class="ltx_Math" alttext="\hat{y}_{x}" display="inline"><semantics id="S5.p4.4.m4.1a"><msub id="S5.p4.4.m4.1.1" xref="S5.p4.4.m4.1.1.cmml"><mover accent="true" id="S5.p4.4.m4.1.1.2" xref="S5.p4.4.m4.1.1.2.cmml"><mi id="S5.p4.4.m4.1.1.2.2" xref="S5.p4.4.m4.1.1.2.2.cmml">y</mi><mo stretchy="false" id="S5.p4.4.m4.1.1.2.1" xref="S5.p4.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S5.p4.4.m4.1.1.3" xref="S5.p4.4.m4.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p4.8.5.w1">.
Thus</span><span> </span><span class="gd_word" id="S5.p4.8.5.w2">before</span><span> </span><span class="gd_word" id="S5.p4.8.5.w3">it</span><span> </span><span class="gd_word" id="S5.p4.8.5.w4">can</span><span> </span><span class="gd_word" id="S5.p4.8.5.w5">compute</span><span> </span><span class="gd_word" id="S5.p4.8.5.w6">a</span><span> </span><span class="gd_word" id="S5.p4.8.5.w7">precise</span><span> </span><span class="gd_word" id="S5.p4.8.5.w8">score</span><span> </span><span class="gd_word" id="S5.p4.8.5.w9">approximation,</span><span> </span><span class="gd_word" id="S5.p4.8.5.w10">it</span><span> </span><span class="gd_word" id="S5.p4.8.5.w11">first</span><span> </span><span class="gd_word" id="S5.p4.8.5.w12">has</span><span> </span><span class="gd_word" id="S5.p4.8.5.w13">to</span><span> </span><span class="gd_word" id="S5.p4.8.5.w14">infer</span><span> </span><math id="S5.p4.5.m5.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.p4.5.m5.1a"><msub id="S5.p4.5.m5.1.1" xref="S5.p4.5.m5.1.1.cmml"><mi id="S5.p4.5.m5.1.1.2" xref="S5.p4.5.m5.1.1.2.cmml">y</mi><mi id="S5.p4.5.m5.1.1.3" xref="S5.p4.5.m5.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p4.8.6.w1"/><span> </span><span class="gd_word" id="S5.p4.8.6.w2">from</span><span> </span><math id="S5.p4.6.m6.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.p4.6.m6.1a"><mi id="S5.p4.6.m6.1.1" xref="S5.p4.6.m6.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.p4.8.7.w1">.
But</span><span> </span><span class="gd_word" id="S5.p4.8.7.w2">of</span><span> </span><span class="gd_word" id="S5.p4.8.7.w3">course,</span><span> </span><span class="gd_word" id="S5.p4.8.7.w4">inferring</span><span> </span><math id="S5.p4.7.m7.1" class="ltx_Math" alttext="y_{x}" display="inline"><semantics id="S5.p4.7.m7.1a"><msub id="S5.p4.7.m7.1.1" xref="S5.p4.7.m7.1.1.cmml"><mi id="S5.p4.7.m7.1.1.2" xref="S5.p4.7.m7.1.1.2.cmml">y</mi><mi id="S5.p4.7.m7.1.1.3" xref="S5.p4.7.m7.1.1.3.cmml">x</mi></msub></semantics></math><span class="gd_word" id="S5.p4.8.8.w1"/><span> </span><span class="gd_word" id="S5.p4.8.8.w2">from</span><span> </span><math id="S5.p4.8.m8.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S5.p4.8.m8.1a"><mi id="S5.p4.8.m8.1.1" xref="S5.p4.8.m8.1.1.cmml">x</mi></semantics></math><span class="gd_word" id="S5.p4.8.9.w1"/><span> </span><span class="gd_word" id="S5.p4.8.9.w2">is</span><span> </span><span class="gd_word" id="S5.p4.8.9.w3">exactly</span><span> </span><span class="gd_word" id="S5.p4.8.9.w4">the</span><span> </span><span class="gd_word" id="S5.p4.8.9.w5">original</span><span> </span><span class="gd_word" id="S5.p4.8.9.w6">machine</span><span> </span><span class="gd_word" id="S5.p4.8.9.w7">translation</span><span> </span><span class="gd_word" id="S5.p4.8.9.w8">problem,</span><span> </span><span class="gd_word" id="S5.p4.8.9.w9">which</span><span> </span><span class="gd_word" id="S5.p4.8.9.w10">makes</span><span> </span><span class="gd_word" id="S5.p4.8.9.w11">the</span><span> </span><span class="gd_word" id="S5.p4.8.9.w12">value</span><span> </span><span class="gd_word" id="S5.p4.8.9.w13">problem</span><span> </span><span class="gd_word" id="S5.p4.8.9.w14">empirically</span><span> </span><span class="gd_word" id="S5.p4.8.9.w15">harder</span><span> </span><span class="gd_word" id="S5.p4.8.9.w16">than</span><span> </span><span class="gd_word" id="S5.p4.8.9.w17">its</span><span> </span><span class="gd_word" id="S5.p4.8.9.w18">policy</span><span> </span><span class="gd_word" id="S5.p4.8.9.w19">counterpart</span><span> </span><span class="gd_word" id="S5.p4.8.9.w20">on</span><span> </span><span class="gd_word" id="S5.p4.8.9.w21">our</span><span> </span><span class="gd_word" id="S5.p4.8.9.w22">dataset.</span></p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.1" class="ltx_p"><span class="gd_word" id="S5.p5.1.1.w1">Hybrid</span><span> </span><span class="gd_word" id="S5.p5.1.1.w2">architecture</span><span> </span><span class="gd_word" id="S5.p5.1.1.w3">for</span><span> </span><span class="gd_word" id="S5.p5.1.1.w4">privileged</span><span> </span><span class="gd_word" id="S5.p5.1.1.w5">metrics.
We</span><span> </span><span class="gd_word" id="S5.p5.1.1.w6">see</span><span> </span><span class="gd_word" id="S5.p5.1.1.w7">that</span><span> </span><span class="gd_word" id="S5.p5.1.1.w8">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w9">“cheating”</span><span> </span><span class="gd_word" id="S5.p5.1.1.w10">value</span><span> </span><span class="gd_word" id="S5.p5.1.1.w11">network</span><span> </span><span class="gd_word" id="S5.p5.1.1.w12">(as</span><span> </span><span class="gd_word" id="S5.p5.1.1.w13">in</span><span> </span><span class="gd_word" id="S5.p5.1.1.w14">(ii))</span><span> </span><span class="gd_word" id="S5.p5.1.1.w15">performs</span><span> </span><span class="gd_word" id="S5.p5.1.1.w16">strongly.
Unfortunately,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w17">we</span><span> </span><span class="gd_word" id="S5.p5.1.1.w18">cannot</span><span> </span><span class="gd_word" id="S5.p5.1.1.w19">allow</span><span> </span><span class="gd_word" id="S5.p5.1.1.w20">our</span><span> </span><span class="gd_word" id="S5.p5.1.1.w21">model</span><span> </span><span class="gd_word" id="S5.p5.1.1.w22">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w23">cheat</span><span> </span><span class="gd_word" id="S5.p5.1.1.w24">at</span><span> </span><span class="gd_word" id="S5.p5.1.1.w25">test</span><span> </span><span class="gd_word" id="S5.p5.1.1.w26">time.
However,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w27">we</span><span> </span><span class="gd_word" id="S5.p5.1.1.w28">can</span><span> </span><span class="gd_word" id="S5.p5.1.1.w29">still</span><span> </span><span class="gd_word" id="S5.p5.1.1.w30">leverage</span><span> </span><span class="gd_word" id="S5.p5.1.1.w31">privileged</span><span> </span><span class="gd_word" id="S5.p5.1.1.w32">information</span><span> </span><span class="gd_word" id="S5.p5.1.1.w33">at</span><span> </span><span class="gd_word" id="S5.p5.1.1.w34">training</span><span> </span><span class="gd_word" id="S5.p5.1.1.w35">time</span><span> </span><span class="gd_word" id="S5.p5.1.1.w36">through</span><span> </span><span class="gd_word" id="S5.p5.1.1.w37">representation</span><span> </span><span class="gd_word" id="S5.p5.1.1.w38">shaping,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w39">by</span><span> </span><span class="gd_word" id="S5.p5.1.1.w40">distilling</span><span> </span><span class="gd_word" id="S5.p5.1.1.w41">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w42">cheating</span><span> </span><span class="gd_word" id="S5.p5.1.1.w43">value</span><span> </span><span class="gd_word" id="S5.p5.1.1.w44">network</span><span> </span><span class="gd_word" id="S5.p5.1.1.w45">into</span><span> </span><span class="gd_word" id="S5.p5.1.1.w46">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w47">non-cheating</span><span> </span><span class="gd_word" id="S5.p5.1.1.w48">one.
We</span><span> </span><span class="gd_word" id="S5.p5.1.1.w49">propose</span><span> </span><span class="gd_word" id="S5.p5.1.1.w50">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w51">new</span><span> </span><span class="gd_word" id="S5.p5.1.1.w52">training</span><span> </span><span class="gd_word" id="S5.p5.1.1.w53">paradigm,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w54">where</span><span> </span><span class="gd_word" id="S5.p5.1.1.w55">we</span><span> </span><span class="gd_word" id="S5.p5.1.1.w56">call</span><span> </span><span class="gd_word" id="S5.p5.1.1.w57">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w58">transformer</span><span> </span><span class="gd_word" id="S5.p5.1.1.w59">model</span><span> </span><span class="gd_word" id="S5.p5.1.1.w60">twice</span><span> </span><span class="gd_word" id="S5.p5.1.1.w61">per</span><span> </span><span class="gd_word" id="S5.p5.1.1.w62">step.
The</span><span> </span><span class="gd_word" id="S5.p5.1.1.w63">first</span><span> </span><span class="gd_word" id="S5.p5.1.1.w64">call</span><span> </span><span class="gd_word" id="S5.p5.1.1.w65">is</span><span> </span><span class="gd_word" id="S5.p5.1.1.w66">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w67">regular</span><span> </span><span class="gd_word" id="S5.p5.1.1.w68">pathway,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w69">with</span><span> </span><span class="gd_word" id="S5.p5.1.1.w70">source</span><span> </span><span class="gd_word" id="S5.p5.1.1.w71">sentence</span><span> </span><span class="gd_word" id="S5.p5.1.1.w72">fed</span><span> </span><span class="gd_word" id="S5.p5.1.1.w73">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w74">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w75">encoder</span><span> </span><span class="gd_word" id="S5.p5.1.1.w76">and</span><span> </span><span class="gd_word" id="S5.p5.1.1.w77">sample</span><span> </span><span class="gd_word" id="S5.p5.1.1.w78">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w79">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w80">decoder.
The</span><span> </span><span class="gd_word" id="S5.p5.1.1.w81">second</span><span> </span><span class="gd_word" id="S5.p5.1.1.w82">call</span><span> </span><span class="gd_word" id="S5.p5.1.1.w83">is</span><span> </span><span class="gd_word" id="S5.p5.1.1.w84">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w85">“cheating”</span><span> </span><span class="gd_word" id="S5.p5.1.1.w86">pathway,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w87">with</span><span> </span><span class="gd_word" id="S5.p5.1.1.w88">ground</span><span> </span><span class="gd_word" id="S5.p5.1.1.w89">truth</span><span> </span><span class="gd_word" id="S5.p5.1.1.w90">reference</span><span> </span><span class="gd_word" id="S5.p5.1.1.w91">fed</span><span> </span><span class="gd_word" id="S5.p5.1.1.w92">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w93">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w94">encoder</span><span> </span><span class="gd_word" id="S5.p5.1.1.w95">and</span><span> </span><span class="gd_word" id="S5.p5.1.1.w96">sample</span><span> </span><span class="gd_word" id="S5.p5.1.1.w97">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w98">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w99">decoder.
We</span><span> </span><span class="gd_word" id="S5.p5.1.1.w100">apply</span><span> </span><span class="gd_word" id="S5.p5.1.1.w101">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w102">policy</span><span> </span><span class="gd_word" id="S5.p5.1.1.w103">and</span><span> </span><span class="gd_word" id="S5.p5.1.1.w104">value</span><span> </span><span class="gd_word" id="S5.p5.1.1.w105">losses</span><span> </span><span class="gd_word" id="S5.p5.1.1.w106">described</span><span> </span><span class="gd_word" id="S5.p5.1.1.w107">earlier</span><span> </span><span class="gd_word" id="S5.p5.1.1.w108">in</span><span> </span><span class="gd_word" id="S5.p5.1.1.w109">this</span><span> </span><span class="gd_word" id="S5.p5.1.1.w110">section</span><span> </span><span class="gd_word" id="S5.p5.1.1.w111">to</span><span> </span><span class="gd_word" id="S5.p5.1.1.w112">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w113">regular</span><span> </span><span class="gd_word" id="S5.p5.1.1.w114">pathway</span><span> </span><span class="gd_word" id="S5.p5.1.1.w115">outputs.
To</span><span> </span><span class="gd_word" id="S5.p5.1.1.w116">the</span><span> </span><span class="gd_word" id="S5.p5.1.1.w117">cheating</span><span> </span><span class="gd_word" id="S5.p5.1.1.w118">pathway</span><span> </span><span class="gd_word" id="S5.p5.1.1.w119">outputs,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w120">we</span><span> </span><span class="gd_word" id="S5.p5.1.1.w121">apply</span><span> </span><span class="gd_word" id="S5.p5.1.1.w122">only</span><span> </span><span class="gd_word" id="S5.p5.1.1.w123">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w124">value</span><span> </span><span class="gd_word" id="S5.p5.1.1.w125">loss.
Finally,</span><span> </span><span class="gd_word" id="S5.p5.1.1.w126">we</span><span> </span><span class="gd_word" id="S5.p5.1.1.w127">add</span><span> </span><span class="gd_word" id="S5.p5.1.1.w128">a</span><span> </span><span class="gd_word" id="S5.p5.1.1.w129">simple</span><span> </span><math id="S5.p5.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="S5.p5.1.m1.1a"><msub id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml"><mi mathvariant="normal" id="S5.p5.1.m1.1.1.2" xref="S5.p5.1.m1.1.1.2.cmml">ℓ</mi><mn id="S5.p5.1.m1.1.1.3" xref="S5.p5.1.m1.1.1.3.cmml">2</mn></msub></semantics></math><span class="gd_word" id="S5.p5.1.2.w1"/><span> </span><span class="gd_word" id="S5.p5.1.2.w2">loss</span><span> </span><span class="gd_word" id="S5.p5.1.2.w3">between</span><span> </span><span class="gd_word" id="S5.p5.1.2.w4">the</span><span> </span><span class="gd_word" id="S5.p5.1.2.w5">final</span><span> </span><span class="gd_word" id="S5.p5.1.2.w6">layers</span><span> </span><span class="gd_word" id="S5.p5.1.2.w7">of</span><span> </span><span class="gd_word" id="S5.p5.1.2.w8">both</span><span> </span><span class="gd_word" id="S5.p5.1.2.w9">pathways.
The</span><span> </span><span class="gd_word" id="S5.p5.1.2.w10">idea</span><span> </span><span class="gd_word" id="S5.p5.1.2.w11">is</span><span> </span><span class="gd_word" id="S5.p5.1.2.w12">to</span><span> </span><span class="gd_word" id="S5.p5.1.2.w13">use</span><span> </span><span class="gd_word" id="S5.p5.1.2.w14">the</span><span> </span><span class="gd_word" id="S5.p5.1.2.w15">powerful</span><span> </span><span class="gd_word" id="S5.p5.1.2.w16">cheating</span><span> </span><span class="gd_word" id="S5.p5.1.2.w17">representation</span><span> </span><span class="gd_word" id="S5.p5.1.2.w18">to</span><span> </span><span class="gd_word" id="S5.p5.1.2.w19">help</span><span> </span><span class="gd_word" id="S5.p5.1.2.w20">the</span><span> </span><span class="gd_word" id="S5.p5.1.2.w21">weaker</span><span> </span><span class="gd_word" id="S5.p5.1.2.w22">regular</span><span> </span><span class="gd_word" id="S5.p5.1.2.w23">representation.
An</span><span> </span><span class="gd_word" id="S5.p5.1.2.w24">illustration</span><span> </span><span class="gd_word" id="S5.p5.1.2.w25">can</span><span> </span><span class="gd_word" id="S5.p5.1.2.w26">be</span><span> </span><span class="gd_word" id="S5.p5.1.2.w27">found</span><span> </span><span class="gd_word" id="S5.p5.1.2.w28">in</span><span> </span><span class="gd_word" id="S5.p5.1.2.w29">Appendix </span><a href="#A1" title="Appendix A Network architectures and training ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">A</a><span class="gd_word" id="S5.p5.1.3.w1">.</span></p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p"><span class="gd_word" id="S5.p6.1.1.w1">At</span><span> </span><span class="gd_word" id="S5.p6.1.1.w2">inference</span><span> </span><span class="gd_word" id="S5.p6.1.1.w3">time,</span><span> </span><span class="gd_word" id="S5.p6.1.1.w4">we</span><span> </span><span class="gd_word" id="S5.p6.1.1.w5">only</span><span> </span><span class="gd_word" id="S5.p6.1.1.w6">compute</span><span> </span><span class="gd_word" id="S5.p6.1.1.w7">the</span><span> </span><span class="gd_word" id="S5.p6.1.1.w8">regular</span><span> </span><span class="gd_word" id="S5.p6.1.1.w9">pathway,</span><span> </span><span class="gd_word" id="S5.p6.1.1.w10">which</span><span> </span><span class="gd_word" id="S5.p6.1.1.w11">does</span><span> </span><span class="gd_word" id="S5.p6.1.1.w12">not</span><span> </span><span class="gd_word" id="S5.p6.1.1.w13">cheat.
In</span><span> </span><span class="gd_word" id="S5.p6.1.1.w14">practice,</span><span> </span><span class="gd_word" id="S5.p6.1.1.w15">with</span><span> </span><span class="gd_word" id="S5.p6.1.1.w16">careful</span><span> </span><span class="gd_word" id="S5.p6.1.1.w17">tuning</span><span> </span><span class="gd_word" id="S5.p6.1.1.w18">of</span><span> </span><span class="gd_word" id="S5.p6.1.1.w19">the</span><span> </span><span class="gd_word" id="S5.p6.1.1.w20">loss</span><span> </span><span class="gd_word" id="S5.p6.1.1.w21">hyper-parameters</span><span> </span><span class="gd_word" id="S5.p6.1.1.w22">we</span><span> </span><span class="gd_word" id="S5.p6.1.1.w23">are</span><span> </span><span class="gd_word" id="S5.p6.1.1.w24">able</span><span> </span><span class="gd_word" id="S5.p6.1.1.w25">to</span><span> </span><span class="gd_word" id="S5.p6.1.1.w26">significantly</span><span> </span><span class="gd_word" id="S5.p6.1.1.w27">reduce</span><span> </span><span class="gd_word" id="S5.p6.1.1.w28">the</span><span> </span><span class="gd_word" id="S5.p6.1.1.w29">gap</span><span> </span><span class="gd_word" id="S5.p6.1.1.w30">in</span><span> </span><span class="gd_word" id="S5.p6.1.1.w31">performance</span><span> </span><span class="gd_word" id="S5.p6.1.1.w32">between</span><span> </span><span class="gd_word" id="S5.p6.1.1.w33">this</span><span> </span><span class="gd_word" id="S5.p6.1.1.w34">new</span><span> </span><span class="gd_word" id="S5.p6.1.1.w35">hybrid</span><span> </span><span class="gd_word" id="S5.p6.1.1.w36">model</span><span> </span><span class="gd_word" id="S5.p6.1.1.w37">and</span><span> </span><span class="gd_word" id="S5.p6.1.1.w38">the</span><span> </span><span class="gd_word" id="S5.p6.1.1.w39">cheating</span><span> </span><span class="gd_word" id="S5.p6.1.1.w40">one</span><span> </span><span class="gd_word" id="S5.p6.1.1.w41">(as</span><span> </span><span class="gd_word" id="S5.p6.1.1.w42">in</span><span> </span><span class="gd_word" id="S5.p6.1.1.w43">(ii)),</span><span> </span><span class="gd_word" id="S5.p6.1.1.w44">so</span><span> </span><span class="gd_word" id="S5.p6.1.1.w45">we</span><span> </span><span class="gd_word" id="S5.p6.1.1.w46">use</span><span> </span><span class="gd_word" id="S5.p6.1.1.w47">this</span><span> </span><span class="gd_word" id="S5.p6.1.1.w48">training</span><span> </span><span class="gd_word" id="S5.p6.1.1.w49">regimen</span><span> </span><span class="gd_word" id="S5.p6.1.1.w50">for</span><span> </span><span class="gd_word" id="S5.p6.1.1.w51">our</span><span> </span><span class="gd_word" id="S5.p6.1.1.w52">experiments</span><span> </span><span class="gd_word" id="S5.p6.1.1.w53">on</span><span> </span><span class="gd_word" id="S5.p6.1.1.w54">privileged</span><span> </span><span class="gd_word" id="S5.p6.1.1.w55">metrics.</span></p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experiments</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p"><span class="gd_word" id="S6.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.p1.1.1.w2">start</span><span> </span><span class="gd_word" id="S6.p1.1.1.w3">by</span><span> </span><span class="gd_word" id="S6.p1.1.1.w4">detailing</span><span> </span><span class="gd_word" id="S6.p1.1.1.w5">our</span><span> </span><span class="gd_word" id="S6.p1.1.1.w6">general</span><span> </span><span class="gd_word" id="S6.p1.1.1.w7">setup,</span><span> </span><span class="gd_word" id="S6.p1.1.1.w8">then</span><span> </span><span class="gd_word" id="S6.p1.1.1.w9">report</span><span> </span><span class="gd_word" id="S6.p1.1.1.w10">results</span><span> </span><span class="gd_word" id="S6.p1.1.1.w11">for</span><span> </span><span class="gd_word" id="S6.p1.1.1.w12">all</span><span> </span><span class="gd_word" id="S6.p1.1.1.w13">3</span><span> </span><span class="gd_word" id="S6.p1.1.1.w14">metrics</span><span> </span><span class="gd_word" id="S6.p1.1.1.w15">we</span><span> </span><span class="gd_word" id="S6.p1.1.1.w16">consider,</span><span> </span><span class="gd_word" id="S6.p1.1.1.w17">move</span><span> </span><span class="gd_word" id="S6.p1.1.1.w18">on</span><span> </span><span class="gd_word" id="S6.p1.1.1.w19">to</span><span> </span><span class="gd_word" id="S6.p1.1.1.w20">describe</span><span> </span><span class="gd_word" id="S6.p1.1.1.w21">how</span><span> </span><span class="gd_word" id="S6.p1.1.1.w22">we</span><span> </span><span class="gd_word" id="S6.p1.1.1.w23">tuned</span><span> </span><span class="gd_word" id="S6.p1.1.1.w24">all</span><span> </span><span class="gd_word" id="S6.p1.1.1.w25">algorithms</span><span> </span><span class="gd_word" id="S6.p1.1.1.w26">for</span><span> </span><span class="gd_word" id="S6.p1.1.1.w27">best</span><span> </span><span class="gd_word" id="S6.p1.1.1.w28">performance,</span><span> </span><span class="gd_word" id="S6.p1.1.1.w29">and</span><span> </span><span class="gd_word" id="S6.p1.1.1.w30">finally</span><span> </span><span class="gd_word" id="S6.p1.1.1.w31">study</span><span> </span><span class="gd_word" id="S6.p1.1.1.w32">how</span><span> </span><span class="gd_word" id="S6.p1.1.1.w33">they</span><span> </span><span class="gd_word" id="S6.p1.1.1.w34">scale</span><span> </span><span class="gd_word" id="S6.p1.1.1.w35">with</span><span> </span><span class="gd_word" id="S6.p1.1.1.w36">increasing</span><span> </span><span class="gd_word" id="S6.p1.1.1.w37">search</span><span> </span><span class="gd_word" id="S6.p1.1.1.w38">budget.</span></p>
</div>
<figure id="S6.T4" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/S6_T4.png" alt="/static/img/2104.05336-gpt-4/S6_T4.png"/><figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span><span class="gd_word" id="S6.T4.2.w1">Comparison</span><span> </span><span class="gd_word" id="S6.T4.2.w2">of</span><span> </span><span class="gd_word" id="S6.T4.2.w3">decoding</span><span> </span><span class="gd_word" id="S6.T4.2.w4">mechanisms</span><span> </span><span class="gd_word" id="S6.T4.2.w5">on</span><span> </span><span class="gd_word" id="S6.T4.2.w6">ENDE</span><span> </span><span class="gd_word" id="S6.T4.2.w7">and</span><span> </span><span class="gd_word" id="S6.T4.2.w8">ENFR.</span><span> </span><span class="gd_word" id="S6.T4.2.w9">Top</span><span> </span><span class="gd_word" id="S6.T4.2.w10">row</span><span> </span><span class="gd_word" id="S6.T4.2.w11">contains</span><span> </span><span class="gd_word" id="S6.T4.2.w12">general</span><span> </span><span class="gd_word" id="S6.T4.2.w13">metric</span><span> </span><span class="gd_word" id="S6.T4.2.w14">statistics</span><span> </span><span class="gd_word" id="S6.T4.2.w15">and</span><span> </span><span class="gd_word" id="S6.T4.2.w16">the</span><span> </span><span class="gd_word" id="S6.T4.2.w17">original</span><span> </span><span class="gd_word" id="S6.T4.2.w18">transformer</span><span> </span><span class="gd_word" id="S6.T4.2.w19">baseline;</span><span> </span><span class="gd_word" id="S6.T4.2.w20">the</span><span> </span><span class="gd_word" id="S6.T4.2.w21">second</span><span> </span><span class="gd_word" id="S6.T4.2.w22">row</span><span> </span><span class="gd_word" id="S6.T4.2.w23">performance</span><span> </span><span class="gd_word" id="S6.T4.2.w24">of</span><span> </span><span class="gd_word" id="S6.T4.2.w25">supervised</span><span> </span><span class="gd_word" id="S6.T4.2.w26">models</span><span> </span><span class="gd_word" id="S6.T4.2.w27">with</span><span> </span><span class="gd_word" id="S6.T4.2.w28">likelihood-based</span><span> </span><span class="gd_word" id="S6.T4.2.w29">decodings;</span><span> </span><span class="gd_word" id="S6.T4.2.w30">the</span><span> </span><span class="gd_word" id="S6.T4.2.w31">third</span><span> </span><span class="gd_word" id="S6.T4.2.w32">results</span><span> </span><span class="gd_word" id="S6.T4.2.w33">for</span><span> </span><span class="gd_word" id="S6.T4.2.w34">value-based</span><span> </span><span class="gd_word" id="S6.T4.2.w35">algorithms</span><span> </span><span class="gd_word" id="S6.T4.2.w36">with</span><span> </span><span class="gd_word" id="S6.T4.2.w37">joint</span><span> </span><span class="gd_word" id="S6.T4.2.w38">policy/value</span><span> </span><span class="gd_word" id="S6.T4.2.w39">models</span><span> </span><span class="gd_word" id="S6.T4.2.w40">(a</span><span> </span><span class="gd_word" id="S6.T4.2.w41">specific</span><span> </span><span class="gd_word" id="S6.T4.2.w42">one</span><span> </span><span class="gd_word" id="S6.T4.2.w43">for</span><span> </span><span class="gd_word" id="S6.T4.2.w44">each</span><span> </span><span class="gd_word" id="S6.T4.2.w45">metric);</span><span> </span><span class="gd_word" id="S6.T4.2.w46">the</span><span> </span><span class="gd_word" id="S6.T4.2.w47">last</span><span> </span><span class="gd_word" id="S6.T4.2.w48">one</span><span> </span><span class="gd_word" id="S6.T4.2.w49">numbers</span><span> </span><span class="gd_word" id="S6.T4.2.w50">for</span><span> </span><span class="gd_word" id="S6.T4.2.w51">score-based</span><span> </span><span class="gd_word" id="S6.T4.2.w52">methods.</span><span> </span><span class="gd_word" id="S6.T4.2.w53">Best</span><span> </span><span class="gd_word" id="S6.T4.2.w54">overall</span><span> </span><span class="gd_word" id="S6.T4.2.w55">performance</span><span> </span><span class="gd_word" id="S6.T4.2.w56">is</span><span> </span><span class="gd_word" id="S6.T4.2.w57">in</span><span> </span><span class="gd_word" id="S6.T4.2.w58">bold;</span><span> </span><span class="gd_word" id="S6.T4.2.w59">best</span><span> </span><span class="gd_word" id="S6.T4.2.w60">value-based</span><span> </span><span class="gd_word" id="S6.T4.2.w61">performance</span><span> </span><span class="gd_word" id="S6.T4.2.w62">in</span><span> </span><span class="gd_word" id="S6.T4.2.w63">blue.</span><span> </span><span class="gd_word" id="S6.T4.2.w64">Beam</span><span> </span><span class="gd_word" id="S6.T4.2.w65">search</span><span> </span><span class="gd_word" id="S6.T4.2.w66">performs</span><span> </span><span class="gd_word" id="S6.T4.2.w67">strongly</span><span> </span><span class="gd_word" id="S6.T4.2.w68">for</span><span> </span><span class="gd_word" id="S6.T4.2.w69">privileged</span><span> </span><span class="gd_word" id="S6.T4.2.w70">metrics,</span><span> </span><span class="gd_word" id="S6.T4.2.w71">while</span><span> </span><span class="gd_word" id="S6.T4.2.w72">value-based</span><span> </span><span class="gd_word" id="S6.T4.2.w73">methods</span><span> </span><span class="gd_word" id="S6.T4.2.w74">prevail</span><span> </span><span class="gd_word" id="S6.T4.2.w75">for</span><span> </span><span class="gd_word" id="S6.T4.2.w76">unprivileged</span><span> </span><span class="gd_word" id="S6.T4.2.w77">scores.</span><span> </span><span class="gd_word" id="S6.T4.2.w78">Score-based</span><span> </span><span class="gd_word" id="S6.T4.2.w79">methods</span><span> </span><span class="gd_word" id="S6.T4.2.w80">outperform</span><span> </span><span class="gd_word" id="S6.T4.2.w81">their</span><span> </span><span class="gd_word" id="S6.T4.2.w82">value-based</span><span> </span><span class="gd_word" id="S6.T4.2.w83">counterparts,</span><span> </span><span class="gd_word" id="S6.T4.2.w84">but</span><span> </span><span class="gd_word" id="S6.T4.2.w85">V-MCTS</span><span> </span><span class="gd_word" id="S6.T4.2.w86">remains</span><span> </span><span class="gd_word" id="S6.T4.2.w87">competitive.</span></figcaption>
</figure>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Experimental setup</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p"><span class="gd_word" id="S6.SS1.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w2">consider</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w3">two</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w4">established</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w5">machine</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w6">translation</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w7">datasets:</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w8">WMT’14</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w9">English</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w10">to</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w11">German</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w12">(ENDE)</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w13">and</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w14">WMT’14</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w15">English</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w16">to</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w17">French</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w18">(ENFR).
The</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w19">first</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w20">dataset</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w21">contains</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w22">roughly</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w23">4.5</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w24">million</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w25">training</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w26">sentence</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w27">pairs,</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w28">while</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w29">the</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w30">second</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w31">is</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w32">much</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w33">bigger</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w34">with</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w35">just</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w36">under</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w37">41</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w38">million</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w39">training</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w40">sentence</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w41">pairs,</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w42">which</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w43">enables</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w44">us</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w45">to</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w46">account</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w47">for</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w48">scale</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w49">in</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w50">our</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w51">experiments.
All</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w52">dev</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w53">and</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w54">test</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w55">sets</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w56">contains</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w57">approximately</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w58">3000</span><span> </span><span class="gd_word" id="S6.SS1.p1.1.1.w59">sentences.</span></p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p"><span class="gd_word" id="S6.SS1.p2.1.1.w1">Our</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w2">joint</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w3">policy/value</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w4">model</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w5">is</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w6">based</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w7">on</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w8">the</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w9">Transformer</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w10">encoder-decoder</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.1.w11">architecture </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S6.SS1.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w2">which</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w3">is</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w4">typically</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w5">used</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w6">in</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w7">machine</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w8">translation</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w9">studies.
Encoder</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w10">and</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w11">decoder</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w12">have</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w13">6</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w14">attention</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w15">blocks,</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w16">hidden</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w17">dimensionality</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w18">512,</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w19">16</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w20">heads</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w21">and</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w22">our</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w23">dictionary</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w24">size</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w25">is</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w26">about</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w27">32k.
As</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w28">we</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w29">test</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w30">inference-intensive</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w31">methods,</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w32">we</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w33">use</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w34">a</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w35">few</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w36">adaptations</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w37">(while</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w38">still</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w39">matching</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w40">or</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w41">outperforming</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w42">the</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w43">original</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w44">transformer</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w45">models,</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w46">as</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w47">shown</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w48">in</span><span> </span><span class="gd_word" id="S6.SS1.p2.1.2.w49">Table </span><a href="#S6.T4" title="Table 4 ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S6.SS1.p2.1.3.w1">).</span></p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p id="S6.SS1.p3.1" class="ltx_p"><span class="gd_word" id="S6.SS1.p3.1.1.w1">First,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w2">we</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w3">use</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w4">multi-query</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w5">attention,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w6">as</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w7">defined</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.1.w8">by </span><cite class="ltx_cite ltx_citemacro_citet">Shazeer (<a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S6.SS1.p3.1.2.w1">.
Counter-intuitively,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w2">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w3">performance</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w4">bottleneck</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w5">for</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w6">small</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w7">transformer</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w8">architectures</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w9">on</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w10">our</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w11">hardware</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w12">of</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w13">choice,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w14">TPUv3,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w15">is</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w16">memory</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w17">access</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w18">by</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w19">a</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w20">very</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w21">large</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w22">margin.
This</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w23">is</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w24">driven</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w25">by</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w26">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w27">need</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w28">to</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w29">store</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w30">and</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w31">read</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w32">keys</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w33">and</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w34">values</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w35">from</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w36">memory</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w37">to</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w38">enable</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w39">faster,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w40">incremental</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w41">inference.
We</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w42">reduce</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w43">this</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w44">memory</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w45">footprint</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w46">by</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w47">only</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w48">computing</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w49">a</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w50">single</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w51">set</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w52">of</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w53">keys</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w54">and</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w55">values</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w56">per</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w57">attention</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w58">block,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w59">that</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w60">we</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w61">share</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w62">across</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w63">all</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w64">attention</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w65">heads.
This</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w66">simple</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w67">change</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w68">yields</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w69">an</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w70">impressive,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w71">almost</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w72">linear</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w73">speedup</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w74">with</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w75">respect</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w76">to</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w77">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w78">number</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w79">of</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w80">attention</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w81">heads.
While</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w82">it</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w83">comes</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w84">at</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w85">a</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w86">small</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w87">cost</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w88">in</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w89">terms</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w90">of</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w91">accuracy,</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w92">this</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w93">can</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w94">easily</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w95">be</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w96">offset</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w97">by</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w98">reallocating</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w99">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w100">attention</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w101">weights</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w102">we</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w103">removed</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w104">to</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w105">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w106">feed-forward</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w107">layer</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w108">of</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w109">the</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w110">attention</span><span> </span><span class="gd_word" id="S6.SS1.p3.1.2.w111">blocks.</span></p>
</div>
<div id="S6.SS1.p4" class="ltx_para">
<p id="S6.SS1.p4.1" class="ltx_p"><span class="gd_word" id="S6.SS1.p4.1.1.w1">Second,</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w2">we</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w3">use</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w4">key</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w5">and</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w6">value</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w7">dimensionality</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w8">128,</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w9">rather</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w10">than</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w11">the</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w12">more</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w13">customary</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w14">64,</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w15">which</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w16">enables</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w17">faster</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w18">inference</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w19">by</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w20">removing</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w21">an</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w22">expensive</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w23">padding</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w24">operation</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w25">on</span><span> </span><span class="gd_word" id="S6.SS1.p4.1.1.w26">TPUv3.</span></p>
</div>
<div id="S6.SS1.p5" class="ltx_para">
<p id="S6.SS1.p5.1" class="ltx_p"><span class="gd_word" id="S6.SS1.p5.1.1.w1">Finally,</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w2">we</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w3">allow</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w4">a</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w5">budget</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w6">of</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w7">50</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w8">inferences</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w9">per</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w10">token</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w11">in</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w12">the</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w13">sampled</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w14">solutions</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w15">for</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w16">all</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w17">methods;</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w18">compared</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w19">to</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w20">1</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w21">for</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w22">greedy</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w23">decoding,</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w24">and</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w25">4</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w26">for</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w27">beam</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w28">search.
We</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w29">use</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w30">incremental</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w31">sampling</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w32">for</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w33">speed.
Both</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w34">the</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w35">running</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w36">time</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w37">and</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w38">the</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w39">memory</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w40">footprint</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w41">are</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w42">directly</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w43">proportional</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w44">to</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w45">the</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w46">amount</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w47">of</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w48">inferences</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w49">for</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w50">all</span><span> </span><span class="gd_word" id="S6.SS1.p5.1.1.w51">methods.</span></p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Main results analysis</h3>

<div id="S6.SS2.p1" class="ltx_para ltx_noindent">
<p id="S6.SS2.p1.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p1.1.1.w1">Privileged</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w2">metrics:</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w3">BLEU</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w4">and</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w5">BERTScore.
We</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w6">report</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w7">our</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w8">results</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w9">on</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w10">privileged</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w11">metrics</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w12">in</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.1.w13">Table </span><a href="#S6.T4" title="Table 4 ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S6.SS2.p1.1.2.w1">.
Plain</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w2">beam</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w3">search</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w4">is</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w5">a</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w6">strong</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w7">contender</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w8">in</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w9">this</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w10">setup,</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w11">often</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w12">matching</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w13">or</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w14">outperforming</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w15">other</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w16">methods,</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w17">while</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w18">using</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w19">a</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w20">fraction</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w21">of</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w22">the</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w23">inference</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w24">budget</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w25">(unfortunately</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w26">performance</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w27">degrades</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w28">rapidly</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w29">with</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w30">larger</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w31">beam</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w32">sizes</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w33">so</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w34">we</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w35">cannot</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w36">leverage</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w37">more</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w38">computational</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w39">budget).
In</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w40">this</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w41">setup,</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w42">value-based</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w43">methods</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w44">struggle</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w45">to</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w46">justify</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w47">their</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w48">higher</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w49">complexity</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w50">and</span><span> </span><span class="gd_word" id="S6.SS2.p1.1.2.w51">cost.</span></p>
</div>
<div id="S6.SS2.p2" class="ltx_para ltx_noindent">
<p id="S6.SS2.p2.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p2.1.1.w1">Value-based</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w2">algorithms</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w3">for</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w4">unprivileged</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w5">metrics.
The</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w6">results</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w7">for</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w8">this</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w9">alternative</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w10">use</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w11">case,</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w12">also</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w13">presented</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w14">in</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.1.w15">Table </span><a href="#S6.T4" title="Table 4 ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S6.SS2.p2.1.2.w1">,</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w2">paint</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w3">a</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w4">completely</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w5">different</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w6">picture.
We</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w7">see</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w8">that</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w9">while</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w10">regular</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w11">beam</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w12">size</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w13">obtains</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w14">a</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w15">small</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w16">but</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w17">consistent</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w18">improvement,</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w19">value-guided</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w20">methods</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w21">perform</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w22">significantly</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w23">better.
Between</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w24">the</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w25">latter,</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w26">MCTS</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w27">is</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w28">particularly</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w29">promising,</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w30">as</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w31">its</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w32">performance</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w33">scales</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w34">nicely</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w35">with</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w36">the</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w37">size</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w38">of</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w39">the</span><span> </span><span class="gd_word" id="S6.SS2.p2.1.2.w40">dataset.</span></p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p id="S6.SS2.p3.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p3.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w2">observe</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w3">that</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w4">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w5">policies</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w6">of</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w7">our</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w8">joint</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w9">policy/value</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w10">models</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w11">perform</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w12">slightly</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w13">worse</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w14">than</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w15">their</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w16">supervised</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w17">counterparts</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w18">(see</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.1.w19">Table </span><a href="#A4.T12" title="Table 12 ‣ Appendix D Supervised policy vs Distilled policy ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">12</a><span class="gd_word" id="S6.SS2.p3.1.2.w1"/><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w2">in</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w3">Appendix).
If</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w4">we</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w5">use</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w6">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w7">initial</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w8">supervised</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w9">model</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w10">policy</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w11">in</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w12">conjunction</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w13">with</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w14">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w15">multilingual</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w16">value</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w17">(see</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.2.w18">Table </span><a href="#A4.T13" title="Table 13 ‣ Appendix D Supervised policy vs Distilled policy ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">13</a><span class="gd_word" id="S6.SS2.p3.1.3.w1"/><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w2">in</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w3">Appendix),</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w4">we</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w5">obtain</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w6">promising</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w7">results:</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w8">notably</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w9">40.31</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w10">BLEU</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w11">when</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w12">optimising</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w13">MLBERTScore</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w14">with</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w15">MCTS</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w16">on</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w17">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w18">ENFR</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w19">dataset</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w20">–</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w21">more</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w22">than</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w23">a</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w24">full</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w25">BLEU</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w26">point</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w27">above</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w28">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w29">performance</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w30">of</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w31">beam</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w32">search.
From</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w33">a</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w34">qualitative</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w35">point</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w36">of</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w37">view,</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w38">we</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w39">see</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w40">a</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w41">confirmation</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w42">of</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w43">our</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w44">conjecture:</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w45">multilingual</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w46">BERTScore</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w47">is</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w48">not</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w49">perfectly</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w50">aligned</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w51">with</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w52">BLEU.
It</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w53">seems</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w54">to</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w55">encourage</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w56">word-for-word</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w57">translations,</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w58">which</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w59">has</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w60">a</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w61">positive</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w62">effect</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w63">initially</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w64">(more</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w65">consistency</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w66">between</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w67">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w68">source</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w69">and</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w70">the</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w71">sample</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w72">sentences),</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w73">but</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w74">ultimately</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w75">leads</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w76">to</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w77">less</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w78">natural</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w79">translations</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w80">if</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w81">used</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w82">with</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w83">enough</span><span> </span><span class="gd_word" id="S6.SS2.p3.1.3.w84">budget.</span></p>
</div>
<div id="S6.SS2.p4" class="ltx_para ltx_noindent">
<p id="S6.SS2.p4.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p4.1.1.w1">Score-based</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w2">approaches</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w3">for</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w4">unprivileged</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w5">metrics.
The</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w6">bottom</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w7">of</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.1.w8">Table </span><a href="#S6.T4" title="Table 4 ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S6.SS2.p4.1.2.w1"/><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w2">gives</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w3">results</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w4">when</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w5">we</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w6">allow</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w7">direct</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w8">access</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w9">to</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w10">our</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w11">two</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w12">unprivileged</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w13">metrics,</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w14">without</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w15">having</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w16">to</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w17">go</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w18">through</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w19">a</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w20">value</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w21">approximation.
They</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w22">reinforce</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w23">our</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w24">finding</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w25">that</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w26">the</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w27">choice</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w28">of</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w29">algorithm</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w30">heavily</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w31">depends</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w32">on</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w33">the</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w34">use</span><span> </span><span class="gd_word" id="S6.SS2.p4.1.2.w35">case.</span></p>
</div>
<div id="S6.SS2.p5" class="ltx_para">
<p id="S6.SS2.p5.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p5.1.1.w1">Two</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w2">additional</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w3">properties</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w4">stand</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w5">out.
First,</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w6">all</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w7">the</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w8">methods</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w9">that</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w10">access</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w11">the</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w12">score</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w13">directly</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w14">perform</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w15">significantly</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w16">better</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w17">than</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w18">their</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w19">value-guided</span><span> </span><span class="gd_word" id="S6.SS2.p5.1.1.w20">counterparts.</span></p>
</div>
<div id="S6.SS2.p6" class="ltx_para">
<p id="S6.SS2.p6.1" class="ltx_p"><span class="gd_word" id="S6.SS2.p6.1.1.w1">Second,</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w2">the</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w3">purely</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w4">value-based</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w5">V-MCTS</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w6">is</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w7">competitive</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w8">with</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w9">and</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w10">can</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w11">even</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w12">outperform</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w13">the</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w14">score-based</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w15">approach,</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w16">S+R.
This</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w17">is</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w18">promising,</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w19">as</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w20">MCTS</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w21">is</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w22">more</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w23">widely</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w24">applicable</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w25">(as</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w26">some</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w27">scores</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w28">are</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w29">expensive</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w30">to</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w31">get).
However</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w32">S+R</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w33">performs</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w34">surprisingly</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w35">well,</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w36">which</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w37">may</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w38">warrant</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w39">more</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w40">explorations</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w41">of</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w42">sampling</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w43">methods</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w44">optimising</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w45">for</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w46">diversity</span><span> </span><span class="gd_word" id="S6.SS2.p6.1.1.w47">(e.g. </span><cite class="ltx_cite ltx_citemacro_citet">Fan et al. (<a href="#bib.bib14" title="" class="ltx_ref">2018</a>); Holtzman et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>); Kool et al. (<a href="#bib.bib22" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="S6.SS2.p6.1.2.w1">).</span></p>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Algorithms tuning and ablations</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p"><span class="gd_word" id="S6.SS3.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w2">detail</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w3">in</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w4">this</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w5">section</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w6">which</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w7">hyper-parameters</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w8">we</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w9">tuned</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w10">(and</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w11">how)</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w12">to</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w13">generate</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w14">the</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w15">results</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w16">reported</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w17">in</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.1.w18">Table </span><a href="#S6.T4" title="Table 4 ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">4</a><span class="gd_word" id="S6.SS3.p1.1.2.w1">.
Precise</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w2">ranges</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w3">and</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w4">ablations</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w5">are</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w6">provided</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w7">in</span><span> </span><span class="gd_word" id="S6.SS3.p1.1.2.w8">Appendix </span><a href="#A2" title="Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">B</a><span class="gd_word" id="S6.SS3.p1.1.3.w1">.</span></p>
</div>
<div id="S6.SS3.p2" class="ltx_para ltx_noindent">
<p id="S6.SS3.p2.1" class="ltx_p"><span class="gd_word" id="S6.SS3.p2.1.1.w1">Beam</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w2">search.
We</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w3">experiment</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w4">with</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w5">the</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w6">beam</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w7">size,</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w8">the</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w9">normalisation</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w10">constant,</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w11">and</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w12">try</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w13">to</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w14">apply</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w15">temperature</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w16">to</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w17">the</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w18">logits.
We</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w19">found</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w20">that</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w21">the</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w22">best</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w23">performance</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w24">was</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w25">achieved</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w26">with</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w27">the</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w28">default</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w29">hyper-parameters</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w30">for</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w31">most</span><span> </span><span class="gd_word" id="S6.SS3.p2.1.1.w32">metrics.</span></p>
</div>
<div id="S6.SS3.p3" class="ltx_para ltx_noindent">
<p id="S6.SS3.p3.4" class="ltx_p"><span class="gd_word" id="S6.SS3.p3.4.1.w1">Value-guided</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w2">beam</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w3">search.
In</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w4">this</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w5">variant,</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w6">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w7">ranking</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w8">rule</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w9">is</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w10">a</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w11">linear</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w12">combination</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w13">of</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w14">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w15">log-likelihoods</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w16">of</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w17">tokens</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w18">and</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w19">their</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w20">values</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w21">provided</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w22">by</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w23">a</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w24">neural</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w25">network.
We</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w26">tested</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w27">various</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w28">value</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w29">scaling</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w30">schemes</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w31">(e.g.</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w32">taking</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w33">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w34">logarithm</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w35">of</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w36">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w37">value</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w38">as</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w39">detailed</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.1.w40">by </span><cite class="ltx_cite ltx_citemacro_citet">He et al. (<a href="#bib.bib18" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="S6.SS3.p3.4.2.w1">),</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w2">as</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w3">well</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w4">as</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w5">log-likelihood</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w6">normalisations;</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w7">we</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w8">found</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w9">that</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w10">using</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w11">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w12">plain</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w13">value,</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w14">with</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w15">a</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w16">length</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w17">normalisation</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w18">for</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w19">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w20">log-likelihoods</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w21">worked</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w22">best.
We</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w23">tuned</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w24">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.2.w25">weight</span><span> </span><math id="S6.SS3.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS3.p3.1.m1.1a"><mi id="S6.SS3.p3.1.m1.1.1" xref="S6.SS3.p3.1.m1.1.1.cmml">α</mi></semantics></math><span class="gd_word" id="S6.SS3.p3.4.3.w1"/><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w2">of</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w3">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w4">value</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w5">in</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w6">the</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w7">score.
For</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w8">privileged</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.3.w9">metrics,</span><span> </span><math id="S6.SS3.p3.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S6.SS3.p3.2.m2.1a"><mrow id="S6.SS3.p3.2.m2.1.1" xref="S6.SS3.p3.2.m2.1.1.cmml"><mi id="S6.SS3.p3.2.m2.1.1.2" xref="S6.SS3.p3.2.m2.1.1.2.cmml">α</mi><mo id="S6.SS3.p3.2.m2.1.1.1" xref="S6.SS3.p3.2.m2.1.1.1.cmml">=</mo><mn id="S6.SS3.p3.2.m2.1.1.3" xref="S6.SS3.p3.2.m2.1.1.3.cmml">0.5</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p3.4.4.w1"/><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w2">performed</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w3">best.
For</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w4">unprivileged</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w5">metrics</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w6">larger</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w7">weights</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w8">were</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w9">preferable</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.4.w10">(</span><math id="S6.SS3.p3.3.m3.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="S6.SS3.p3.3.m3.1a"><mrow id="S6.SS3.p3.3.m3.1.1" xref="S6.SS3.p3.3.m3.1.1.cmml"><mi id="S6.SS3.p3.3.m3.1.1.2" xref="S6.SS3.p3.3.m3.1.1.2.cmml">α</mi><mo id="S6.SS3.p3.3.m3.1.1.1" xref="S6.SS3.p3.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS3.p3.3.m3.1.1.3" xref="S6.SS3.p3.3.m3.1.1.3.cmml">0.9</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p3.4.5.w1"/><span> </span><span class="gd_word" id="S6.SS3.p3.4.5.w2">for</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.5.w3">ENDE</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.5.w4">and</span><span> </span><math id="S6.SS3.p3.4.m4.1" class="ltx_Math" alttext="\alpha=0.95" display="inline"><semantics id="S6.SS3.p3.4.m4.1a"><mrow id="S6.SS3.p3.4.m4.1.1" xref="S6.SS3.p3.4.m4.1.1.cmml"><mi id="S6.SS3.p3.4.m4.1.1.2" xref="S6.SS3.p3.4.m4.1.1.2.cmml">α</mi><mo id="S6.SS3.p3.4.m4.1.1.1" xref="S6.SS3.p3.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS3.p3.4.m4.1.1.3" xref="S6.SS3.p3.4.m4.1.1.3.cmml">0.95</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p3.4.6.w1"/><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w2">for</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w3">ENFR),</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w4">which</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w5">confirms</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w6">our</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w7">observation</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w8">that</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w9">value</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w10">functions</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w11">are</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w12">of</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w13">higher</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w14">quality</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w15">in</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w16">this</span><span> </span><span class="gd_word" id="S6.SS3.p3.4.6.w17">setup.</span></p>
</div>
<div id="S6.SS3.p4" class="ltx_para ltx_noindent">
<p id="S6.SS3.p4.1" class="ltx_p"><span class="gd_word" id="S6.SS3.p4.1.1.w1">Value-guided</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w2">MCTS.
We</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w3">find</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w4">that</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w5">selecting</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w6">the</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w7">best</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w8">pair</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w9">of</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w10">logits</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w11">temperature</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w12">and</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w13">scaling</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.1.w14">factor</span><span> </span><math id="S6.SS3.p4.1.m1.1" class="ltx_Math" alttext="c_{\text{puct}}" display="inline"><semantics id="S6.SS3.p4.1.m1.1a"><msub id="S6.SS3.p4.1.m1.1.1" xref="S6.SS3.p4.1.m1.1.1.cmml"><mi id="S6.SS3.p4.1.m1.1.1.2" xref="S6.SS3.p4.1.m1.1.1.2.cmml">c</mi><mi id="S6.SS3.p4.1.m1.1.1.3" xref="S6.SS3.p4.1.m1.1.1.3a.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="S6.SS3.p4.1.2.w1"/><span> </span><span class="gd_word" id="S6.SS3.p4.1.2.w2">is</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.2.w3">key</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.2.w4">for</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.2.w5">optimising</span><span> </span><span class="gd_word" id="S6.SS3.p4.1.2.w6">performance.</span></p>
</div>
<div id="S6.SS3.p5" class="ltx_para">
<p id="S6.SS3.p5.1" class="ltx_p"><span class="gd_word" id="S6.SS3.p5.1.1.w1">Specifically</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w2">for</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w3">unprivileged</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w4">metrics,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w5">we</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w6">made</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w7">two</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w8">other</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w9">key</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w10">decisions.
First,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w11">instead</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w12">of</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w13">using</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w14">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w15">weighted</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w16">average</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w17">rule</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w18">in</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w19">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w20">backup</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w21">phase</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w22">(where</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w23">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w24">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w25">of</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w26">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w27">newly</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w28">opened</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w29">node</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w30">is</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w31">used</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w32">to</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w33">update</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w34">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w35">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w36">of</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w37">all</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w38">its</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w39">predecessors),</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w40">we</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w41">found</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w42">that</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w43">we</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w44">could</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w45">use</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w46">instead</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w47">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w48">max</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w49">operator</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w50">to</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w51">better</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w52">effect.
Second,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w53">we</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w54">observed</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w55">better</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w56">results</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w57">when</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w58">selecting</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w59">as</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w60">action</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w61">(once</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w62">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w63">full</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w64">tree</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w65">is</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w66">completed)</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w67">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w68">root</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w69">child</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w70">with</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.1.w71">maximum</span><span> </span><em id="S6.SS3.p5.1.1" class="ltx_emph ltx_font_italic">aggregate value</em><span class="gd_word" id="S6.SS3.p5.1.2.w1">,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.2.w2">instead</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.2.w3">of</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.2.w4">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.2.w5">more</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.2.w6">customary</span><span> </span><em id="S6.SS3.p5.1.2" class="ltx_emph ltx_font_italic">visit count</em><span class="gd_word" id="S6.SS3.p5.1.3.w1">.
Both</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w2">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w3">generic</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w4">options</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w5">are</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w6">meant</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w7">to</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w8">make</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w9">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w10">search</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w11">more</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w12">robust</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w13">to</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w14">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w15">outliers,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w16">as</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w17">they</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w18">average</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w19">statistics.
We</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w20">essentially</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w21">found</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w22">that</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w23">for</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w24">unprivileged</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w25">metrics,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w26">our</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w27">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w28">approximation</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w29">was</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w30">good</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w31">enough</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w32">that</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w33">following</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w34">the</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w35">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w36">more</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w37">aggressively</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w38">led</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w39">to</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w40">improved</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w41">performance.
The</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w42">reverse</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w43">was</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w44">true</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w45">on</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w46">privileged</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w47">metrics,</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w48">where</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w49">our</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w50">value</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w51">networks</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w52">are</span><span> </span><span class="gd_word" id="S6.SS3.p5.1.3.w53">lower-quality.</span></p>
</div>
<div id="S6.SS3.p6" class="ltx_para ltx_noindent">
<p id="S6.SS3.p6.4" class="ltx_p"><span class="gd_word" id="S6.SS3.p6.4.1.w1">Sampling</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w2">and</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w3">reranking.
Given</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w4">the</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w5">simplicity</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w6">of</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w7">this</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w8">approach,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w9">there</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w10">really</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w11">is</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w12">a</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w13">single</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w14">hyper-parameter</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w15">to</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w16">tune:</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w17">the</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w18">temperature</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w19">applied</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w20">to</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w21">the</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w22">model</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w23">likelihoods</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w24">before</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w25">sampling.
We</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w26">do</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w27">find</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w28">however,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w29">that</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w30">properly</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w31">picking</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w32">this</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w33">temperature</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w34">is</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w35">critical,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w36">as</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w37">the</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w38">method</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w39">is</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w40">sensitive</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w41">to</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w42">it:</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w43">high</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w44">temperatures</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.1.w45">(</span><math id="S6.SS3.p6.1.m1.1" class="ltx_Math" alttext="\tau\geq 1" display="inline"><semantics id="S6.SS3.p6.1.m1.1a"><mrow id="S6.SS3.p6.1.m1.1.1" xref="S6.SS3.p6.1.m1.1.1.cmml"><mi id="S6.SS3.p6.1.m1.1.1.2" xref="S6.SS3.p6.1.m1.1.1.2.cmml">τ</mi><mo id="S6.SS3.p6.1.m1.1.1.1" xref="S6.SS3.p6.1.m1.1.1.1.cmml">≥</mo><mn id="S6.SS3.p6.1.m1.1.1.3" xref="S6.SS3.p6.1.m1.1.1.3.cmml">1</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p6.4.2.w1">)</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w2">leads</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w3">to</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w4">nonsensical</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w5">outputs,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w6">while</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w7">conversely</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w8">low</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w9">temperatures</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.2.w10">(</span><math id="S6.SS3.p6.2.m2.1" class="ltx_Math" alttext="\tau\leq 0.5)" display="inline"><semantics id="S6.SS3.p6.2.m2.1a"><mrow id="S6.SS3.p6.2.m2.1b"><mi id="S6.SS3.p6.2.m2.1.1" xref="S6.SS3.p6.2.m2.1.1.cmml">τ</mi><mo id="S6.SS3.p6.2.m2.1.2" xref="S6.SS3.p6.2.m2.1.2.cmml">≤</mo><mn id="S6.SS3.p6.2.m2.1.3" xref="S6.SS3.p6.2.m2.1.3.cmml">0.5</mn><mo stretchy="false" id="S6.SS3.p6.2.m2.1.4" xref="S6.SS3.p6.2.m2.1.4.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="S6.SS3.p6.4.3.w1"/><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w2">lead</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w3">to</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w4">almost</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w5">no</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w6">diversity</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w7">in</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w8">outputs.
On</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w9">the</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w10">dev</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w11">set,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w12">our</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w13">best</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w14">performing</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w15">runs</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.3.w16">use</span><span> </span><math id="S6.SS3.p6.3.m3.1" class="ltx_Math" alttext="\tau=0.75" display="inline"><semantics id="S6.SS3.p6.3.m3.1a"><mrow id="S6.SS3.p6.3.m3.1.1" xref="S6.SS3.p6.3.m3.1.1.cmml"><mi id="S6.SS3.p6.3.m3.1.1.2" xref="S6.SS3.p6.3.m3.1.1.2.cmml">τ</mi><mo id="S6.SS3.p6.3.m3.1.1.1" xref="S6.SS3.p6.3.m3.1.1.1.cmml">=</mo><mn id="S6.SS3.p6.3.m3.1.1.3" xref="S6.SS3.p6.3.m3.1.1.3.cmml">0.75</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p6.4.4.w1"/><span> </span><span class="gd_word" id="S6.SS3.p6.4.4.w2">for</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.4.w3">MLBERTScore,</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.4.w4">but</span><span> </span><math id="S6.SS3.p6.4.m4.1" class="ltx_Math" alttext="\tau=0.25" display="inline"><semantics id="S6.SS3.p6.4.m4.1a"><mrow id="S6.SS3.p6.4.m4.1.1" xref="S6.SS3.p6.4.m4.1.1.cmml"><mi id="S6.SS3.p6.4.m4.1.1.2" xref="S6.SS3.p6.4.m4.1.1.2.cmml">τ</mi><mo id="S6.SS3.p6.4.m4.1.1.1" xref="S6.SS3.p6.4.m4.1.1.1.cmml">=</mo><mn id="S6.SS3.p6.4.m4.1.1.3" xref="S6.SS3.p6.4.m4.1.1.3.cmml">0.25</mn></mrow></semantics></math><span class="gd_word" id="S6.SS3.p6.4.5.w1"/><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w2">for</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w3">privileged</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w4">metrics</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w5">(using</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w6">S+RV</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w7">which</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w8">relies</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w9">on</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w10">value</span><span> </span><span class="gd_word" id="S6.SS3.p6.4.5.w11">approximation).</span></p>
</div>
<div id="S6.SS3.p7" class="ltx_para ltx_noindent">
<p id="S6.SS3.p7.1" class="ltx_p"><span class="gd_word" id="S6.SS3.p7.1.1.w1">MCTS</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w2">+</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w3">rollouts.
We</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w4">find</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w5">that</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w6">the</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w7">adaptations</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w8">we</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w9">made</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w10">for</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w11">Value-guided</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w12">MCTS</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w13">also</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w14">perform</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w15">best</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w16">for</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w17">this</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w18">proof-of-concept</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w19">algorithm.
As</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w20">the</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w21">quality</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w22">of</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w23">the</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w24">value</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w25">estimation</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w26">is</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w27">good</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w28">(though</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w29">expensive),</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w30">following</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w31">the</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w32">value</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w33">aggressively</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w34">also</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w35">yields</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w36">the</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w37">best</span><span> </span><span class="gd_word" id="S6.SS3.p7.1.1.w38">results.</span></p>
</div>
</section>
<section id="S6.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4 </span>Scaling search with computational budget</h3>

<figure id="S6.T5" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/S6_T5.png" alt="/static/img/2104.05336-gpt-4/S6_T5.png"/><figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 5: </span><span class="gd_word" id="S6.T5.2.w1">Comparison</span><span> </span><span class="gd_word" id="S6.T5.2.w2">of</span><span> </span><span class="gd_word" id="S6.T5.2.w3">how</span><span> </span><span class="gd_word" id="S6.T5.2.w4">our</span><span> </span><span class="gd_word" id="S6.T5.2.w5">methods</span><span> </span><span class="gd_word" id="S6.T5.2.w6">scale</span><span> </span><span class="gd_word" id="S6.T5.2.w7">with</span><span> </span><span class="gd_word" id="S6.T5.2.w8">search</span><span> </span><span class="gd_word" id="S6.T5.2.w9">budget</span><span> </span><span class="gd_word" id="S6.T5.2.w10">(from</span><span> </span><span class="gd_word" id="S6.T5.2.w11">1</span><span> </span><span class="gd_word" id="S6.T5.2.w12">to</span><span> </span><span class="gd_word" id="S6.T5.2.w13">100</span><span> </span><span class="gd_word" id="S6.T5.2.w14">inferences</span><span> </span><span class="gd_word" id="S6.T5.2.w15">per</span><span> </span><span class="gd_word" id="S6.T5.2.w16">token)</span><span> </span><span class="gd_word" id="S6.T5.2.w17">on</span><span> </span><span class="gd_word" id="S6.T5.2.w18">MLBERTScore.</span></figcaption>
</figure>
<div id="S6.SS4.p1" class="ltx_para">
<p id="S6.SS4.p1.1" class="ltx_p"><span class="gd_word" id="S6.SS4.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w2">study</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w3">how</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w4">our</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w5">decoding</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w6">algorithms</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w7">scale</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w8">with</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w9">their</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w10">search</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w11">computational</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w12">budget.
We</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w13">report</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w14">results</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w15">on</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w16">MLBERTScore</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w17">in</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.1.w18">Table </span><a href="#S6.T5" title="Table 5 ‣ 6.4 Scaling search with computational budget ‣ 6 Experiments ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">5</a><span class="gd_word" id="S6.SS4.p1.1.2.w1"/><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w2">and</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w3">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w4">detailed</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w5">numbers</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w6">in</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.2.w7">Appendix </span><a href="#A3" title="Appendix C Scaling search with computational budget ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">C</a><span class="gd_word" id="S6.SS4.p1.1.3.w1">.
Our</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w2">findings</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w3">are</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w4">fairly</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w5">unsurprising:</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w6">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w7">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w8">quality</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w9">score</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w10">data</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w11">algorithms</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w12">can</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w13">leverage,</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w14">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w15">better</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w16">they</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w17">scale.
We</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w18">see</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w19">that</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w20">on</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w21">privileged</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w22">metrics</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w23">–</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w24">where</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w25">value</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w26">networks</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w27">are</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w28">hard</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w29">to</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w30">train</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w31">and</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w32">thus</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w33">quite</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w34">imperfect</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w35">–</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w36">performance</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w37">quickly</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w38">stops</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w39">increasing</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w40">with</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w41">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w42">computation</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w43">and</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w44">start</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w45">degrading</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w46">instead.
When</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w47">using</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w48">higher</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w49">quality</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w50">value</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w51">networks</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w52">(in</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w53">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w54">unprivileged</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w55">metrics</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w56">setup),</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w57">performance</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w58">increases</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w59">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w60">steadily</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w61">with</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w62">computation</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w63">(almost</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w64">everywhere),</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w65">plateauing</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w66">rather</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w67">than</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w68">degrading.
Finally,</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w69">when</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w70">accessing</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w71">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w72">score</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w73">directly</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w74">(for</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w75">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w76">ranking</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w77">approaches),</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w78">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w79">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w80">computation,</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w81">the</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w82">better</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w83">and</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w84">performance</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w85">keeps</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w86">increasing</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w87">with</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w88">more</span><span> </span><span class="gd_word" id="S6.SS4.p1.1.3.w89">inferences.</span></p>
</div>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Discussion</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p"><span class="gd_word" id="S7.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="S7.p1.1.1.w2">now</span><span> </span><span class="gd_word" id="S7.p1.1.1.w3">summarise</span><span> </span><span class="gd_word" id="S7.p1.1.1.w4">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w5">contextualise</span><span> </span><span class="gd_word" id="S7.p1.1.1.w6">our</span><span> </span><span class="gd_word" id="S7.p1.1.1.w7">findings,</span><span> </span><span class="gd_word" id="S7.p1.1.1.w8">and</span><span> </span><span class="gd_word" id="S7.p1.1.1.w9">discuss</span><span> </span><span class="gd_word" id="S7.p1.1.1.w10">potential</span><span> </span><span class="gd_word" id="S7.p1.1.1.w11">next</span><span> </span><span class="gd_word" id="S7.p1.1.1.w12">steps</span><span> </span><span class="gd_word" id="S7.p1.1.1.w13">for</span><span> </span><span class="gd_word" id="S7.p1.1.1.w14">optimising</span><span> </span><span class="gd_word" id="S7.p1.1.1.w15">relevant</span><span> </span><span class="gd_word" id="S7.p1.1.1.w16">MT</span><span> </span><span class="gd_word" id="S7.p1.1.1.w17">metrics.</span></p>
</div>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p"><span class="gd_word" id="S7.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="S7.p2.1.1.w2">main</span><span> </span><span class="gd_word" id="S7.p2.1.1.w3">takeaway</span><span> </span><span class="gd_word" id="S7.p2.1.1.w4">from</span><span> </span><span class="gd_word" id="S7.p2.1.1.w5">our</span><span> </span><span class="gd_word" id="S7.p2.1.1.w6">experiments</span><span> </span><span class="gd_word" id="S7.p2.1.1.w7">is</span><span> </span><span class="gd_word" id="S7.p2.1.1.w8">that</span><span> </span><span class="gd_word" id="S7.p2.1.1.w9">which</span><span> </span><span class="gd_word" id="S7.p2.1.1.w10">algorithm</span><span> </span><span class="gd_word" id="S7.p2.1.1.w11">is</span><span> </span><span class="gd_word" id="S7.p2.1.1.w12">best</span><span> </span><span class="gd_word" id="S7.p2.1.1.w13">depends</span><span> </span><span class="gd_word" id="S7.p2.1.1.w14">heavily</span><span> </span><span class="gd_word" id="S7.p2.1.1.w15">on</span><span> </span><span class="gd_word" id="S7.p2.1.1.w16">the</span><span> </span><span class="gd_word" id="S7.p2.1.1.w17">metric</span><span> </span><span class="gd_word" id="S7.p2.1.1.w18">to</span><span> </span><span class="gd_word" id="S7.p2.1.1.w19">optimise.
This</span><span> </span><span class="gd_word" id="S7.p2.1.1.w20">reinforces</span><span> </span><span class="gd_word" id="S7.p2.1.1.w21">the</span><span> </span><span class="gd_word" id="S7.p2.1.1.w22">notion</span><span> </span><span class="gd_word" id="S7.p2.1.1.w23">that</span><span> </span><span class="gd_word" id="S7.p2.1.1.w24">one</span><span> </span><span class="gd_word" id="S7.p2.1.1.w25">should</span><span> </span><span class="gd_word" id="S7.p2.1.1.w26">carefully</span><span> </span><span class="gd_word" id="S7.p2.1.1.w27">consider</span><span> </span><span class="gd_word" id="S7.p2.1.1.w28">when</span><span> </span><span class="gd_word" id="S7.p2.1.1.w29">picking</span><span> </span><span class="gd_word" id="S7.p2.1.1.w30">a</span><span> </span><span class="gd_word" id="S7.p2.1.1.w31">decoding</span><span> </span><span class="gd_word" id="S7.p2.1.1.w32">mechanism</span><span> </span><span class="gd_word" id="S7.p2.1.1.w33">for</span><span> </span><span class="gd_word" id="S7.p2.1.1.w34">a</span><span> </span><span class="gd_word" id="S7.p2.1.1.w35">machine</span><span> </span><span class="gd_word" id="S7.p2.1.1.w36">translation</span><span> </span><span class="gd_word" id="S7.p2.1.1.w37">pipeline,</span><span> </span><span class="gd_word" id="S7.p2.1.1.w38">rather</span><span> </span><span class="gd_word" id="S7.p2.1.1.w39">than</span><span> </span><span class="gd_word" id="S7.p2.1.1.w40">default</span><span> </span><span class="gd_word" id="S7.p2.1.1.w41">to</span><span> </span><span class="gd_word" id="S7.p2.1.1.w42">beam</span><span> </span><span class="gd_word" id="S7.p2.1.1.w43">search.</span></p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.1" class="ltx_p"><span class="gd_word" id="S7.p3.1.1.w1">Second,</span><span> </span><span class="gd_word" id="S7.p3.1.1.w2">we</span><span> </span><span class="gd_word" id="S7.p3.1.1.w3">find</span><span> </span><span class="gd_word" id="S7.p3.1.1.w4">that</span><span> </span><span class="gd_word" id="S7.p3.1.1.w5">optimising</span><span> </span><span class="gd_word" id="S7.p3.1.1.w6">privileged</span><span> </span><span class="gd_word" id="S7.p3.1.1.w7">metrics</span><span> </span><span class="gd_word" id="S7.p3.1.1.w8">(e.g.</span><span> </span><span class="gd_word" id="S7.p3.1.1.w9">BLEU)</span><span> </span><span class="gd_word" id="S7.p3.1.1.w10">via</span><span> </span><span class="gd_word" id="S7.p3.1.1.w11">a</span><span> </span><span class="gd_word" id="S7.p3.1.1.w12">value</span><span> </span><span class="gd_word" id="S7.p3.1.1.w13">function</span><span> </span><span class="gd_word" id="S7.p3.1.1.w14">is</span><span> </span><span class="gd_word" id="S7.p3.1.1.w15">surprisingly</span><span> </span><span class="gd_word" id="S7.p3.1.1.w16">hard.
While</span><span> </span><span class="gd_word" id="S7.p3.1.1.w17">distinguishing</span><span> </span><span class="gd_word" id="S7.p3.1.1.w18">large</span><span> </span><span class="gd_word" id="S7.p3.1.1.w19">gaps</span><span> </span><span class="gd_word" id="S7.p3.1.1.w20">in</span><span> </span><span class="gd_word" id="S7.p3.1.1.w21">quality</span><span> </span><span class="gd_word" id="S7.p3.1.1.w22">is</span><span> </span><span class="gd_word" id="S7.p3.1.1.w23">easier</span><span> </span><span class="gd_word" id="S7.p3.1.1.w24">than</span><span> </span><span class="gd_word" id="S7.p3.1.1.w25">modelling</span><span> </span><span class="gd_word" id="S7.p3.1.1.w26">the</span><span> </span><span class="gd_word" id="S7.p3.1.1.w27">policy,</span><span> </span><span class="gd_word" id="S7.p3.1.1.w28">discriminating</span><span> </span><span class="gd_word" id="S7.p3.1.1.w29">between</span><span> </span><span class="gd_word" id="S7.p3.1.1.w30">good</span><span> </span><span class="gd_word" id="S7.p3.1.1.w31">candidates</span><span> </span><span class="gd_word" id="S7.p3.1.1.w32">is</span><span> </span><span class="gd_word" id="S7.p3.1.1.w33">in</span><span> </span><span class="gd_word" id="S7.p3.1.1.w34">practice</span><span> </span><span class="gd_word" id="S7.p3.1.1.w35">as</span><span> </span><span class="gd_word" id="S7.p3.1.1.w36">hard</span><span> </span><span class="gd_word" id="S7.p3.1.1.w37">as</span><span> </span><span class="gd_word" id="S7.p3.1.1.w38">the</span><span> </span><span class="gd_word" id="S7.p3.1.1.w39">policy</span><span> </span><span class="gd_word" id="S7.p3.1.1.w40">problem,</span><span> </span><span class="gd_word" id="S7.p3.1.1.w41">since</span><span> </span><span class="gd_word" id="S7.p3.1.1.w42">a</span><span> </span><span class="gd_word" id="S7.p3.1.1.w43">first</span><span> </span><span class="gd_word" id="S7.p3.1.1.w44">step</span><span> </span><span class="gd_word" id="S7.p3.1.1.w45">required</span><span> </span><span class="gd_word" id="S7.p3.1.1.w46">step</span><span> </span><span class="gd_word" id="S7.p3.1.1.w47">is</span><span> </span><span class="gd_word" id="S7.p3.1.1.w48">to</span><span> </span><span class="gd_word" id="S7.p3.1.1.w49">estimating</span><span> </span><span class="gd_word" id="S7.p3.1.1.w50">the</span><span> </span><span class="gd_word" id="S7.p3.1.1.w51">ground</span><span> </span><span class="gd_word" id="S7.p3.1.1.w52">truth</span><span> </span><span class="gd_word" id="S7.p3.1.1.w53">sentence.
Indeed,</span><span> </span><span class="gd_word" id="S7.p3.1.1.w54">in</span><span> </span><span class="gd_word" id="S7.p3.1.1.w55">our</span><span> </span><span class="gd_word" id="S7.p3.1.1.w56">experiments</span><span> </span><span class="gd_word" id="S7.p3.1.1.w57">we</span><span> </span><span class="gd_word" id="S7.p3.1.1.w58">observe</span><span> </span><span class="gd_word" id="S7.p3.1.1.w59">relatively</span><span> </span><span class="gd_word" id="S7.p3.1.1.w60">low</span><span> </span><span class="gd_word" id="S7.p3.1.1.w61">quality</span><span> </span><span class="gd_word" id="S7.p3.1.1.w62">value</span><span> </span><span class="gd_word" id="S7.p3.1.1.w63">networks,</span><span> </span><span class="gd_word" id="S7.p3.1.1.w64">and</span><span> </span><span class="gd_word" id="S7.p3.1.1.w65">comparatively</span><span> </span><span class="gd_word" id="S7.p3.1.1.w66">little</span><span> </span><span class="gd_word" id="S7.p3.1.1.w67">improvements</span><span> </span><span class="gd_word" id="S7.p3.1.1.w68">with</span><span> </span><span class="gd_word" id="S7.p3.1.1.w69">value-based</span><span> </span><span class="gd_word" id="S7.p3.1.1.w70">decoding</span><span> </span><span class="gd_word" id="S7.p3.1.1.w71">methods</span><span> </span><span class="gd_word" id="S7.p3.1.1.w72">(especially</span><span> </span><span class="gd_word" id="S7.p3.1.1.w73">on</span><span> </span><span class="gd_word" id="S7.p3.1.1.w74">the</span><span> </span><span class="gd_word" id="S7.p3.1.1.w75">small</span><span> </span><span class="gd_word" id="S7.p3.1.1.w76">ENDE</span><span> </span><span class="gd_word" id="S7.p3.1.1.w77">dataset).
Using</span><span> </span><span class="gd_word" id="S7.p3.1.1.w78">a</span><span> </span><span class="gd_word" id="S7.p3.1.1.w79">value</span><span> </span><span class="gd_word" id="S7.p3.1.1.w80">function</span><span> </span><span class="gd_word" id="S7.p3.1.1.w81">to</span><span> </span><span class="gd_word" id="S7.p3.1.1.w82">optimise</span><span> </span><span class="gd_word" id="S7.p3.1.1.w83">unprivileged</span><span> </span><span class="gd_word" id="S7.p3.1.1.w84">metrics</span><span> </span><span class="gd_word" id="S7.p3.1.1.w85">is</span><span> </span><span class="gd_word" id="S7.p3.1.1.w86">more</span><span> </span><span class="gd_word" id="S7.p3.1.1.w87">promising.</span></p>
</div>
<div id="S7.p4" class="ltx_para">
<p id="S7.p4.1" class="ltx_p"><span class="gd_word" id="S7.p4.1.1.w1">Third,</span><span> </span><span class="gd_word" id="S7.p4.1.1.w2">we</span><span> </span><span class="gd_word" id="S7.p4.1.1.w3">show</span><span> </span><span class="gd_word" id="S7.p4.1.1.w4">that</span><span> </span><span class="gd_word" id="S7.p4.1.1.w5">MCTS</span><span> </span><span class="gd_word" id="S7.p4.1.1.w6">is</span><span> </span><span class="gd_word" id="S7.p4.1.1.w7">not</span><span> </span><span class="gd_word" id="S7.p4.1.1.w8">only</span><span> </span><span class="gd_word" id="S7.p4.1.1.w9">a</span><span> </span><span class="gd_word" id="S7.p4.1.1.w10">valid</span><span> </span><span class="gd_word" id="S7.p4.1.1.w11">way</span><span> </span><span class="gd_word" id="S7.p4.1.1.w12">of</span><span> </span><span class="gd_word" id="S7.p4.1.1.w13">decoding</span><span> </span><span class="gd_word" id="S7.p4.1.1.w14">for</span><span> </span><span class="gd_word" id="S7.p4.1.1.w15">machine</span><span> </span><span class="gd_word" id="S7.p4.1.1.w16">translation</span><span> </span><span class="gd_word" id="S7.p4.1.1.w17">tasks,</span><span> </span><span class="gd_word" id="S7.p4.1.1.w18">but</span><span> </span><span class="gd_word" id="S7.p4.1.1.w19">also</span><span> </span><span class="gd_word" id="S7.p4.1.1.w20">the</span><span> </span><span class="gd_word" id="S7.p4.1.1.w21">best</span><span> </span><span class="gd_word" id="S7.p4.1.1.w22">option</span><span> </span><span class="gd_word" id="S7.p4.1.1.w23">in</span><span> </span><span class="gd_word" id="S7.p4.1.1.w24">some</span><span> </span><span class="gd_word" id="S7.p4.1.1.w25">use</span><span> </span><span class="gd_word" id="S7.p4.1.1.w26">cases</span><span> </span><span class="gd_word" id="S7.p4.1.1.w27">(given</span><span> </span><span class="gd_word" id="S7.p4.1.1.w28">some</span><span> </span><span class="gd_word" id="S7.p4.1.1.w29">necessary</span><span> </span><span class="gd_word" id="S7.p4.1.1.w30">adjustments).
We</span><span> </span><span class="gd_word" id="S7.p4.1.1.w31">study</span><span> </span><span class="gd_word" id="S7.p4.1.1.w32">its</span><span> </span><span class="gd_word" id="S7.p4.1.1.w33">strengths</span><span> </span><span class="gd_word" id="S7.p4.1.1.w34">and</span><span> </span><span class="gd_word" id="S7.p4.1.1.w35">weaknesses,</span><span> </span><span class="gd_word" id="S7.p4.1.1.w36">and</span><span> </span><span class="gd_word" id="S7.p4.1.1.w37">demonstrate</span><span> </span><span class="gd_word" id="S7.p4.1.1.w38">that</span><span> </span><span class="gd_word" id="S7.p4.1.1.w39">its</span><span> </span><span class="gd_word" id="S7.p4.1.1.w40">performance</span><span> </span><span class="gd_word" id="S7.p4.1.1.w41">is</span><span> </span><span class="gd_word" id="S7.p4.1.1.w42">crucially</span><span> </span><span class="gd_word" id="S7.p4.1.1.w43">linked</span><span> </span><span class="gd_word" id="S7.p4.1.1.w44">to</span><span> </span><span class="gd_word" id="S7.p4.1.1.w45">the</span><span> </span><span class="gd_word" id="S7.p4.1.1.w46">ease</span><span> </span><span class="gd_word" id="S7.p4.1.1.w47">of</span><span> </span><span class="gd_word" id="S7.p4.1.1.w48">learning</span><span> </span><span class="gd_word" id="S7.p4.1.1.w49">a</span><span> </span><span class="gd_word" id="S7.p4.1.1.w50">good</span><span> </span><span class="gd_word" id="S7.p4.1.1.w51">value</span><span> </span><span class="gd_word" id="S7.p4.1.1.w52">function.
We</span><span> </span><span class="gd_word" id="S7.p4.1.1.w53">include</span><span> </span><span class="gd_word" id="S7.p4.1.1.w54">pseudo-code</span><span> </span><span class="gd_word" id="S7.p4.1.1.w55">for</span><span> </span><span class="gd_word" id="S7.p4.1.1.w56">an</span><span> </span><span class="gd_word" id="S7.p4.1.1.w57">easily</span><span> </span><span class="gd_word" id="S7.p4.1.1.w58">reproducible</span><span> </span><span class="gd_word" id="S7.p4.1.1.w59">Numpy</span><span> </span><span class="gd_word" id="S7.p4.1.1.w60">implementation</span><span> </span><span class="gd_word" id="S7.p4.1.1.w61">in</span><span> </span><span class="gd_word" id="S7.p4.1.1.w62">Appendix </span><a href="#A6" title="Appendix F Batched Numpy-friendly MCTS ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">F</a><span class="gd_word" id="S7.p4.1.2.w1">.
All</span><span> </span><span class="gd_word" id="S7.p4.1.2.w2">told,</span><span> </span><span class="gd_word" id="S7.p4.1.2.w3">we</span><span> </span><span class="gd_word" id="S7.p4.1.2.w4">provide</span><span> </span><span class="gd_word" id="S7.p4.1.2.w5">a</span><span> </span><span class="gd_word" id="S7.p4.1.2.w6">blueprint</span><span> </span><span class="gd_word" id="S7.p4.1.2.w7">for</span><span> </span><span class="gd_word" id="S7.p4.1.2.w8">how</span><span> </span><span class="gd_word" id="S7.p4.1.2.w9">to</span><span> </span><span class="gd_word" id="S7.p4.1.2.w10">use</span><span> </span><span class="gd_word" id="S7.p4.1.2.w11">MCTS</span><span> </span><span class="gd_word" id="S7.p4.1.2.w12">efficiently</span><span> </span><span class="gd_word" id="S7.p4.1.2.w13">in</span><span> </span><span class="gd_word" id="S7.p4.1.2.w14">NLP</span><span> </span><span class="gd_word" id="S7.p4.1.2.w15">with</span><span> </span><span class="gd_word" id="S7.p4.1.2.w16">state-of-the-art</span><span> </span><span class="gd_word" id="S7.p4.1.2.w17">transformer</span><span> </span><span class="gd_word" id="S7.p4.1.2.w18">models.</span></p>
</div>
<div id="S7.p5" class="ltx_para">
<p id="S7.p5.1" class="ltx_p"><span class="gd_word" id="S7.p5.1.1.w1">Finally</span><span> </span><span class="gd_word" id="S7.p5.1.1.w2">and</span><span> </span><span class="gd_word" id="S7.p5.1.1.w3">somewhat</span><span> </span><span class="gd_word" id="S7.p5.1.1.w4">surprisingly,</span><span> </span><span class="gd_word" id="S7.p5.1.1.w5">we</span><span> </span><span class="gd_word" id="S7.p5.1.1.w6">find</span><span> </span><span class="gd_word" id="S7.p5.1.1.w7">that</span><span> </span><span class="gd_word" id="S7.p5.1.1.w8">whenever</span><span> </span><span class="gd_word" id="S7.p5.1.1.w9">access</span><span> </span><span class="gd_word" id="S7.p5.1.1.w10">to</span><span> </span><span class="gd_word" id="S7.p5.1.1.w11">the</span><span> </span><span class="gd_word" id="S7.p5.1.1.w12">score</span><span> </span><span class="gd_word" id="S7.p5.1.1.w13">is</span><span> </span><span class="gd_word" id="S7.p5.1.1.w14">possible,</span><span> </span><span class="gd_word" id="S7.p5.1.1.w15">the</span><span> </span><span class="gd_word" id="S7.p5.1.1.w16">deceivingly</span><span> </span><span class="gd_word" id="S7.p5.1.1.w17">simple</span><span> </span><span class="gd_word" id="S7.p5.1.1.w18">S+R</span><span> </span><span class="gd_word" id="S7.p5.1.1.w19">method</span><span> </span><span class="gd_word" id="S7.p5.1.1.w20">performs</span><span> </span><span class="gd_word" id="S7.p5.1.1.w21">well.
More</span><span> </span><span class="gd_word" id="S7.p5.1.1.w22">experimentation</span><span> </span><span class="gd_word" id="S7.p5.1.1.w23">is</span><span> </span><span class="gd_word" id="S7.p5.1.1.w24">required</span><span> </span><span class="gd_word" id="S7.p5.1.1.w25">to</span><span> </span><span class="gd_word" id="S7.p5.1.1.w26">understand</span><span> </span><span class="gd_word" id="S7.p5.1.1.w27">why;</span><span> </span><span class="gd_word" id="S7.p5.1.1.w28">but</span><span> </span><span class="gd_word" id="S7.p5.1.1.w29">at</span><span> </span><span class="gd_word" id="S7.p5.1.1.w30">any</span><span> </span><span class="gd_word" id="S7.p5.1.1.w31">rate,</span><span> </span><span class="gd_word" id="S7.p5.1.1.w32">it</span><span> </span><span class="gd_word" id="S7.p5.1.1.w33">should</span><span> </span><span class="gd_word" id="S7.p5.1.1.w34">be</span><span> </span><span class="gd_word" id="S7.p5.1.1.w35">a</span><span> </span><span class="gd_word" id="S7.p5.1.1.w36">strong</span><span> </span><span class="gd_word" id="S7.p5.1.1.w37">contender</span><span> </span><span class="gd_word" id="S7.p5.1.1.w38">in</span><span> </span><span class="gd_word" id="S7.p5.1.1.w39">this</span><span> </span><span class="gd_word" id="S7.p5.1.1.w40">specific</span><span> </span><span class="gd_word" id="S7.p5.1.1.w41">setup.</span></p>
</div>
<div id="S7.p6" class="ltx_para ltx_noindent">
<p id="S7.p6.1" class="ltx_p"><span class="gd_word" id="S7.p6.1.1.w1">Future</span><span> </span><span class="gd_word" id="S7.p6.1.1.w2">directions.
We</span><span> </span><span class="gd_word" id="S7.p6.1.1.w3">have</span><span> </span><span class="gd_word" id="S7.p6.1.1.w4">shown</span><span> </span><span class="gd_word" id="S7.p6.1.1.w5">that</span><span> </span><span class="gd_word" id="S7.p6.1.1.w6">optimising</span><span> </span><span class="gd_word" id="S7.p6.1.1.w7">for</span><span> </span><span class="gd_word" id="S7.p6.1.1.w8">unprivileged</span><span> </span><span class="gd_word" id="S7.p6.1.1.w9">metrics</span><span> </span><span class="gd_word" id="S7.p6.1.1.w10">is</span><span> </span><span class="gd_word" id="S7.p6.1.1.w11">easier</span><span> </span><span class="gd_word" id="S7.p6.1.1.w12">than</span><span> </span><span class="gd_word" id="S7.p6.1.1.w13">for</span><span> </span><span class="gd_word" id="S7.p6.1.1.w14">privileged</span><span> </span><span class="gd_word" id="S7.p6.1.1.w15">ones.
The</span><span> </span><span class="gd_word" id="S7.p6.1.1.w16">ultimate</span><span> </span><span class="gd_word" id="S7.p6.1.1.w17">unprivileged</span><span> </span><span class="gd_word" id="S7.p6.1.1.w18">metric</span><span> </span><span class="gd_word" id="S7.p6.1.1.w19">for</span><span> </span><span class="gd_word" id="S7.p6.1.1.w20">machine</span><span> </span><span class="gd_word" id="S7.p6.1.1.w21">translation</span><span> </span><span class="gd_word" id="S7.p6.1.1.w22">is</span><span> </span><span class="gd_word" id="S7.p6.1.1.w23">human</span><span> </span><span class="gd_word" id="S7.p6.1.1.w24">translation</span><span> </span><span class="gd_word" id="S7.p6.1.1.w25">assessment.
Thus</span><span> </span><span class="gd_word" id="S7.p6.1.1.w26">it</span><span> </span><span class="gd_word" id="S7.p6.1.1.w27">seems</span><span> </span><span class="gd_word" id="S7.p6.1.1.w28">natural</span><span> </span><span class="gd_word" id="S7.p6.1.1.w29">to</span><span> </span><span class="gd_word" id="S7.p6.1.1.w30">consider</span><span> </span><span class="gd_word" id="S7.p6.1.1.w31">training</span><span> </span><span class="gd_word" id="S7.p6.1.1.w32">a</span><span> </span><span class="gd_word" id="S7.p6.1.1.w33">score</span><span> </span><span class="gd_word" id="S7.p6.1.1.w34">directly</span><span> </span><span class="gd_word" id="S7.p6.1.1.w35">from</span><span> </span><span class="gd_word" id="S7.p6.1.1.w36">human</span><span> </span><span class="gd_word" id="S7.p6.1.1.w37">evaluation</span><span> </span><span class="gd_word" id="S7.p6.1.1.w38">of</span><span> </span><span class="gd_word" id="S7.p6.1.1.w39">translation</span><span> </span><span class="gd_word" id="S7.p6.1.1.w40">pairs,</span><span> </span><span class="gd_word" id="S7.p6.1.1.w41">and</span><span> </span><span class="gd_word" id="S7.p6.1.1.w42">to</span><span> </span><span class="gd_word" id="S7.p6.1.1.w43">later</span><span> </span><span class="gd_word" id="S7.p6.1.1.w44">focus</span><span> </span><span class="gd_word" id="S7.p6.1.1.w45">on</span><span> </span><span class="gd_word" id="S7.p6.1.1.w46">optimising</span><span> </span><span class="gd_word" id="S7.p6.1.1.w47">it</span><span> </span><span class="gd_word" id="S7.p6.1.1.w48">via</span><span> </span><span class="gd_word" id="S7.p6.1.1.w49">MCTS.</span></p>
</div>
<div id="S7.p7" class="ltx_para">
<p id="S7.p7.1" class="ltx_p"><span class="gd_word" id="S7.p7.1.1.w1">Another</span><span> </span><span class="gd_word" id="S7.p7.1.1.w2">natural</span><span> </span><span class="gd_word" id="S7.p7.1.1.w3">extension</span><span> </span><span class="gd_word" id="S7.p7.1.1.w4">is</span><span> </span><span class="gd_word" id="S7.p7.1.1.w5">a</span><span> </span><span class="gd_word" id="S7.p7.1.1.w6">full-blown</span><span> </span><span class="gd_word" id="S7.p7.1.1.w7">RL</span><span> </span><span class="gd_word" id="S7.p7.1.1.w8">algorithm;</span><span> </span><span class="gd_word" id="S7.p7.1.1.w9">iteratively</span><span> </span><span class="gd_word" id="S7.p7.1.1.w10">improving</span><span> </span><span class="gd_word" id="S7.p7.1.1.w11">policies</span><span> </span><span class="gd_word" id="S7.p7.1.1.w12">via</span><span> </span><span class="gd_word" id="S7.p7.1.1.w13">value-guided</span><span> </span><span class="gd_word" id="S7.p7.1.1.w14">search</span><span> </span><span class="gd_word" id="S7.p7.1.1.w15">and</span><span> </span><span class="gd_word" id="S7.p7.1.1.w16">training</span><span> </span><span class="gd_word" id="S7.p7.1.1.w17">value</span><span> </span><span class="gd_word" id="S7.p7.1.1.w18">functions</span><span> </span><span class="gd_word" id="S7.p7.1.1.w19">on</span><span> </span><span class="gd_word" id="S7.p7.1.1.w20">search-improved</span><span> </span><span class="gd_word" id="S7.p7.1.1.w21">policies,</span><span> </span><span class="gd_word" id="S7.p7.1.1.w22">getting</span><span> </span><span class="gd_word" id="S7.p7.1.1.w23">closer</span><span> </span><span class="gd_word" id="S7.p7.1.1.w24">to</span><span> </span><span class="gd_word" id="S7.p7.1.1.w25">the</span><span> </span><span class="gd_word" id="S7.p7.1.1.w26">optimal</span><span> </span><span class="gd_word" id="S7.p7.1.1.w27">policy</span><span> </span><span class="gd_word" id="S7.p7.1.1.w28">and</span><span> </span><span class="gd_word" id="S7.p7.1.1.w29">value</span><span> </span><span class="gd_word" id="S7.p7.1.1.w30">at</span><span> </span><span class="gd_word" id="S7.p7.1.1.w31">each</span><span> </span><span class="gd_word" id="S7.p7.1.1.w32">step.</span></p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p"><span class="gd_word" id="Sx1.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w2">want</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w3">to</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w4">thank</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w5">our</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w6">colleagues</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w7">David</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w8">Silver,</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w9">Chris</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w10">Dyer,</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w11">Wang</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w12">Ling,</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w13">Julian</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w14">Schrittwieser</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w15">and</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w16">Thomas</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w17">Hubert</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w18">for</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w19">fruitful</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w20">conversations,</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w21">guidance,</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w22">contributions</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w23">to</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w24">the</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w25">paper</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w26">and</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w27">help</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w28">with</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w29">technical</span><span> </span><span class="gd_word" id="Sx1.p1.1.1.w30">support.</span></p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ackley et al. (1985)</span>
<span class="ltx_bibblock">
Ackley, D. H., Hinton, G. E., and Sejnowski, T. J.

</span>
<span class="ltx_bibblock">A learning algorithm for boltzmann machines.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Cognitive Science</em>, 1985.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bahdanau et al. (2017)</span>
<span class="ltx_bibblock">
Bahdanau, D., Brakel, P., Xu, K., Goyal, A., Lowe, R., Pineau, J., Courville,
A., and Bengio, Y.

</span>
<span class="ltx_bibblock"><a href="https://openreview.net/forum?id=SJDaqqveg" title="" class="ltx_ref ltx_href">An Actor-Critic
Algorithm for Sequence Prediction</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib2.1.1.m1.1" class="ltx_Math" alttext="5^{th}" display="inline"><semantics id="bib.bib2.1.1.m1.1a"><msup id="bib.bib2.1.1.m1.1.1" xref="bib.bib2.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib2.1.1.m1.1.1.2" xref="bib.bib2.1.1.m1.1.1.2.cmml">5</mn><mrow id="bib.bib2.1.1.m1.1.1.3" xref="bib.bib2.1.1.m1.1.1.3.cmml"><mtext id="bib.bib2.1.1.m1.1.1.3.2" xref="bib.bib2.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2017.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bengio et al. (2015)</span>
<span class="ltx_bibblock">
Bengio, S., Vinyals, O., Jaitly, N., and Shazeer, N.

</span>
<span class="ltx_bibblock"><a href="https://papers.nips.cc/paper/5956-scheduled-sampling-for-sequence-prediction-with-recurrent-neural-networks" title="" class="ltx_ref ltx_href">Scheduled
Sampling for Sequence Prediction with Recurrent Neural Networks</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 28
(NIPS)</em>, 2015.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bhattacharyya et al. (2021)</span>
<span class="ltx_bibblock">
Bhattacharyya, S., Rooshenas, A., Naskar, S., Sun, S., Iyyer, M., and McCallum,
A.

</span>
<span class="ltx_bibblock">Energy-based reranking: Improving neural machine translation using
energy-based models.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Browne et al. (2012)</span>
<span class="ltx_bibblock">
Browne, C., Powley, E., Whitehouse, D., Lucas, S., Cowling, P., Rohlfshagen,
P., Tavener, S., Perez Liebana, D., Samothrakis, S., and Colton, S.

</span>
<span class="ltx_bibblock">A survey of monte carlo tree search methods.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Computational Intelligence and AI in
Games</em>, 2012.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choshen et al. (2019)</span>
<span class="ltx_bibblock">
Choshen, L., Fox, L., Aizenbud, Z., and Abend, O.

</span>
<span class="ltx_bibblock">On the weaknesses of reinforcement learning for neural machine
translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib6.1.1.m1.1" class="ltx_Math" alttext="8^{th}" display="inline"><semantics id="bib.bib6.1.1.m1.1a"><msup id="bib.bib6.1.1.m1.1.1" xref="bib.bib6.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib6.1.1.m1.1.1.2" xref="bib.bib6.1.1.m1.1.1.2.cmml">8</mn><mrow id="bib.bib6.1.1.m1.1.1.3" xref="bib.bib6.1.1.m1.1.1.3.cmml"><mtext id="bib.bib6.1.1.m1.1.1.3.2" xref="bib.bib6.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cohen &amp; Beck (2019)</span>
<span class="ltx_bibblock">
Cohen, E. and Beck, J. C.

</span>
<span class="ltx_bibblock">Empirical analysis of beam search performance degradation in neural
sequence models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib7.1.1.m1.1" class="ltx_Math" alttext="36^{th}" display="inline"><semantics id="bib.bib7.1.1.m1.1a"><msup id="bib.bib7.1.1.m1.1.1" xref="bib.bib7.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib7.1.1.m1.1.1.2" xref="bib.bib7.1.1.m1.1.1.2.cmml">36</mn><mrow id="bib.bib7.1.1.m1.1.1.3" xref="bib.bib7.1.1.m1.1.1.3.cmml"><mtext id="bib.bib7.1.1.m1.1.1.3.2" xref="bib.bib7.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Machine Learning (ICML)</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Collobert et al. (2019)</span>
<span class="ltx_bibblock">
Collobert, R., Hannun, A., and Synnaeve, G.

</span>
<span class="ltx_bibblock">A fully differentiable beam search decoder.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib8.1.1.m1.1" class="ltx_Math" alttext="36^{th}" display="inline"><semantics id="bib.bib8.1.1.m1.1a"><msup id="bib.bib8.1.1.m1.1.1" xref="bib.bib8.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib8.1.1.m1.1.1.2" xref="bib.bib8.1.1.m1.1.1.2.cmml">36</mn><mrow id="bib.bib8.1.1.m1.1.1.3" xref="bib.bib8.1.1.m1.1.1.3.cmml"><mtext id="bib.bib8.1.1.m1.1.1.3.2" xref="bib.bib8.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Machine Learning (ICML)</em>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Coulom (2006)</span>
<span class="ltx_bibblock">
Coulom, R.

</span>
<span class="ltx_bibblock">Efficient selectivity and backup operators in monte-carlo tree
search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib9.1.1.m1.1" class="ltx_Math" alttext="5^{th}" display="inline"><semantics id="bib.bib9.1.1.m1.1a"><msup id="bib.bib9.1.1.m1.1.1" xref="bib.bib9.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib9.1.1.m1.1.1.2" xref="bib.bib9.1.1.m1.1.1.2.cmml">5</mn><mrow id="bib.bib9.1.1.m1.1.1.3" xref="bib.bib9.1.1.m1.1.1.3.cmml"><mtext id="bib.bib9.1.1.m1.1.1.3.2" xref="bib.bib9.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Computers and Games (ICCG)</em>, 2006.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Denkowski &amp; Lavie (2014)</span>
<span class="ltx_bibblock">
Denkowski, M. and Lavie, A.

</span>
<span class="ltx_bibblock">Meteor universal: Language specific translation evaluation for any
target language.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the EACL 2014 Workshop on Statistical Machine
Translation</em>, 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. (2019)</span>
<span class="ltx_bibblock">
Devlin, J., Chang, M.-W., Lee, K., and Toutanova, K.

</span>
<span class="ltx_bibblock">BERT: Pre-training of deep bidirectional transformers for language
understanding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference of the North American
Chapter of the Association for Computational Linguistics</em>, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edunov et al. (2018)</span>
<span class="ltx_bibblock">
Edunov, S., Ott, M., Auli, M., Grangier, D., and Ranzato, M.

</span>
<span class="ltx_bibblock"><a href="http://aclweb.org/anthology/N18-1033" title="" class="ltx_ref ltx_href">Classical structured
prediction losses for sequence to sequence learning</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2018 Conference of the North American
Chapter of the Association for Computational Linguistics (NAACL)</em>, 2018.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eikema &amp; Aziz (2020)</span>
<span class="ltx_bibblock">
Eikema, B. and Aziz, W.

</span>
<span class="ltx_bibblock">Is map decoding all you need? the inadequacy of the mode in neural
machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2005.10283, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fan et al. (2018)</span>
<span class="ltx_bibblock">
Fan, A., Lewis, M., and Dauphin, Y.

</span>
<span class="ltx_bibblock">Hierarchical neural story generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 56th Annual Meeting of the Association
for Computational Linguistics (Volume 1: Long Papers)</em>, 2018.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al. (2018)</span>
<span class="ltx_bibblock">
Gu, J., Bradbury, J., Xiong, C., Li, V. O., , and Socher, R.

</span>
<span class="ltx_bibblock">Non-autoregressive neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib15.1.1.m1.1" class="ltx_Math" alttext="6^{th}" display="inline"><semantics id="bib.bib15.1.1.m1.1a"><msup id="bib.bib15.1.1.m1.1.1" xref="bib.bib15.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib15.1.1.m1.1.1.2" xref="bib.bib15.1.1.m1.1.1.2.cmml">6</mn><mrow id="bib.bib15.1.1.m1.1.1.3" xref="bib.bib15.1.1.m1.1.1.3.cmml"><mtext id="bib.bib15.1.1.m1.1.1.3.2" xref="bib.bib15.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gumbel (1954)</span>
<span class="ltx_bibblock">
Gumbel, E. J.

</span>
<span class="ltx_bibblock">Statistical theory of extreme values and some practical applications:
a series of lectures, 1954.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Harris et al. (2020)</span>
<span class="ltx_bibblock">
Harris, C. R., Millman, K. J., van der Walt, S. J., Gommers, R., Virtanen, P.,
Cournapeau, D., Wieser, E., Taylor, J., Berg, S., Smith, N. J., Kern, R.,
Picus, M., Hoyer, S., van Kerkwijk, M. H., Brett, M., Haldane, A., del
R’ıo, J. F., Wiebe, M., Peterson, P., G’erard-Marchant, P.,
Sheppard, K., Reddy, T., Weckesser, W., Abbasi, H., Gohlke, C., and Oliphant,
T. E.

</span>
<span class="ltx_bibblock">Array programming with NumPy.

</span>
<span class="ltx_bibblock"><em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Nature</em>, September 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2017)</span>
<span class="ltx_bibblock">
He, D., Lu, H., Xia, Y., Qin, T., Wang, L., and Liu, T.-Y.

</span>
<span class="ltx_bibblock">Decoding with value networks for neural machine translation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Holtzman et al. (2019)</span>
<span class="ltx_bibblock">
Holtzman, A., Buys, J., Du, L., Forbes, M., and Choi, Y.

</span>
<span class="ltx_bibblock">The curious case of neural text degeneration.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib19.1.1.m1.1" class="ltx_Math" alttext="7^{th}" display="inline"><semantics id="bib.bib19.1.1.m1.1a"><msup id="bib.bib19.1.1.m1.1.1" xref="bib.bib19.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib19.1.1.m1.1.1.2" xref="bib.bib19.1.1.m1.1.1.2.cmml">7</mn><mrow id="bib.bib19.1.1.m1.1.1.3" xref="bib.bib19.1.1.m1.1.1.3.cmml"><mtext id="bib.bib19.1.1.m1.1.1.3.2" xref="bib.bib19.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2015)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">3rd International Conference on Learning Representations,
ICLR 2015, San Diego, CA, USA, May 7-9, 2015, Conference Track
Proceedings</em>, 2015.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kocsis &amp; Szepesvári (2006)</span>
<span class="ltx_bibblock">
Kocsis, L. and Szepesvári, C.

</span>
<span class="ltx_bibblock">Bandit based monte-carlo planning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib21.1.1.m1.1" class="ltx_Math" alttext="15^{th}" display="inline"><semantics id="bib.bib21.1.1.m1.1a"><msup id="bib.bib21.1.1.m1.1.1" xref="bib.bib21.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib21.1.1.m1.1.1.2" xref="bib.bib21.1.1.m1.1.1.2.cmml">15</mn><mrow id="bib.bib21.1.1.m1.1.1.3" xref="bib.bib21.1.1.m1.1.1.3.cmml"><mtext id="bib.bib21.1.1.m1.1.1.3.2" xref="bib.bib21.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> European Conference on Machine
Learning (ECML)</em>, 2006.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kool et al. (2019)</span>
<span class="ltx_bibblock">
Kool, W., Van Hoof, H., and Welling, M.

</span>
<span class="ltx_bibblock">Stochastic beams and where to find them: The Gumbel-top-k trick for
sampling sequences without replacement.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib22.1.1.m1.1" class="ltx_Math" alttext="36^{th}" display="inline"><semantics id="bib.bib22.1.1.m1.1a"><msup id="bib.bib22.1.1.m1.1.1" xref="bib.bib22.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib22.1.1.m1.1.1.2" xref="bib.bib22.1.1.m1.1.1.2.cmml">36</mn><mrow id="bib.bib22.1.1.m1.1.1.3" xref="bib.bib22.1.1.m1.1.1.3.cmml"><mtext id="bib.bib22.1.1.m1.1.1.3.2" xref="bib.bib22.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Machine Learning (ICML)</em>, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Leblond et al. (2018)</span>
<span class="ltx_bibblock">
Leblond, R., Alayrac, J.-B., Osokin, A., and Lacoste-Julien, S.

</span>
<span class="ltx_bibblock"><a href="https://openreview.net/forum?id=HkUR_y-RZ" title="" class="ltx_ref ltx_href">searnn:
training rnns with global-local losses</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib23.1.1.m1.1" class="ltx_Math" alttext="6^{th}" display="inline"><semantics id="bib.bib23.1.1.m1.1a"><msup id="bib.bib23.1.1.m1.1.1" xref="bib.bib23.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib23.1.1.m1.1.1.2" xref="bib.bib23.1.1.m1.1.1.2.cmml">6</mn><mrow id="bib.bib23.1.1.m1.1.1.3" xref="bib.bib23.1.1.m1.1.1.3.cmml"><mtext id="bib.bib23.1.1.m1.1.1.3.2" xref="bib.bib23.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2018.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Martins et al. (2017)</span>
<span class="ltx_bibblock">
Martins, A. F. T., Junczys-Dowmunt, M., Kepler, F. N., Astudillo, R., Hokamp,
C., and Grundkiewicz, R.

</span>
<span class="ltx_bibblock">Pushing the limits of translation quality estimation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
2017.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meister et al. (2020a)</span>
<span class="ltx_bibblock">
Meister, C., Cotterell, R., and Vieira, T.

</span>
<span class="ltx_bibblock">If beam search is the answer, what was the question?

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 Conference on Empirical Methods in
Natural Language Processing (EMNLP)</em>, pp.  2173–2185. Association for
Computational Linguistics, November 2020a.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meister et al. (2020b)</span>
<span class="ltx_bibblock">
Meister, C., Vieira, T., and Cotterell, R.

</span>
<span class="ltx_bibblock">Best-first beam search.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">Transactions of the Association for Computational Linguistics</em>,
2020b.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Norouzi et al. (2016)</span>
<span class="ltx_bibblock">
Norouzi, M., Bengio, S., Chen, Z., Jaitly, N., Schuster, M., Wu, Y., and
Schuurmans, D.

</span>
<span class="ltx_bibblock"><a href="https://papers.nips.cc/paper/6547-reward-augmented-maximum-likelihood-for-neural-structured-prediction" title="" class="ltx_ref ltx_href">Reward
Augmented Maximum Likelihood for Neural Structured Prediction</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems 29
(NIPS)</em>, 2016.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Papineni, K., Roukos, S., Ward, T., and Zhu, W.-J.

</span>
<span class="ltx_bibblock"><a href="https://www.aclweb.org/anthology/P02-1040.pdf" title="" class="ltx_ref ltx_href">Bleu: a method
for automatic evaluation of machine translation</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib28.1.1.m1.1" class="ltx_Math" alttext="40^{th}" display="inline"><semantics id="bib.bib28.1.1.m1.1a"><msup id="bib.bib28.1.1.m1.1.1" xref="bib.bib28.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib28.1.1.m1.1.1.2" xref="bib.bib28.1.1.m1.1.1.2.cmml">40</mn><mrow id="bib.bib28.1.1.m1.1.1.3" xref="bib.bib28.1.1.m1.1.1.3.cmml"><mtext id="bib.bib28.1.1.m1.1.1.3.2" xref="bib.bib28.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> Annual Meeting of the
Association for Computational Linguistics (ACL)</em>, 2002.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ranzato et al. (2016)</span>
<span class="ltx_bibblock">
Ranzato, M., Chopra, S., Auli, M., and Zaremba, W.

</span>
<span class="ltx_bibblock"><a href="https://arxiv.org/abs/1511.06732" title="" class="ltx_ref ltx_href">Sequence Level Training with
Recurrent Neural Networks</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib29.1.1.m1.1" class="ltx_Math" alttext="5^{th}" display="inline"><semantics id="bib.bib29.1.1.m1.1a"><msup id="bib.bib29.1.1.m1.1.1" xref="bib.bib29.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib29.1.1.m1.1.1.2" xref="bib.bib29.1.1.m1.1.1.2.cmml">5</mn><mrow id="bib.bib29.1.1.m1.1.1.3" xref="bib.bib29.1.1.m1.1.1.3.cmml"><mtext id="bib.bib29.1.1.m1.1.1.3.2" xref="bib.bib29.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2016.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddy (1977)</span>
<span class="ltx_bibblock">
Reddy, R.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">Speech understanding systems: A summary of results of the
five-year research effort</em>.

</span>
<span class="ltx_bibblock">Carnegie Mellon University, 1977.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al. (2017)</span>
<span class="ltx_bibblock">
Ren, Z., Wang, X., Zhang, N., Lv, X., and Li, L.

</span>
<span class="ltx_bibblock">Deep reinforcement learning-based image captioning with embedding
reward.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">2017 IEEE Conference on Computer Vision and Pattern
Recognition (CVPR)</em>, 2017.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schrittwieser et al. (2020)</span>
<span class="ltx_bibblock">
Schrittwieser, J., Antonoglou, I., Hubert, T., Simonyan, K., Sifre, L.,
Schmitt, S., Guez, A., Lockhart, E., Hassabis, D., Graepel, T., Lillicrap,
T., and Silver, D.

</span>
<span class="ltx_bibblock">Mastering atari, go, chess and shogi by planning with a learned
model.

</span>
<span class="ltx_bibblock"><em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 2020.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shazeer (2019)</span>
<span class="ltx_bibblock">
Shazeer, N.

</span>
<span class="ltx_bibblock">Fast transformer decoding: One write-head is all you need.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, abs/1911.02150, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shen et al. (2016)</span>
<span class="ltx_bibblock">
Shen, S., Cheng, Y., He, Z., He, W., Wu, H., Sun, M., and Liu, Y.

</span>
<span class="ltx_bibblock"><a href="http://www.aclweb.org/anthology/P16-1159" title="" class="ltx_ref ltx_href">Minimum Risk Training
for Neural Machine Translation</a>.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib34.1.1.m1.1" class="ltx_Math" alttext="53^{rd}" display="inline"><semantics id="bib.bib34.1.1.m1.1a"><msup id="bib.bib34.1.1.m1.1.1" xref="bib.bib34.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib34.1.1.m1.1.1.2" xref="bib.bib34.1.1.m1.1.1.2.cmml">53</mn><mrow id="bib.bib34.1.1.m1.1.1.3" xref="bib.bib34.1.1.m1.1.1.3.cmml"><mtext id="bib.bib34.1.1.m1.1.1.3.2" xref="bib.bib34.1.1.m1.1.1.3.2.cmml">rd</mtext></mrow></msup></semantics></math> Annual Meeting of the
Association for Computational Linguistics (ACL)</em>, 2016.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Silver et al. (2017)</span>
<span class="ltx_bibblock">
Silver, D., Schrittwieser Julian, Simonyan Karen, Antonoglou Ioannis,
Huang Aja, Guez Arthur, Hubert Thomas, Baker Lucas, Lai Matthew,
Bolton Adrian, Chen Yutian, Lillicrap Timothy, Hui Fan, Sifre
Laurent, van den Driessche George, Graepel Thore, and Hassabis Demis.

</span>
<span class="ltx_bibblock"><a href="http://dx.doi.org/10.1038/nature24270" title="" class="ltx_ref ltx_href">Mastering the game of Go
without human knowledge</a>.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">Nature</em>, 2017.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Specia et al. (2018)</span>
<span class="ltx_bibblock">
Specia, L., Scarton, C., and Paetzold, G. H.

</span>
<span class="ltx_bibblock">Quality estimation for machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Synthesis Lectures on Human Language Technologies</em>, 2018.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stahlberg &amp; Byrne (2019)</span>
<span class="ltx_bibblock">
Stahlberg, F. and Byrne, B.

</span>
<span class="ltx_bibblock">On NMT search errors and model errors: Cat got your tongue?

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2019 Conference on Empirical Methods in
Natural Language Processing and the 9th International Joint Conference on
Natural Language Processing (EMNLP-IJCNLP)</em>, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al. (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N.,
Kaiser, L. u., and Polosukhin, I.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2017.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2020)</span>
<span class="ltx_bibblock">
Wang, Y.-S., Kuo, Y.-L., and Katz, B.

</span>
<span class="ltx_bibblock">Investigating the decoders of maximum likelihood sequence models: A
look-ahead approach.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">ArXiv</em>, abs/2003.03716, 2020.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welleck et al. (2019)</span>
<span class="ltx_bibblock">
Welleck, S., Brantley, K., Daumé, III, H., and Cho, K.

</span>
<span class="ltx_bibblock">Non-monotonic sequential text generation.

</span>
<span class="ltx_bibblock">In <em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib40.1.1.m1.1" class="ltx_Math" alttext="36^{th}" display="inline"><semantics id="bib.bib40.1.1.m1.1a"><msup id="bib.bib40.1.1.m1.1.1" xref="bib.bib40.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib40.1.1.m1.1.1.2" xref="bib.bib40.1.1.m1.1.1.2.cmml">36</mn><mrow id="bib.bib40.1.1.m1.1.1.3" xref="bib.bib40.1.1.m1.1.1.3.cmml"><mtext id="bib.bib40.1.1.m1.1.1.3.2" xref="bib.bib40.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Machine Learning (ICML)</em>, 2019.

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Welleck et al. (2020)</span>
<span class="ltx_bibblock">
Welleck, S., Kulikov, I., Kim, J., Pang, R. Y., and Cho, K.

</span>
<span class="ltx_bibblock">Consistency of a recurrent language model with respect to incomplete
decoding.

</span>
<span class="ltx_bibblock">In <em id="bib.bib41.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 2020 Conference on Empirical Methods in
Natural Language Processing (EMNLP)</em>, 2020.

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. (2016)</span>
<span class="ltx_bibblock">
Wu, Y., Schuster, M., Chen, Z., Le, Q. V., Norouzi, M., Macherey, W., Krikun,
M., Cao, Y., Gao, Q., Macherey, K., Klingner, J., Shah, A., Johnson, M., Liu,
X., Kaiser, L., Gouws, S., Kato, Y., Kudo, T., Kazawa, H., Stevens, K.,
Kurian, G., Patil, N., Wang, W., Young, C., Smith, J., Riesa, J., Rudnick,
A., Vinyals, O., Corrado, G., Hughes, M., and Dean, J.

</span>
<span class="ltx_bibblock">Google’s neural machine translation system: Bridging the gap between
human and machine translation.

</span>
<span class="ltx_bibblock"><em id="bib.bib42.1.1" class="ltx_emph ltx_font_italic">arXiv</em>, 2016.

</span>
<span class="ltx_bibblock">URL <a href="http://arxiv.org/abs/1609.08144" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1609.08144</a>.

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2020)</span>
<span class="ltx_bibblock">
Yu, L., Sartran, L., Huang, P.-S., Stokowiec, W., Donato, D., Srinivasan, S.,
Andreev, A., Ling, W., Mokra, S., Dal Lago, A., Doron, Y., Young, S.,
Blunsom, P., and Dyer, C.

</span>
<span class="ltx_bibblock">The DeepMind Chinese–English document translation system
at WMT2020.

</span>
<span class="ltx_bibblock">In <em id="bib.bib43.1.1" class="ltx_emph ltx_font_italic">Proceedings of the Fifth Conference on Machine Translation</em>,
2020.

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2019)</span>
<span class="ltx_bibblock">
Zhang, T., Kishore, V., Wu, F., Weinberger, K. Q., and Artzi, Y.

</span>
<span class="ltx_bibblock">BERTScore: Evaluating text generation with BERT.

</span>
<span class="ltx_bibblock">In <em id="bib.bib44.1.1" class="ltx_emph ltx_font_italic">Proceedings of the <math id="bib.bib44.1.1.m1.1" class="ltx_Math" alttext="7^{th}" display="inline"><semantics id="bib.bib44.1.1.m1.1a"><msup id="bib.bib44.1.1.m1.1.1" xref="bib.bib44.1.1.m1.1.1.cmml"><mn mathvariant="normal" id="bib.bib44.1.1.m1.1.1.2" xref="bib.bib44.1.1.m1.1.1.2.cmml">7</mn><mrow id="bib.bib44.1.1.m1.1.1.3" xref="bib.bib44.1.1.m1.1.1.3.cmml"><mtext id="bib.bib44.1.1.m1.1.1.3.2" xref="bib.bib44.1.1.m1.1.1.3.2.cmml">th</mtext></mrow></msup></semantics></math> International Conference on
Learning Representations (ICLR)</em>, 2019.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"/>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Outline</h2>

<div id="Ax1.p1" class="ltx_para">
<p id="Ax1.p1.1" class="ltx_p"><span class="gd_word" id="Ax1.p1.1.1.w1">Appendix </span><a href="#A1" title="Appendix A Network architectures and training ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">A</a><span class="gd_word" id="Ax1.p1.1.2.w1"/><span> </span><span class="gd_word" id="Ax1.p1.1.2.w2">provides</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w3">details</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w4">about</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w5">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w6">network</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w7">architectures</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w8">and</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w9">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w10">optimisation</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w11">hyper-parameters</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w12">used</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w13">in</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w14">our</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w15">work.
We</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w16">also</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w17">describe</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w18">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w19">hybrid</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w20">architecture</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w21">that</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w22">is</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w23">used</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w24">to</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w25">improve</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w26">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w27">training</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w28">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w29">value</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w30">networks</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w31">in</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w32">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w33">hard</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w34">case</span><span> </span><span class="gd_word" id="Ax1.p1.1.2.w35">of</span><span> </span><em id="Ax1.p1.1.1" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="Ax1.p1.1.3.w1"/><span> </span><span class="gd_word" id="Ax1.p1.1.3.w2">metrics.
In</span><span> </span><span class="gd_word" id="Ax1.p1.1.3.w3">Appendix </span><a href="#A2" title="Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">B</a><span class="gd_word" id="Ax1.p1.1.4.w1">,</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w2">we</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w3">lay</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w4">out</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w5">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w6">details</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w7">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w8">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w9">tuning</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w10">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w11">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w12">different</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w13">decoding</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w14">mechanisms</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w15">used</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w16">throughout</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w17">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w18">paper.
In</span><span> </span><span class="gd_word" id="Ax1.p1.1.4.w19">Appendix </span><a href="#A3" title="Appendix C Scaling search with computational budget ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">C</a><span class="gd_word" id="Ax1.p1.1.5.w1">,</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w2">we</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w3">give</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w4">results</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w5">about</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w6">how</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w7">performance</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w8">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w9">our</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w10">decoding</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w11">algorithms</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w12">scale</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w13">with</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w14">more</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w15">computational</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w16">budget.
In</span><span> </span><span class="gd_word" id="Ax1.p1.1.5.w17">Appendix </span><a href="#A4" title="Appendix D Supervised policy vs Distilled policy ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">D</a><span class="gd_word" id="Ax1.p1.1.6.w1">,</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w2">we</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w3">discuss</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w4">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w5">trade</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w6">offs</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w7">between</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w8">learning</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w9">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w10">joint</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w11">policy</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w12">and</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w13">value</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w14">network</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w15">on</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w16">sampled</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w17">(or</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w18">distilled)</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w19">trajectories,</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w20">versus</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w21">training</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w22">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w23">separate</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w24">value</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w25">network</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w26">to</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w27">predict</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w28">the</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w29">value</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w30">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w31">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w32">policy</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w33">network</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w34">trained</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w35">on</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w36">supervised</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w37">trajectories.
In</span><span> </span><span class="gd_word" id="Ax1.p1.1.6.w38">Appendix </span><a href="#A5" title="Appendix E MCTS examples ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">E</a><span class="gd_word" id="Ax1.p1.1.7.w1">,</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w2">we</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w3">give</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w4">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w5">few</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w6">examples</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w7">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w8">MCTS</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w9">exploratory</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w10">trees.
Finally,</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w11">in</span><span> </span><span class="gd_word" id="Ax1.p1.1.7.w12">Appendix </span><a href="#A6" title="Appendix F Batched Numpy-friendly MCTS ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">F</a><span class="gd_word" id="Ax1.p1.1.8.w1"/><span> </span><span class="gd_word" id="Ax1.p1.1.8.w2">we</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w3">provide</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w4">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w5">simple</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w6">implementation</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w7">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w8">a</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w9">batched</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w10">version</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w11">of</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w12">MCTS</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w13">in</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w14">plain</span><span> </span><span class="gd_word" id="Ax1.p1.1.8.w15">Numpy.</span></p>
</div>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Network architectures and training</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p"><span class="gd_word" id="A1.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="A1.p1.1.1.w2">this</span><span> </span><span class="gd_word" id="A1.p1.1.1.w3">section,</span><span> </span><span class="gd_word" id="A1.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="A1.p1.1.1.w5">detail</span><span> </span><span class="gd_word" id="A1.p1.1.1.w6">our</span><span> </span><span class="gd_word" id="A1.p1.1.1.w7">basic</span><span> </span><span class="gd_word" id="A1.p1.1.1.w8">dual-headed</span><span> </span><span class="gd_word" id="A1.p1.1.1.w9">architecture,</span><span> </span><span class="gd_word" id="A1.p1.1.1.w10">our</span><span> </span><span class="gd_word" id="A1.p1.1.1.w11">training</span><span> </span><span class="gd_word" id="A1.p1.1.1.w12">regimen</span><span> </span><span class="gd_word" id="A1.p1.1.1.w13">and</span><span> </span><span class="gd_word" id="A1.p1.1.1.w14">our</span><span> </span><span class="gd_word" id="A1.p1.1.1.w15">optimisation</span><span> </span><span class="gd_word" id="A1.p1.1.1.w16">hyper-parameters.
We</span><span> </span><span class="gd_word" id="A1.p1.1.1.w17">also</span><span> </span><span class="gd_word" id="A1.p1.1.1.w18">describe</span><span> </span><span class="gd_word" id="A1.p1.1.1.w19">our</span><span> </span><span class="gd_word" id="A1.p1.1.1.w20">hybrid</span><span> </span><span class="gd_word" id="A1.p1.1.1.w21">architecture</span><span> </span><span class="gd_word" id="A1.p1.1.1.w22">(which</span><span> </span><span class="gd_word" id="A1.p1.1.1.w23">we</span><span> </span><span class="gd_word" id="A1.p1.1.1.w24">use</span><span> </span><span class="gd_word" id="A1.p1.1.1.w25">for</span><span> </span><span class="gd_word" id="A1.p1.1.1.w26">privileged</span><span> </span><span class="gd_word" id="A1.p1.1.1.w27">metrics)</span><span> </span><span class="gd_word" id="A1.p1.1.1.w28">in</span><span> </span><span class="gd_word" id="A1.p1.1.1.w29">more</span><span> </span><span class="gd_word" id="A1.p1.1.1.w30">depth.</span></p>
</div>
<section id="A1.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Dual-head transformer architecture.</h4>

<div id="A1.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS0.SSS0.Px1.p1.2" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w1">We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w2">start</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w3">from</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w4">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w5">original</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w6">transformer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w7">encoder-decoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.1.w8">architecture </span><cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al., <a href="#bib.bib38" title="" class="ltx_ref">2017</a>)</cite><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w1">,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w2">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w3">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w4">few</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w5">modifications.
Both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w6">encoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w7">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w8">decoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.2.w9">have</span><span> </span><math id="A1.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathrm{num\_layers}=6" display="inline"><semantics id="A1.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="A1.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mrow id="A1.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="A1.SS0.SSS0.Px1.p1.1.m1.1.1.2.2" xref="A1.SS0.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">num_layers</mi></mrow><mo id="A1.SS0.SSS0.Px1.p1.1.m1.1.1.1" xref="A1.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A1.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">6</mn></mrow></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w2">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w3">layers.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w4">hidden</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w5">size</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w6">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w7">512.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w8">embedding</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w9">vocabulary</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w10">size</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w11">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w12">just</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w13">short</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w14">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w15">32000</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w16">tokens</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w17">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w18">both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w19">language</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w20">pairs.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w21">unroll</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w22">length</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w23">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w24">our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w25">models</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w26">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w27">128.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w28">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w29">“normal</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w30">GPT-2”-style</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w31">initialisers,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w32">i.e.</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w33">initial</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w34">values</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w35">are</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w36">sampled</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w37">from</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w38">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w39">Gaussian</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w40">distribution</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w41">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w42">mean</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w43">0</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w44">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w45">standard</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.3.w46">deviation</span><span> </span><math id="A1.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\frac{0.02}{\sqrt{\mathrm{num\_layers}}}" display="inline"><semantics id="A1.SS0.SSS0.Px1.p1.2.m2.1a"><mfrac id="A1.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS0.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="A1.SS0.SSS0.Px1.p1.2.m2.1.1.2" xref="A1.SS0.SSS0.Px1.p1.2.m2.1.1.2.cmml">0.02</mn><msqrt id="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3" xref="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3.cmml"><mrow id="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3.2" xref="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.cmml"><mi id="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.2" xref="A1.SS0.SSS0.Px1.p1.2.m2.1.1.3.2.2.cmml">num_layers</mi></mrow></msqrt></mfrac></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w1">.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w2">one</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w3">exception</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w4">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w5">this</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w6">rule</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w7">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w8">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w9">embeddings,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w10">where</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w11">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w12">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w13">truncated</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w14">normal</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w15">initialisers</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w16">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w17">standard</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w18">deviation</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p1.2.4.w19">1.0.</span></p>
</div>
<div id="A1.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="A1.SS0.SSS0.Px1.p2.3" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w1">On</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w2">top</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w3">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w4">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w5">decoder,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w6">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w7">add</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w8">two</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w9">“heads”.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w10">first</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w11">one</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w12">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w13">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w14">policy</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w15">head.
It</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w16">consists</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w17">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w18">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w19">linear</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w20">projection</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w21">from</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w22">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w23">hidden</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w24">dimensionality</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w25">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w26">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w27">vocabulary</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w28">size,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w29">followed</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w30">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w31">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w32">softmax</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w33">operator</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w34">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w35">output</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w36">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w37">distribution</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w38">over</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w39">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w40">whole</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w41">vocabulary.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w42">second</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w43">head</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w44">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w45">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w46">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w47">head:</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w48">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w49">linear</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w50">projection</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w51">from</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w52">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w53">hidden</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w54">dimensionality</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w55">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w56">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w57">amount</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w58">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w59">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w60">buckets</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w61">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w62">define</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.1.w63">(</span><math id="A1.SS0.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="|\mathcal{B}|=500" display="inline"><semantics id="A1.SS0.SSS0.Px1.p2.1.m1.1a"><mrow id="A1.SS0.SSS0.Px1.p2.1.m1.1.2" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.cmml"><mrow id="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.2" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.1.cmml"><mo stretchy="false" id="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.2.1" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px1.p2.1.m1.1.1" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.1.cmml">ℬ</mi><mo stretchy="false" id="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.2.2" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="A1.SS0.SSS0.Px1.p2.1.m1.1.2.1" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px1.p2.1.m1.1.2.3" xref="A1.SS0.SSS0.Px1.p2.1.m1.1.2.3.cmml">500</mn></mrow></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w2">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w3">our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w4">experiments),</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w5">followed</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w6">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w7">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w8">softmax</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w9">operator.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w10">compute</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w11">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w12">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w13">loss</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w14">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w15">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w16">cross-entropy</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w17">between</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w18">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w19">softmax</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.2.w20">distribution</span><span> </span><math id="A1.SS0.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="(v_{i})_{i\in\mathcal{B}}" display="inline"><semantics id="A1.SS0.SSS0.Px1.p2.2.m2.1a"><msub id="A1.SS0.SSS0.Px1.p2.2.m2.1.1" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.cmml"><mrow id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.2" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml"><mi id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.2.cmml">v</mi><mi id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.3" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow><mrow id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.cmml"><mi id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.2" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.2.cmml">i</mi><mo id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.1" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.3" xref="A1.SS0.SSS0.Px1.p2.2.m2.1.1.3.3.cmml">ℬ</mi></mrow></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w2">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w3">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w4">one-hot</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w5">encoding</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w6">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w7">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w8">target</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w9">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w10">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w11">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w12">same</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w13">dimension.
To</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w14">output</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w15">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w16">value,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w17">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w18">compute</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w19">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w20">sum</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w21">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w22">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w23">softmax</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w24">distribution</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w25">multiplied</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w26">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w27">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w28">average</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w29">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w30">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w31">each</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.3.w32">bucket</span><span> </span><math id="A1.SS0.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="\sum_{i\in\mathcal{B}}v_{i}\bar{b}_{i}" display="inline"><semantics id="A1.SS0.SSS0.Px1.p2.3.m3.1a"><mrow id="A1.SS0.SSS0.Px1.p2.3.m3.1.1" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.cmml"><msub id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.cmml"><mo largeop="true" symmetric="true" id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.2.cmml">∑</mo><mrow id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.cmml"><mi id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.2.cmml">i</mi><mo id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.1" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.1.3.3.cmml">ℬ</mi></mrow></msub><mrow id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.cmml"><msub id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2.cmml"><mi id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2.2.cmml">v</mi><mi id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2.3" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.2.3.cmml">i</mi></msub><mo id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.1" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.1.cmml">⁢</mo><msub id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.cmml"><mover accent="true" id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2.cmml"><mi id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2.2" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2.2.cmml">b</mi><mo stretchy="false" id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2.1" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.2.1.cmml">¯</mo></mover><mi id="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.3" xref="A1.SS0.SSS0.Px1.p2.3.m3.1.1.2.3.3.cmml">i</mi></msub></mrow></mrow></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px1.p2.3.4.w1">.</span></p>
</div>
<div id="A1.SS0.SSS0.Px1.p3" class="ltx_para">
<p id="A1.SS0.SSS0.Px1.p3.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w1">Compared</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w2">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w3">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w4">original</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w5">architecture,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w6">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w7">apply</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w8">several</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w9">changes</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w10">related</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w11">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w12">inference</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w13">speed.
First,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w14">instead</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w15">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w16">8</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w17">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w18">heads</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w19">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w20">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w21">16.
Second,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w22">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w23">dimensionality</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w24">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w25">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w26">keys</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w27">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w28">values</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w29">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w30">128,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w31">compared</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w32">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w33">64</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w34">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w35">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w36">original</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w37">architecture,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w38">thus</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w39">avoiding</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w40">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w41">costly</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w42">padding</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w43">operation</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w44">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w45">our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w46">hardware</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w47">accelerators,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w48">TPUv3.
Finally,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w49">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w50">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w51">multi-query</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.1.w52">attention </span><cite class="ltx_cite ltx_citemacro_citep">(Shazeer, <a href="#bib.bib33" title="" class="ltx_ref">2019</a>)</cite><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w1">,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w2">only</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w3">computing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w4">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w5">single</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w6">set</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w7">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w8">keys</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w9">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w10">values</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w11">per</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w12">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w13">block</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w14">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w15">sharing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w16">them</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w17">across</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w18">all</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w19">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w20">heads.
This</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w21">reduces</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w22">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w23">memory</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w24">footprint</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w25">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w26">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w27">keys</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w28">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w29">values</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w30">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w31">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w32">factor</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w33">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w34">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w35">number</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w36">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w37">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w38">heads</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w39">(16</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w40">here),</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w41">considerably</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w42">decreasing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w43">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w44">time</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w45">spent</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w46">reading</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w47">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w48">writing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w49">from</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w50">memory,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w51">which</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w52">ultimately</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w53">results</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w54">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w55">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w56">near-linear</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w57">inference</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w58">speedup</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w59">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w60">respect</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w61">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w62">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w63">number</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w64">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w65">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w66">heads.
As</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w67">this</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w68">alternative</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w69">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w70">mechanism</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w71">requires</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w72">less</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w73">trainable</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w74">weights</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w75">than</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w76">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w77">more</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w78">conventional</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w79">one,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w80">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w81">reallocate</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w82">some</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w83">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w84">those</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w85">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w86">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w87">feedforward</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w88">layer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w89">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w90">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w91">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w92">blocks</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w93">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w94">using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w95">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w96">bigger</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w97">internal</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w98">hidden</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w99">dimensionality</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w100">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w101">3072</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w102">instead</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w103">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px1.p3.1.2.w104">2048.</span></p>
</div>
</section>
<section id="A1.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Optimisation.</h4>

<div id="A1.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS0.SSS0.Px2.p1.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.1.w2">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.1.w3">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.1.w4">Adam </span><cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib20" title="" class="ltx_ref">2015</a>)</cite><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w2">optimiser</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w3">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w4">learning</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w5">rate</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w6">0.001,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w7">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w8">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w9">following</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.2.w10">hyper-parameters:</span><span> </span><math id="A1.SS0.SSS0.Px2.p1.1.m1.2" class="ltx_Math" alttext="b_{1}=0.9;b_{2}=0.98;\epsilon=1e^{-9}" display="inline"><semantics id="A1.SS0.SSS0.Px2.p1.1.m1.2a"><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.3.cmml"><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.cmml"><msub id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.2.cmml">b</mi><mn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.3a.cmml">;</mo><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.3.cmml"><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.cmml"><msub id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2.2.cmml">b</mi><mn id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.1.cmml">=</mo><mn id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.1.1.3.cmml">0.98</mn></mrow><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.3a.cmml">;</mo><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.cmml"><mi id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.2.cmml">ϵ</mi><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.1.cmml">=</mo><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.cmml"><mn id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.2.cmml">1</mn><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.1.cmml">⁢</mo><msup id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.cmml"><mi id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.2.cmml">e</mi><mrow id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3.cmml"><mo id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3.1" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3.1.cmml">-</mo><mn id="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3.2" xref="A1.SS0.SSS0.Px2.p1.1.m1.2.2.2.2.2.2.3.3.3.2.cmml">9</mn></mrow></msup></mrow></mrow></mrow></mrow></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w1">.
Our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w2">batch</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w3">size</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w4">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w5">4096,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w6">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w7">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w8">train</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w9">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w10">100000</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w11">steps</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w12">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w13">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w14">ENDE</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w15">dataset</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w16">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w17">300000</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w18">steps</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w19">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w20">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w21">larger</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w22">ENFR</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w23">dataset.
As</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w24">regularisation,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w25">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w26">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w27">dropout</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w28">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w29">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w30">weight</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w31">0.1,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w32">but</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w33">no</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w34">weight</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w35">decay.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w36">also</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w37">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w38">label</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w39">smoothing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w40">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w41">hyper-parameter</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w42">0.1</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w43">(although</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w44">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w45">see</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w46">little</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w47">impact</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w48">when</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w49">removing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p1.1.3.w50">it).</span></p>
</div>
<div id="A1.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="A1.SS0.SSS0.Px2.p2.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w2">last</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w3">difference</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w4">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w5">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w6">original</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w7">transformer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w8">encoder-decoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w9">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w10">where</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w11">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w12">place</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w13">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w14">layer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w15">norm</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w16">operator.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w17">put</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w18">it</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w19">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w20">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w21">beginning</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w22">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w23">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w24">attention</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w25">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w26">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w27">feed-forward</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w28">layers,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w29">rather</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w30">than</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w31">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w32">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w33">end,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w34">which</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w35">allows</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w36">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w37">fully-residual</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px2.p2.1.1.w38">layers.</span></p>
</div>
</section>
<section id="A1.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Hybrid architecture for privileged metrics.</h4>

<div id="A1.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p1.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.1.w1">In</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.1.w2">Section </span><a href="#S5" title="5 Training a value network ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">5</a><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w1">,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w2">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w3">show</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w4">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w5">learning</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w6">good</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w7">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w8">functions</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w9">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w10">privileged</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w11">metrics</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w12">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w13">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w14">BLEU</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w15">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w16">BERTScore</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w17">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w18">very</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w19">difficult.
This</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w20">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w21">mainly</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w22">due</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w23">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w24">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w25">fact</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w26">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w27">our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w28">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w29">networks</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w30">are</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w31">lacking</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w32">access</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w33">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w34">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w35">ground</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w36">truth</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w37">targets</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w38">which</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w39">are</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w40">required</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w41">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w42">precise</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w43">score</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w44">computation.
Our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w45">ablation</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w46">study</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w47">show</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w48">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w49">if</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w50">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w51">remove</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w52">this</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w53">difficulty</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w54">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w55">allowing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w56">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w57">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w58">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w59">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w60">“cheat”</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w61">by</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w62">using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w63">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w64">ground</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w65">truth</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w66">targets</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w67">rather</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w68">than</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w69">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w70">source</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w71">sentences</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w72">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w73">encoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w74">inputs,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w75">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w76">obtain</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w77">much</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w78">more</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w79">precise</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w80">values.
Downstream</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w81">results</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w82">using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w83">MCTS</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w84">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w85">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w86">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w87">“cheating”</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w88">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w89">show</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w90">very</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w91">large</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w92">BLEU</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w93">improvements.
Unfortunately,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w94">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w95">practice</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w96">one</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w97">cannot</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w98">rely</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w99">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w100">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w101">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w102">trick</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w103">when</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p1.1.2.w104">decoding.
</span></p>
</div>
<div id="A1.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p2.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w1">Our</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w2">idea</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w3">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w4">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w5">try</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w6">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w7">leverage</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w8">“cheating”</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w9">information</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w10">indirectly</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w11">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w12">training</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w13">time</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w14">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w15">shape</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w16">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w17">representation</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w18">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w19">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w20">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w21">(i.e.</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w22">non-cheating)</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w23">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w24">network.
Another</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w25">way</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w26">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w27">look</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w28">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w29">it</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w30">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w31">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w32">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w33">try</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w34">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w35">distill</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w36">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w37">knowledge</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w38">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w39">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w40">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w41">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w42">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w43">into</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w44">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w45">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p2.1.1.w46">one.</span></p>
</div>
<div id="A1.SS0.SSS0.Px3.p3" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p3.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w1">To</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w2">achieve</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w3">this,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w4">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w5">propose</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w6">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w7">new</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w8">training</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w9">regimen,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w10">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w11">detailed</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w12">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.1.w13">Figure </span><a href="#A1.F1" title="Figure 1 ‣ Hybrid architecture for privileged metrics. ‣ Appendix A Network architectures and training ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">1</a><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w1">.
The</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w2">basic</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w3">idea</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w4">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w5">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w6">compute</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w7">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w8">final</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w9">layer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w10">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w11">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w12">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w13">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w14">model,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w15">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w16">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w17">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w18">it</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w19">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w20">an</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w21">auxiliary</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w22">target</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w23">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w24">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w25">final</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w26">layer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w27">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w28">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w29">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w30">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w31">model,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w32">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w33">addition</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w34">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w35">its</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w36">normal</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w37">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w38">loss.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w39">thus</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w40">have</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w41">two</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w42">pathways.
On</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w43">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w44">left,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w45">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w46">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w47">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w48">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w49">encoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w50">receives</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w51">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w52">source</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w53">sentence</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w54">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w55">input</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w56">(which</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w57">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w58">available</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w59">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w60">test</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w61">time).
On</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w62">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w63">right,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w64">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w65">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w66">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w67">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w68">encoder</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w69">receives</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w70">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w71">ground</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w72">truth</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w73">target</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w74">sentence</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w75">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w76">input</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w77">(which</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w78">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w79">not</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w80">available</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w81">at</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w82">test</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w83">time).
For</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w84">both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w85">pathways,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w86">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w87">decoder’s</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w88">input</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w89">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w90">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w91">sample</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w92">sentence.
Crucially,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w93">both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w94">pathways</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w95">rely</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w96">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w97">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w98">same</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w99">transformer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w100">encoder-decoder:</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w101">they</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w102">share</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w103">all</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w104">weights,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w105">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w106">only</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w107">difference</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w108">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w109">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w110">their</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p3.1.2.w111">inputs.</span></p>
</div>
<div id="A1.SS0.SSS0.Px3.p4" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p4.6" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w1">To</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w2">train</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w3">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w4">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w5">model,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w6">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w7">use</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w8">four</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w9">losses.
First,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w10">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w11">apply</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w12">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w13">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.1.w14">policy</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\pi}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.1.m1.1a"><msub id="A1.SS0.SSS0.Px3.p4.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p4.1.m1.1.1.2" xref="A1.SS0.SSS0.Px3.p4.1.m1.1.1.2.cmml">ℒ</mi><mi id="A1.SS0.SSS0.Px3.p4.1.m1.1.1.3" xref="A1.SS0.SSS0.Px3.p4.1.m1.1.1.3.cmml">π</mi></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.2.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.2.w2">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.2.w3">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.2.w4">loss</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{v}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.2.m2.1a"><msub id="A1.SS0.SSS0.Px3.p4.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p4.2.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p4.2.m2.1.1.2.cmml">ℒ</mi><mi id="A1.SS0.SSS0.Px3.p4.2.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p4.2.m2.1.1.3.cmml">v</mi></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w2">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w3">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w4">regular</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w5">pathway.
Second,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w6">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w7">apply</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w8">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w9">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.3.w10">loss</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{v_{c}}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.3.m3.1a"><msub id="A1.SS0.SSS0.Px3.p4.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p4.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p4.3.m3.1.1.2" xref="A1.SS0.SSS0.Px3.p4.3.m3.1.1.2.cmml">ℒ</mi><msub id="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3" xref="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3.cmml"><mi id="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3.2" xref="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3.2.cmml">v</mi><mi id="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3.3" xref="A1.SS0.SSS0.Px3.p4.3.m3.1.1.3.3.cmml">c</mi></msub></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w2">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w3">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w4">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w5">pathway.
Finally,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w6">we</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w7">add</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.4.w8">an</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.4.m4.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.4.m4.1a"><msub id="A1.SS0.SSS0.Px3.p4.4.m4.1.1" xref="A1.SS0.SSS0.Px3.p4.4.m4.1.1.cmml"><mi mathvariant="normal" id="A1.SS0.SSS0.Px3.p4.4.m4.1.1.2" xref="A1.SS0.SSS0.Px3.p4.4.m4.1.1.2.cmml">ℓ</mi><mn id="A1.SS0.SSS0.Px3.p4.4.m4.1.1.3" xref="A1.SS0.SSS0.Px3.p4.4.m4.1.1.3.cmml">2</mn></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.5.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.5.w2">loss</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.5.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p4.5.m5.1.1" xref="A1.SS0.SSS0.Px3.p4.5.m5.1.1.cmml">𝒟</mi></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w2">between</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w3">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w4">final</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w5">layer</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w6">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w7">both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w8">pathways,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w9">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w10">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w11">stop</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w12">gradient</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w13">for</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w14">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w15">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w16">one</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w17">–</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w18">so</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w19">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w20">its</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w21">representation</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w22">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w23">not</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w24">directly</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w25">affected</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.6.w26">by</span><span> </span><math id="A1.SS0.SSS0.Px3.p4.6.m6.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p4.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p4.6.m6.1.1" xref="A1.SS0.SSS0.Px3.p4.6.m6.1.1.cmml">𝒟</mi></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p4.6.7.w1">.</span></p>
</div>
<div id="A1.SS0.SSS0.Px3.p5" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p5.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w1">We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w2">do</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w3">not</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w4">add</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w5">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w6">policy</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w7">loss</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w8">on</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w9">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w10">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w11">pathway.
This</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w12">seems</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w13">natural,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w14">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w15">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w16">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w17">loss</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w18">would</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w19">only</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w20">encourage</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w21">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w22">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w23">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w24">reproduce</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w25">its</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w26">inputs</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w27">exactly,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w28">effectively</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w29">pushing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w30">it</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w31">towards</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w32">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w33">identity</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p5.1.1.w34">function.</span></p>
</div>
<figure id="A1.T6" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A1_T6.png" alt="/static/img/2104.05336-gpt-4/A1_T6.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 6: </span><span class="gd_word" id="A1.T6.2.w1">Greedy</span><span> </span><span class="gd_word" id="A1.T6.2.w2">vs</span><span> </span><span class="gd_word" id="A1.T6.2.w3">MCTS</span><span> </span><span class="gd_word" id="A1.T6.2.w4">(50</span><span> </span><span class="gd_word" id="A1.T6.2.w5">simulations)</span><span> </span><span class="gd_word" id="A1.T6.2.w6">performance</span><span> </span><span class="gd_word" id="A1.T6.2.w7">on</span><span> </span><span class="gd_word" id="A1.T6.2.w8">the</span><span> </span><span class="gd_word" id="A1.T6.2.w9">ENDE</span><span> </span><span class="gd_word" id="A1.T6.2.w10">dataset</span><span> </span><span class="gd_word" id="A1.T6.2.w11">for</span><span> </span><span class="gd_word" id="A1.T6.2.w12">BLEU</span><span> </span><span class="gd_word" id="A1.T6.2.w13">(top</span><span> </span><span class="gd_word" id="A1.T6.2.w14">rows)</span><span> </span><span class="gd_word" id="A1.T6.2.w15">and</span><span> </span><span class="gd_word" id="A1.T6.2.w16">BERTScore</span><span> </span><span class="gd_word" id="A1.T6.2.w17">(bottom</span><span> </span><span class="gd_word" id="A1.T6.2.w18">rows).</span><span> </span><span class="gd_word" id="A1.T6.2.w19">Using</span><span> </span><span class="gd_word" id="A1.T6.2.w20">the</span><span> </span><span class="gd_word" id="A1.T6.2.w21">normal</span><span> </span><span class="gd_word" id="A1.T6.2.w22">architecture,</span><span> </span><span class="gd_word" id="A1.T6.2.w23">improvements</span><span> </span><span class="gd_word" id="A1.T6.2.w24">are</span><span> </span><span class="gd_word" id="A1.T6.2.w25">very</span><span> </span><span class="gd_word" id="A1.T6.2.w26">small.</span><span> </span><span class="gd_word" id="A1.T6.2.w27">Using</span><span> </span><span class="gd_word" id="A1.T6.2.w28">the</span><span> </span><span class="gd_word" id="A1.T6.2.w29">hybrid</span><span> </span><span class="gd_word" id="A1.T6.2.w30">architecture</span><span> </span><span class="gd_word" id="A1.T6.2.w31">yields</span><span> </span><span class="gd_word" id="A1.T6.2.w32">more</span><span> </span><span class="gd_word" id="A1.T6.2.w33">significant</span><span> </span><span class="gd_word" id="A1.T6.2.w34">improvements.</span><span> </span><span class="gd_word" id="A1.T6.2.w35">The</span><span> </span><span class="gd_word" id="A1.T6.2.w36">middle</span><span> </span><span class="gd_word" id="A1.T6.2.w37">column</span><span> </span><span class="gd_word" id="A1.T6.2.w38">contains</span><span> </span><span class="gd_word" id="A1.T6.2.w39">(greyed-out)</span><span> </span><span class="gd_word" id="A1.T6.2.w40">results</span><span> </span><span class="gd_word" id="A1.T6.2.w41">when</span><span> </span><span class="gd_word" id="A1.T6.2.w42">using</span><span> </span><span class="gd_word" id="A1.T6.2.w43">a</span><span> </span><span class="gd_word" id="A1.T6.2.w44">cheating</span><span> </span><span class="gd_word" id="A1.T6.2.w45">model</span><span> </span><span class="gd_word" id="A1.T6.2.w46">which</span><span> </span><span class="gd_word" id="A1.T6.2.w47">takes</span><span> </span><span class="gd_word" id="A1.T6.2.w48">ground</span><span> </span><span class="gd_word" id="A1.T6.2.w49">truth</span><span> </span><span class="gd_word" id="A1.T6.2.w50">targets</span><span> </span><span class="gd_word" id="A1.T6.2.w51">as</span><span> </span><span class="gd_word" id="A1.T6.2.w52">inputs.</span><span> </span><span class="gd_word" id="A1.T6.2.w53">Improvements</span><span> </span><span class="gd_word" id="A1.T6.2.w54">are</span><span> </span><span class="gd_word" id="A1.T6.2.w55">enormous</span><span> </span><span class="gd_word" id="A1.T6.2.w56">in</span><span> </span><span class="gd_word" id="A1.T6.2.w57">this</span><span> </span><span class="gd_word" id="A1.T6.2.w58">prohibited</span><span> </span><span class="gd_word" id="A1.T6.2.w59">setting,</span><span> </span><span class="gd_word" id="A1.T6.2.w60">which</span><span> </span><span class="gd_word" id="A1.T6.2.w61">is</span><span> </span><span class="gd_word" id="A1.T6.2.w62">unsurprising</span><span> </span><span class="gd_word" id="A1.T6.2.w63">at</span><span> </span><span class="gd_word" id="A1.T6.2.w64">the</span><span> </span><span class="gd_word" id="A1.T6.2.w65">value</span><span> </span><span class="gd_word" id="A1.T6.2.w66">function</span><span> </span><span class="gd_word" id="A1.T6.2.w67">receives</span><span> </span><span class="gd_word" id="A1.T6.2.w68">optimal</span><span> </span><span class="gd_word" id="A1.T6.2.w69">output</span><span> </span><span class="gd_word" id="A1.T6.2.w70">as</span><span> </span><span class="gd_word" id="A1.T6.2.w71">its</span><span> </span><span class="gd_word" id="A1.T6.2.w72">own</span><span> </span><span class="gd_word" id="A1.T6.2.w73">inputs.</span></figcaption>
</figure>
<div id="A1.SS0.SSS0.Px3.p6" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p6.1" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w1">Using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w2">such</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w3">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w4">hybrid</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w5">architecture</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w6">yields</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w7">performance</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w8">improvements</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w9">when</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w10">using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w11">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w12">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w13">model</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w14">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w15">MCTS,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w16">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w17">shown</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w18">in</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.1.w19">Table </span><a href="#A1.T6" title="Table 6 ‣ Hybrid architecture for privileged metrics. ‣ Appendix A Network architectures and training ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">6</a><span class="gd_word" id="A1.SS0.SSS0.Px3.p6.1.2.w1">.</span></p>
</div>
<div id="A1.SS0.SSS0.Px3.p7" class="ltx_para">
<p id="A1.SS0.SSS0.Px3.p7.5" class="ltx_p"><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w1">We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w2">find</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w3">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w4">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w5">obtain</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w6">best</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w7">performance,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w8">three</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w9">things</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w10">need</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w11">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w12">be</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w13">combined:</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w14">(i)</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w15">sharing</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w16">weights</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w17">across</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w18">both</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w19">pathways,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w20">(ii)</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w21">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.1.w22">distillation</span><span> </span><math id="A1.SS0.SSS0.Px3.p7.1.m1.1" class="ltx_Math" alttext="\ell_{2}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p7.1.m1.1a"><msub id="A1.SS0.SSS0.Px3.p7.1.m1.1.1" xref="A1.SS0.SSS0.Px3.p7.1.m1.1.1.cmml"><mi mathvariant="normal" id="A1.SS0.SSS0.Px3.p7.1.m1.1.1.2" xref="A1.SS0.SSS0.Px3.p7.1.m1.1.1.2.cmml">ℓ</mi><mn id="A1.SS0.SSS0.Px3.p7.1.m1.1.1.3" xref="A1.SS0.SSS0.Px3.p7.1.m1.1.1.3.cmml">2</mn></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w2">loss</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w3">and</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w4">(iii)</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w5">the</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w6">cheating</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w7">value</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w8">loss.
Each</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w9">loss</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w10">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w11">added</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w12">with</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w13">a</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w14">linear</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w15">weight.
Proper</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w16">tuning</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w17">of</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w18">these</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w19">weights</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w20">is</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w21">important.
We</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w22">find</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w23">that</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w24">using</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w25">weights</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w26">1.0</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.2.w27">for</span><span> </span><math id="A1.SS0.SSS0.Px3.p7.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{\pi}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p7.2.m2.1a"><msub id="A1.SS0.SSS0.Px3.p7.2.m2.1.1" xref="A1.SS0.SSS0.Px3.p7.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p7.2.m2.1.1.2" xref="A1.SS0.SSS0.Px3.p7.2.m2.1.1.2.cmml">ℒ</mi><mi id="A1.SS0.SSS0.Px3.p7.2.m2.1.1.3" xref="A1.SS0.SSS0.Px3.p7.2.m2.1.1.3.cmml">π</mi></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.3.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.3.w2">and</span><span> </span><math id="A1.SS0.SSS0.Px3.p7.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{v_{c}}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p7.3.m3.1a"><msub id="A1.SS0.SSS0.Px3.p7.3.m3.1.1" xref="A1.SS0.SSS0.Px3.p7.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p7.3.m3.1.1.2" xref="A1.SS0.SSS0.Px3.p7.3.m3.1.1.2.cmml">ℒ</mi><msub id="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3" xref="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3.cmml"><mi id="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3.2" xref="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3.2.cmml">v</mi><mi id="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3.3" xref="A1.SS0.SSS0.Px3.p7.3.m3.1.1.3.3.cmml">c</mi></msub></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w1">,</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w2">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w3">well</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w4">as</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w5">0.1</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.4.w6">for</span><span> </span><math id="A1.SS0.SSS0.Px3.p7.4.m4.1" class="ltx_Math" alttext="\mathcal{L}_{v}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p7.4.m4.1a"><msub id="A1.SS0.SSS0.Px3.p7.4.m4.1.1" xref="A1.SS0.SSS0.Px3.p7.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p7.4.m4.1.1.2" xref="A1.SS0.SSS0.Px3.p7.4.m4.1.1.2.cmml">ℒ</mi><mi id="A1.SS0.SSS0.Px3.p7.4.m4.1.1.3" xref="A1.SS0.SSS0.Px3.p7.4.m4.1.1.3.cmml">v</mi></msub></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.5.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.5.w2">and</span><span> </span><math id="A1.SS0.SSS0.Px3.p7.5.m5.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.SS0.SSS0.Px3.p7.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="A1.SS0.SSS0.Px3.p7.5.m5.1.1" xref="A1.SS0.SSS0.Px3.p7.5.m5.1.1.cmml">𝒟</mi></semantics></math><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.6.w1"/><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.6.w2">leads</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.6.w3">to</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.6.w4">best</span><span> </span><span class="gd_word" id="A1.SS0.SSS0.Px3.p7.5.6.w5">performance.</span></p>
</div>
<figure id="A1.F1" class="ltx_figure"><img src="/static/img/2104.05336-gpt-4//static/img/2104.05336/" id="A1.F1.g1" class="ltx_graphics ltx_centering" alt="/static/img/2104.05336-gpt-4//static/img/2104.05336/" width="" height=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span><span class="gd_word" id="A1.F1.2.w1">
Hybrid</span><span> </span><span class="gd_word" id="A1.F1.2.w2">architecture.
Since</span><span> </span><span class="gd_word" id="A1.F1.2.w3">learning</span><span> </span><span class="gd_word" id="A1.F1.2.w4">a</span><span> </span><span class="gd_word" id="A1.F1.2.w5">good</span><span> </span><span class="gd_word" id="A1.F1.2.w6">value</span><span> </span><span class="gd_word" id="A1.F1.2.w7">network</span><span> </span><span class="gd_word" id="A1.F1.2.w8">is</span><span> </span><span class="gd_word" id="A1.F1.2.w9">hard</span><span> </span><span class="gd_word" id="A1.F1.2.w10">when</span><span> </span><span class="gd_word" id="A1.F1.2.w11">dealing</span><span> </span><span class="gd_word" id="A1.F1.2.w12">with</span><span> </span><em id="A1.F1.8.4.4.1" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="A1.F1.3.w1"/><span> </span><span class="gd_word" id="A1.F1.3.w2">metrics,</span><span> </span><span class="gd_word" id="A1.F1.3.w3">we</span><span> </span><span class="gd_word" id="A1.F1.3.w4">propose</span><span> </span><span class="gd_word" id="A1.F1.3.w5">a</span><span> </span><span class="gd_word" id="A1.F1.3.w6">training</span><span> </span><span class="gd_word" id="A1.F1.3.w7">mechanism</span><span> </span><span class="gd_word" id="A1.F1.3.w8">to</span><span> </span><span class="gd_word" id="A1.F1.3.w9">distill</span><span> </span><span class="gd_word" id="A1.F1.3.w10">the</span><span> </span><span class="gd_word" id="A1.F1.3.w11">information</span><span> </span><span class="gd_word" id="A1.F1.3.w12">from</span><span> </span><span class="gd_word" id="A1.F1.3.w13">a</span><span> </span><em id="A1.F1.8.4.4.2" class="ltx_emph ltx_font_italic">cheating</em><span class="gd_word" id="A1.F1.4.w1"/><span> </span><span class="gd_word" id="A1.F1.4.w2">network</span><span> </span><span class="gd_word" id="A1.F1.4.w3">that</span><span> </span><span class="gd_word" id="A1.F1.4.w4">has</span><span> </span><span class="gd_word" id="A1.F1.4.w5">access</span><span> </span><span class="gd_word" id="A1.F1.4.w6">to</span><span> </span><span class="gd_word" id="A1.F1.4.w7">the</span><span> </span><span class="gd_word" id="A1.F1.4.w8">full</span><span> </span><em id="A1.F1.8.4.4.3" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="A1.F1.5.w1"/><span> </span><span class="gd_word" id="A1.F1.5.w2">information</span><span> </span><span class="gd_word" id="A1.F1.5.w3">in</span><span> </span><span class="gd_word" id="A1.F1.5.w4">order</span><span> </span><span class="gd_word" id="A1.F1.5.w5">to</span><span> </span><span class="gd_word" id="A1.F1.5.w6">predict</span><span> </span><span class="gd_word" id="A1.F1.5.w7">the</span><span> </span><span class="gd_word" id="A1.F1.5.w8">value</span><span> </span><span class="gd_word" id="A1.F1.5.w9">score.
In</span><span> </span><span class="gd_word" id="A1.F1.5.w10">details,</span><span> </span><span class="gd_word" id="A1.F1.5.w11">we</span><span> </span><span class="gd_word" id="A1.F1.5.w12">have</span><span> </span><span class="gd_word" id="A1.F1.5.w13">two</span><span> </span><span class="gd_word" id="A1.F1.5.w14">encoder/decoder</span><span> </span><span class="gd_word" id="A1.F1.5.w15">networks</span><span> </span><span class="gd_word" id="A1.F1.5.w16">that</span><span> </span><span class="gd_word" id="A1.F1.5.w17">share</span><span> </span><span class="gd_word" id="A1.F1.5.w18">their</span><span> </span><span class="gd_word" id="A1.F1.5.w19">weights.
The</span><span> </span><span class="gd_word" id="A1.F1.5.w20">first</span><span> </span><span class="gd_word" id="A1.F1.5.w21">network</span><span> </span><span class="gd_word" id="A1.F1.5.w22">(</span><em id="A1.F1.8.4.4.4" class="ltx_emph ltx_font_italic">left</em><span class="gd_word" id="A1.F1.6.w1">)</span><span> </span><span class="gd_word" id="A1.F1.6.w2">is</span><span> </span><span class="gd_word" id="A1.F1.6.w3">a</span><span> </span><span class="gd_word" id="A1.F1.6.w4">regular</span><span> </span><span class="gd_word" id="A1.F1.6.w5">network</span><span> </span><span class="gd_word" id="A1.F1.6.w6">that</span><span> </span><span class="gd_word" id="A1.F1.6.w7">takes</span><span> </span><span class="gd_word" id="A1.F1.6.w8">as</span><span> </span><span class="gd_word" id="A1.F1.6.w9">input</span><span> </span><span class="gd_word" id="A1.F1.6.w10">the</span><span> </span><span class="gd_word" id="A1.F1.6.w11">input</span><span> </span><span class="gd_word" id="A1.F1.6.w12">sentence</span><span> </span><span class="gd_word" id="A1.F1.6.w13">in</span><span> </span><span class="gd_word" id="A1.F1.6.w14">the</span><span> </span><span class="gd_word" id="A1.F1.6.w15">source</span><span> </span><span class="gd_word" id="A1.F1.6.w16">language</span><span> </span><span class="gd_word" id="A1.F1.6.w17">and</span><span> </span><span class="gd_word" id="A1.F1.6.w18">is</span><span> </span><span class="gd_word" id="A1.F1.6.w19">trained</span><span> </span><span class="gd_word" id="A1.F1.6.w20">to</span><span> </span><span class="gd_word" id="A1.F1.6.w21">output</span><span> </span><span class="gd_word" id="A1.F1.6.w22">(i)</span><span> </span><span class="gd_word" id="A1.F1.6.w23">a</span><span> </span><span class="gd_word" id="A1.F1.6.w24">policy</span><span> </span><span class="gd_word" id="A1.F1.6.w25">predicting</span><span> </span><span class="gd_word" id="A1.F1.6.w26">the</span><span> </span><span class="gd_word" id="A1.F1.6.w27">words</span><span> </span><span class="gd_word" id="A1.F1.6.w28">of</span><span> </span><span class="gd_word" id="A1.F1.6.w29">the</span><span> </span><span class="gd_word" id="A1.F1.6.w30">output</span><span> </span><span class="gd_word" id="A1.F1.6.w31">sentence</span><span> </span><span class="gd_word" id="A1.F1.6.w32">in</span><span> </span><span class="gd_word" id="A1.F1.6.w33">the</span><span> </span><span class="gd_word" id="A1.F1.6.w34">target</span><span> </span><span class="gd_word" id="A1.F1.6.w35">language</span><span> </span><span class="gd_word" id="A1.F1.6.w36">and</span><span> </span><span class="gd_word" id="A1.F1.6.w37">(ii)</span><span> </span><span class="gd_word" id="A1.F1.6.w38">a</span><span> </span><span class="gd_word" id="A1.F1.6.w39">value</span><span> </span><span class="gd_word" id="A1.F1.6.w40">score</span><span> </span><span class="gd_word" id="A1.F1.6.w41">for</span><span> </span><span class="gd_word" id="A1.F1.6.w42">that</span><span> </span><span class="gd_word" id="A1.F1.6.w43">output</span><span> </span><span class="gd_word" id="A1.F1.6.w44">via</span><span> </span><span class="gd_word" id="A1.F1.6.w45">a</span><span> </span><span class="gd_word" id="A1.F1.6.w46">policy</span><span> </span><span class="gd_word" id="A1.F1.6.w47">and</span><span> </span><span class="gd_word" id="A1.F1.6.w48">a</span><span> </span><span class="gd_word" id="A1.F1.6.w49">value</span><span> </span><span class="gd_word" id="A1.F1.6.w50">loss</span><span> </span><math id="A1.F1.5.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{\pi}" display="inline"><semantics id="A1.F1.5.1.1.m1.1b"><msub id="A1.F1.5.1.1.m1.1.1" xref="A1.F1.5.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.F1.5.1.1.m1.1.1.2" xref="A1.F1.5.1.1.m1.1.1.2.cmml">ℒ</mi><mi id="A1.F1.5.1.1.m1.1.1.3" xref="A1.F1.5.1.1.m1.1.1.3.cmml">π</mi></msub></semantics></math><span class="gd_word" id="A1.F1.7.w1"/><span> </span><span class="gd_word" id="A1.F1.7.w2">and</span><span> </span><math id="A1.F1.6.2.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{v}" display="inline"><semantics id="A1.F1.6.2.2.m2.1b"><msub id="A1.F1.6.2.2.m2.1.1" xref="A1.F1.6.2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.F1.6.2.2.m2.1.1.2" xref="A1.F1.6.2.2.m2.1.1.2.cmml">ℒ</mi><mi id="A1.F1.6.2.2.m2.1.1.3" xref="A1.F1.6.2.2.m2.1.1.3.cmml">v</mi></msub></semantics></math><span class="gd_word" id="A1.F1.8.w1">,</span><span> </span><span class="gd_word" id="A1.F1.8.w2">respectively.
The</span><span> </span><span class="gd_word" id="A1.F1.8.w3">second</span><span> </span><span class="gd_word" id="A1.F1.8.w4">network</span><span> </span><span class="gd_word" id="A1.F1.8.w5">(</span><em id="A1.F1.8.4.4.5" class="ltx_emph ltx_font_italic">right</em><span class="gd_word" id="A1.F1.9.w1">),</span><span> </span><span class="gd_word" id="A1.F1.9.w2">dubbed</span><span> </span><span class="gd_word" id="A1.F1.9.w3">cheating,</span><span> </span><span class="gd_word" id="A1.F1.9.w4">is</span><span> </span><span class="gd_word" id="A1.F1.9.w5">given</span><span> </span><span class="gd_word" id="A1.F1.9.w6">as</span><span> </span><span class="gd_word" id="A1.F1.9.w7">input</span><span> </span><span class="gd_word" id="A1.F1.9.w8">the</span><span> </span><span class="gd_word" id="A1.F1.9.w9">ground</span><span> </span><span class="gd_word" id="A1.F1.9.w10">truth</span><span> </span><span class="gd_word" id="A1.F1.9.w11">sentence</span><span> </span><span class="gd_word" id="A1.F1.9.w12">in</span><span> </span><span class="gd_word" id="A1.F1.9.w13">the</span><span> </span><span class="gd_word" id="A1.F1.9.w14">target</span><span> </span><span class="gd_word" id="A1.F1.9.w15">language</span><span> </span><span class="gd_word" id="A1.F1.9.w16">and</span><span> </span><span class="gd_word" id="A1.F1.9.w17">is</span><span> </span><span class="gd_word" id="A1.F1.9.w18">trained</span><span> </span><span class="gd_word" id="A1.F1.9.w19">to</span><span> </span><span class="gd_word" id="A1.F1.9.w20">output</span><span> </span><span class="gd_word" id="A1.F1.9.w21">the</span><span> </span><span class="gd_word" id="A1.F1.9.w22">value</span><span> </span><span class="gd_word" id="A1.F1.9.w23">score</span><span> </span><span class="gd_word" id="A1.F1.9.w24">of</span><span> </span><span class="gd_word" id="A1.F1.9.w25">the</span><span> </span><span class="gd_word" id="A1.F1.9.w26">output</span><span> </span><span class="gd_word" id="A1.F1.9.w27">sentence</span><span> </span><span class="gd_word" id="A1.F1.9.w28">in</span><span> </span><span class="gd_word" id="A1.F1.9.w29">the</span><span> </span><span class="gd_word" id="A1.F1.9.w30">target</span><span> </span><span class="gd_word" id="A1.F1.9.w31">language</span><span> </span><span class="gd_word" id="A1.F1.9.w32">against</span><span> </span><span class="gd_word" id="A1.F1.9.w33">that</span><span> </span><span class="gd_word" id="A1.F1.9.w34">ground</span><span> </span><span class="gd_word" id="A1.F1.9.w35">truth</span><span> </span><span class="gd_word" id="A1.F1.9.w36">via</span><span> </span><span class="gd_word" id="A1.F1.9.w37">the</span><span> </span><span class="gd_word" id="A1.F1.9.w38">loss</span><span> </span><math id="A1.F1.7.3.3.m3.1" class="ltx_Math" alttext="\mathcal{L}_{v_{c}}" display="inline"><semantics id="A1.F1.7.3.3.m3.1b"><msub id="A1.F1.7.3.3.m3.1.1" xref="A1.F1.7.3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.F1.7.3.3.m3.1.1.2" xref="A1.F1.7.3.3.m3.1.1.2.cmml">ℒ</mi><msub id="A1.F1.7.3.3.m3.1.1.3" xref="A1.F1.7.3.3.m3.1.1.3.cmml"><mi id="A1.F1.7.3.3.m3.1.1.3.2" xref="A1.F1.7.3.3.m3.1.1.3.2.cmml">v</mi><mi id="A1.F1.7.3.3.m3.1.1.3.3" xref="A1.F1.7.3.3.m3.1.1.3.3.cmml">c</mi></msub></msub></semantics></math><span class="gd_word" id="A1.F1.10.w1">.
This</span><span> </span><span class="gd_word" id="A1.F1.10.w2">simplifies</span><span> </span><span class="gd_word" id="A1.F1.10.w3">its</span><span> </span><span class="gd_word" id="A1.F1.10.w4">task</span><span> </span><span class="gd_word" id="A1.F1.10.w5">considerably,</span><span> </span><span class="gd_word" id="A1.F1.10.w6">as</span><span> </span><span class="gd_word" id="A1.F1.10.w7">it</span><span> </span><span class="gd_word" id="A1.F1.10.w8">has</span><span> </span><span class="gd_word" id="A1.F1.10.w9">direct</span><span> </span><span class="gd_word" id="A1.F1.10.w10">access</span><span> </span><span class="gd_word" id="A1.F1.10.w11">to</span><span> </span><span class="gd_word" id="A1.F1.10.w12">the</span><span> </span><em id="A1.F1.8.4.4.6" class="ltx_emph ltx_font_italic">privileged</em><span class="gd_word" id="A1.F1.11.w1"/><span> </span><span class="gd_word" id="A1.F1.11.w2">information</span><span> </span><span class="gd_word" id="A1.F1.11.w3">to</span><span> </span><span class="gd_word" id="A1.F1.11.w4">compute</span><span> </span><span class="gd_word" id="A1.F1.11.w5">the</span><span> </span><span class="gd_word" id="A1.F1.11.w6">value.
A</span><span> </span><span class="gd_word" id="A1.F1.11.w7">distillation</span><span> </span><span class="gd_word" id="A1.F1.11.w8">loss</span><span> </span><math id="A1.F1.8.4.4.m4.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="A1.F1.8.4.4.m4.1b"><mi class="ltx_font_mathcaligraphic" id="A1.F1.8.4.4.m4.1.1" xref="A1.F1.8.4.4.m4.1.1.cmml">𝒟</mi></semantics></math><span class="gd_word" id="A1.F1.12.w1"/><span> </span><span class="gd_word" id="A1.F1.12.w2">is</span><span> </span><span class="gd_word" id="A1.F1.12.w3">added</span><span> </span><span class="gd_word" id="A1.F1.12.w4">to</span><span> </span><span class="gd_word" id="A1.F1.12.w5">transfer</span><span> </span><span class="gd_word" id="A1.F1.12.w6">knowledge</span><span> </span><span class="gd_word" id="A1.F1.12.w7">from</span><span> </span><span class="gd_word" id="A1.F1.12.w8">the</span><span> </span><span class="gd_word" id="A1.F1.12.w9">cheating</span><span> </span><span class="gd_word" id="A1.F1.12.w10">model</span><span> </span><span class="gd_word" id="A1.F1.12.w11">to</span><span> </span><span class="gd_word" id="A1.F1.12.w12">the</span><span> </span><span class="gd_word" id="A1.F1.12.w13">regular</span><span> </span><span class="gd_word" id="A1.F1.12.w14">network.
Results</span><span> </span><span class="gd_word" id="A1.F1.12.w15">in</span><span> </span><span class="gd_word" id="A1.F1.12.w16">Table </span><a href="#A1.T6" title="Table 6 ‣ Hybrid architecture for privileged metrics. ‣ Appendix A Network architectures and training ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">6</a><span class="gd_word" id="A1.F1.13.w1"/><span> </span><span class="gd_word" id="A1.F1.13.w2">shows</span><span> </span><span class="gd_word" id="A1.F1.13.w3">that</span><span> </span><span class="gd_word" id="A1.F1.13.w4">such</span><span> </span><span class="gd_word" id="A1.F1.13.w5">an</span><span> </span><span class="gd_word" id="A1.F1.13.w6">approach</span><span> </span><span class="gd_word" id="A1.F1.13.w7">yields</span><span> </span><span class="gd_word" id="A1.F1.13.w8">significant</span><span> </span><span class="gd_word" id="A1.F1.13.w9">improvements</span><span> </span><span class="gd_word" id="A1.F1.13.w10">by</span><span> </span><span class="gd_word" id="A1.F1.13.w11">easing</span><span> </span><span class="gd_word" id="A1.F1.13.w12">the</span><span> </span><span class="gd_word" id="A1.F1.13.w13">training</span><span> </span><span class="gd_word" id="A1.F1.13.w14">of</span><span> </span><span class="gd_word" id="A1.F1.13.w15">the</span><span> </span><span class="gd_word" id="A1.F1.13.w16">value</span><span> </span><span class="gd_word" id="A1.F1.13.w17">network.
</span></figcaption>
</figure>
</section>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Experimental details and ablations</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p"><span class="gd_word" id="A2.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="A2.p1.1.1.w2">detail</span><span> </span><span class="gd_word" id="A2.p1.1.1.w3">how</span><span> </span><span class="gd_word" id="A2.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="A2.p1.1.1.w5">tuned</span><span> </span><span class="gd_word" id="A2.p1.1.1.w6">each</span><span> </span><span class="gd_word" id="A2.p1.1.1.w7">algorithm</span><span> </span><span class="gd_word" id="A2.p1.1.1.w8">for</span><span> </span><span class="gd_word" id="A2.p1.1.1.w9">best</span><span> </span><span class="gd_word" id="A2.p1.1.1.w10">performance</span><span> </span><span class="gd_word" id="A2.p1.1.1.w11">in</span><span> </span><span class="gd_word" id="A2.p1.1.1.w12">this</span><span> </span><span class="gd_word" id="A2.p1.1.1.w13">section.
We</span><span> </span><span class="gd_word" id="A2.p1.1.1.w14">used</span><span> </span><span class="gd_word" id="A2.p1.1.1.w15">the</span><span> </span><span class="gd_word" id="A2.p1.1.1.w16">dev</span><span> </span><span class="gd_word" id="A2.p1.1.1.w17">datasets</span><span> </span><span class="gd_word" id="A2.p1.1.1.w18">to</span><span> </span><span class="gd_word" id="A2.p1.1.1.w19">determine</span><span> </span><span class="gd_word" id="A2.p1.1.1.w20">which</span><span> </span><span class="gd_word" id="A2.p1.1.1.w21">options</span><span> </span><span class="gd_word" id="A2.p1.1.1.w22">were</span><span> </span><span class="gd_word" id="A2.p1.1.1.w23">best.
Wherever</span><span> </span><span class="gd_word" id="A2.p1.1.1.w24">we</span><span> </span><span class="gd_word" id="A2.p1.1.1.w25">report</span><span> </span><span class="gd_word" id="A2.p1.1.1.w26">numbers,</span><span> </span><span class="gd_word" id="A2.p1.1.1.w27">we</span><span> </span><span class="gd_word" id="A2.p1.1.1.w28">compute</span><span> </span><span class="gd_word" id="A2.p1.1.1.w29">those</span><span> </span><span class="gd_word" id="A2.p1.1.1.w30">on</span><span> </span><span class="gd_word" id="A2.p1.1.1.w31">the</span><span> </span><span class="gd_word" id="A2.p1.1.1.w32">test</span><span> </span><span class="gd_word" id="A2.p1.1.1.w33">set</span><span> </span><span class="gd_word" id="A2.p1.1.1.w34">for</span><span> </span><span class="gd_word" id="A2.p1.1.1.w35">comparison</span><span> </span><span class="gd_word" id="A2.p1.1.1.w36">purposes,</span><span> </span><span class="gd_word" id="A2.p1.1.1.w37">but</span><span> </span><span class="gd_word" id="A2.p1.1.1.w38">the</span><span> </span><span class="gd_word" id="A2.p1.1.1.w39">experiments</span><span> </span><span class="gd_word" id="A2.p1.1.1.w40">were</span><span> </span><span class="gd_word" id="A2.p1.1.1.w41">run</span><span> </span><em id="A2.p1.1.1" class="ltx_emph ltx_font_italic">after</em><span class="gd_word" id="A2.p1.1.2.w1"/><span> </span><span class="gd_word" id="A2.p1.1.2.w2">dev</span><span> </span><span class="gd_word" id="A2.p1.1.2.w3">set</span><span> </span><span class="gd_word" id="A2.p1.1.2.w4">selection.
In</span><span> </span><span class="gd_word" id="A2.p1.1.2.w5">practice,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w6">we</span><span> </span><span class="gd_word" id="A2.p1.1.2.w7">find</span><span> </span><span class="gd_word" id="A2.p1.1.2.w8">a</span><span> </span><span class="gd_word" id="A2.p1.1.2.w9">very</span><span> </span><span class="gd_word" id="A2.p1.1.2.w10">good</span><span> </span><span class="gd_word" id="A2.p1.1.2.w11">correlation</span><span> </span><span class="gd_word" id="A2.p1.1.2.w12">between</span><span> </span><span class="gd_word" id="A2.p1.1.2.w13">observations</span><span> </span><span class="gd_word" id="A2.p1.1.2.w14">on</span><span> </span><span class="gd_word" id="A2.p1.1.2.w15">the</span><span> </span><span class="gd_word" id="A2.p1.1.2.w16">dev</span><span> </span><span class="gd_word" id="A2.p1.1.2.w17">and</span><span> </span><span class="gd_word" id="A2.p1.1.2.w18">on</span><span> </span><span class="gd_word" id="A2.p1.1.2.w19">the</span><span> </span><span class="gd_word" id="A2.p1.1.2.w20">test</span><span> </span><span class="gd_word" id="A2.p1.1.2.w21">sets</span><span> </span><span class="gd_word" id="A2.p1.1.2.w22">(although</span><span> </span><span class="gd_word" id="A2.p1.1.2.w23">absolute</span><span> </span><span class="gd_word" id="A2.p1.1.2.w24">values</span><span> </span><span class="gd_word" id="A2.p1.1.2.w25">were</span><span> </span><span class="gd_word" id="A2.p1.1.2.w26">lower</span><span> </span><span class="gd_word" id="A2.p1.1.2.w27">on</span><span> </span><span class="gd_word" id="A2.p1.1.2.w28">the</span><span> </span><span class="gd_word" id="A2.p1.1.2.w29">dev</span><span> </span><span class="gd_word" id="A2.p1.1.2.w30">set,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w31">rankings</span><span> </span><span class="gd_word" id="A2.p1.1.2.w32">remained</span><span> </span><span class="gd_word" id="A2.p1.1.2.w33">mostly</span><span> </span><span class="gd_word" id="A2.p1.1.2.w34">unchanged).
Unless</span><span> </span><span class="gd_word" id="A2.p1.1.2.w35">otherwise</span><span> </span><span class="gd_word" id="A2.p1.1.2.w36">indicated,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w37">our</span><span> </span><span class="gd_word" id="A2.p1.1.2.w38">findings</span><span> </span><span class="gd_word" id="A2.p1.1.2.w39">hold</span><span> </span><span class="gd_word" id="A2.p1.1.2.w40">for</span><span> </span><span class="gd_word" id="A2.p1.1.2.w41">both</span><span> </span><span class="gd_word" id="A2.p1.1.2.w42">ENDE</span><span> </span><span class="gd_word" id="A2.p1.1.2.w43">and</span><span> </span><span class="gd_word" id="A2.p1.1.2.w44">ENFR</span><span> </span><span class="gd_word" id="A2.p1.1.2.w45">datasets,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w46">and</span><span> </span><span class="gd_word" id="A2.p1.1.2.w47">for</span><span> </span><span class="gd_word" id="A2.p1.1.2.w48">all</span><span> </span><span class="gd_word" id="A2.p1.1.2.w49">3</span><span> </span><span class="gd_word" id="A2.p1.1.2.w50">metrics</span><span> </span><span class="gd_word" id="A2.p1.1.2.w51">we</span><span> </span><span class="gd_word" id="A2.p1.1.2.w52">consider</span><span> </span><span class="gd_word" id="A2.p1.1.2.w53">(BLEU,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w54">BERTScore,</span><span> </span><span class="gd_word" id="A2.p1.1.2.w55">Multilingual</span><span> </span><span class="gd_word" id="A2.p1.1.2.w56">BERTScore).</span></p>
</div>
<section id="A2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Beam Search.</h4>

<div id="A2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="A2.SS0.SSS0.Px1.p1.2" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w1">As</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w2">this</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w3">method</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w4">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w5">known</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w6">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w7">degrading</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w8">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w9">large</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w10">beam</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w11">sizes,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w12">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w13">add</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w14">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w15">length</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w16">normalisation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w17">term,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w18">as</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w19">advocated</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.1.w20">by </span><cite class="ltx_cite ltx_citemacro_citet">Wu et al. (<a href="#bib.bib42" title="" class="ltx_ref">2016</a>)</cite><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w1">.
The</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w2">resulting</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w3">score</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w4">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w5">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.2.w6">candidate</span><span> </span><math id="A2.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="y_{1}..y_{t}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px1.p1.1.m1.1b"><msub id="A2.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">y</mi><mn id="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><mo id="A2.SS0.SSS0.Px1.p1.1.m1.1.2" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.2.cmml">.</mo><mo id="A2.SS0.SSS0.Px1.p1.1.m1.1.3" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.3.cmml">.</mo><msub id="A2.SS0.SSS0.Px1.p1.1.m1.1.4" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.4.cmml"><mi id="A2.SS0.SSS0.Px1.p1.1.m1.1.4.2" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.4.2.cmml">y</mi><mi id="A2.SS0.SSS0.Px1.p1.1.m1.1.4.3" xref="A2.SS0.SSS0.Px1.p1.1.m1.1.4.3.cmml">t</mi></msub></mrow></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.3.w1"/><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.3.w2">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p1.2.3.w3">thus:
</span><math id="A2.SS0.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="bs(y_{1}..y_{t})=(\frac{6}{t+5})^{\theta}\log\big{(}\pi(y_{1}..y_{t})\big{)}" display="inline"><semantics id="A2.SS0.SSS0.Px1.p1.2.m2.1a"><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1b"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.1.cmml">bs</mi><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.cmml"><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.1.cmml">(</mo><msub id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2.cmml"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2.2.cmml">y</mi><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.2.3.cmml">1</mn></msub><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.3.cmml">.</mo><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.4" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.4.cmml">.</mo><msub id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5.cmml"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5.2.cmml">y</mi><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.3.6" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.3.6.cmml">)</mo></mrow><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.4" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.4.cmml">=</mo><msup id="A2.SS0.SSS0.Px1.p1.2.m2.1.5" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.cmml"><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.cmml"><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.1.cmml">(</mo><mfrac id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.cmml"><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.2.cmml">6</mn><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.cmml"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.2.cmml">t</mi><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.1.cmml">+</mo><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.2.3.3.cmml">5</mn></mrow></mfrac><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.2.3.cmml">)</mo></mrow><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.5.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.5.3.cmml">θ</mi></msup><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.6" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.6.cmml">log</mi><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.7" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.cmml"><mo maxsize="120%" minsize="120%" id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.1.cmml">(</mo><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.2.cmml">π</mi><mrow id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.cmml"><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.1" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.1.cmml">(</mo><msub id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2.cmml"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2.2.cmml">y</mi><mn id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.2.3.cmml">1</mn></msub><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.3.cmml">.</mo><mo id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.4" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.4.cmml">.</mo><msub id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5.cmml"><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5.2" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5.2.cmml">y</mi><mi id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5.3" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.6" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.3.6.cmml">)</mo></mrow><mo maxsize="120%" minsize="120%" id="A2.SS0.SSS0.Px1.p1.2.m2.1.7.4" xref="A2.SS0.SSS0.Px1.p1.2.m2.1.7.4.cmml">)</mo></mrow></mrow></semantics></math></p>
</div>
<div id="A2.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="A2.SS0.SSS0.Px1.p2.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w1">We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w2">tuned</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w3">three</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w4">hyper-parameters</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w5">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w6">beam</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px1.p2.1.1.w7">search:</span></p>
<ul id="A2.I1" class="ltx_itemize">
<li id="A2.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i1.p1" class="ltx_para">
<p id="A2.I1.i1.p1.1" class="ltx_p"><span class="gd_word" id="A2.I1.i1.p1.1.1.w1">the</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w2">beam</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w3">size:</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w5">tried</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w6">2,</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w7">4,</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w8">6,</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w9">8,</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w10">10</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w11">and</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w12">20.</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w13">We</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w14">find</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w15">that</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w16">the</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w17">best</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w18">performance</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w19">is</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w20">attained</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w21">at</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w22">6,</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w23">plateaus</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w24">until</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w25">10</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w26">and</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w27">starts</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w28">slowly</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w29">decreasing</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w30">by</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w31">20</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w32">(see</span><span> </span><span class="gd_word" id="A2.I1.i1.p1.1.1.w33">Table </span><a href="#A2.T7" title="Table 7 ‣ Beam Search. ‣ Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">7</a><span class="gd_word" id="A2.I1.i1.p1.1.2.w1">).</span></p>
</div>
</li>
<li id="A2.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i2.p1" class="ltx_para">
<p id="A2.I1.i2.p1.1" class="ltx_p"><span class="gd_word" id="A2.I1.i2.p1.1.1.w1">the</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w2">logits</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w3">temperature:</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w4">we</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w5">tried</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w6">0.6,</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w7">0.8,</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w8">1.0,</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w9">1.2,</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w10">1.4.</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w11">1.0</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w12">performs</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w13">best</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w14">by</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w15">a</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w16">wide</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w17">margin.</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w18">Low</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w19">values</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w20">degrade</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w21">to</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w22">greedy</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w23">search</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w24">performance</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w25">while</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w26">high</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w27">values</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w28">yield</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w29">non-sensical</span><span> </span><span class="gd_word" id="A2.I1.i2.p1.1.1.w30">sentences.</span></p>
</div>
</li>
<li id="A2.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I1.i3.p1" class="ltx_para">
<p id="A2.I1.i3.p1.4" class="ltx_p"><span class="gd_word" id="A2.I1.i3.p1.4.1.w1">the</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.1.w2">normalisation</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.1.w3">temperature</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.1.w4">parameter</span><span> </span><math id="A2.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="A2.I1.i3.p1.1.m1.1a"><mi id="A2.I1.i3.p1.1.m1.1.1" xref="A2.I1.i3.p1.1.m1.1.1.cmml">θ</mi></semantics></math><span class="gd_word" id="A2.I1.i3.p1.4.2.w1">:</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w2">we</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w3">tried</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w4">0.4,</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w5">0.6,</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w6">0.8</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w7">and</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w8">1.0.</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w9">We</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.2.w10">find</span><span> </span><math id="A2.I1.i3.p1.2.m2.1" class="ltx_Math" alttext="\theta=0.6" display="inline"><semantics id="A2.I1.i3.p1.2.m2.1a"><mrow id="A2.I1.i3.p1.2.m2.1.1" xref="A2.I1.i3.p1.2.m2.1.1.cmml"><mi id="A2.I1.i3.p1.2.m2.1.1.2" xref="A2.I1.i3.p1.2.m2.1.1.2.cmml">θ</mi><mo id="A2.I1.i3.p1.2.m2.1.1.1" xref="A2.I1.i3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.I1.i3.p1.2.m2.1.1.3" xref="A2.I1.i3.p1.2.m2.1.1.3.cmml">0.6</mn></mrow></semantics></math><span class="gd_word" id="A2.I1.i3.p1.4.3.w1"/><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w2">performs</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w3">best,</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w4">as</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w5">in</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w6">the</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w7">original</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w8">paper</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.3.w9">(</span><math id="A2.I1.i3.p1.3.m3.1" class="ltx_Math" alttext="\theta=0.4" display="inline"><semantics id="A2.I1.i3.p1.3.m3.1a"><mrow id="A2.I1.i3.p1.3.m3.1.1" xref="A2.I1.i3.p1.3.m3.1.1.cmml"><mi id="A2.I1.i3.p1.3.m3.1.1.2" xref="A2.I1.i3.p1.3.m3.1.1.2.cmml">θ</mi><mo id="A2.I1.i3.p1.3.m3.1.1.1" xref="A2.I1.i3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.I1.i3.p1.3.m3.1.1.3" xref="A2.I1.i3.p1.3.m3.1.1.3.cmml">0.4</mn></mrow></semantics></math><span class="gd_word" id="A2.I1.i3.p1.4.4.w1"/><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w2">is</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w3">on</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w4">par</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w5">but</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w6">slightly</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w7">worse,</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w8">and</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w9">performance</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w10">degrades</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w11">as</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w12">soon</span><span> </span><span class="gd_word" id="A2.I1.i3.p1.4.4.w13">as</span><span> </span><math id="A2.I1.i3.p1.4.m4.1" class="ltx_Math" alttext="\theta\geq 0.8" display="inline"><semantics id="A2.I1.i3.p1.4.m4.1a"><mrow id="A2.I1.i3.p1.4.m4.1.1" xref="A2.I1.i3.p1.4.m4.1.1.cmml"><mi id="A2.I1.i3.p1.4.m4.1.1.2" xref="A2.I1.i3.p1.4.m4.1.1.2.cmml">θ</mi><mo id="A2.I1.i3.p1.4.m4.1.1.1" xref="A2.I1.i3.p1.4.m4.1.1.1.cmml">≥</mo><mn id="A2.I1.i3.p1.4.m4.1.1.3" xref="A2.I1.i3.p1.4.m4.1.1.3.cmml">0.8</mn></mrow></semantics></math><span class="gd_word" id="A2.I1.i3.p1.4.5.w1">).</span></p>
</div>
</li>
</ul>
</div>
<figure id="A2.T7" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A2_T7.png" alt="/static/img/2104.05336-gpt-4/A2_T7.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7: </span><span class="gd_word" id="A2.T7.2.w1">BLEU</span><span> </span><span class="gd_word" id="A2.T7.2.w2">results</span><span> </span><span class="gd_word" id="A2.T7.2.w3">as</span><span> </span><span class="gd_word" id="A2.T7.2.w4">a</span><span> </span><span class="gd_word" id="A2.T7.2.w5">function</span><span> </span><span class="gd_word" id="A2.T7.2.w6">of</span><span> </span><span class="gd_word" id="A2.T7.2.w7">beam</span><span> </span><span class="gd_word" id="A2.T7.2.w8">size</span><span> </span><span class="gd_word" id="A2.T7.2.w9">for</span><span> </span><span class="gd_word" id="A2.T7.2.w10">plain</span><span> </span><span class="gd_word" id="A2.T7.2.w11">beam</span><span> </span><span class="gd_word" id="A2.T7.2.w12">search.</span></figcaption>
</figure>
</section>
<section id="A2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Value-guided beam search.</h4>

<div id="A2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="A2.SS0.SSS0.Px2.p1.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.1.w1">The</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.1.w2">score</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.1.w3">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.1.w4">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.1.w5">candidate</span><span> </span><math id="A2.SS0.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="y_{1}..y_{t}" display="inline"><semantics id="A2.SS0.SSS0.Px2.p1.1.m1.1a"><mrow id="A2.SS0.SSS0.Px2.p1.1.m1.1b"><msub id="A2.SS0.SSS0.Px2.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.2.cmml">y</mi><mn id="A2.SS0.SSS0.Px2.p1.1.m1.1.1.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.1.3.cmml">1</mn></msub><mo id="A2.SS0.SSS0.Px2.p1.1.m1.1.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.2.cmml">.</mo><mo id="A2.SS0.SSS0.Px2.p1.1.m1.1.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.3.cmml">.</mo><msub id="A2.SS0.SSS0.Px2.p1.1.m1.1.4" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.4.cmml"><mi id="A2.SS0.SSS0.Px2.p1.1.m1.1.4.2" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.4.2.cmml">y</mi><mi id="A2.SS0.SSS0.Px2.p1.1.m1.1.4.3" xref="A2.SS0.SSS0.Px2.p1.1.m1.1.4.3.cmml">t</mi></msub></mrow></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.2.w1"/><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.2.w2">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.2.w3">this</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.2.w4">method</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p1.1.2.w5">is:</span></p>
<table id="A2.Ex2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"/>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.Ex2.m1.1" class="ltx_Math" alttext="bs(y_{1}..y_{t})=\frac{\alpha}{t}\log\big{(}\pi(y_{1}..y_{t})\big{)}+(1-\alpha%&#10;)v(y_{1}..y_{t})." display="block"><semantics id="A2.Ex2.m1.1a"><mrow id="A2.Ex2.m1.1b"><mi id="A2.Ex2.m1.1.1" xref="A2.Ex2.m1.1.1.cmml">bs</mi><mrow id="A2.Ex2.m1.1.3" xref="A2.Ex2.m1.1.3.cmml"><mo stretchy="false" id="A2.Ex2.m1.1.3.1" xref="A2.Ex2.m1.1.3.1.cmml">(</mo><msub id="A2.Ex2.m1.1.3.2" xref="A2.Ex2.m1.1.3.2.cmml"><mi id="A2.Ex2.m1.1.3.2.2" xref="A2.Ex2.m1.1.3.2.2.cmml">y</mi><mn id="A2.Ex2.m1.1.3.2.3" xref="A2.Ex2.m1.1.3.2.3.cmml">1</mn></msub><mo id="A2.Ex2.m1.1.3.3" xref="A2.Ex2.m1.1.3.3.cmml">.</mo><mo id="A2.Ex2.m1.1.3.4" xref="A2.Ex2.m1.1.3.4.cmml">.</mo><msub id="A2.Ex2.m1.1.3.5" xref="A2.Ex2.m1.1.3.5.cmml"><mi id="A2.Ex2.m1.1.3.5.2" xref="A2.Ex2.m1.1.3.5.2.cmml">y</mi><mi id="A2.Ex2.m1.1.3.5.3" xref="A2.Ex2.m1.1.3.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.Ex2.m1.1.3.6" xref="A2.Ex2.m1.1.3.6.cmml">)</mo></mrow><mo id="A2.Ex2.m1.1.4" xref="A2.Ex2.m1.1.4.cmml">=</mo><mfrac id="A2.Ex2.m1.1.5" xref="A2.Ex2.m1.1.5.cmml"><mi id="A2.Ex2.m1.1.5.2" xref="A2.Ex2.m1.1.5.2.cmml">α</mi><mi id="A2.Ex2.m1.1.5.3" xref="A2.Ex2.m1.1.5.3.cmml">t</mi></mfrac><mi id="A2.Ex2.m1.1.6" xref="A2.Ex2.m1.1.6.cmml">log</mi><mrow id="A2.Ex2.m1.1.7" xref="A2.Ex2.m1.1.7.cmml"><mo maxsize="120%" minsize="120%" id="A2.Ex2.m1.1.7.1" xref="A2.Ex2.m1.1.7.1.cmml">(</mo><mi id="A2.Ex2.m1.1.7.2" xref="A2.Ex2.m1.1.7.2.cmml">π</mi><mrow id="A2.Ex2.m1.1.7.3" xref="A2.Ex2.m1.1.7.3.cmml"><mo stretchy="false" id="A2.Ex2.m1.1.7.3.1" xref="A2.Ex2.m1.1.7.3.1.cmml">(</mo><msub id="A2.Ex2.m1.1.7.3.2" xref="A2.Ex2.m1.1.7.3.2.cmml"><mi id="A2.Ex2.m1.1.7.3.2.2" xref="A2.Ex2.m1.1.7.3.2.2.cmml">y</mi><mn id="A2.Ex2.m1.1.7.3.2.3" xref="A2.Ex2.m1.1.7.3.2.3.cmml">1</mn></msub><mo id="A2.Ex2.m1.1.7.3.3" xref="A2.Ex2.m1.1.7.3.3.cmml">.</mo><mo id="A2.Ex2.m1.1.7.3.4" xref="A2.Ex2.m1.1.7.3.4.cmml">.</mo><msub id="A2.Ex2.m1.1.7.3.5" xref="A2.Ex2.m1.1.7.3.5.cmml"><mi id="A2.Ex2.m1.1.7.3.5.2" xref="A2.Ex2.m1.1.7.3.5.2.cmml">y</mi><mi id="A2.Ex2.m1.1.7.3.5.3" xref="A2.Ex2.m1.1.7.3.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.Ex2.m1.1.7.3.6" xref="A2.Ex2.m1.1.7.3.6.cmml">)</mo></mrow><mo maxsize="120%" minsize="120%" id="A2.Ex2.m1.1.7.4" xref="A2.Ex2.m1.1.7.4.cmml">)</mo></mrow><mo id="A2.Ex2.m1.1.8" xref="A2.Ex2.m1.1.8.cmml">+</mo><mrow id="A2.Ex2.m1.1.9" xref="A2.Ex2.m1.1.9.cmml"><mo stretchy="false" id="A2.Ex2.m1.1.9.1" xref="A2.Ex2.m1.1.9.1.cmml">(</mo><mn id="A2.Ex2.m1.1.9.2" xref="A2.Ex2.m1.1.9.2.cmml">1</mn><mo id="A2.Ex2.m1.1.9.3" xref="A2.Ex2.m1.1.9.3.cmml">-</mo><mi id="A2.Ex2.m1.1.9.4" xref="A2.Ex2.m1.1.9.4.cmml">α</mi><mo stretchy="false" id="A2.Ex2.m1.1.9.5" xref="A2.Ex2.m1.1.9.5.cmml">)</mo></mrow><mi id="A2.Ex2.m1.1.10" xref="A2.Ex2.m1.1.10.cmml">v</mi><mrow id="A2.Ex2.m1.1.11" xref="A2.Ex2.m1.1.11.cmml"><mo stretchy="false" id="A2.Ex2.m1.1.11.1" xref="A2.Ex2.m1.1.11.1.cmml">(</mo><msub id="A2.Ex2.m1.1.11.2" xref="A2.Ex2.m1.1.11.2.cmml"><mi id="A2.Ex2.m1.1.11.2.2" xref="A2.Ex2.m1.1.11.2.2.cmml">y</mi><mn id="A2.Ex2.m1.1.11.2.3" xref="A2.Ex2.m1.1.11.2.3.cmml">1</mn></msub><mo id="A2.Ex2.m1.1.11.3" xref="A2.Ex2.m1.1.11.3.cmml">.</mo><mo id="A2.Ex2.m1.1.11.4" xref="A2.Ex2.m1.1.11.4.cmml">.</mo><msub id="A2.Ex2.m1.1.11.5" xref="A2.Ex2.m1.1.11.5.cmml"><mi id="A2.Ex2.m1.1.11.5.2" xref="A2.Ex2.m1.1.11.5.2.cmml">y</mi><mi id="A2.Ex2.m1.1.11.5.3" xref="A2.Ex2.m1.1.11.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.Ex2.m1.1.11.6" xref="A2.Ex2.m1.1.11.6.cmml">)</mo></mrow><mo id="A2.Ex2.m1.1.12" xref="A2.Ex2.m1.1.12.cmml">.</mo></mrow></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"/>
</tr>
</table>
</div>
<div id="A2.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="A2.SS0.SSS0.Px2.p2.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w2">hyper-parameters</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w3">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w4">tune</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w5">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w6">slightly</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w7">different</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w8">than</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w9">those</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w10">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w11">plain</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w12">beam</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w13">search.
As</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w14">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w15">do</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w16">not</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w17">see</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w18">performance</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w19">decrease</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w20">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w21">larger</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w22">beam</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w23">size,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w24">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w25">no</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w26">longer</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w27">need</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w28">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w29">find</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w30">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w31">optimal</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w32">one.
Which</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w33">one</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w34">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w35">use</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w36">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w37">largely</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w38">dependent</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w39">on</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w40">how</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w41">much</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w42">computation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w43">one</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w44">can</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w45">afford</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w46">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w47">use.
Performance</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w48">as</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w49">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w50">function</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w51">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w52">this</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w53">quantity</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w54">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w55">reported</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w56">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.1.w57">Section </span><a href="#A3" title="Appendix C Scaling search with computational budget ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">C</a><span class="gd_word" id="A2.SS0.SSS0.Px2.p2.1.2.w1">.</span></p>
</div>
<div id="A2.SS0.SSS0.Px2.p3" class="ltx_para">
<p id="A2.SS0.SSS0.Px2.p3.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w1">Further,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w2">because</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w3">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w4">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w5">additional</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w6">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w7">term,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w8">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w9">have</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w10">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w11">new</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w12">linear</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w13">combination</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.1.w14">weight</span><span> </span><math id="A2.SS0.SSS0.Px2.p3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.SS0.SSS0.Px2.p3.1.m1.1a"><mi id="A2.SS0.SSS0.Px2.p3.1.m1.1.1" xref="A2.SS0.SSS0.Px2.p3.1.m1.1.1.cmml">α</mi></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w1"/><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w2">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w3">tune.
Here</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w4">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w5">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w6">hyper-parameter</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w7">ranges</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w8">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px2.p3.1.2.w9">consider:</span></p>
<ul id="A2.I2" class="ltx_itemize">
<li id="A2.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i1.p1" class="ltx_para">
<p id="A2.I2.i1.p1.1" class="ltx_p"><span class="gd_word" id="A2.I2.i1.p1.1.1.w1">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w2">logits</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w3">temperature:</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w4">as</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w5">for</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w6">plain</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w7">beam</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w8">search,</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w9">we</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w10">tried</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w11">0.6,</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w12">0.8,</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w13">1.0,</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w14">1.2,</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w15">1.4.</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w16">We</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w17">find</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w18">similar</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w19">results:</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w20">1.0</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w21">is</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w22">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w23">best-performing</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w24">temperature</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w25">by</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w26">a</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w27">significant</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w28">margin;</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w29">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w30">reliance</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w31">on</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w32">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w33">value</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w34">mitigates</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w35">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w36">effect</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w37">for</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w38">unprivileged</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w39">metrics</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w40">(where</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w41">the</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w42">value</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w43">is</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w44">a</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w45">good</span><span> </span><span class="gd_word" id="A2.I2.i1.p1.1.1.w46">approximation).</span></p>
</div>
</li>
<li id="A2.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i2.p1" class="ltx_para">
<p id="A2.I2.i2.p1.3" class="ltx_p"><span class="gd_word" id="A2.I2.i2.p1.3.1.w1">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w2">value</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w3">normalisation:</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w4">we</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w5">tried</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w6">using</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w7">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w8">logarithm</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w9">of</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w10">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w11">value</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w12">instead</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w13">of</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w14">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w15">value</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w16">itself,</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w17">with</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w18">appropriate</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.1.w19">scaling:</span><span> </span><math id="A2.I2.i2.p1.1.m1.2" class="ltx_Math" alttext="\log(\frac{v(y_{1}..y_{t})-d}{D-d})" display="inline"><semantics id="A2.I2.i2.p1.1.m1.2a"><mrow id="A2.I2.i2.p1.1.m1.2.3.2" xref="A2.I2.i2.p1.1.m1.2.3.1.cmml"><mi id="A2.I2.i2.p1.1.m1.1.1" xref="A2.I2.i2.p1.1.m1.1.1.cmml">log</mi><mo id="A2.I2.i2.p1.1.m1.2.3.2a" xref="A2.I2.i2.p1.1.m1.2.3.1.cmml">⁡</mo><mrow id="A2.I2.i2.p1.1.m1.2.3.2.1" xref="A2.I2.i2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="A2.I2.i2.p1.1.m1.2.3.2.1.1" xref="A2.I2.i2.p1.1.m1.2.3.1.cmml">(</mo><mfrac id="A2.I2.i2.p1.1.m1.2.2" xref="A2.I2.i2.p1.1.m1.2.2.cmml"><mrow id="A2.I2.i2.p1.1.m1.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.cmml"><mi id="A2.I2.i2.p1.1.m1.2.2.2.1" xref="A2.I2.i2.p1.1.m1.2.2.2.1.cmml">v</mi><mrow id="A2.I2.i2.p1.1.m1.2.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.cmml"><mo stretchy="false" id="A2.I2.i2.p1.1.m1.2.2.2.2.1" xref="A2.I2.i2.p1.1.m1.2.2.2.2.1.cmml">(</mo><msub id="A2.I2.i2.p1.1.m1.2.2.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.2.cmml"><mi id="A2.I2.i2.p1.1.m1.2.2.2.2.2.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.2.2.cmml">y</mi><mn id="A2.I2.i2.p1.1.m1.2.2.2.2.2.3" xref="A2.I2.i2.p1.1.m1.2.2.2.2.2.3.cmml">1</mn></msub><mo id="A2.I2.i2.p1.1.m1.2.2.2.2.3" xref="A2.I2.i2.p1.1.m1.2.2.2.2.3.cmml">.</mo><mo id="A2.I2.i2.p1.1.m1.2.2.2.2.4" xref="A2.I2.i2.p1.1.m1.2.2.2.2.4.cmml">.</mo><msub id="A2.I2.i2.p1.1.m1.2.2.2.2.5" xref="A2.I2.i2.p1.1.m1.2.2.2.2.5.cmml"><mi id="A2.I2.i2.p1.1.m1.2.2.2.2.5.2" xref="A2.I2.i2.p1.1.m1.2.2.2.2.5.2.cmml">y</mi><mi id="A2.I2.i2.p1.1.m1.2.2.2.2.5.3" xref="A2.I2.i2.p1.1.m1.2.2.2.2.5.3.cmml">t</mi></msub><mo stretchy="false" id="A2.I2.i2.p1.1.m1.2.2.2.2.6" xref="A2.I2.i2.p1.1.m1.2.2.2.2.6.cmml">)</mo></mrow><mo id="A2.I2.i2.p1.1.m1.2.2.2.3" xref="A2.I2.i2.p1.1.m1.2.2.2.3.cmml">-</mo><mi id="A2.I2.i2.p1.1.m1.2.2.2.4" xref="A2.I2.i2.p1.1.m1.2.2.2.4.cmml">d</mi></mrow><mrow id="A2.I2.i2.p1.1.m1.2.2.3" xref="A2.I2.i2.p1.1.m1.2.2.3.cmml"><mi id="A2.I2.i2.p1.1.m1.2.2.3.2" xref="A2.I2.i2.p1.1.m1.2.2.3.2.cmml">D</mi><mo id="A2.I2.i2.p1.1.m1.2.2.3.1" xref="A2.I2.i2.p1.1.m1.2.2.3.1.cmml">-</mo><mi id="A2.I2.i2.p1.1.m1.2.2.3.3" xref="A2.I2.i2.p1.1.m1.2.2.3.3.cmml">d</mi></mrow></mfrac><mo stretchy="false" id="A2.I2.i2.p1.1.m1.2.3.2.1.2" xref="A2.I2.i2.p1.1.m1.2.3.1.cmml">)</mo></mrow></mrow></semantics></math><span class="gd_word" id="A2.I2.i2.p1.3.2.w1">.
We</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w2">find</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w3">that</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w4">by</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w5">carefully</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w6">tuning</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w7">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w8">minimum</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w9">and</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w10">maximum</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.2.w11">bounds</span><span> </span><math id="A2.I2.i2.p1.2.m2.1" class="ltx_Math" alttext="d" display="inline"><semantics id="A2.I2.i2.p1.2.m2.1a"><mi id="A2.I2.i2.p1.2.m2.1.1" xref="A2.I2.i2.p1.2.m2.1.1.cmml">d</mi></semantics></math><span class="gd_word" id="A2.I2.i2.p1.3.3.w1"/><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.3.w2">and</span><span> </span><math id="A2.I2.i2.p1.3.m3.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A2.I2.i2.p1.3.m3.1a"><mi id="A2.I2.i2.p1.3.m3.1.1" xref="A2.I2.i2.p1.3.m3.1.1.cmml">D</mi></semantics></math><span class="gd_word" id="A2.I2.i2.p1.3.4.w1"/><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w2">we</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w3">can</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w4">match</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w5">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w6">performance</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w7">we</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w8">obtain</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w9">with</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w10">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w11">plain</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w12">value,</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w13">but</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w14">not</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w15">outperform</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w16">it.</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w17">As</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w18">a</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w19">result</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w20">we</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w21">opt</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w22">for</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w23">the</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w24">simpler</span><span> </span><span class="gd_word" id="A2.I2.i2.p1.3.4.w25">formulation.</span></p>
</div>
</li>
<li id="A2.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I2.i3.p1" class="ltx_para">
<p id="A2.I2.i3.p1.4" class="ltx_p"><span class="gd_word" id="A2.I2.i3.p1.4.1.w1">the</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.1.w2">linear</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.1.w3">combination</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.1.w4">weights</span><span> </span><math id="A2.I2.i3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.I2.i3.p1.1.m1.1a"><mi id="A2.I2.i3.p1.1.m1.1.1" xref="A2.I2.i3.p1.1.m1.1.1.cmml">α</mi></semantics></math><span class="gd_word" id="A2.I2.i3.p1.4.2.w1">:</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w2">we</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w3">swept</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w4">between</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w5">0</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w6">and</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w7">1</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w8">by</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w9">0.1</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w10">increments</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w11">(with</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w12">an</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w13">additional</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w14">measure</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w15">at</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w16">0.95).</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w17">For</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w18">privileged</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w19">metrics,</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w20">we</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.2.w21">find</span><span> </span><math id="A2.I2.i3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="A2.I2.i3.p1.2.m2.1a"><mrow id="A2.I2.i3.p1.2.m2.1.1" xref="A2.I2.i3.p1.2.m2.1.1.cmml"><mi id="A2.I2.i3.p1.2.m2.1.1.2" xref="A2.I2.i3.p1.2.m2.1.1.2.cmml">α</mi><mo id="A2.I2.i3.p1.2.m2.1.1.1" xref="A2.I2.i3.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.I2.i3.p1.2.m2.1.1.3" xref="A2.I2.i3.p1.2.m2.1.1.3.cmml">0.5</mn></mrow></semantics></math><span class="gd_word" id="A2.I2.i3.p1.4.3.w1"/><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w2">to</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w3">perform</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w4">best</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w5">(on</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w6">both</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w7">datasets).</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w8">For</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w9">Multilingual</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w10">BERTScore</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w11">on</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w12">the</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w13">other</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w14">hand,</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w15">much</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w16">larger</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w17">values</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w18">are</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w19">required</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w20">to</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w21">achieve</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w22">best</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.3.w23">performance:</span><span> </span><math id="A2.I2.i3.p1.3.m3.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="A2.I2.i3.p1.3.m3.1a"><mrow id="A2.I2.i3.p1.3.m3.1.1" xref="A2.I2.i3.p1.3.m3.1.1.cmml"><mi id="A2.I2.i3.p1.3.m3.1.1.2" xref="A2.I2.i3.p1.3.m3.1.1.2.cmml">α</mi><mo id="A2.I2.i3.p1.3.m3.1.1.1" xref="A2.I2.i3.p1.3.m3.1.1.1.cmml">=</mo><mn id="A2.I2.i3.p1.3.m3.1.1.3" xref="A2.I2.i3.p1.3.m3.1.1.3.cmml">0.9</mn></mrow></semantics></math><span class="gd_word" id="A2.I2.i3.p1.4.4.w1"/><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.4.w2">for</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.4.w3">ENDE</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.4.w4">and</span><span> </span><math id="A2.I2.i3.p1.4.m4.1" class="ltx_Math" alttext="\alpha=0.95" display="inline"><semantics id="A2.I2.i3.p1.4.m4.1a"><mrow id="A2.I2.i3.p1.4.m4.1.1" xref="A2.I2.i3.p1.4.m4.1.1.cmml"><mi id="A2.I2.i3.p1.4.m4.1.1.2" xref="A2.I2.i3.p1.4.m4.1.1.2.cmml">α</mi><mo id="A2.I2.i3.p1.4.m4.1.1.1" xref="A2.I2.i3.p1.4.m4.1.1.1.cmml">=</mo><mn id="A2.I2.i3.p1.4.m4.1.1.3" xref="A2.I2.i3.p1.4.m4.1.1.3.cmml">0.95</mn></mrow></semantics></math><span class="gd_word" id="A2.I2.i3.p1.4.5.w1"/><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w2">for</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w3">ENFR.</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w4">Our</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w5">hypothesis</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w6">is</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w7">that</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w8">the</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w9">quality</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w10">of</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w11">our</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w12">value</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w13">function</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w14">is</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w15">much</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w16">higher</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w17">for</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w18">this</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.5.w19">last </span><em id="A2.I2.i3.p1.4.1" class="ltx_emph ltx_font_italic">unprivileged</em><span class="gd_word" id="A2.I2.i3.p1.4.6.w1"/><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w2">metric,</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w3">which</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w4">allows</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w5">us</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w6">to</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w7">lean</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w8">more</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w9">heavily</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w10">on</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w11">its</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w12">guidance.</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w13">See</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.6.w14">Table </span><a href="#A2.T8" title="Table 8 ‣ Value-guided beam search. ‣ Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">8</a><span class="gd_word" id="A2.I2.i3.p1.4.7.w1"/><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.7.w2">for</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.7.w3">illustrative</span><span> </span><span class="gd_word" id="A2.I2.i3.p1.4.7.w4">results.</span></p>
</div>
</li>
</ul>
</div>
<figure id="A2.T8" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A2_T8.png" alt="/static/img/2104.05336-gpt-4/A2_T8.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 8: </span><span class="gd_word" id="A2.T8.2.w1">VGBS</span><span> </span><span class="gd_word" id="A2.T8.2.w2">performance</span><span> </span><span class="gd_word" id="A2.T8.2.w3">on</span><span> </span><span class="gd_word" id="A2.T8.2.w4">the</span><span> </span><span class="gd_word" id="A2.T8.2.w5">ENFR</span><span> </span><span class="gd_word" id="A2.T8.2.w6">dataset</span><span> </span><span class="gd_word" id="A2.T8.2.w7">as</span><span> </span><span class="gd_word" id="A2.T8.2.w8">a</span><span> </span><span class="gd_word" id="A2.T8.2.w9">function</span><span> </span><span class="gd_word" id="A2.T8.2.w10">of</span><span> </span><span class="gd_word" id="A2.T8.2.w11">the</span><span> </span><span class="gd_word" id="A2.T8.2.w12">linear</span><span> </span><span class="gd_word" id="A2.T8.2.w13">weight</span><span> </span><math id="A2.T8.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A2.T8.2.m1.1b"><mi id="A2.T8.2.m1.1.1" xref="A2.T8.2.m1.1.1.cmml">α</mi></semantics></math><span class="gd_word" id="A2.T8.3.w1">.</span></figcaption>
</figure>
</section>
<section id="A2.SS0.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">MCTS variants.</h4>

<div id="A2.SS0.SSS0.Px3.p1" class="ltx_para">
<p id="A2.SS0.SSS0.Px3.p1.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w1">MCTS</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w2">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w3">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w4">complex</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w5">algorithm</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w6">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w7">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w8">large</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w9">number</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w10">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w11">hyper-parameters.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w12">found</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w13">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w14">three</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w15">main</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w16">aspects</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w17">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w18">important</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w19">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w20">performance:</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w21">making</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w22">sure</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w23">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w24">policy</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w25">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w27">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w28">terms</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w29">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w30">well-balanced</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w31">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w32">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w33">UCT</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w34">formula,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w35">picking</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w36">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w37">best</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w38">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w39">aggregation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w40">mechanism</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w41">during</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w42">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w43">backup</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w44">phase,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w45">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w46">selecting</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w47">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w48">best</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w49">acting</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w50">criteria</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w51">(once</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w52">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w53">tree</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w54">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p1.1.1.w55">finished).</span></p>
</div>
<div id="A2.SS0.SSS0.Px3.p2" class="ltx_para">
<p id="A2.SS0.SSS0.Px3.p2.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w1">To</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w2">ensure</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w3">balance</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w4">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w5">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w6">UCT</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w7">formula,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w8">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w9">tuned</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w10">two</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p2.1.1.w11">things:</span></p>
<ul id="A2.I3" class="ltx_itemize">
<li id="A2.I3.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I3.i1.p1" class="ltx_para">
<p id="A2.I3.i1.p1.6" class="ltx_p"><span class="gd_word" id="A2.I3.i1.p1.6.1.w1">we</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.1.w2">optimised</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.1.w3">for</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.1.w4">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.1.w5">logits</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.1.w6">temperature</span><span> </span><math id="A2.I3.i1.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A2.I3.i1.p1.1.m1.1a"><mi id="A2.I3.i1.p1.1.m1.1.1" xref="A2.I3.i1.p1.1.m1.1.1.cmml">τ</mi></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.2.w1"/><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.2.w2">and</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.2.w3">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.2.w4">multiplicative</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.2.w5">constant</span><span> </span><math id="A2.I3.i1.p1.2.m2.1" class="ltx_Math" alttext="c_{\mathrm{puct}}" display="inline"><semantics id="A2.I3.i1.p1.2.m2.1a"><msub id="A2.I3.i1.p1.2.m2.1.1" xref="A2.I3.i1.p1.2.m2.1.1.cmml"><mi id="A2.I3.i1.p1.2.m2.1.1.2" xref="A2.I3.i1.p1.2.m2.1.1.2.cmml">c</mi><mi id="A2.I3.i1.p1.2.m2.1.1.3" xref="A2.I3.i1.p1.2.m2.1.1.3.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.3.w1"/><span> </span><em id="A2.I3.i1.p1.6.1" class="ltx_emph ltx_font_italic">jointly</em><span class="gd_word" id="A2.I3.i1.p1.6.4.w1">.</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w2">We</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w3">tried</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w4">temperatures</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w5">0.9,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w6">1.1</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w7">and</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w8">1.3,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w9">in</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w10">conjunction</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.4.w11">with</span><span> </span><math id="A2.I3.i1.p1.3.m3.1" class="ltx_Math" alttext="c_{\mathrm{puct}}" display="inline"><semantics id="A2.I3.i1.p1.3.m3.1a"><msub id="A2.I3.i1.p1.3.m3.1.1" xref="A2.I3.i1.p1.3.m3.1.1.cmml"><mi id="A2.I3.i1.p1.3.m3.1.1.2" xref="A2.I3.i1.p1.3.m3.1.1.2.cmml">c</mi><mi id="A2.I3.i1.p1.3.m3.1.1.3" xref="A2.I3.i1.p1.3.m3.1.1.3.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.5.w1"/><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w2">in</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w3">1.0,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w4">2.0,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w5">3.0,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w6">4.0,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w7">6.0,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w8">8.0.</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w9">For</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w10">privileged</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w11">metrics,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w12">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.5.w13">pair</span><span> </span><math id="A2.I3.i1.p1.4.m4.1" class="ltx_Math" alttext="(\tau=0.9;c_{\mathrm{puct}}=3.0)" display="inline"><semantics id="A2.I3.i1.p1.4.m4.1a"><mrow id="A2.I3.i1.p1.4.m4.1.1.1"><mo stretchy="false" id="A2.I3.i1.p1.4.m4.1.1.1.2">(</mo><mrow id="A2.I3.i1.p1.4.m4.1.1.1.1.2" xref="A2.I3.i1.p1.4.m4.1.1.1.1.3.cmml"><mrow id="A2.I3.i1.p1.4.m4.1.1.1.1.1.1" xref="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.cmml"><mi id="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.2" xref="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.2.cmml">τ</mi><mo id="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.1" xref="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.1.cmml">=</mo><mn id="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.3" xref="A2.I3.i1.p1.4.m4.1.1.1.1.1.1.3.cmml">0.9</mn></mrow><mo id="A2.I3.i1.p1.4.m4.1.1.1.1.2.3" xref="A2.I3.i1.p1.4.m4.1.1.1.1.3a.cmml">;</mo><mrow id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.cmml"><msub id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2.cmml"><mi id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2.2" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2.2.cmml">c</mi><mi id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2.3" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.2.3.cmml">puct</mi></msub><mo id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.1" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.1.cmml">=</mo><mn id="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.3" xref="A2.I3.i1.p1.4.m4.1.1.1.1.2.2.3.cmml">3.0</mn></mrow></mrow><mo stretchy="false" id="A2.I3.i1.p1.4.m4.1.1.1.3">)</mo></mrow></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.6.w1"/><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w2">performed</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w3">best</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w4">across</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w5">both</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w6">datasets</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w7">and</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w8">both</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w9">metrics;</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w10">while</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w11">for</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w12">Multilingual</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w13">BERTScore</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w14">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w15">best</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w16">performer</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.6.w17">was</span><span> </span><math id="A2.I3.i1.p1.5.m5.1" class="ltx_Math" alttext="(\tau=1.1;c_{\mathrm{puct}}=8.0)" display="inline"><semantics id="A2.I3.i1.p1.5.m5.1a"><mrow id="A2.I3.i1.p1.5.m5.1.1.1"><mo stretchy="false" id="A2.I3.i1.p1.5.m5.1.1.1.2">(</mo><mrow id="A2.I3.i1.p1.5.m5.1.1.1.1.2" xref="A2.I3.i1.p1.5.m5.1.1.1.1.3.cmml"><mrow id="A2.I3.i1.p1.5.m5.1.1.1.1.1.1" xref="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.2" xref="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.2.cmml">τ</mi><mo id="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.1" xref="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.1.cmml">=</mo><mn id="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.3" xref="A2.I3.i1.p1.5.m5.1.1.1.1.1.1.3.cmml">1.1</mn></mrow><mo id="A2.I3.i1.p1.5.m5.1.1.1.1.2.3" xref="A2.I3.i1.p1.5.m5.1.1.1.1.3a.cmml">;</mo><mrow id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.cmml"><msub id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2.cmml"><mi id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2.2" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2.2.cmml">c</mi><mi id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2.3" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.2.3.cmml">puct</mi></msub><mo id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.1" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.1.cmml">=</mo><mn id="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.3" xref="A2.I3.i1.p1.5.m5.1.1.1.1.2.2.3.cmml">8.0</mn></mrow></mrow><mo stretchy="false" id="A2.I3.i1.p1.5.m5.1.1.1.3">)</mo></mrow></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.7.w1"/><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w2">across</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w3">both</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w4">datasets.</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w5">Note</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w6">that</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w7">both</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w8">larger</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w9">temperature</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w10">and</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.7.w11">larger</span><span> </span><math id="A2.I3.i1.p1.6.m6.1" class="ltx_Math" alttext="c_{\mathrm{puct}}" display="inline"><semantics id="A2.I3.i1.p1.6.m6.1a"><msub id="A2.I3.i1.p1.6.m6.1.1" xref="A2.I3.i1.p1.6.m6.1.1.cmml"><mi id="A2.I3.i1.p1.6.m6.1.1.2" xref="A2.I3.i1.p1.6.m6.1.1.2.cmml">c</mi><mi id="A2.I3.i1.p1.6.m6.1.1.3" xref="A2.I3.i1.p1.6.m6.1.1.3.cmml">puct</mi></msub></semantics></math><span class="gd_word" id="A2.I3.i1.p1.6.8.w1"/><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w2">encourage</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w3">exploration</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w4">in</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w5">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w6">UCT</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w7">formula,</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w8">thus</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w9">reducing</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w10">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w11">relative</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w12">weight</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w13">of</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w14">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w15">policy</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w16">in</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w17">favour</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w18">of</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w19">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w20">value;</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w21">that</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w22">we</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w23">can</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w24">use</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w25">larger</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w26">scalars</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w27">for</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w28">unprivileged</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w29">metrics</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w30">is</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w31">yet</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w32">another</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w33">indication</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w34">that</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w35">the</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w36">associated</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w37">value</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w38">functions</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w39">are</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w40">more</span><span> </span><span class="gd_word" id="A2.I3.i1.p1.6.8.w41">trustworthy.</span></p>
</div>
</li>
<li id="A2.I3.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A2.I3.i2.p1" class="ltx_para">
<p id="A2.I3.i2.p1.1" class="ltx_p"><span class="gd_word" id="A2.I3.i2.p1.1.1.w1">as</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w2">we</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w3">detailed</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w4">in</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w5">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w6">main</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w7">text,</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w8">we</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w9">rescale</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w10">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w11">values</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w12">dynamically</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w13">during</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w14">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w15">tree</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w16">construction</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w17">so</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w18">that</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w19">all</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w20">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w21">values</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w22">encountered</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w23">until</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w24">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w25">current</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w26">step</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w27">are</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w28">more</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w29">evenly</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w30">distributed</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w31">in</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.1.w32">the</span><span> </span><math id="A2.I3.i2.p1.1.m1.2" class="ltx_Math" alttext="[0,1]" display="inline"><semantics id="A2.I3.i2.p1.1.m1.2a"><mrow id="A2.I3.i2.p1.1.m1.2.3.2" xref="A2.I3.i2.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="A2.I3.i2.p1.1.m1.2.3.2.1" xref="A2.I3.i2.p1.1.m1.2.3.1.cmml">[</mo><mn id="A2.I3.i2.p1.1.m1.1.1" xref="A2.I3.i2.p1.1.m1.1.1.cmml">0</mn><mo id="A2.I3.i2.p1.1.m1.2.3.2.2" xref="A2.I3.i2.p1.1.m1.2.3.1.cmml">,</mo><mn id="A2.I3.i2.p1.1.m1.2.2" xref="A2.I3.i2.p1.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="A2.I3.i2.p1.1.m1.2.3.2.3" xref="A2.I3.i2.p1.1.m1.2.3.1.cmml">]</mo></mrow></semantics></math><span class="gd_word" id="A2.I3.i2.p1.1.2.w1"/><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w2">interval</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w3">by</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w4">mapping</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w5">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w6">minimum</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w7">value</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w8">to</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w9">0</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w10">and</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w11">the</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w12">maximum</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w13">value</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w14">to</span><span> </span><span class="gd_word" id="A2.I3.i2.p1.1.2.w15">1.</span></p>
</div>
</li>
</ul>
</div>
<div id="A2.SS0.SSS0.Px3.p3" class="ltx_para">
<p id="A2.SS0.SSS0.Px3.p3.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w1">We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w2">tested</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w3">two</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w4">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w5">aggregation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w6">operators:</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w7">running</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w8">average</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w9">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w10">maximum.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w11">also</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w12">tried</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w13">two</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w14">action</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w15">selection</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w16">mechanisms:</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w17">picking</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w18">among</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w19">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w20">root’s</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w21">children</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w22">nodes</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w23">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w24">one</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w25">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w26">maximum</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w27">visit</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w28">count,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w29">or</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w30">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w31">one</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w32">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w33">maximum</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w34">aggregated</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p3.1.1.w35">value.</span></p>
</div>
<figure id="A2.T9" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A2_T9.png" alt="/static/img/2104.05336-gpt-4/A2_T9.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 9: </span><span class="gd_word" id="A2.T9.2.w1">BLEU</span><span> </span><span class="gd_word" id="A2.T9.2.w2">and</span><span> </span><span class="gd_word" id="A2.T9.2.w3">Multilingual</span><span> </span><span class="gd_word" id="A2.T9.2.w4">BERTScore</span><span> </span><span class="gd_word" id="A2.T9.2.w5">performance</span><span> </span><span class="gd_word" id="A2.T9.2.w6">when</span><span> </span><span class="gd_word" id="A2.T9.2.w7">using</span><span> </span><span class="gd_word" id="A2.T9.2.w8">different</span><span> </span><span class="gd_word" id="A2.T9.2.w9">value</span><span> </span><span class="gd_word" id="A2.T9.2.w10">aggregation</span><span> </span><span class="gd_word" id="A2.T9.2.w11">mechanisms</span><span> </span><span class="gd_word" id="A2.T9.2.w12">and</span><span> </span><span class="gd_word" id="A2.T9.2.w13">action</span><span> </span><span class="gd_word" id="A2.T9.2.w14">selection</span><span> </span><span class="gd_word" id="A2.T9.2.w15">rules.</span><span> </span><span class="gd_word" id="A2.T9.2.w16">We</span><span> </span><span class="gd_word" id="A2.T9.2.w17">observe</span><span> </span><span class="gd_word" id="A2.T9.2.w18">that</span><span> </span><span class="gd_word" id="A2.T9.2.w19">on</span><span> </span><span class="gd_word" id="A2.T9.2.w20">the</span><span> </span><span class="gd_word" id="A2.T9.2.w21">unprivileged</span><span> </span><span class="gd_word" id="A2.T9.2.w22">metric,</span><span> </span><span class="gd_word" id="A2.T9.2.w23">the</span><span> </span><span class="gd_word" id="A2.T9.2.w24">best</span><span> </span><span class="gd_word" id="A2.T9.2.w25">option</span><span> </span><span class="gd_word" id="A2.T9.2.w26">rely</span><span> </span><span class="gd_word" id="A2.T9.2.w27">more</span><span> </span><span class="gd_word" id="A2.T9.2.w28">heavily</span><span> </span><span class="gd_word" id="A2.T9.2.w29">on</span><span> </span><span class="gd_word" id="A2.T9.2.w30">the</span><span> </span><span class="gd_word" id="A2.T9.2.w31">value</span><span> </span><span class="gd_word" id="A2.T9.2.w32">function;</span><span> </span><span class="gd_word" id="A2.T9.2.w33">contrary</span><span> </span><span class="gd_word" id="A2.T9.2.w34">to</span><span> </span><span class="gd_word" id="A2.T9.2.w35">what</span><span> </span><span class="gd_word" id="A2.T9.2.w36">we</span><span> </span><span class="gd_word" id="A2.T9.2.w37">see</span><span> </span><span class="gd_word" id="A2.T9.2.w38">for</span><span> </span><span class="gd_word" id="A2.T9.2.w39">the</span><span> </span><span class="gd_word" id="A2.T9.2.w40">privileged</span><span> </span><span class="gd_word" id="A2.T9.2.w41">metric.</span></figcaption>
</figure>
<div id="A2.SS0.SSS0.Px3.p4" class="ltx_para">
<p id="A2.SS0.SSS0.Px3.p4.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w1">Our</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w2">observation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w3">once</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w4">again</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w5">underline</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w6">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w7">contrast</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w8">between</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w9">privileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w10">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w11">unprivileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w12">metrics,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w13">as</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w14">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w15">illustrated</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w16">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.1.w17">Table </span><a href="#A2.T9" title="Table 9 ‣ MCTS variants. ‣ Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">9</a><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w1">.
For</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w2">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w3">former,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w4">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w5">best</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w6">choice</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w7">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w8">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w9">use</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w10">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w11">running</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w12">average</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w13">as</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w14">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w15">aggregation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w16">operator</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w17">during</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w18">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w19">backup</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w20">phase,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w21">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w22">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w23">pick</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w24">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w25">root</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w26">child</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w27">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w28">maximum</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w29">visit</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w30">counts.
Conversely,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w31">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w32">Multilingual</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w33">BERTScore</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w34">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w35">found</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w36">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w37">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w38">obtained</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w39">best</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w40">performance</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w41">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w42">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w43">maximum</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w44">aggregation</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w45">operator</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w46">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w47">by</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w48">picking</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w49">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w50">root</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w51">child</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w52">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w53">maximum</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w54">aggregated</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w55">value.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w56">thus</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w57">see</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w58">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w59">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w60">our</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w61">unprivileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w62">metric</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w63">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w64">can</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w65">rely</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w66">on</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w67">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w68">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w69">function</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w70">aggressively;</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w71">while</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w72">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w73">privileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w74">metrics</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w75">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w76">need</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w77">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w78">limit</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w79">our</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w80">exposure</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w81">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px3.p4.1.2.w82">it.</span></p>
</div>
</section>
<section id="A2.SS0.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Sampling + Ranking variants.</h4>

<div id="A2.SS0.SSS0.Px4.p1" class="ltx_para">
<p id="A2.SS0.SSS0.Px4.p1.2" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w1">For</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w2">these</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w3">algorithms,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w4">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w5">really</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w6">only</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w7">have</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w8">a</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w9">single</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w10">hyper-parameter</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w11">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w12">tune:</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w13">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w14">policy</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.1.w15">temperature</span><span> </span><math id="A2.SS0.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="A2.SS0.SSS0.Px4.p1.1.m1.1a"><mi id="A2.SS0.SSS0.Px4.p1.1.m1.1.1" xref="A2.SS0.SSS0.Px4.p1.1.m1.1.1.cmml">τ</mi></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w1">.
Small</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w2">temperatures</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w3">lead</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w4">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w5">little</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w6">diversity</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w7">across</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w8">different</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w9">samples,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w10">but</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w11">ensure</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w12">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w13">samples</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w14">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w15">highly</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w16">ranked</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w17">by</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w18">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w19">model</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w20">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w21">hence</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w22">are</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w23">syntactically</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w24">correct.
On</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w25">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w26">other</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w27">hand,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w28">large</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w29">temperature</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w30">encourage</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w31">diversity,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w32">at</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w33">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w34">price</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w35">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w36">correctness.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w37">sweep</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w38">over</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w39">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w40">[0.15,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w41">0.95]</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w42">interval</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w43">by</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w44">0.1</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w45">increments,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w46">and</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w47">report</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w48">results</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w49">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.2.w50">Table </span><a href="#A2.T10" title="Table 10 ‣ Sampling + Ranking variants. ‣ Appendix B Experimental details and ablations ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">10</a><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w1">.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w2">find</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w3">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w4">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w5">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w6">score-based</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w7">S+R,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w8">balancing</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w9">diversity</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w10">with</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w11">correctness</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w12">means</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w13">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w14">have</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w15">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.3.w16">use</span><span> </span><math id="A2.SS0.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="\tau=0.75" display="inline"><semantics id="A2.SS0.SSS0.Px4.p1.2.m2.1a"><mrow id="A2.SS0.SSS0.Px4.p1.2.m2.1.1" xref="A2.SS0.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="A2.SS0.SSS0.Px4.p1.2.m2.1.1.2" xref="A2.SS0.SSS0.Px4.p1.2.m2.1.1.2.cmml">τ</mi><mo id="A2.SS0.SSS0.Px4.p1.2.m2.1.1.1" xref="A2.SS0.SSS0.Px4.p1.2.m2.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px4.p1.2.m2.1.1.3" xref="A2.SS0.SSS0.Px4.p1.2.m2.1.1.3.cmml">0.75</mn></mrow></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px4.p1.2.4.w1">.</span></p>
</div>
<div id="A2.SS0.SSS0.Px4.p2" class="ltx_para">
<p id="A2.SS0.SSS0.Px4.p2.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w2">story</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w3">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w4">more</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w5">nuanced</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w6">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w7">S+RV.
As</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w8">this</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w9">variant</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w10">relies</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w11">on</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w12">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w13">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w14">function</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w15">rather</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w16">than</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w17">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w18">score</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w19">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w20">rerank</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w21">samples,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w22">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w23">can</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w24">use</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w25">it</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w26">even</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w27">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w28">privileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w29">metrics.
We</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w30">observe</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w31">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w32">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w33">these,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w34">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w35">optimal</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w36">temperature</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w37">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w38">much</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w39">smaller</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.1.w40">(</span><math id="A2.SS0.SSS0.Px4.p2.1.m1.1" class="ltx_Math" alttext="\tau=0.25" display="inline"><semantics id="A2.SS0.SSS0.Px4.p2.1.m1.1a"><mrow id="A2.SS0.SSS0.Px4.p2.1.m1.1.1" xref="A2.SS0.SSS0.Px4.p2.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px4.p2.1.m1.1.1.2" xref="A2.SS0.SSS0.Px4.p2.1.m1.1.1.2.cmml">τ</mi><mo id="A2.SS0.SSS0.Px4.p2.1.m1.1.1.1" xref="A2.SS0.SSS0.Px4.p2.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px4.p2.1.m1.1.1.3" xref="A2.SS0.SSS0.Px4.p2.1.m1.1.1.3.cmml">0.25</mn></mrow></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w1">),</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w2">which</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w3">in</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w4">effect</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w5">means</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w6">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w7">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w8">algorithm</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w9">relies</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w10">more</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w11">heavily</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w12">on</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w13">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w14">policy,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w15">compared</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w16">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w17">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w18">value.
The</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w19">reason</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w20">why</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w21">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w22">once</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w23">again</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w24">that</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w25">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w26">value</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w27">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w28">this</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w29">type</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w30">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w31">metrics</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w32">is</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w33">of</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w34">lower</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p2.1.2.w35">quality.</span></p>
</div>
<div id="A2.SS0.SSS0.Px4.p3" class="ltx_para">
<p id="A2.SS0.SSS0.Px4.p3.1" class="ltx_p"><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w1">In</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w2">contrast,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w3">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w4">optimal</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w5">temperature</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w6">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w7">our</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w8">unprivileged</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w9">metric</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.1.w10">is</span><span> </span><math id="A2.SS0.SSS0.Px4.p3.1.m1.1" class="ltx_Math" alttext="\tau=0.75" display="inline"><semantics id="A2.SS0.SSS0.Px4.p3.1.m1.1a"><mrow id="A2.SS0.SSS0.Px4.p3.1.m1.1.1" xref="A2.SS0.SSS0.Px4.p3.1.m1.1.1.cmml"><mi id="A2.SS0.SSS0.Px4.p3.1.m1.1.1.2" xref="A2.SS0.SSS0.Px4.p3.1.m1.1.1.2.cmml">τ</mi><mo id="A2.SS0.SSS0.Px4.p3.1.m1.1.1.1" xref="A2.SS0.SSS0.Px4.p3.1.m1.1.1.1.cmml">=</mo><mn id="A2.SS0.SSS0.Px4.p3.1.m1.1.1.3" xref="A2.SS0.SSS0.Px4.p3.1.m1.1.1.3.cmml">0.75</mn></mrow></semantics></math><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w1">,</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w2">similar</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w3">to</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w4">what</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w5">we</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w6">find</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w7">for</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w8">the</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w9">score-based</span><span> </span><span class="gd_word" id="A2.SS0.SSS0.Px4.p3.1.2.w10">S+R.
</span></p>
</div>
<figure id="A2.T10" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A2_T10.png" alt="/static/img/2104.05336-gpt-4/A2_T10.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 10: </span><span class="gd_word" id="A2.T10.2.w1">Sampling</span><span> </span><span class="gd_word" id="A2.T10.2.w2">+</span><span> </span><span class="gd_word" id="A2.T10.2.w3">ranking</span><span> </span><span class="gd_word" id="A2.T10.2.w4">performance</span><span> </span><span class="gd_word" id="A2.T10.2.w5">as</span><span> </span><span class="gd_word" id="A2.T10.2.w6">a</span><span> </span><span class="gd_word" id="A2.T10.2.w7">function</span><span> </span><span class="gd_word" id="A2.T10.2.w8">of</span><span> </span><span class="gd_word" id="A2.T10.2.w9">policy</span><span> </span><span class="gd_word" id="A2.T10.2.w10">logits</span><span> </span><span class="gd_word" id="A2.T10.2.w11">temperature,</span><span> </span><span class="gd_word" id="A2.T10.2.w12">for</span><span> </span><span class="gd_word" id="A2.T10.2.w13">both</span><span> </span><span class="gd_word" id="A2.T10.2.w14">score</span><span> </span><span class="gd_word" id="A2.T10.2.w15">and</span><span> </span><span class="gd_word" id="A2.T10.2.w16">value-based</span><span> </span><span class="gd_word" id="A2.T10.2.w17">variants.</span></figcaption>
</figure>
</section>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Scaling search with computational budget</h2>

<figure id="A3.T11" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A3_T11.png" alt="/static/img/2104.05336-gpt-4/A3_T11.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 11: </span><span class="gd_word" id="A3.T11.2.w1">Comparison</span><span> </span><span class="gd_word" id="A3.T11.2.w2">of</span><span> </span><span class="gd_word" id="A3.T11.2.w3">how</span><span> </span><span class="gd_word" id="A3.T11.2.w4">decoding</span><span> </span><span class="gd_word" id="A3.T11.2.w5">algorithms</span><span> </span><span class="gd_word" id="A3.T11.2.w6">scale</span><span> </span><span class="gd_word" id="A3.T11.2.w7">with</span><span> </span><span class="gd_word" id="A3.T11.2.w8">computational</span><span> </span><span class="gd_word" id="A3.T11.2.w9">budget,</span><span> </span><span class="gd_word" id="A3.T11.2.w10">on</span><span> </span><span class="gd_word" id="A3.T11.2.w11">the</span><span> </span><span class="gd_word" id="A3.T11.2.w12">ENFR</span><span> </span><span class="gd_word" id="A3.T11.2.w13">dataset,</span><span> </span><span class="gd_word" id="A3.T11.2.w14">for</span><span> </span><span class="gd_word" id="A3.T11.2.w15">both</span><span> </span><span class="gd_word" id="A3.T11.2.w16">privileged</span><span> </span><span class="gd_word" id="A3.T11.2.w17">and</span><span> </span><span class="gd_word" id="A3.T11.2.w18">unprivileged</span><span> </span><span class="gd_word" id="A3.T11.2.w19">metrics.</span></figcaption>
</figure>
<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p"><span class="gd_word" id="A3.p1.1.1.w1">We</span><span> </span><span class="gd_word" id="A3.p1.1.1.w2">present</span><span> </span><span class="gd_word" id="A3.p1.1.1.w3">more</span><span> </span><span class="gd_word" id="A3.p1.1.1.w4">detailed</span><span> </span><span class="gd_word" id="A3.p1.1.1.w5">scaling</span><span> </span><span class="gd_word" id="A3.p1.1.1.w6">results</span><span> </span><span class="gd_word" id="A3.p1.1.1.w7">in</span><span> </span><span class="gd_word" id="A3.p1.1.1.w8">this</span><span> </span><span class="gd_word" id="A3.p1.1.1.w9">section.
These</span><span> </span><span class="gd_word" id="A3.p1.1.1.w10">confirm</span><span> </span><span class="gd_word" id="A3.p1.1.1.w11">our</span><span> </span><span class="gd_word" id="A3.p1.1.1.w12">main</span><span> </span><span class="gd_word" id="A3.p1.1.1.w13">observation:</span><span> </span><span class="gd_word" id="A3.p1.1.1.w14">the</span><span> </span><span class="gd_word" id="A3.p1.1.1.w15">higher</span><span> </span><span class="gd_word" id="A3.p1.1.1.w16">the</span><span> </span><span class="gd_word" id="A3.p1.1.1.w17">quality</span><span> </span><span class="gd_word" id="A3.p1.1.1.w18">of</span><span> </span><span class="gd_word" id="A3.p1.1.1.w19">the</span><span> </span><span class="gd_word" id="A3.p1.1.1.w20">metric</span><span> </span><span class="gd_word" id="A3.p1.1.1.w21">signal</span><span> </span><span class="gd_word" id="A3.p1.1.1.w22">we</span><span> </span><span class="gd_word" id="A3.p1.1.1.w23">use,</span><span> </span><span class="gd_word" id="A3.p1.1.1.w24">the</span><span> </span><span class="gd_word" id="A3.p1.1.1.w25">better</span><span> </span><span class="gd_word" id="A3.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="A3.p1.1.1.w27">method</span><span> </span><span class="gd_word" id="A3.p1.1.1.w28">scales</span><span> </span><span class="gd_word" id="A3.p1.1.1.w29">with</span><span> </span><span class="gd_word" id="A3.p1.1.1.w30">additional</span><span> </span><span class="gd_word" id="A3.p1.1.1.w31">computation.</span></p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p"><span class="gd_word" id="A3.p2.1.1.w1">We</span><span> </span><span class="gd_word" id="A3.p2.1.1.w2">see</span><span> </span><span class="gd_word" id="A3.p2.1.1.w3">for</span><span> </span><span class="gd_word" id="A3.p2.1.1.w4">instance</span><span> </span><span class="gd_word" id="A3.p2.1.1.w5">that</span><span> </span><span class="gd_word" id="A3.p2.1.1.w6">on</span><span> </span><span class="gd_word" id="A3.p2.1.1.w7">privileged</span><span> </span><span class="gd_word" id="A3.p2.1.1.w8">metrics,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w9">where</span><span> </span><span class="gd_word" id="A3.p2.1.1.w10">value</span><span> </span><span class="gd_word" id="A3.p2.1.1.w11">functions</span><span> </span><span class="gd_word" id="A3.p2.1.1.w12">are</span><span> </span><span class="gd_word" id="A3.p2.1.1.w13">hard</span><span> </span><span class="gd_word" id="A3.p2.1.1.w14">to</span><span> </span><span class="gd_word" id="A3.p2.1.1.w15">train,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w16">the</span><span> </span><span class="gd_word" id="A3.p2.1.1.w17">performance</span><span> </span><span class="gd_word" id="A3.p2.1.1.w18">of</span><span> </span><span class="gd_word" id="A3.p2.1.1.w19">value-based</span><span> </span><span class="gd_word" id="A3.p2.1.1.w20">methods</span><span> </span><span class="gd_word" id="A3.p2.1.1.w21">reaches</span><span> </span><span class="gd_word" id="A3.p2.1.1.w22">its</span><span> </span><span class="gd_word" id="A3.p2.1.1.w23">peak</span><span> </span><span class="gd_word" id="A3.p2.1.1.w24">quickly</span><span> </span><span class="gd_word" id="A3.p2.1.1.w25">and</span><span> </span><span class="gd_word" id="A3.p2.1.1.w26">start</span><span> </span><span class="gd_word" id="A3.p2.1.1.w27">degrading.
Comparatively,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w28">on</span><span> </span><span class="gd_word" id="A3.p2.1.1.w29">unprivileged</span><span> </span><span class="gd_word" id="A3.p2.1.1.w30">metrics,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w31">value-based</span><span> </span><span class="gd_word" id="A3.p2.1.1.w32">methods</span><span> </span><span class="gd_word" id="A3.p2.1.1.w33">keep</span><span> </span><span class="gd_word" id="A3.p2.1.1.w34">improving</span><span> </span><span class="gd_word" id="A3.p2.1.1.w35">with</span><span> </span><span class="gd_word" id="A3.p2.1.1.w36">more</span><span> </span><span class="gd_word" id="A3.p2.1.1.w37">inferences,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w38">eventually</span><span> </span><span class="gd_word" id="A3.p2.1.1.w39">plateauing.
Finally,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w40">score-based</span><span> </span><span class="gd_word" id="A3.p2.1.1.w41">methods</span><span> </span><span class="gd_word" id="A3.p2.1.1.w42">do</span><span> </span><span class="gd_word" id="A3.p2.1.1.w43">not</span><span> </span><span class="gd_word" id="A3.p2.1.1.w44">even</span><span> </span><span class="gd_word" id="A3.p2.1.1.w45">plateau.
As</span><span> </span><span class="gd_word" id="A3.p2.1.1.w46">a</span><span> </span><span class="gd_word" id="A3.p2.1.1.w47">result,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w48">S+R</span><span> </span><span class="gd_word" id="A3.p2.1.1.w49">ends</span><span> </span><span class="gd_word" id="A3.p2.1.1.w50">up</span><span> </span><span class="gd_word" id="A3.p2.1.1.w51">outperforming</span><span> </span><span class="gd_word" id="A3.p2.1.1.w52">MCTS</span><span> </span><span class="gd_word" id="A3.p2.1.1.w53">after</span><span> </span><span class="gd_word" id="A3.p2.1.1.w54">200</span><span> </span><span class="gd_word" id="A3.p2.1.1.w55">simulations</span><span> </span><span class="gd_word" id="A3.p2.1.1.w56">per</span><span> </span><span class="gd_word" id="A3.p2.1.1.w57">token,</span><span> </span><span class="gd_word" id="A3.p2.1.1.w58">although</span><span> </span><span class="gd_word" id="A3.p2.1.1.w59">MCTS</span><span> </span><span class="gd_word" id="A3.p2.1.1.w60">remains</span><span> </span><span class="gd_word" id="A3.p2.1.1.w61">the</span><span> </span><span class="gd_word" id="A3.p2.1.1.w62">best</span><span> </span><span class="gd_word" id="A3.p2.1.1.w63">performer</span><span> </span><span class="gd_word" id="A3.p2.1.1.w64">under</span><span> </span><span class="gd_word" id="A3.p2.1.1.w65">100</span><span> </span><span class="gd_word" id="A3.p2.1.1.w66">simulations.
This</span><span> </span><span class="gd_word" id="A3.p2.1.1.w67">motivates</span><span> </span><span class="gd_word" id="A3.p2.1.1.w68">investigating</span><span> </span><span class="gd_word" id="A3.p2.1.1.w69">a</span><span> </span><span class="gd_word" id="A3.p2.1.1.w70">variant</span><span> </span><span class="gd_word" id="A3.p2.1.1.w71">of</span><span> </span><span class="gd_word" id="A3.p2.1.1.w72">MCTS</span><span> </span><span class="gd_word" id="A3.p2.1.1.w73">which</span><span> </span><span class="gd_word" id="A3.p2.1.1.w74">is</span><span> </span><span class="gd_word" id="A3.p2.1.1.w75">allowed</span><span> </span><span class="gd_word" id="A3.p2.1.1.w76">to</span><span> </span><span class="gd_word" id="A3.p2.1.1.w77">use</span><span> </span><span class="gd_word" id="A3.p2.1.1.w78">the</span><span> </span><span class="gd_word" id="A3.p2.1.1.w79">score</span><span> </span><span class="gd_word" id="A3.p2.1.1.w80">on</span><span> </span><span class="gd_word" id="A3.p2.1.1.w81">completed</span><span> </span><span class="gd_word" id="A3.p2.1.1.w82">sentences</span><span> </span><span class="gd_word" id="A3.p2.1.1.w83">(our</span><span> </span><span class="gd_word" id="A3.p2.1.1.w84">current</span><span> </span><span class="gd_word" id="A3.p2.1.1.w85">algorithm</span><span> </span><span class="gd_word" id="A3.p2.1.1.w86">is</span><span> </span><span class="gd_word" id="A3.p2.1.1.w87">purely</span><span> </span><span class="gd_word" id="A3.p2.1.1.w88">value-based).</span></p>
</div>
<div id="A3.p3" class="ltx_para">
<p id="A3.p3.1" class="ltx_p"><span class="gd_word" id="A3.p3.1.1.w1">Beam</span><span> </span><span class="gd_word" id="A3.p3.1.1.w2">search,</span><span> </span><span class="gd_word" id="A3.p3.1.1.w3">which</span><span> </span><span class="gd_word" id="A3.p3.1.1.w4">does</span><span> </span><span class="gd_word" id="A3.p3.1.1.w5">not</span><span> </span><span class="gd_word" id="A3.p3.1.1.w6">use</span><span> </span><span class="gd_word" id="A3.p3.1.1.w7">the</span><span> </span><span class="gd_word" id="A3.p3.1.1.w8">metric</span><span> </span><span class="gd_word" id="A3.p3.1.1.w9">at</span><span> </span><span class="gd_word" id="A3.p3.1.1.w10">all,</span><span> </span><span class="gd_word" id="A3.p3.1.1.w11">behaves</span><span> </span><span class="gd_word" id="A3.p3.1.1.w12">thus</span><span> </span><span class="gd_word" id="A3.p3.1.1.w13">more</span><span> </span><span class="gd_word" id="A3.p3.1.1.w14">similarly</span><span> </span><span class="gd_word" id="A3.p3.1.1.w15">across</span><span> </span><span class="gd_word" id="A3.p3.1.1.w16">all</span><span> </span><span class="gd_word" id="A3.p3.1.1.w17">metrics,</span><span> </span><span class="gd_word" id="A3.p3.1.1.w18">quickly</span><span> </span><span class="gd_word" id="A3.p3.1.1.w19">reaching</span><span> </span><span class="gd_word" id="A3.p3.1.1.w20">its</span><span> </span><span class="gd_word" id="A3.p3.1.1.w21">peak</span><span> </span><span class="gd_word" id="A3.p3.1.1.w22">performance</span><span> </span><span class="gd_word" id="A3.p3.1.1.w23">and</span><span> </span><span class="gd_word" id="A3.p3.1.1.w24">then</span><span> </span><span class="gd_word" id="A3.p3.1.1.w25">plateauing.
The</span><span> </span><span class="gd_word" id="A3.p3.1.1.w26">length</span><span> </span><span class="gd_word" id="A3.p3.1.1.w27">penalty</span><span> </span><span class="gd_word" id="A3.p3.1.1.w28">is</span><span> </span><span class="gd_word" id="A3.p3.1.1.w29">crucial</span><span> </span><span class="gd_word" id="A3.p3.1.1.w30">to</span><span> </span><span class="gd_word" id="A3.p3.1.1.w31">prevent</span><span> </span><span class="gd_word" id="A3.p3.1.1.w32">performance</span><span> </span><span class="gd_word" id="A3.p3.1.1.w33">degradation.</span></p>
</div>
<div id="A3.p4" class="ltx_para">
<p id="A3.p4.1" class="ltx_p"><span class="gd_word" id="A3.p4.1.1.w1">Another</span><span> </span><span class="gd_word" id="A3.p4.1.1.w2">interesting</span><span> </span><span class="gd_word" id="A3.p4.1.1.w3">observation</span><span> </span><span class="gd_word" id="A3.p4.1.1.w4">is</span><span> </span><span class="gd_word" id="A3.p4.1.1.w5">that</span><span> </span><span class="gd_word" id="A3.p4.1.1.w6">S+RV,</span><span> </span><span class="gd_word" id="A3.p4.1.1.w7">the</span><span> </span><span class="gd_word" id="A3.p4.1.1.w8">value-based</span><span> </span><span class="gd_word" id="A3.p4.1.1.w9">alternative</span><span> </span><span class="gd_word" id="A3.p4.1.1.w10">of</span><span> </span><span class="gd_word" id="A3.p4.1.1.w11">S+R,</span><span> </span><span class="gd_word" id="A3.p4.1.1.w12">performs</span><span> </span><span class="gd_word" id="A3.p4.1.1.w13">worse</span><span> </span><span class="gd_word" id="A3.p4.1.1.w14">than</span><span> </span><span class="gd_word" id="A3.p4.1.1.w15">VGBS</span><span> </span><span class="gd_word" id="A3.p4.1.1.w16">or</span><span> </span><span class="gd_word" id="A3.p4.1.1.w17">MCTS.
It</span><span> </span><span class="gd_word" id="A3.p4.1.1.w18">appears</span><span> </span><span class="gd_word" id="A3.p4.1.1.w19">that</span><span> </span><span class="gd_word" id="A3.p4.1.1.w20">the</span><span> </span><span class="gd_word" id="A3.p4.1.1.w21">crucial</span><span> </span><span class="gd_word" id="A3.p4.1.1.w22">ingredient</span><span> </span><span class="gd_word" id="A3.p4.1.1.w23">to</span><span> </span><span class="gd_word" id="A3.p4.1.1.w24">S+R</span><span> </span><span class="gd_word" id="A3.p4.1.1.w25">good</span><span> </span><span class="gd_word" id="A3.p4.1.1.w26">performance</span><span> </span><span class="gd_word" id="A3.p4.1.1.w27">is</span><span> </span><span class="gd_word" id="A3.p4.1.1.w28">direct</span><span> </span><span class="gd_word" id="A3.p4.1.1.w29">access</span><span> </span><span class="gd_word" id="A3.p4.1.1.w30">to</span><span> </span><span class="gd_word" id="A3.p4.1.1.w31">the</span><span> </span><span class="gd_word" id="A3.p4.1.1.w32">score,</span><span> </span><span class="gd_word" id="A3.p4.1.1.w33">rather</span><span> </span><span class="gd_word" id="A3.p4.1.1.w34">than</span><span> </span><span class="gd_word" id="A3.p4.1.1.w35">its</span><span> </span><span class="gd_word" id="A3.p4.1.1.w36">simple</span><span> </span><span class="gd_word" id="A3.p4.1.1.w37">search</span><span> </span><span class="gd_word" id="A3.p4.1.1.w38">mechanism.</span></p>
</div>
<div id="A3.p5" class="ltx_para">
<p id="A3.p5.7" class="ltx_p"><span class="gd_word" id="A3.p5.7.1.w1">Finally,</span><span> </span><span class="gd_word" id="A3.p5.7.1.w2">we</span><span> </span><span class="gd_word" id="A3.p5.7.1.w3">note</span><span> </span><span class="gd_word" id="A3.p5.7.1.w4">that</span><span> </span><span class="gd_word" id="A3.p5.7.1.w5">for</span><span> </span><span class="gd_word" id="A3.p5.7.1.w6">VGBS,</span><span> </span><span class="gd_word" id="A3.p5.7.1.w7">each</span><span> </span><span class="gd_word" id="A3.p5.7.1.w8">token</span><span> </span><span class="gd_word" id="A3.p5.7.1.w9">costs</span><span> </span><math id="A3.p5.1.m1.1" class="ltx_Math" alttext="k+k^{2}" display="inline"><semantics id="A3.p5.1.m1.1a"><mrow id="A3.p5.1.m1.1.1" xref="A3.p5.1.m1.1.1.cmml"><mi id="A3.p5.1.m1.1.1.2" xref="A3.p5.1.m1.1.1.2.cmml">k</mi><mo id="A3.p5.1.m1.1.1.1" xref="A3.p5.1.m1.1.1.1.cmml">+</mo><msup id="A3.p5.1.m1.1.1.3" xref="A3.p5.1.m1.1.1.3.cmml"><mi id="A3.p5.1.m1.1.1.3.2" xref="A3.p5.1.m1.1.1.3.2.cmml">k</mi><mn id="A3.p5.1.m1.1.1.3.3" xref="A3.p5.1.m1.1.1.3.3.cmml">2</mn></msup></mrow></semantics></math><span class="gd_word" id="A3.p5.7.2.w1"/><span> </span><span class="gd_word" id="A3.p5.7.2.w2">inferences</span><span> </span><span class="gd_word" id="A3.p5.7.2.w3">(</span><math id="A3.p5.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.p5.2.m2.1a"><mi id="A3.p5.2.m2.1.1" xref="A3.p5.2.m2.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="A3.p5.7.3.w1"/><span> </span><span class="gd_word" id="A3.p5.7.3.w2">to</span><span> </span><span class="gd_word" id="A3.p5.7.3.w3">compute</span><span> </span><span class="gd_word" id="A3.p5.7.3.w4">the</span><span> </span><span class="gd_word" id="A3.p5.7.3.w5">policy</span><span> </span><span class="gd_word" id="A3.p5.7.3.w6">for</span><span> </span><span class="gd_word" id="A3.p5.7.3.w7">every</span><span> </span><span class="gd_word" id="A3.p5.7.3.w8">beam,</span><span> </span><math id="A3.p5.3.m3.1" class="ltx_Math" alttext="k^{2}" display="inline"><semantics id="A3.p5.3.m3.1a"><msup id="A3.p5.3.m3.1.1" xref="A3.p5.3.m3.1.1.cmml"><mi id="A3.p5.3.m3.1.1.2" xref="A3.p5.3.m3.1.1.2.cmml">k</mi><mn id="A3.p5.3.m3.1.1.3" xref="A3.p5.3.m3.1.1.3.cmml">2</mn></msup></semantics></math><span class="gd_word" id="A3.p5.7.4.w1"/><span> </span><span class="gd_word" id="A3.p5.7.4.w2">to</span><span> </span><span class="gd_word" id="A3.p5.7.4.w3">compute</span><span> </span><span class="gd_word" id="A3.p5.7.4.w4">the</span><span> </span><span class="gd_word" id="A3.p5.7.4.w5">value</span><span> </span><span class="gd_word" id="A3.p5.7.4.w6">for</span><span> </span><span class="gd_word" id="A3.p5.7.4.w7">the</span><span> </span><math id="A3.p5.4.m4.1" class="ltx_Math" alttext="k^{2}" display="inline"><semantics id="A3.p5.4.m4.1a"><msup id="A3.p5.4.m4.1.1" xref="A3.p5.4.m4.1.1.cmml"><mi id="A3.p5.4.m4.1.1.2" xref="A3.p5.4.m4.1.1.2.cmml">k</mi><mn id="A3.p5.4.m4.1.1.3" xref="A3.p5.4.m4.1.1.3.cmml">2</mn></msup></semantics></math><span class="gd_word" id="A3.p5.7.5.w1"/><span> </span><span class="gd_word" id="A3.p5.7.5.w2">possible</span><span> </span><span class="gd_word" id="A3.p5.7.5.w3">follow-up</span><span> </span><span class="gd_word" id="A3.p5.7.5.w4">tokens).
As</span><span> </span><span class="gd_word" id="A3.p5.7.5.w5">a</span><span> </span><span class="gd_word" id="A3.p5.7.5.w6">result,</span><span> </span><span class="gd_word" id="A3.p5.7.5.w7">we</span><span> </span><span class="gd_word" id="A3.p5.7.5.w8">use</span><span> </span><span class="gd_word" id="A3.p5.7.5.w9">the</span><span> </span><span class="gd_word" id="A3.p5.7.5.w10">smallest</span><span> </span><math id="A3.p5.5.m5.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A3.p5.5.m5.1a"><mi id="A3.p5.5.m5.1.1" xref="A3.p5.5.m5.1.1.cmml">k</mi></semantics></math><span class="gd_word" id="A3.p5.7.6.w1"/><span> </span><span class="gd_word" id="A3.p5.7.6.w2">such</span><span> </span><span class="gd_word" id="A3.p5.7.6.w3">that</span><span> </span><math id="A3.p5.6.m6.1" class="ltx_Math" alttext="k+k^{2}\geq n" display="inline"><semantics id="A3.p5.6.m6.1a"><mrow id="A3.p5.6.m6.1.1" xref="A3.p5.6.m6.1.1.cmml"><mrow id="A3.p5.6.m6.1.1.2" xref="A3.p5.6.m6.1.1.2.cmml"><mi id="A3.p5.6.m6.1.1.2.2" xref="A3.p5.6.m6.1.1.2.2.cmml">k</mi><mo id="A3.p5.6.m6.1.1.2.1" xref="A3.p5.6.m6.1.1.2.1.cmml">+</mo><msup id="A3.p5.6.m6.1.1.2.3" xref="A3.p5.6.m6.1.1.2.3.cmml"><mi id="A3.p5.6.m6.1.1.2.3.2" xref="A3.p5.6.m6.1.1.2.3.2.cmml">k</mi><mn id="A3.p5.6.m6.1.1.2.3.3" xref="A3.p5.6.m6.1.1.2.3.3.cmml">2</mn></msup></mrow><mo id="A3.p5.6.m6.1.1.1" xref="A3.p5.6.m6.1.1.1.cmml">≥</mo><mi id="A3.p5.6.m6.1.1.3" xref="A3.p5.6.m6.1.1.3.cmml">n</mi></mrow></semantics></math><span class="gd_word" id="A3.p5.7.7.w1"/><span> </span><span class="gd_word" id="A3.p5.7.7.w2">when</span><span> </span><span class="gd_word" id="A3.p5.7.7.w3">allowing</span><span> </span><math id="A3.p5.7.m7.1" class="ltx_Math" alttext="n" display="inline"><semantics id="A3.p5.7.m7.1a"><mi id="A3.p5.7.m7.1.1" xref="A3.p5.7.m7.1.1.cmml">n</mi></semantics></math><span class="gd_word" id="A3.p5.7.8.w1"/><span> </span><span class="gd_word" id="A3.p5.7.8.w2">simulations</span><span> </span><span class="gd_word" id="A3.p5.7.8.w3">for</span><span> </span><span class="gd_word" id="A3.p5.7.8.w4">other</span><span> </span><span class="gd_word" id="A3.p5.7.8.w5">decoding</span><span> </span><span class="gd_word" id="A3.p5.7.8.w6">algorithms.</span></p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Supervised policy vs Distilled policy</h2>

<div id="A4.p1" class="ltx_para">
<p id="A4.p1.1" class="ltx_p"><span class="gd_word" id="A4.p1.1.1.w1">As</span><span> </span><span class="gd_word" id="A4.p1.1.1.w2">we</span><span> </span><span class="gd_word" id="A4.p1.1.1.w3">study</span><span> </span><span class="gd_word" id="A4.p1.1.1.w4">decoding</span><span> </span><span class="gd_word" id="A4.p1.1.1.w5">mechanisms</span><span> </span><span class="gd_word" id="A4.p1.1.1.w6">on</span><span> </span><span class="gd_word" id="A4.p1.1.1.w7">privileged</span><span> </span><span class="gd_word" id="A4.p1.1.1.w8">metrics</span><span> </span><span class="gd_word" id="A4.p1.1.1.w9">based</span><span> </span><span class="gd_word" id="A4.p1.1.1.w10">on</span><span> </span><span class="gd_word" id="A4.p1.1.1.w11">the</span><span> </span><span class="gd_word" id="A4.p1.1.1.w12">ground</span><span> </span><span class="gd_word" id="A4.p1.1.1.w13">truth,</span><span> </span><span class="gd_word" id="A4.p1.1.1.w14">we</span><span> </span><span class="gd_word" id="A4.p1.1.1.w15">cannot</span><span> </span><span class="gd_word" id="A4.p1.1.1.w16">train</span><span> </span><span class="gd_word" id="A4.p1.1.1.w17">our</span><span> </span><span class="gd_word" id="A4.p1.1.1.w18">value</span><span> </span><span class="gd_word" id="A4.p1.1.1.w19">networks</span><span> </span><span class="gd_word" id="A4.p1.1.1.w20">on</span><span> </span><span class="gd_word" id="A4.p1.1.1.w21">the</span><span> </span><span class="gd_word" id="A4.p1.1.1.w22">initial</span><span> </span><span class="gd_word" id="A4.p1.1.1.w23">supervised</span><span> </span><span class="gd_word" id="A4.p1.1.1.w24">dataset</span><span> </span><span class="gd_word" id="A4.p1.1.1.w25">(where</span><span> </span><span class="gd_word" id="A4.p1.1.1.w26">the</span><span> </span><span class="gd_word" id="A4.p1.1.1.w27">value</span><span> </span><span class="gd_word" id="A4.p1.1.1.w28">target</span><span> </span><span class="gd_word" id="A4.p1.1.1.w29">would</span><span> </span><span class="gd_word" id="A4.p1.1.1.w30">be</span><span> </span><span class="gd_word" id="A4.p1.1.1.w31">1</span><span> </span><span class="gd_word" id="A4.p1.1.1.w32">for</span><span> </span><span class="gd_word" id="A4.p1.1.1.w33">all</span><span> </span><span class="gd_word" id="A4.p1.1.1.w34">items,</span><span> </span><span class="gd_word" id="A4.p1.1.1.w35">as</span><span> </span><span class="gd_word" id="A4.p1.1.1.w36">the</span><span> </span><span class="gd_word" id="A4.p1.1.1.w37">ground</span><span> </span><span class="gd_word" id="A4.p1.1.1.w38">truth</span><span> </span><span class="gd_word" id="A4.p1.1.1.w39">targets</span><span> </span><span class="gd_word" id="A4.p1.1.1.w40">are</span><span> </span><span class="gd_word" id="A4.p1.1.1.w41">considered</span><span> </span><span class="gd_word" id="A4.p1.1.1.w42">optimal).
As</span><span> </span><span class="gd_word" id="A4.p1.1.1.w43">a</span><span> </span><span class="gd_word" id="A4.p1.1.1.w44">result</span><span> </span><span class="gd_word" id="A4.p1.1.1.w45">we</span><span> </span><span class="gd_word" id="A4.p1.1.1.w46">go</span><span> </span><span class="gd_word" id="A4.p1.1.1.w47">through</span><span> </span><span class="gd_word" id="A4.p1.1.1.w48">an</span><span> </span><span class="gd_word" id="A4.p1.1.1.w49">intermediate</span><span> </span><span class="gd_word" id="A4.p1.1.1.w50">step,</span><span> </span><span class="gd_word" id="A4.p1.1.1.w51">first</span><span> </span><span class="gd_word" id="A4.p1.1.1.w52">training</span><span> </span><span class="gd_word" id="A4.p1.1.1.w53">a</span><span> </span><span class="gd_word" id="A4.p1.1.1.w54">supervised</span><span> </span><span class="gd_word" id="A4.p1.1.1.w55">policy</span><span> </span><span class="gd_word" id="A4.p1.1.1.w56">model,</span><span> </span><span class="gd_word" id="A4.p1.1.1.w57">and</span><span> </span><span class="gd_word" id="A4.p1.1.1.w58">then</span><span> </span><span class="gd_word" id="A4.p1.1.1.w59">replacing</span><span> </span><span class="gd_word" id="A4.p1.1.1.w60">ground</span><span> </span><span class="gd_word" id="A4.p1.1.1.w61">truth</span><span> </span><span class="gd_word" id="A4.p1.1.1.w62">targets</span><span> </span><span class="gd_word" id="A4.p1.1.1.w63">by</span><span> </span><span class="gd_word" id="A4.p1.1.1.w64">a</span><span> </span><span class="gd_word" id="A4.p1.1.1.w65">greedy</span><span> </span><span class="gd_word" id="A4.p1.1.1.w66">sample</span><span> </span><span class="gd_word" id="A4.p1.1.1.w67">from</span><span> </span><span class="gd_word" id="A4.p1.1.1.w68">the</span><span> </span><span class="gd_word" id="A4.p1.1.1.w69">said</span><span> </span><span class="gd_word" id="A4.p1.1.1.w70">policy</span><span> </span><span class="gd_word" id="A4.p1.1.1.w71">to</span><span> </span><span class="gd_word" id="A4.p1.1.1.w72">create</span><span> </span><span class="gd_word" id="A4.p1.1.1.w73">a</span><span> </span><span class="gd_word" id="A4.p1.1.1.w74">new</span><span> </span><span class="gd_word" id="A4.p1.1.1.w75">distillation</span><span> </span><span class="gd_word" id="A4.p1.1.1.w76">dataset.</span></p>
</div>
<div id="A4.p2" class="ltx_para">
<p id="A4.p2.1" class="ltx_p"><span class="gd_word" id="A4.p2.1.1.w1">We</span><span> </span><span class="gd_word" id="A4.p2.1.1.w2">observe</span><span> </span><span class="gd_word" id="A4.p2.1.1.w3">is</span><span> </span><span class="gd_word" id="A4.p2.1.1.w4">the</span><span> </span><span class="gd_word" id="A4.p2.1.1.w5">performance</span><span> </span><span class="gd_word" id="A4.p2.1.1.w6">of</span><span> </span><span class="gd_word" id="A4.p2.1.1.w7">the</span><span> </span><span class="gd_word" id="A4.p2.1.1.w8">policy</span><span> </span><span class="gd_word" id="A4.p2.1.1.w9">models</span><span> </span><span class="gd_word" id="A4.p2.1.1.w10">trained</span><span> </span><span class="gd_word" id="A4.p2.1.1.w11">on</span><span> </span><span class="gd_word" id="A4.p2.1.1.w12">the</span><span> </span><span class="gd_word" id="A4.p2.1.1.w13">distillation</span><span> </span><span class="gd_word" id="A4.p2.1.1.w14">datasets</span><span> </span><span class="gd_word" id="A4.p2.1.1.w15">is</span><span> </span><span class="gd_word" id="A4.p2.1.1.w16">slightly</span><span> </span><span class="gd_word" id="A4.p2.1.1.w17">lower</span><span> </span><span class="gd_word" id="A4.p2.1.1.w18">than</span><span> </span><span class="gd_word" id="A4.p2.1.1.w19">that</span><span> </span><span class="gd_word" id="A4.p2.1.1.w20">of</span><span> </span><span class="gd_word" id="A4.p2.1.1.w21">their</span><span> </span><span class="gd_word" id="A4.p2.1.1.w22">plainly</span><span> </span><span class="gd_word" id="A4.p2.1.1.w23">supervised</span><span> </span><span class="gd_word" id="A4.p2.1.1.w24">counterparts,</span><span> </span><span class="gd_word" id="A4.p2.1.1.w25">as</span><span> </span><span class="gd_word" id="A4.p2.1.1.w26">illustrated</span><span> </span><span class="gd_word" id="A4.p2.1.1.w27">in</span><span> </span><span class="gd_word" id="A4.p2.1.1.w28">Table </span><a href="#A4.T12" title="Table 12 ‣ Appendix D Supervised policy vs Distilled policy ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">12</a><span class="gd_word" id="A4.p2.1.2.w1">.
The</span><span> </span><span class="gd_word" id="A4.p2.1.2.w2">effect</span><span> </span><span class="gd_word" id="A4.p2.1.2.w3">is</span><span> </span><span class="gd_word" id="A4.p2.1.2.w4">larger</span><span> </span><span class="gd_word" id="A4.p2.1.2.w5">for</span><span> </span><span class="gd_word" id="A4.p2.1.2.w6">the</span><span> </span><span class="gd_word" id="A4.p2.1.2.w7">bigger</span><span> </span><span class="gd_word" id="A4.p2.1.2.w8">dataset,</span><span> </span><span class="gd_word" id="A4.p2.1.2.w9">ENFR.</span></p>
</div>
<div id="A4.p3" class="ltx_para">
<p id="A4.p3.1" class="ltx_p"><span class="gd_word" id="A4.p3.1.1.w1">This</span><span> </span><span class="gd_word" id="A4.p3.1.1.w2">prompts</span><span> </span><span class="gd_word" id="A4.p3.1.1.w3">another</span><span> </span><span class="gd_word" id="A4.p3.1.1.w4">line</span><span> </span><span class="gd_word" id="A4.p3.1.1.w5">of</span><span> </span><span class="gd_word" id="A4.p3.1.1.w6">investigation:</span><span> </span><span class="gd_word" id="A4.p3.1.1.w7">what</span><span> </span><span class="gd_word" id="A4.p3.1.1.w8">happens</span><span> </span><span class="gd_word" id="A4.p3.1.1.w9">if</span><span> </span><span class="gd_word" id="A4.p3.1.1.w10">at</span><span> </span><span class="gd_word" id="A4.p3.1.1.w11">decoding</span><span> </span><span class="gd_word" id="A4.p3.1.1.w12">time</span><span> </span><span class="gd_word" id="A4.p3.1.1.w13">we</span><span> </span><span class="gd_word" id="A4.p3.1.1.w14">use</span><span> </span><span class="gd_word" id="A4.p3.1.1.w15">a</span><span> </span><span class="gd_word" id="A4.p3.1.1.w16">value</span><span> </span><span class="gd_word" id="A4.p3.1.1.w17">model</span><span> </span><span class="gd_word" id="A4.p3.1.1.w18">(trained</span><span> </span><span class="gd_word" id="A4.p3.1.1.w19">on</span><span> </span><span class="gd_word" id="A4.p3.1.1.w20">a</span><span> </span><span class="gd_word" id="A4.p3.1.1.w21">distillation</span><span> </span><span class="gd_word" id="A4.p3.1.1.w22">dataset)</span><span> </span><span class="gd_word" id="A4.p3.1.1.w23">together</span><span> </span><span class="gd_word" id="A4.p3.1.1.w24">with</span><span> </span><span class="gd_word" id="A4.p3.1.1.w25">a</span><span> </span><span class="gd_word" id="A4.p3.1.1.w26">policy</span><span> </span><span class="gd_word" id="A4.p3.1.1.w27">model</span><span> </span><span class="gd_word" id="A4.p3.1.1.w28">trained</span><span> </span><span class="gd_word" id="A4.p3.1.1.w29">on</span><span> </span><span class="gd_word" id="A4.p3.1.1.w30">a</span><span> </span><span class="gd_word" id="A4.p3.1.1.w31">supervised</span><span> </span><span class="gd_word" id="A4.p3.1.1.w32">dataset?
We</span><span> </span><span class="gd_word" id="A4.p3.1.1.w33">present</span><span> </span><span class="gd_word" id="A4.p3.1.1.w34">BLEU</span><span> </span><span class="gd_word" id="A4.p3.1.1.w35">results</span><span> </span><span class="gd_word" id="A4.p3.1.1.w36">for</span><span> </span><span class="gd_word" id="A4.p3.1.1.w37">MCTS</span><span> </span><span class="gd_word" id="A4.p3.1.1.w38">in</span><span> </span><span class="gd_word" id="A4.p3.1.1.w39">Table </span><a href="#A4.T13" title="Table 13 ‣ Appendix D Supervised policy vs Distilled policy ‣ Machine Translation Decoding beyond Beam Search" class="ltx_ref">13</a><span class="gd_word" id="A4.p3.1.2.w1">.
On</span><span> </span><span class="gd_word" id="A4.p3.1.2.w2">the</span><span> </span><span class="gd_word" id="A4.p3.1.2.w3">larger</span><span> </span><span class="gd_word" id="A4.p3.1.2.w4">dataset,</span><span> </span><span class="gd_word" id="A4.p3.1.2.w5">we</span><span> </span><span class="gd_word" id="A4.p3.1.2.w6">see</span><span> </span><span class="gd_word" id="A4.p3.1.2.w7">that</span><span> </span><span class="gd_word" id="A4.p3.1.2.w8">MCTS</span><span> </span><span class="gd_word" id="A4.p3.1.2.w9">decoding</span><span> </span><span class="gd_word" id="A4.p3.1.2.w10">outperforms</span><span> </span><span class="gd_word" id="A4.p3.1.2.w11">any</span><span> </span><span class="gd_word" id="A4.p3.1.2.w12">other</span><span> </span><span class="gd_word" id="A4.p3.1.2.w13">type</span><span> </span><span class="gd_word" id="A4.p3.1.2.w14">of</span><span> </span><span class="gd_word" id="A4.p3.1.2.w15">decoding.
Interestingly,</span><span> </span><span class="gd_word" id="A4.p3.1.2.w16">we</span><span> </span><span class="gd_word" id="A4.p3.1.2.w17">obtain</span><span> </span><span class="gd_word" id="A4.p3.1.2.w18">an</span><span> </span><span class="gd_word" id="A4.p3.1.2.w19">improvement</span><span> </span><span class="gd_word" id="A4.p3.1.2.w20">of</span><span> </span><span class="gd_word" id="A4.p3.1.2.w21">more</span><span> </span><span class="gd_word" id="A4.p3.1.2.w22">than</span><span> </span><span class="gd_word" id="A4.p3.1.2.w23">1</span><span> </span><span class="gd_word" id="A4.p3.1.2.w24">BLEU</span><span> </span><span class="gd_word" id="A4.p3.1.2.w25">point</span><span> </span><span class="gd_word" id="A4.p3.1.2.w26">over</span><span> </span><span class="gd_word" id="A4.p3.1.2.w27">the</span><span> </span><span class="gd_word" id="A4.p3.1.2.w28">supervised</span><span> </span><span class="gd_word" id="A4.p3.1.2.w29">baseline</span><span> </span><span class="gd_word" id="A4.p3.1.2.w30">when</span><span> </span><span class="gd_word" id="A4.p3.1.2.w31">using</span><span> </span><span class="gd_word" id="A4.p3.1.2.w32">a</span><span> </span><span class="gd_word" id="A4.p3.1.2.w33">Multilingual</span><span> </span><span class="gd_word" id="A4.p3.1.2.w34">BERTScore</span><span> </span><span class="gd_word" id="A4.p3.1.2.w35">value</span><span> </span><span class="gd_word" id="A4.p3.1.2.w36">function;</span><span> </span><span class="gd_word" id="A4.p3.1.2.w37">and</span><span> </span><span class="gd_word" id="A4.p3.1.2.w38">we</span><span> </span><span class="gd_word" id="A4.p3.1.2.w39">obtain</span><span> </span><span class="gd_word" id="A4.p3.1.2.w40">this</span><span> </span><span class="gd_word" id="A4.p3.1.2.w41">result</span><span> </span><span class="gd_word" id="A4.p3.1.2.w42">with</span><span> </span><span class="gd_word" id="A4.p3.1.2.w43">a</span><span> </span><span class="gd_word" id="A4.p3.1.2.w44">relatively</span><span> </span><span class="gd_word" id="A4.p3.1.2.w45">low</span><span> </span><span class="gd_word" id="A4.p3.1.2.w46">amount</span><span> </span><span class="gd_word" id="A4.p3.1.2.w47">of</span><span> </span><span class="gd_word" id="A4.p3.1.2.w48">simulations</span><span> </span><span class="gd_word" id="A4.p3.1.2.w49">(25).
Unfortunately</span><span> </span><span class="gd_word" id="A4.p3.1.2.w50">adding</span><span> </span><span class="gd_word" id="A4.p3.1.2.w51">more</span><span> </span><span class="gd_word" id="A4.p3.1.2.w52">computational</span><span> </span><span class="gd_word" id="A4.p3.1.2.w53">budget</span><span> </span><span class="gd_word" id="A4.p3.1.2.w54">does</span><span> </span><span class="gd_word" id="A4.p3.1.2.w55">not</span><span> </span><span class="gd_word" id="A4.p3.1.2.w56">help,</span><span> </span><span class="gd_word" id="A4.p3.1.2.w57">as</span><span> </span><span class="gd_word" id="A4.p3.1.2.w58">the</span><span> </span><span class="gd_word" id="A4.p3.1.2.w59">decoding</span><span> </span><span class="gd_word" id="A4.p3.1.2.w60">is</span><span> </span><span class="gd_word" id="A4.p3.1.2.w61">targeting</span><span> </span><span class="gd_word" id="A4.p3.1.2.w62">a</span><span> </span><span class="gd_word" id="A4.p3.1.2.w63">different</span><span> </span><span class="gd_word" id="A4.p3.1.2.w64">metric</span><span> </span><span class="gd_word" id="A4.p3.1.2.w65">than</span><span> </span><span class="gd_word" id="A4.p3.1.2.w66">BLEU.
But</span><span> </span><span class="gd_word" id="A4.p3.1.2.w67">with</span><span> </span><span class="gd_word" id="A4.p3.1.2.w68">a</span><span> </span><span class="gd_word" id="A4.p3.1.2.w69">low</span><span> </span><span class="gd_word" id="A4.p3.1.2.w70">enough</span><span> </span><span class="gd_word" id="A4.p3.1.2.w71">amount</span><span> </span><span class="gd_word" id="A4.p3.1.2.w72">of</span><span> </span><span class="gd_word" id="A4.p3.1.2.w73">simulations,</span><span> </span><span class="gd_word" id="A4.p3.1.2.w74">we</span><span> </span><span class="gd_word" id="A4.p3.1.2.w75">see</span><span> </span><span class="gd_word" id="A4.p3.1.2.w76">that</span><span> </span><span class="gd_word" id="A4.p3.1.2.w77">trying</span><span> </span><span class="gd_word" id="A4.p3.1.2.w78">to</span><span> </span><span class="gd_word" id="A4.p3.1.2.w79">optimise</span><span> </span><span class="gd_word" id="A4.p3.1.2.w80">our</span><span> </span><span class="gd_word" id="A4.p3.1.2.w81">unprivileged</span><span> </span><span class="gd_word" id="A4.p3.1.2.w82">metric</span><span> </span><span class="gd_word" id="A4.p3.1.2.w83">yields</span><span> </span><span class="gd_word" id="A4.p3.1.2.w84">benefits.</span></p>
</div>
<div id="A4.p4" class="ltx_para">
<p id="A4.p4.1" class="ltx_p"><span class="gd_word" id="A4.p4.1.1.w1">While</span><span> </span><span class="gd_word" id="A4.p4.1.1.w2">this</span><span> </span><span class="gd_word" id="A4.p4.1.1.w3">result</span><span> </span><span class="gd_word" id="A4.p4.1.1.w4">is</span><span> </span><span class="gd_word" id="A4.p4.1.1.w5">close</span><span> </span><span class="gd_word" id="A4.p4.1.1.w6">to</span><span> </span><span class="gd_word" id="A4.p4.1.1.w7">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w8">state</span><span> </span><span class="gd_word" id="A4.p4.1.1.w9">of</span><span> </span><span class="gd_word" id="A4.p4.1.1.w10">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w11">art</span><span> </span><span class="gd_word" id="A4.p4.1.1.w12">for</span><span> </span><span class="gd_word" id="A4.p4.1.1.w13">such</span><span> </span><span class="gd_word" id="A4.p4.1.1.w14">a</span><span> </span><span class="gd_word" id="A4.p4.1.1.w15">small</span><span> </span><span class="gd_word" id="A4.p4.1.1.w16">policy</span><span> </span><span class="gd_word" id="A4.p4.1.1.w17">model,</span><span> </span><span class="gd_word" id="A4.p4.1.1.w18">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w19">comparison</span><span> </span><span class="gd_word" id="A4.p4.1.1.w20">is</span><span> </span><span class="gd_word" id="A4.p4.1.1.w21">not</span><span> </span><span class="gd_word" id="A4.p4.1.1.w22">fair</span><span> </span><span class="gd_word" id="A4.p4.1.1.w23">as</span><span> </span><span class="gd_word" id="A4.p4.1.1.w24">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w25">approach</span><span> </span><span class="gd_word" id="A4.p4.1.1.w26">requires</span><span> </span><span class="gd_word" id="A4.p4.1.1.w27">double</span><span> </span><span class="gd_word" id="A4.p4.1.1.w28">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w29">amount</span><span> </span><span class="gd_word" id="A4.p4.1.1.w30">of</span><span> </span><span class="gd_word" id="A4.p4.1.1.w31">parameters</span><span> </span><span class="gd_word" id="A4.p4.1.1.w32">(since</span><span> </span><span class="gd_word" id="A4.p4.1.1.w33">the</span><span> </span><span class="gd_word" id="A4.p4.1.1.w34">value</span><span> </span><span class="gd_word" id="A4.p4.1.1.w35">net</span><span> </span><span class="gd_word" id="A4.p4.1.1.w36">is</span><span> </span><span class="gd_word" id="A4.p4.1.1.w37">another</span><span> </span><span class="gd_word" id="A4.p4.1.1.w38">network).
This</span><span> </span><span class="gd_word" id="A4.p4.1.1.w39">could</span><span> </span><span class="gd_word" id="A4.p4.1.1.w40">be</span><span> </span><span class="gd_word" id="A4.p4.1.1.w41">alleviated</span><span> </span><span class="gd_word" id="A4.p4.1.1.w42">by</span><span> </span><span class="gd_word" id="A4.p4.1.1.w43">training</span><span> </span><span class="gd_word" id="A4.p4.1.1.w44">a</span><span> </span><span class="gd_word" id="A4.p4.1.1.w45">supervised</span><span> </span><span class="gd_word" id="A4.p4.1.1.w46">policy,</span><span> </span><span class="gd_word" id="A4.p4.1.1.w47">fixing</span><span> </span><span class="gd_word" id="A4.p4.1.1.w48">its</span><span> </span><span class="gd_word" id="A4.p4.1.1.w49">weights,</span><span> </span><span class="gd_word" id="A4.p4.1.1.w50">and</span><span> </span><span class="gd_word" id="A4.p4.1.1.w51">adding</span><span> </span><span class="gd_word" id="A4.p4.1.1.w52">a</span><span> </span><span class="gd_word" id="A4.p4.1.1.w53">lightweight</span><span> </span><span class="gd_word" id="A4.p4.1.1.w54">value</span><span> </span><span class="gd_word" id="A4.p4.1.1.w55">head</span><span> </span><span class="gd_word" id="A4.p4.1.1.w56">on</span><span> </span><span class="gd_word" id="A4.p4.1.1.w57">top</span><span> </span><span class="gd_word" id="A4.p4.1.1.w58">in</span><span> </span><span class="gd_word" id="A4.p4.1.1.w59">a</span><span> </span><span class="gd_word" id="A4.p4.1.1.w60">second</span><span> </span><span class="gd_word" id="A4.p4.1.1.w61">training</span><span> </span><span class="gd_word" id="A4.p4.1.1.w62">step.
We</span><span> </span><span class="gd_word" id="A4.p4.1.1.w63">leave</span><span> </span><span class="gd_word" id="A4.p4.1.1.w64">this</span><span> </span><span class="gd_word" id="A4.p4.1.1.w65">for</span><span> </span><span class="gd_word" id="A4.p4.1.1.w66">future</span><span> </span><span class="gd_word" id="A4.p4.1.1.w67">work.</span></p>
</div>
<figure id="A4.T12" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A4_T12.png" alt="/static/img/2104.05336-gpt-4/A4_T12.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 12: </span><span class="gd_word" id="A4.T12.2.w1">Greedy</span><span> </span><span class="gd_word" id="A4.T12.2.w2">decoding</span><span> </span><span class="gd_word" id="A4.T12.2.w3">performance</span><span> </span><span class="gd_word" id="A4.T12.2.w4">for</span><span> </span><span class="gd_word" id="A4.T12.2.w5">plainly</span><span> </span><span class="gd_word" id="A4.T12.2.w6">supervised</span><span> </span><span class="gd_word" id="A4.T12.2.w7">policy</span><span> </span><span class="gd_word" id="A4.T12.2.w8">model</span><span> </span><span class="gd_word" id="A4.T12.2.w9">and</span><span> </span><span class="gd_word" id="A4.T12.2.w10">dual-headed</span><span> </span><span class="gd_word" id="A4.T12.2.w11">distilled</span><span> </span><span class="gd_word" id="A4.T12.2.w12">ones.</span></figcaption>
</figure>
<figure id="A4.T13" class="ltx_table">
<img src="/static/img/2104.05336-gpt-4/A4_T13.png" alt="/static/img/2104.05336-gpt-4/A4_T13.png"/><figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 13: </span><span class="gd_word" id="A4.T13.2.w1">MCTS</span><span> </span><span class="gd_word" id="A4.T13.2.w2">(25</span><span> </span><span class="gd_word" id="A4.T13.2.w3">simulations)</span><span> </span><span class="gd_word" id="A4.T13.2.w4">BLEU</span><span> </span><span class="gd_word" id="A4.T13.2.w5">performance,</span><span> </span><span class="gd_word" id="A4.T13.2.w6">using</span><span> </span><span class="gd_word" id="A4.T13.2.w7">a</span><span> </span><span class="gd_word" id="A4.T13.2.w8">supervised</span><span> </span><span class="gd_word" id="A4.T13.2.w9">policy</span><span> </span><span class="gd_word" id="A4.T13.2.w10">model</span><span> </span><span class="gd_word" id="A4.T13.2.w11">and</span><span> </span><span class="gd_word" id="A4.T13.2.w12">a</span><span> </span><span class="gd_word" id="A4.T13.2.w13">distinct</span><span> </span><span class="gd_word" id="A4.T13.2.w14">value</span><span> </span><span class="gd_word" id="A4.T13.2.w15">model.</span></figcaption>
</figure>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>MCTS examples</h2>

<figure id="A5.F2" class="ltx_figure"><img src="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts0.png" id="A5.F2.g1" class="ltx_graphics ltx_centering" width="" height="" alt="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts0.png"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span><span class="gd_word" id="A5.F2.2.w1">MCTS</span><span> </span><span class="gd_word" id="A5.F2.2.w2">tree</span><span> </span><span class="gd_word" id="A5.F2.2.w3">when</span><span> </span><span class="gd_word" id="A5.F2.2.w4">translating</span><span> </span><span class="gd_word" id="A5.F2.2.w5">“Open-air</span><span> </span><span class="gd_word" id="A5.F2.2.w6">concert</span><span> </span><span class="gd_word" id="A5.F2.2.w7">accompanied</span><span> </span><span class="gd_word" id="A5.F2.2.w8">by</span><span> </span><span class="gd_word" id="A5.F2.2.w9">high</span><span> </span><span class="gd_word" id="A5.F2.2.w10">summer</span><span> </span><span class="gd_word" id="A5.F2.2.w11">temperatures”</span><span> </span><span class="gd_word" id="A5.F2.2.w12">from</span><span> </span><span class="gd_word" id="A5.F2.2.w13">English</span><span> </span><span class="gd_word" id="A5.F2.2.w14">to</span><span> </span><span class="gd_word" id="A5.F2.2.w15">German,</span><span> </span><span class="gd_word" id="A5.F2.2.w16">first</span><span> </span><span class="gd_word" id="A5.F2.2.w17">step.</span></figcaption>
</figure>
<figure id="A5.F3" class="ltx_figure"><img src="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts5.png" id="A5.F3.g1" class="ltx_graphics ltx_centering" width="" height="" alt="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts5.png"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span class="gd_word" id="A5.F3.2.w1">MCTS</span><span> </span><span class="gd_word" id="A5.F3.2.w2">tree</span><span> </span><span class="gd_word" id="A5.F3.2.w3">when</span><span> </span><span class="gd_word" id="A5.F3.2.w4">translating</span><span> </span><span class="gd_word" id="A5.F3.2.w5">“Open-air</span><span> </span><span class="gd_word" id="A5.F3.2.w6">concert</span><span> </span><span class="gd_word" id="A5.F3.2.w7">accompanied</span><span> </span><span class="gd_word" id="A5.F3.2.w8">by</span><span> </span><span class="gd_word" id="A5.F3.2.w9">high</span><span> </span><span class="gd_word" id="A5.F3.2.w10">summer</span><span> </span><span class="gd_word" id="A5.F3.2.w11">temperatures”</span><span> </span><span class="gd_word" id="A5.F3.2.w12">from</span><span> </span><span class="gd_word" id="A5.F3.2.w13">English</span><span> </span><span class="gd_word" id="A5.F3.2.w14">to</span><span> </span><span class="gd_word" id="A5.F3.2.w15">German,</span><span> </span><span class="gd_word" id="A5.F3.2.w16">sixth</span><span> </span><span class="gd_word" id="A5.F3.2.w17">step.</span></figcaption>
</figure>
<figure id="A5.F4" class="ltx_figure"><img src="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts8.png" id="A5.F4.g1" class="ltx_graphics ltx_centering" width="" height="" alt="/static/img/2104.05336-gpt-4//static/img/2104.05336/src/mcts8.png"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span class="gd_word" id="A5.F4.2.w1">MCTS</span><span> </span><span class="gd_word" id="A5.F4.2.w2">tree</span><span> </span><span class="gd_word" id="A5.F4.2.w3">when</span><span> </span><span class="gd_word" id="A5.F4.2.w4">translating</span><span> </span><span class="gd_word" id="A5.F4.2.w5">“Open-air</span><span> </span><span class="gd_word" id="A5.F4.2.w6">concert</span><span> </span><span class="gd_word" id="A5.F4.2.w7">accompanied</span><span> </span><span class="gd_word" id="A5.F4.2.w8">by</span><span> </span><span class="gd_word" id="A5.F4.2.w9">high</span><span> </span><span class="gd_word" id="A5.F4.2.w10">summer</span><span> </span><span class="gd_word" id="A5.F4.2.w11">temperatures”</span><span> </span><span class="gd_word" id="A5.F4.2.w12">from</span><span> </span><span class="gd_word" id="A5.F4.2.w13">English</span><span> </span><span class="gd_word" id="A5.F4.2.w14">to</span><span> </span><span class="gd_word" id="A5.F4.2.w15">German,</span><span> </span><span class="gd_word" id="A5.F4.2.w16">ninth</span><span> </span><span class="gd_word" id="A5.F4.2.w17">step.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"/>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Batched Numpy-friendly MCTS</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p"><span class="gd_word" id="A6.p1.1.1.w1">Accelerator</span><span> </span><span class="gd_word" id="A6.p1.1.1.w2">hardware</span><span> </span><span class="gd_word" id="A6.p1.1.1.w3">such</span><span> </span><span class="gd_word" id="A6.p1.1.1.w4">as</span><span> </span><span class="gd_word" id="A6.p1.1.1.w5">GPUs</span><span> </span><span class="gd_word" id="A6.p1.1.1.w6">or</span><span> </span><span class="gd_word" id="A6.p1.1.1.w7">TPUs</span><span> </span><span class="gd_word" id="A6.p1.1.1.w8">allow</span><span> </span><span class="gd_word" id="A6.p1.1.1.w9">us</span><span> </span><span class="gd_word" id="A6.p1.1.1.w10">to</span><span> </span><span class="gd_word" id="A6.p1.1.1.w11">execute</span><span> </span><span class="gd_word" id="A6.p1.1.1.w12">neural</span><span> </span><span class="gd_word" id="A6.p1.1.1.w13">networks</span><span> </span><span class="gd_word" id="A6.p1.1.1.w14">faster;</span><span> </span><span class="gd_word" id="A6.p1.1.1.w15">but</span><span> </span><span class="gd_word" id="A6.p1.1.1.w16">to</span><span> </span><span class="gd_word" id="A6.p1.1.1.w17">fully</span><span> </span><span class="gd_word" id="A6.p1.1.1.w18">leverage</span><span> </span><span class="gd_word" id="A6.p1.1.1.w19">their</span><span> </span><span class="gd_word" id="A6.p1.1.1.w20">computing</span><span> </span><span class="gd_word" id="A6.p1.1.1.w21">power,</span><span> </span><span class="gd_word" id="A6.p1.1.1.w22">we</span><span> </span><span class="gd_word" id="A6.p1.1.1.w23">have</span><span> </span><span class="gd_word" id="A6.p1.1.1.w24">to</span><span> </span><span class="gd_word" id="A6.p1.1.1.w25">run</span><span> </span><span class="gd_word" id="A6.p1.1.1.w26">on</span><span> </span><span class="gd_word" id="A6.p1.1.1.w27">batches</span><span> </span><span class="gd_word" id="A6.p1.1.1.w28">of</span><span> </span><span class="gd_word" id="A6.p1.1.1.w29">several</span><span> </span><span class="gd_word" id="A6.p1.1.1.w30">inputs.
This</span><span> </span><span class="gd_word" id="A6.p1.1.1.w31">is</span><span> </span><span class="gd_word" id="A6.p1.1.1.w32">not</span><span> </span><span class="gd_word" id="A6.p1.1.1.w33">very</span><span> </span><span class="gd_word" id="A6.p1.1.1.w34">easily</span><span> </span><span class="gd_word" id="A6.p1.1.1.w35">mixed</span><span> </span><span class="gd_word" id="A6.p1.1.1.w36">with</span><span> </span><span class="gd_word" id="A6.p1.1.1.w37">an</span><span> </span><span class="gd_word" id="A6.p1.1.1.w38">algorithm</span><span> </span><span class="gd_word" id="A6.p1.1.1.w39">such</span><span> </span><span class="gd_word" id="A6.p1.1.1.w40">as</span><span> </span><span class="gd_word" id="A6.p1.1.1.w41">MCTS,</span><span> </span><span class="gd_word" id="A6.p1.1.1.w42">as</span><span> </span><span class="gd_word" id="A6.p1.1.1.w43">it</span><span> </span><span class="gd_word" id="A6.p1.1.1.w44">requires</span><span> </span><span class="gd_word" id="A6.p1.1.1.w45">a</span><span> </span><span class="gd_word" id="A6.p1.1.1.w46">queuing</span><span> </span><span class="gd_word" id="A6.p1.1.1.w47">mechanism</span><span> </span><span class="gd_word" id="A6.p1.1.1.w48">between</span><span> </span><span class="gd_word" id="A6.p1.1.1.w49">the</span><span> </span><span class="gd_word" id="A6.p1.1.1.w50">search</span><span> </span><span class="gd_word" id="A6.p1.1.1.w51">itself</span><span> </span><span class="gd_word" id="A6.p1.1.1.w52">and</span><span> </span><span class="gd_word" id="A6.p1.1.1.w53">the</span><span> </span><span class="gd_word" id="A6.p1.1.1.w54">neural</span><span> </span><span class="gd_word" id="A6.p1.1.1.w55">network</span><span> </span><span class="gd_word" id="A6.p1.1.1.w56">computations,</span><span> </span><span class="gd_word" id="A6.p1.1.1.w57">potentially</span><span> </span><span class="gd_word" id="A6.p1.1.1.w58">leading</span><span> </span><span class="gd_word" id="A6.p1.1.1.w59">to</span><span> </span><span class="gd_word" id="A6.p1.1.1.w60">inefficiencies.
To</span><span> </span><span class="gd_word" id="A6.p1.1.1.w61">circumvent</span><span> </span><span class="gd_word" id="A6.p1.1.1.w62">this</span><span> </span><span class="gd_word" id="A6.p1.1.1.w63">issue,</span><span> </span><span class="gd_word" id="A6.p1.1.1.w64">we</span><span> </span><span class="gd_word" id="A6.p1.1.1.w65">introduce</span><span> </span><span class="gd_word" id="A6.p1.1.1.w66">a</span><span> </span><span class="gd_word" id="A6.p1.1.1.w67">Numpy-compatible</span><span> </span><span class="gd_word" id="A6.p1.1.1.w68">version</span><span> </span><span class="gd_word" id="A6.p1.1.1.w69">of</span><span> </span><span class="gd_word" id="A6.p1.1.1.w70">MCTS,</span><span> </span><span class="gd_word" id="A6.p1.1.1.w71">which</span><span> </span><span class="gd_word" id="A6.p1.1.1.w72">can</span><span> </span><span class="gd_word" id="A6.p1.1.1.w73">then</span><span> </span><span class="gd_word" id="A6.p1.1.1.w74">be</span><span> </span><span class="gd_word" id="A6.p1.1.1.w75">run</span><span> </span><span class="gd_word" id="A6.p1.1.1.w76">completely</span><span> </span><span class="gd_word" id="A6.p1.1.1.w77">on</span><span> </span><span class="gd_word" id="A6.p1.1.1.w78">the</span><span> </span><span class="gd_word" id="A6.p1.1.1.w79">accelerator</span><span> </span><span class="gd_word" id="A6.p1.1.1.w80">device.</span></p>
</div>
<div id="A6.p2" class="ltx_para">
<p id="A6.p2.1" class="ltx_p"><span class="gd_word" id="A6.p2.1.1.w1">The</span><span> </span><span class="gd_word" id="A6.p2.1.1.w2">basic</span><span> </span><span class="gd_word" id="A6.p2.1.1.w3">idea</span><span> </span><span class="gd_word" id="A6.p2.1.1.w4">is</span><span> </span><span class="gd_word" id="A6.p2.1.1.w5">that</span><span> </span><span class="gd_word" id="A6.p2.1.1.w6">we</span><span> </span><span class="gd_word" id="A6.p2.1.1.w7">use</span><span> </span><span class="gd_word" id="A6.p2.1.1.w8">storage</span><span> </span><span class="gd_word" id="A6.p2.1.1.w9">tensors</span><span> </span><span class="gd_word" id="A6.p2.1.1.w10">which</span><span> </span><span class="gd_word" id="A6.p2.1.1.w11">are</span><span> </span><span class="gd_word" id="A6.p2.1.1.w12">indexed</span><span> </span><span class="gd_word" id="A6.p2.1.1.w13">by</span><span> </span><span class="gd_word" id="A6.p2.1.1.w14">the</span><span> </span><span class="gd_word" id="A6.p2.1.1.w15">number</span><span> </span><span class="gd_word" id="A6.p2.1.1.w16">of</span><span> </span><span class="gd_word" id="A6.p2.1.1.w17">the</span><span> </span><span class="gd_word" id="A6.p2.1.1.w18">current</span><span> </span><span class="gd_word" id="A6.p2.1.1.w19">node</span><span> </span><span class="gd_word" id="A6.p2.1.1.w20">or</span><span> </span><span class="gd_word" id="A6.p2.1.1.w21">simulation</span><span> </span><span class="gd_word" id="A6.p2.1.1.w22">in</span><span> </span><span class="gd_word" id="A6.p2.1.1.w23">the</span><span> </span><span class="gd_word" id="A6.p2.1.1.w24">MCTS</span><span> </span><span class="gd_word" id="A6.p2.1.1.w25">tree.
The</span><span> </span><span class="gd_word" id="A6.p2.1.1.w26">root</span><span> </span><span class="gd_word" id="A6.p2.1.1.w27">node</span><span> </span><span class="gd_word" id="A6.p2.1.1.w28">has</span><span> </span><span class="gd_word" id="A6.p2.1.1.w29">index</span><span> </span><span class="gd_word" id="A6.p2.1.1.w30">0</span><span> </span><span class="gd_word" id="A6.p2.1.1.w31">for</span><span> </span><span class="gd_word" id="A6.p2.1.1.w32">all</span><span> </span><span class="gd_word" id="A6.p2.1.1.w33">elements</span><span> </span><span class="gd_word" id="A6.p2.1.1.w34">in</span><span> </span><span class="gd_word" id="A6.p2.1.1.w35">a</span><span> </span><span class="gd_word" id="A6.p2.1.1.w36">batch,</span><span> </span><span class="gd_word" id="A6.p2.1.1.w37">and</span><span> </span><span class="gd_word" id="A6.p2.1.1.w38">we</span><span> </span><span class="gd_word" id="A6.p2.1.1.w39">then</span><span> </span><span class="gd_word" id="A6.p2.1.1.w40">build</span><span> </span><span class="gd_word" id="A6.p2.1.1.w41">all</span><span> </span><span class="gd_word" id="A6.p2.1.1.w42">subsequent</span><span> </span><span class="gd_word" id="A6.p2.1.1.w43">elements</span><span> </span><span class="gd_word" id="A6.p2.1.1.w44">recursively.</span></p>
</div>
<div id="A6.p3" class="ltx_para">
<p id="A6.p3.1" class="ltx_p"><span class="gd_word" id="A6.p3.1.1.w1">We</span><span> </span><span class="gd_word" id="A6.p3.1.1.w2">start</span><span> </span><span class="gd_word" id="A6.p3.1.1.w3">by</span><span> </span><span class="gd_word" id="A6.p3.1.1.w4">creating</span><span> </span><span class="gd_word" id="A6.p3.1.1.w5">a</span><span> </span><span class="gd_word" id="A6.p3.1.1.w6">NumpyMCTS</span><span> </span><span class="gd_word" id="A6.p3.1.1.w7">object,</span><span> </span><span class="gd_word" id="A6.p3.1.1.w8">whose</span><span> </span><span class="gd_word" id="A6.p3.1.1.w9">fields</span><span> </span><span class="gd_word" id="A6.p3.1.1.w10">store</span><span> </span><span class="gd_word" id="A6.p3.1.1.w11">all</span><span> </span><span class="gd_word" id="A6.p3.1.1.w12">the</span><span> </span><span class="gd_word" id="A6.p3.1.1.w13">necessary</span><span> </span><span class="gd_word" id="A6.p3.1.1.w14">tree</span><span> </span><span class="gd_word" id="A6.p3.1.1.w15">information</span><span> </span><span class="gd_word" id="A6.p3.1.1.w16">to</span><span> </span><span class="gd_word" id="A6.p3.1.1.w17">compute</span><span> </span><span class="gd_word" id="A6.p3.1.1.w18">a</span><span> </span><span class="gd_word" id="A6.p3.1.1.w19">single</span><span> </span><span class="gd_word" id="A6.p3.1.1.w20">batched</span><span> </span><span class="gd_word" id="A6.p3.1.1.w21">instance</span><span> </span><span class="gd_word" id="A6.p3.1.1.w22">of</span><span> </span><span class="gd_word" id="A6.p3.1.1.w23">search</span><span> </span><span class="gd_word" id="A6.p3.1.1.w24">(i.e.</span><span> </span><span class="gd_word" id="A6.p3.1.1.w25">MCTS</span><span> </span><span class="gd_word" id="A6.p3.1.1.w26">for</span><span> </span><span class="gd_word" id="A6.p3.1.1.w27">one</span><span> </span><span class="gd_word" id="A6.p3.1.1.w28">token,</span><span> </span><span class="gd_word" id="A6.p3.1.1.w29">not</span><span> </span><span class="gd_word" id="A6.p3.1.1.w30">MCTS</span><span> </span><span class="gd_word" id="A6.p3.1.1.w31">applied</span><span> </span><span class="gd_word" id="A6.p3.1.1.w32">to</span><span> </span><span class="gd_word" id="A6.p3.1.1.w33">the</span><span> </span><span class="gd_word" id="A6.p3.1.1.w34">full</span><span> </span><span class="gd_word" id="A6.p3.1.1.w35">sequence).
In</span><span> </span><span class="gd_word" id="A6.p3.1.1.w36">details,</span><span> </span><span class="gd_word" id="A6.p3.1.1.w37">for</span><span> </span><span class="gd_word" id="A6.p3.1.1.w38">each</span><span> </span><span class="gd_word" id="A6.p3.1.1.w39">node,</span><span> </span><span class="gd_word" id="A6.p3.1.1.w40">for</span><span> </span><span class="gd_word" id="A6.p3.1.1.w41">each</span><span> </span><span class="gd_word" id="A6.p3.1.1.w42">item</span><span> </span><span class="gd_word" id="A6.p3.1.1.w43">in</span><span> </span><span class="gd_word" id="A6.p3.1.1.w44">the</span><span> </span><span class="gd_word" id="A6.p3.1.1.w45">batch</span><span> </span><span class="gd_word" id="A6.p3.1.1.w46">we</span><span> </span><span class="gd_word" id="A6.p3.1.1.w47">store:</span></p>
</div>
<div id="A6.p4" class="ltx_para">
<ul id="A6.I1" class="ltx_itemize">
<li id="A6.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i1.p1" class="ltx_para">
<p id="A6.I1.i1.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i1.p1.1.1.w1">visit_counts:</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w3">amount</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w4">of</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w5">times</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w6">said</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w7">nodes</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w8">have</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w9">been</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w10">visited</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w11">during</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w12">the</span><span> </span><span class="gd_word" id="A6.I1.i1.p1.1.1.w13">search,</span></p>
</div>
</li>
<li id="A6.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i2.p1" class="ltx_para">
<p id="A6.I1.i2.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i2.p1.1.1.w1">raw_values:</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w3">initial</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w4">value</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w5">of</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w6">the</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w7">node</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w8">as</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w9">returned</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w10">by</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w11">our</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w12">value</span><span> </span><span class="gd_word" id="A6.I1.i2.p1.1.1.w13">network,</span></p>
</div>
</li>
<li id="A6.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i3.p1" class="ltx_para">
<p id="A6.I1.i3.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i3.p1.1.1.w1">values:</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w3">aggregated</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w4">value</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w5">of</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w6">the</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w7">node</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w8">at</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w9">this</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w10">point</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w11">in</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w12">the</span><span> </span><span class="gd_word" id="A6.I1.i3.p1.1.1.w13">search,</span></p>
</div>
</li>
<li id="A6.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i4.p1" class="ltx_para">
<p id="A6.I1.i4.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i4.p1.1.1.w1">parents:</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w2">which</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w3">node</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w4">is</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w5">its</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w6">parent</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w7">in</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w8">the</span><span> </span><span class="gd_word" id="A6.I1.i4.p1.1.1.w9">tree,</span></p>
</div>
</li>
<li id="A6.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i5.p1" class="ltx_para">
<p id="A6.I1.i5.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i5.p1.1.1.w1">action_from_parents:</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w2">which</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w3">action</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w4">was</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w5">taken</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w6">to</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w7">transition</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w8">from</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w9">the</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w10">parent</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w11">to</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w12">the</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w13">node</span><span> </span><span class="gd_word" id="A6.I1.i5.p1.1.1.w14">itself,</span></p>
</div>
</li>
<li id="A6.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i6.p1" class="ltx_para">
<p id="A6.I1.i6.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i6.p1.1.1.w1">depth:</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w2">the</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w3">tree</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w4">depth</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w5">of</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w6">each</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w7">node</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w8">in</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w9">the</span><span> </span><span class="gd_word" id="A6.I1.i6.p1.1.1.w10">tree,</span></p>
</div>
</li>
<li id="A6.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A6.I1.i7.p1" class="ltx_para">
<p id="A6.I1.i7.p1.1" class="ltx_p"><span class="gd_word" id="A6.I1.i7.p1.1.1.w1">is_terminal:</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w2">whether</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w3">or</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w4">not</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w5">they</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w6">are</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w7">a</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w8">terminal</span><span> </span><span class="gd_word" id="A6.I1.i7.p1.1.1.w9">node.</span></p>
</div>
</li>
</ul>
</div>
<div id="A6.p5" class="ltx_para">
<p id="A6.p5.3" class="ltx_p"><span class="gd_word" id="A6.p5.3.1.w1">All</span><span> </span><span class="gd_word" id="A6.p5.3.1.w2">these</span><span> </span><span class="gd_word" id="A6.p5.3.1.w3">variables</span><span> </span><span class="gd_word" id="A6.p5.3.1.w4">are</span><span> </span><span class="gd_word" id="A6.p5.3.1.w5">tensors</span><span> </span><span class="gd_word" id="A6.p5.3.1.w6">are</span><span> </span><span class="gd_word" id="A6.p5.3.1.w7">of</span><span> </span><span class="gd_word" id="A6.p5.3.1.w8">size</span><span> </span><math id="A6.p5.1.m1.2" class="ltx_Math" alttext="(B,S)" display="inline"><semantics id="A6.p5.1.m1.2a"><mrow id="A6.p5.1.m1.2.3.2" xref="A6.p5.1.m1.2.3.1.cmml"><mo stretchy="false" id="A6.p5.1.m1.2.3.2.1" xref="A6.p5.1.m1.2.3.1.cmml">(</mo><mi id="A6.p5.1.m1.1.1" xref="A6.p5.1.m1.1.1.cmml">B</mi><mo id="A6.p5.1.m1.2.3.2.2" xref="A6.p5.1.m1.2.3.1.cmml">,</mo><mi id="A6.p5.1.m1.2.2" xref="A6.p5.1.m1.2.2.cmml">S</mi><mo stretchy="false" id="A6.p5.1.m1.2.3.2.3" xref="A6.p5.1.m1.2.3.1.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="A6.p5.3.2.w1"/><span> </span><span class="gd_word" id="A6.p5.3.2.w2">where</span><span> </span><math id="A6.p5.2.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A6.p5.2.m2.1a"><mi id="A6.p5.2.m2.1.1" xref="A6.p5.2.m2.1.1.cmml">B</mi></semantics></math><span class="gd_word" id="A6.p5.3.3.w1"/><span> </span><span class="gd_word" id="A6.p5.3.3.w2">is</span><span> </span><span class="gd_word" id="A6.p5.3.3.w3">the</span><span> </span><span class="gd_word" id="A6.p5.3.3.w4">batch</span><span> </span><span class="gd_word" id="A6.p5.3.3.w5">size</span><span> </span><span class="gd_word" id="A6.p5.3.3.w6">and</span><span> </span><math id="A6.p5.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A6.p5.3.m3.1a"><mi id="A6.p5.3.m3.1.1" xref="A6.p5.3.m3.1.1.cmml">S</mi></semantics></math><span class="gd_word" id="A6.p5.3.4.w1"/><span> </span><span class="gd_word" id="A6.p5.3.4.w2">is</span><span> </span><span class="gd_word" id="A6.p5.3.4.w3">the</span><span> </span><span class="gd_word" id="A6.p5.3.4.w4">amount</span><span> </span><span class="gd_word" id="A6.p5.3.4.w5">of</span><span> </span><span class="gd_word" id="A6.p5.3.4.w6">simulation</span><span> </span><span class="gd_word" id="A6.p5.3.4.w7">plus</span><span> </span><span class="gd_word" id="A6.p5.3.4.w8">one.</span></p>
</div>
<div id="A6.p6" class="ltx_para">
<p id="A6.p6.5" class="ltx_p"><span class="gd_word" id="A6.p6.5.1.w1">For</span><span> </span><span class="gd_word" id="A6.p6.5.1.w2">ease</span><span> </span><span class="gd_word" id="A6.p6.5.1.w3">of</span><span> </span><span class="gd_word" id="A6.p6.5.1.w4">tree</span><span> </span><span class="gd_word" id="A6.p6.5.1.w5">manipulation,</span><span> </span><span class="gd_word" id="A6.p6.5.1.w6">we</span><span> </span><span class="gd_word" id="A6.p6.5.1.w7">also</span><span> </span><span class="gd_word" id="A6.p6.5.1.w8">store</span><span> </span><span class="gd_word" id="A6.p6.5.1.w9">for</span><span> </span><span class="gd_word" id="A6.p6.5.1.w10">each</span><span> </span><span class="gd_word" id="A6.p6.5.1.w11">node</span><span> </span><span class="gd_word" id="A6.p6.5.1.w12">the</span><span> </span><span class="gd_word" id="A6.p6.5.1.w13">indices</span><span> </span><span class="gd_word" id="A6.p6.5.1.w14">of</span><span> </span><span class="gd_word" id="A6.p6.5.1.w15">its</span><span> </span><span class="gd_word" id="A6.p6.5.1.w16">children,</span><span> </span><span class="gd_word" id="A6.p6.5.1.w17">its</span><span> </span><span class="gd_word" id="A6.p6.5.1.w18">prior</span><span> </span><span class="gd_word" id="A6.p6.5.1.w19">over</span><span> </span><span class="gd_word" id="A6.p6.5.1.w20">its</span><span> </span><span class="gd_word" id="A6.p6.5.1.w21">possible</span><span> </span><span class="gd_word" id="A6.p6.5.1.w22">children,</span><span> </span><span class="gd_word" id="A6.p6.5.1.w23">the</span><span> </span><span class="gd_word" id="A6.p6.5.1.w24">values</span><span> </span><span class="gd_word" id="A6.p6.5.1.w25">of</span><span> </span><span class="gd_word" id="A6.p6.5.1.w26">each</span><span> </span><span class="gd_word" id="A6.p6.5.1.w27">child,</span><span> </span><span class="gd_word" id="A6.p6.5.1.w28">and</span><span> </span><span class="gd_word" id="A6.p6.5.1.w29">the</span><span> </span><span class="gd_word" id="A6.p6.5.1.w30">visit</span><span> </span><span class="gd_word" id="A6.p6.5.1.w31">count</span><span> </span><span class="gd_word" id="A6.p6.5.1.w32">of</span><span> </span><span class="gd_word" id="A6.p6.5.1.w33">each</span><span> </span><span class="gd_word" id="A6.p6.5.1.w34">child.
The</span><span> </span><span class="gd_word" id="A6.p6.5.1.w35">associated</span><span> </span><span class="gd_word" id="A6.p6.5.1.w36">tensors</span><span> </span><span class="gd_word" id="A6.p6.5.1.w37">should</span><span> </span><span class="gd_word" id="A6.p6.5.1.w38">be</span><span> </span><span class="gd_word" id="A6.p6.5.1.w39">of</span><span> </span><span class="gd_word" id="A6.p6.5.1.w40">shape</span><span> </span><math id="A6.p6.1.m1.3" class="ltx_Math" alttext="(B,S,V)" display="inline"><semantics id="A6.p6.1.m1.3a"><mrow id="A6.p6.1.m1.3.4.2" xref="A6.p6.1.m1.3.4.1.cmml"><mo stretchy="false" id="A6.p6.1.m1.3.4.2.1" xref="A6.p6.1.m1.3.4.1.cmml">(</mo><mi id="A6.p6.1.m1.1.1" xref="A6.p6.1.m1.1.1.cmml">B</mi><mo id="A6.p6.1.m1.3.4.2.2" xref="A6.p6.1.m1.3.4.1.cmml">,</mo><mi id="A6.p6.1.m1.2.2" xref="A6.p6.1.m1.2.2.cmml">S</mi><mo id="A6.p6.1.m1.3.4.2.3" xref="A6.p6.1.m1.3.4.1.cmml">,</mo><mi id="A6.p6.1.m1.3.3" xref="A6.p6.1.m1.3.3.cmml">V</mi><mo stretchy="false" id="A6.p6.1.m1.3.4.2.4" xref="A6.p6.1.m1.3.4.1.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="A6.p6.5.2.w1">,</span><span> </span><span class="gd_word" id="A6.p6.5.2.w2">where</span><span> </span><span class="gd_word" id="A6.p6.5.2.w3">V</span><span> </span><span class="gd_word" id="A6.p6.5.2.w4">is</span><span> </span><span class="gd_word" id="A6.p6.5.2.w5">the</span><span> </span><span class="gd_word" id="A6.p6.5.2.w6">total</span><span> </span><span class="gd_word" id="A6.p6.5.2.w7">number</span><span> </span><span class="gd_word" id="A6.p6.5.2.w8">of</span><span> </span><span class="gd_word" id="A6.p6.5.2.w9">possible</span><span> </span><span class="gd_word" id="A6.p6.5.2.w10">actions.
However</span><span> </span><span class="gd_word" id="A6.p6.5.2.w11">this</span><span> </span><span class="gd_word" id="A6.p6.5.2.w12">makes</span><span> </span><span class="gd_word" id="A6.p6.5.2.w13">for</span><span> </span><span class="gd_word" id="A6.p6.5.2.w14">large</span><span> </span><span class="gd_word" id="A6.p6.5.2.w15">tensors,</span><span> </span><span class="gd_word" id="A6.p6.5.2.w16">on</span><span> </span><span class="gd_word" id="A6.p6.5.2.w17">which</span><span> </span><span class="gd_word" id="A6.p6.5.2.w18">Numpy</span><span> </span><span class="gd_word" id="A6.p6.5.2.w19">operations</span><span> </span><span class="gd_word" id="A6.p6.5.2.w20">can</span><span> </span><span class="gd_word" id="A6.p6.5.2.w21">become</span><span> </span><span class="gd_word" id="A6.p6.5.2.w22">costly.
To</span><span> </span><span class="gd_word" id="A6.p6.5.2.w23">alleviate</span><span> </span><span class="gd_word" id="A6.p6.5.2.w24">this</span><span> </span><span class="gd_word" id="A6.p6.5.2.w25">issue</span><span> </span><span class="gd_word" id="A6.p6.5.2.w26">we</span><span> </span><span class="gd_word" id="A6.p6.5.2.w27">store</span><span> </span><span class="gd_word" id="A6.p6.5.2.w28">a</span><span> </span><span class="gd_word" id="A6.p6.5.2.w29">sparse</span><span> </span><span class="gd_word" id="A6.p6.5.2.w30">version</span><span> </span><span class="gd_word" id="A6.p6.5.2.w31">of</span><span> </span><span class="gd_word" id="A6.p6.5.2.w32">these</span><span> </span><span class="gd_word" id="A6.p6.5.2.w33">tensors</span><span> </span><span class="gd_word" id="A6.p6.5.2.w34">instead,</span><span> </span><span class="gd_word" id="A6.p6.5.2.w35">only</span><span> </span><span class="gd_word" id="A6.p6.5.2.w36">keeping</span><span> </span><span class="gd_word" id="A6.p6.5.2.w37">the</span><span> </span><span class="gd_word" id="A6.p6.5.2.w38">top</span><span> </span><math id="A6.p6.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="A6.p6.2.m2.1a"><mi id="A6.p6.2.m2.1.1" xref="A6.p6.2.m2.1.1.cmml">A</mi></semantics></math><span class="gd_word" id="A6.p6.5.3.w1"/><span> </span><span class="gd_word" id="A6.p6.5.3.w2">children</span><span> </span><span class="gd_word" id="A6.p6.5.3.w3">according</span><span> </span><span class="gd_word" id="A6.p6.5.3.w4">to</span><span> </span><span class="gd_word" id="A6.p6.5.3.w5">the</span><span> </span><span class="gd_word" id="A6.p6.5.3.w6">policy</span><span> </span><span class="gd_word" id="A6.p6.5.3.w7">for</span><span> </span><span class="gd_word" id="A6.p6.5.3.w8">each</span><span> </span><span class="gd_word" id="A6.p6.5.3.w9">node.
The</span><span> </span><span class="gd_word" id="A6.p6.5.3.w10">shapes</span><span> </span><span class="gd_word" id="A6.p6.5.3.w11">are</span><span> </span><span class="gd_word" id="A6.p6.5.3.w12">thus</span><span> </span><math id="A6.p6.3.m3.3" class="ltx_Math" alttext="(B,S,A)" display="inline"><semantics id="A6.p6.3.m3.3a"><mrow id="A6.p6.3.m3.3.4.2" xref="A6.p6.3.m3.3.4.1.cmml"><mo stretchy="false" id="A6.p6.3.m3.3.4.2.1" xref="A6.p6.3.m3.3.4.1.cmml">(</mo><mi id="A6.p6.3.m3.1.1" xref="A6.p6.3.m3.1.1.cmml">B</mi><mo id="A6.p6.3.m3.3.4.2.2" xref="A6.p6.3.m3.3.4.1.cmml">,</mo><mi id="A6.p6.3.m3.2.2" xref="A6.p6.3.m3.2.2.cmml">S</mi><mo id="A6.p6.3.m3.3.4.2.3" xref="A6.p6.3.m3.3.4.1.cmml">,</mo><mi id="A6.p6.3.m3.3.3" xref="A6.p6.3.m3.3.3.cmml">A</mi><mo stretchy="false" id="A6.p6.3.m3.3.4.2.4" xref="A6.p6.3.m3.3.4.1.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="A6.p6.5.4.w1"/><span> </span><span class="gd_word" id="A6.p6.5.4.w2">instead.
We</span><span> </span><span class="gd_word" id="A6.p6.5.4.w3">maintain</span><span> </span><span class="gd_word" id="A6.p6.5.4.w4">a</span><span> </span><span class="gd_word" id="A6.p6.5.4.w5">mapping</span><span> </span><span class="gd_word" id="A6.p6.5.4.w6">from</span><span> </span><span class="gd_word" id="A6.p6.5.4.w7">0</span><span> </span><span class="gd_word" id="A6.p6.5.4.w8">to</span><span> </span><math id="A6.p6.4.m4.1" class="ltx_Math" alttext="A-1" display="inline"><semantics id="A6.p6.4.m4.1a"><mrow id="A6.p6.4.m4.1.1" xref="A6.p6.4.m4.1.1.cmml"><mi id="A6.p6.4.m4.1.1.2" xref="A6.p6.4.m4.1.1.2.cmml">A</mi><mo id="A6.p6.4.m4.1.1.1" xref="A6.p6.4.m4.1.1.1.cmml">-</mo><mn id="A6.p6.4.m4.1.1.3" xref="A6.p6.4.m4.1.1.3.cmml">1</mn></mrow></semantics></math><span class="gd_word" id="A6.p6.5.5.w1"/><span> </span><span class="gd_word" id="A6.p6.5.5.w2">in</span><span> </span><span class="gd_word" id="A6.p6.5.5.w3">the</span><span> </span><span class="gd_word" id="A6.p6.5.5.w4">topk_mapping</span><span> </span><span class="gd_word" id="A6.p6.5.5.w5">tensor,</span><span> </span><span class="gd_word" id="A6.p6.5.5.w6">of</span><span> </span><span class="gd_word" id="A6.p6.5.5.w7">shape</span><span> </span><math id="A6.p6.5.m5.3" class="ltx_Math" alttext="(B,S,A)" display="inline"><semantics id="A6.p6.5.m5.3a"><mrow id="A6.p6.5.m5.3.4.2" xref="A6.p6.5.m5.3.4.1.cmml"><mo stretchy="false" id="A6.p6.5.m5.3.4.2.1" xref="A6.p6.5.m5.3.4.1.cmml">(</mo><mi id="A6.p6.5.m5.1.1" xref="A6.p6.5.m5.1.1.cmml">B</mi><mo id="A6.p6.5.m5.3.4.2.2" xref="A6.p6.5.m5.3.4.1.cmml">,</mo><mi id="A6.p6.5.m5.2.2" xref="A6.p6.5.m5.2.2.cmml">S</mi><mo id="A6.p6.5.m5.3.4.2.3" xref="A6.p6.5.m5.3.4.1.cmml">,</mo><mi id="A6.p6.5.m5.3.3" xref="A6.p6.5.m5.3.3.cmml">A</mi><mo stretchy="false" id="A6.p6.5.m5.3.4.2.4" xref="A6.p6.5.m5.3.4.1.cmml">)</mo></mrow></semantics></math><span class="gd_word" id="A6.p6.5.6.w1"/><span> </span><span class="gd_word" id="A6.p6.5.6.w2">itself</span><span> </span><span class="gd_word" id="A6.p6.5.6.w3">too.</span></p>
</div>
<div id="A6.p7" class="ltx_para">
<p id="A6.p7.1" class="ltx_p"><span class="gd_word" id="A6.p7.1.1.w1">Finally,</span><span> </span><span class="gd_word" id="A6.p7.1.1.w2">the</span><span> </span><span class="gd_word" id="A6.p7.1.1.w3">object</span><span> </span><span class="gd_word" id="A6.p7.1.1.w4">also</span><span> </span><span class="gd_word" id="A6.p7.1.1.w5">stores</span><span> </span><span class="gd_word" id="A6.p7.1.1.w6">for</span><span> </span><span class="gd_word" id="A6.p7.1.1.w7">each</span><span> </span><span class="gd_word" id="A6.p7.1.1.w8">node</span><span> </span><span class="gd_word" id="A6.p7.1.1.w9">its</span><span> </span><span class="gd_word" id="A6.p7.1.1.w10">associated</span><span> </span><span class="gd_word" id="A6.p7.1.1.w11">transformer</span><span> </span><span class="gd_word" id="A6.p7.1.1.w12">state,</span><span> </span><span class="gd_word" id="A6.p7.1.1.w13">so</span><span> </span><span class="gd_word" id="A6.p7.1.1.w14">that</span><span> </span><span class="gd_word" id="A6.p7.1.1.w15">we</span><span> </span><span class="gd_word" id="A6.p7.1.1.w16">can</span><span> </span><span class="gd_word" id="A6.p7.1.1.w17">use</span><span> </span><span class="gd_word" id="A6.p7.1.1.w18">incremental</span><span> </span><span class="gd_word" id="A6.p7.1.1.w19">inference</span><span> </span><span class="gd_word" id="A6.p7.1.1.w20">during</span><span> </span><span class="gd_word" id="A6.p7.1.1.w21">the</span><span> </span><span class="gd_word" id="A6.p7.1.1.w22">search.
These</span><span> </span><span class="gd_word" id="A6.p7.1.1.w23">states</span><span> </span><span class="gd_word" id="A6.p7.1.1.w24">can</span><span> </span><span class="gd_word" id="A6.p7.1.1.w25">be</span><span> </span><span class="gd_word" id="A6.p7.1.1.w26">kept</span><span> </span><span class="gd_word" id="A6.p7.1.1.w27">on</span><span> </span><span class="gd_word" id="A6.p7.1.1.w28">the</span><span> </span><span class="gd_word" id="A6.p7.1.1.w29">accelerator</span><span> </span><span class="gd_word" id="A6.p7.1.1.w30">device</span><span> </span><span class="gd_word" id="A6.p7.1.1.w31">itself.</span></p>
</div>
<div id="A6.p8" class="ltx_para">
<div id="A6.p8.1" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,Y2xhc3MgTnVtcHlNQ1RTKCk6CgogIGRlZiBfX2luaXRfXyhzZWxmLCByb290X2Z1biwgcmVjX2Z1biwgYmF0Y2hfc2l6ZSwgbnVtX3NpbXVsYXRpb25zLCBudW1fYWN0aW9ucywgbnVtX3NwYXJzZV9hY3Rpb25zLCBwYl9jX2luaXQpOgogICAgc2VsZi5fYmF0Y2hfc2l6ZSA9IGJhdGNoX3NpemUKICAgIHNlbGYuX251bV9zaW11bGF0aW9ucyA9IG51bV9zaW11bGF0aW9ucwogICAgc2VsZi5fbnVtX2FjdGlvbnMgPSBudW1fYWN0aW9ucwogICAgc2VsZi5fbnVtX3NwYXJzZV9hY3Rpb25zID0gbWluKG51bV9zcGFyc2VfYWN0aW9ucywgbnVtX2FjdGlvbnMpCiAgICBzZWxmLl9wYl9jX2luaXQgPSBwYl9jX2luaXQKCiAgICBzZWxmLl9yb290X2Z1biA9IHJvb3RfZnVuICAjIGEgZnVuY3Rpb24gY2FsbGVkIGF0IHRoZSByb290CiAgICBzZWxmLl9yZWNfZnVuID0gcmVjX2Z1biAgIyBhIGZ1bmN0aW9uIGNhbGxlZCBpbiB0aGUgdHJlZQogICAgc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlcyA9IG5wLnplcm9zKGJhdGNoX3NpemUsIGR0eXBlPW5wLmZsb2F0MzIpCiAgICBzZWxmLl9hZGFwdGl2ZV9tYXhfdmFsdWVzID0gbnAuemVyb3MoYmF0Y2hfc2l6ZSwgZHR5cGU9bnAuZmxvYXQzMikKCiAgICAjIEFsbG9jYXRlIGFsbCBuZWNlc3Nhcnkgc3RvcmFnZS4KICAgICMgRm9yIGEgZ2l2ZW4gc2VhcmNoIGFzc29jaWF0ZWQgdG8gYSBiYXRjaC1pbmRleCwgbm9kZSBpIGlzIHRoZSBpLXRoIG5vZGUKICAgICMgdG8gYmUgZXhwYW5kZWQuIE5vZGUgMCBjb3JyZXNwb25kcyB0byB0aGUgcm9vdCBub2RlLgogICAgbnVtX25vZGVzID0gbnVtX3NpbXVsYXRpb25zICsgMQogICAgYmF0Y2hfbm9kZSA9IChiYXRjaF9zaXplLCBudW1fbm9kZXMpCiAgICBzZWxmLl9udW1fbm9kZXMgPSBudW1fbm9kZXMKICAgIHNlbGYuX3Zpc2l0X2NvdW50cyA9IG5wLnplcm9zKGJhdGNoX25vZGUsIGR0eXBlPW5wLmludDMyKQogICAgc2VsZi5fdmFsdWVzID0gbnAuemVyb3MoYmF0Y2hfbm9kZSwgZHR5cGU9bnAuZmxvYXQzMikKICAgIHNlbGYuX3Jhd192YWx1ZXMgPSBucC56ZXJvcyhiYXRjaF9ub2RlLCBkdHlwZT1ucC5mbG9hdDMyKQogICAgc2VsZi5fcGFyZW50cyA9IG5wLnplcm9zKGJhdGNoX25vZGUsIGR0eXBlPW5wLmludDMyKQogICAgIyBhY3Rpb25fZnJvbV9wYXJlbnRzW2IsIGldIGlzIHRoZSBhY3Rpb24gdGFrZW4gdG8gcmVhY2ggbm9kZSBpLgogICAgIyBOb3RlIHRoYXQgYWN0aW9uX2Zyb21fcGFyZW50c1tiLCAwXSB3aWxsIHJlbWFpbiAtMSwgYXMgd2UgZG8gbm90IGtub3csCiAgICAjIHdoZW4gZG9pbmcgc2VhcmNoIGZyb20gdGhlIHJvb3QsIHdoYXQgYWN0aW9uIGxlZCB0byB0aGUgcm9vdC4KICAgIHNlbGYuX2FjdGlvbl9mcm9tX3BhcmVudHMgPSBucC56ZXJvcyhiYXRjaF9ub2RlLCBkdHlwZT1ucC5pbnQzMikKICAgICMgVGhlIDAtaW5kZXhlZCBkZXB0aCBvZiB0aGUgbm9kZS4gVGhlIHJvb3QgaXMgdGhlIG9ubHkgMC1kZXB0aCBub2RlLgogICAgIyBUaGUgZGVwdGggb2Ygbm9kZSBpLCBpcyB0aGUgZGVwdGggb2YgaXRzIHBhcmVudCArIDEuCiAgICBzZWxmLl9kZXB0aCA9IG5wLnplcm9zKGJhdGNoX25vZGUsIGR0eXBlPW5wLmludDMyKQogICAgc2VsZi5faXNfdGVybWluYWwgPSBucC5mdWxsKGJhdGNoX25vZGUsIEZhbHNlLCBkdHlwZT1ucC5ib29sKQoKICAgICMgVG8gYXZvaWQgY29zdGx5IG51bXB5IG9wcywgd2Ugc3RvcmUgYSBzcGFyc2UgdmVyc2lvbiBvZiB0aGUgYWN0aW9ucy4KICAgICMgV2Ugc2VsZWN0IHRoZSB0b3AgayBhY3Rpb25zIGFjY29yZGluZyB0byB0aGUgcG9saWN5LCBhbmQga2VlcCBhIG1hcHBpbmcKICAgICMgb2YgaW5kaWNlcyBmcm9tIDAgdG8gay0xIHRvIHRoZSBhY3R1YWwgYWN0aW9uIGluZGljZXMgaW4gdGhlCiAgICAjIHNlbGYuX3RvcGtfbWFwcGluZyB0ZW5zb3IuCiAgICBiYXRjaF9ub2RlX2FjdGlvbiA9IChiYXRjaF9zaXplLCBudW1fbm9kZXMsIHNlbGYuX251bV9zcGFyc2VfYWN0aW9ucykKICAgIHNlbGYuX3RvcGtfbWFwcGluZyA9IG5wLnplcm9zKGJhdGNoX25vZGVfYWN0aW9uLCBkdHlwZT1ucC5pbnQzMikKICAgIHNlbGYuX2NoaWxkcmVuX2luZGV4ID0gbnAuemVyb3MoYmF0Y2hfbm9kZV9hY3Rpb24sIGR0eXBlPW5wLmludDMyKQogICAgc2VsZi5fY2hpbGRyZW5fcHJpb3IgPSBucC56ZXJvcyhiYXRjaF9ub2RlX2FjdGlvbiwgZHR5cGU9bnAuZmxvYXQzMikKICAgIHNlbGYuX2NoaWxkcmVuX3ZhbHVlcyA9IG5wLnplcm9zKGJhdGNoX25vZGVfYWN0aW9uLCBkdHlwZT1ucC5mbG9hdDMyKQogICAgc2VsZi5fY2hpbGRyZW5fdmlzaXRzID0gbnAuemVyb3MoYmF0Y2hfbm9kZV9hY3Rpb24sIGR0eXBlPW5wLmludDMyKQogICAgc2VsZi5fc3RhdGVzID0ge30KICAgIHNlbGYuX2JhdGNoX3JhbmdlID0gbnAuYXJhbmdlKGJhdGNoX3NpemUpCiAgICBzZWxmLl9yZXNldF90cmVlKCkKCiAgZGVmIF9yZXNldF90cmVlKHNlbGYpOgogICAgIiIiUmVzZXRzIHRoZSB0cmVlIGFycmF5cy4iIiIKICAgIHNlbGYuX3Zpc2l0X2NvdW50cy5maWxsKDApCiAgICBzZWxmLl92YWx1ZXMuZmlsbCgwKQogICAgc2VsZi5fcGFyZW50cy5maWxsKC0xKQogICAgc2VsZi5fYWN0aW9uX2Zyb21fcGFyZW50cy5maWxsKC0xKQogICAgc2VsZi5fZGVwdGguZmlsbCgwKQoKICAgIHNlbGYuX3RvcGtfbWFwcGluZy5maWxsKC0xKQogICAgc2VsZi5fY2hpbGRyZW5faW5kZXguZmlsbCgtMSkKICAgIHNlbGYuX2NoaWxkcmVuX3ByaW9yLmZpbGwoMC4wKQogICAgc2VsZi5fY2hpbGRyZW5fdmFsdWVzLmZpbGwoMC4wKQogICAgc2VsZi5fY2hpbGRyZW5fdmlzaXRzLmZpbGwoMCkKICAgIHNlbGYuX3N0YXRlcyA9IHt9ICAjIEluZGV4ZWQgYnkgdHVwbGVzIChiYXRjaCBpbmRleCwgbm9kZSBpbmRleCk=" download="">⬇</a></div>
<div id="lstnumberx1" class="ltx_listingline">
class NumpyMCTS():
</div>
<div id="lstnumberx2" class="ltx_listingline">
</div>
<div id="lstnumberx3" class="ltx_listingline">
  def __init__(self, root_fun, rec_fun, batch_size, num_simulations, num_actions, num_sparse_actions, pb_c_init):
</div>
<div id="lstnumberx4" class="ltx_listingline">
    self._batch_size = batch_size
</div>
<div id="lstnumberx5" class="ltx_listingline">
    self._num_simulations = num_simulations
</div>
<div id="lstnumberx6" class="ltx_listingline">
    self._num_actions = num_actions
</div>
<div id="lstnumberx7" class="ltx_listingline">
    self._num_sparse_actions = min(num_sparse_actions, num_actions)
</div>
<div id="lstnumberx8" class="ltx_listingline">
    self._pb_c_init = pb_c_init
</div>
<div id="lstnumberx9" class="ltx_listingline">
</div>
<div id="lstnumberx10" class="ltx_listingline">
    self._root_fun = root_fun  # a function called at the root
</div>
<div id="lstnumberx11" class="ltx_listingline">
    self._rec_fun = rec_fun  # a function called in the tree
</div>
<div id="lstnumberx12" class="ltx_listingline">
    self._adaptive_min_values = np.zeros(batch_size, dtype=np.float32)
</div>
<div id="lstnumberx13" class="ltx_listingline">
    self._adaptive_max_values = np.zeros(batch_size, dtype=np.float32)
</div>
<div id="lstnumberx14" class="ltx_listingline">
</div>
<div id="lstnumberx15" class="ltx_listingline">
    # Allocate all necessary storage.
</div>
<div id="lstnumberx16" class="ltx_listingline">
    # For a given search associated to a batch-index, node i is the i-th node
</div>
<div id="lstnumberx17" class="ltx_listingline">
    # to be expanded. Node 0 corresponds to the root node.
</div>
<div id="lstnumberx18" class="ltx_listingline">
    num_nodes = num_simulations + 1
</div>
<div id="lstnumberx19" class="ltx_listingline">
    batch_node = (batch_size, num_nodes)
</div>
<div id="lstnumberx20" class="ltx_listingline">
    self._num_nodes = num_nodes
</div>
<div id="lstnumberx21" class="ltx_listingline">
    self._visit_counts = np.zeros(batch_node, dtype=np.int32)
</div>
<div id="lstnumberx22" class="ltx_listingline">
    self._values = np.zeros(batch_node, dtype=np.float32)
</div>
<div id="lstnumberx23" class="ltx_listingline">
    self._raw_values = np.zeros(batch_node, dtype=np.float32)
</div>
<div id="lstnumberx24" class="ltx_listingline">
    self._parents = np.zeros(batch_node, dtype=np.int32)
</div>
<div id="lstnumberx25" class="ltx_listingline">
    # action_from_parents[b, i] is the action taken to reach node i.
</div>
<div id="lstnumberx26" class="ltx_listingline">
    # Note that action_from_parents[b, 0] will remain -1, as we do not know,
</div>
<div id="lstnumberx27" class="ltx_listingline">
    # when doing search from the root, what action led to the root.
</div>
<div id="lstnumberx28" class="ltx_listingline">
    self._action_from_parents = np.zeros(batch_node, dtype=np.int32)
</div>
<div id="lstnumberx29" class="ltx_listingline">
    # The 0-indexed depth of the node. The root is the only 0-depth node.
</div>
<div id="lstnumberx30" class="ltx_listingline">
    # The depth of node i, is the depth of its parent + 1.
</div>
<div id="lstnumberx31" class="ltx_listingline">
    self._depth = np.zeros(batch_node, dtype=np.int32)
</div>
<div id="lstnumberx32" class="ltx_listingline">
    self._is_terminal = np.full(batch_node, False, dtype=np.bool)
</div>
<div id="lstnumberx33" class="ltx_listingline">
</div>
<div id="lstnumberx34" class="ltx_listingline">
    # To avoid costly numpy ops, we store a sparse version of the actions.
</div>
<div id="lstnumberx35" class="ltx_listingline">
    # We select the top k actions according to the policy, and keep a mapping
</div>
<div id="lstnumberx36" class="ltx_listingline">
    # of indices from 0 to k-1 to the actual action indices in the
</div>
<div id="lstnumberx37" class="ltx_listingline">
    # self._topk_mapping tensor.
</div>
<div id="lstnumberx38" class="ltx_listingline">
    batch_node_action = (batch_size, num_nodes, self._num_sparse_actions)
</div>
<div id="lstnumberx39" class="ltx_listingline">
    self._topk_mapping = np.zeros(batch_node_action, dtype=np.int32)
</div>
<div id="lstnumberx40" class="ltx_listingline">
    self._children_index = np.zeros(batch_node_action, dtype=np.int32)
</div>
<div id="lstnumberx41" class="ltx_listingline">
    self._children_prior = np.zeros(batch_node_action, dtype=np.float32)
</div>
<div id="lstnumberx42" class="ltx_listingline">
    self._children_values = np.zeros(batch_node_action, dtype=np.float32)
</div>
<div id="lstnumberx43" class="ltx_listingline">
    self._children_visits = np.zeros(batch_node_action, dtype=np.int32)
</div>
<div id="lstnumberx44" class="ltx_listingline">
    self._states = {}
</div>
<div id="lstnumberx45" class="ltx_listingline">
    self._batch_range = np.arange(batch_size)
</div>
<div id="lstnumberx46" class="ltx_listingline">
    self._reset_tree()
</div>
<div id="lstnumberx47" class="ltx_listingline">
</div>
<div id="lstnumberx48" class="ltx_listingline">
  def _reset_tree(self):
</div>
<div id="lstnumberx49" class="ltx_listingline">
    """Resets the tree arrays."""
</div>
<div id="lstnumberx50" class="ltx_listingline">
    self._visit_counts.fill(0)
</div>
<div id="lstnumberx51" class="ltx_listingline">
    self._values.fill(0)
</div>
<div id="lstnumberx52" class="ltx_listingline">
    self._parents.fill(-1)
</div>
<div id="lstnumberx53" class="ltx_listingline">
    self._action_from_parents.fill(-1)
</div>
<div id="lstnumberx54" class="ltx_listingline">
    self._depth.fill(0)
</div>
<div id="lstnumberx55" class="ltx_listingline">
</div>
<div id="lstnumberx56" class="ltx_listingline">
    self._topk_mapping.fill(-1)
</div>
<div id="lstnumberx57" class="ltx_listingline">
    self._children_index.fill(-1)
</div>
<div id="lstnumberx58" class="ltx_listingline">
    self._children_prior.fill(0.0)
</div>
<div id="lstnumberx59" class="ltx_listingline">
    self._children_values.fill(0.0)
</div>
<div id="lstnumberx60" class="ltx_listingline">
    self._children_visits.fill(0)
</div>
<div id="lstnumberx61" class="ltx_listingline">
    self._states = {}  # Indexed by tuples (batch index, node index)
</div>
</div>
</div>
<div id="A6.p9" class="ltx_para">
<p id="A6.p9.1" class="ltx_p"><span class="gd_word" id="A6.p9.1.1.w1">We</span><span> </span><span class="gd_word" id="A6.p9.1.1.w2">now</span><span> </span><span class="gd_word" id="A6.p9.1.1.w3">define</span><span> </span><span class="gd_word" id="A6.p9.1.1.w4">a</span><span> </span><span class="gd_word" id="A6.p9.1.1.w5">method</span><span> </span><span class="gd_word" id="A6.p9.1.1.w6">to</span><span> </span><span class="gd_word" id="A6.p9.1.1.w7">perform</span><span> </span><span class="gd_word" id="A6.p9.1.1.w8">the</span><span> </span><span class="gd_word" id="A6.p9.1.1.w9">search</span><span> </span><span class="gd_word" id="A6.p9.1.1.w10">itself.
As</span><span> </span><span class="gd_word" id="A6.p9.1.1.w11">stated</span><span> </span><span class="gd_word" id="A6.p9.1.1.w12">in</span><span> </span><span class="gd_word" id="A6.p9.1.1.w13">the</span><span> </span><span class="gd_word" id="A6.p9.1.1.w14">main</span><span> </span><span class="gd_word" id="A6.p9.1.1.w15">text,</span><span> </span><span class="gd_word" id="A6.p9.1.1.w16">MCTS</span><span> </span><span class="gd_word" id="A6.p9.1.1.w17">consists</span><span> </span><span class="gd_word" id="A6.p9.1.1.w18">in</span><span> </span><span class="gd_word" id="A6.p9.1.1.w19">applying</span><span> </span><span class="gd_word" id="A6.p9.1.1.w20">the</span><span> </span><span class="gd_word" id="A6.p9.1.1.w21">same</span><span> </span><span class="gd_word" id="A6.p9.1.1.w22">three</span><span> </span><span class="gd_word" id="A6.p9.1.1.w23">steps</span><span> </span><span class="gd_word" id="A6.p9.1.1.w24">for</span><span> </span><span class="gd_word" id="A6.p9.1.1.w25">each</span><span> </span><span class="gd_word" id="A6.p9.1.1.w26">simulation,</span><span> </span><span class="gd_word" id="A6.p9.1.1.w27">so</span><span> </span><span class="gd_word" id="A6.p9.1.1.w28">we</span><span> </span><span class="gd_word" id="A6.p9.1.1.w29">iterate</span><span> </span><span class="gd_word" id="A6.p9.1.1.w30">over</span><span> </span><math id="A6.p9.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="A6.p9.1.m1.1a"><mi id="A6.p9.1.m1.1.1" xref="A6.p9.1.m1.1.1.cmml">S</mi></semantics></math><span class="gd_word" id="A6.p9.1.2.w1">.
First,</span><span> </span><span class="gd_word" id="A6.p9.1.2.w2">we</span><span> </span><span class="gd_word" id="A6.p9.1.2.w3">use</span><span> </span><span class="gd_word" id="A6.p9.1.2.w4">the</span><span> </span><span class="gd_word" id="A6.p9.1.2.w5">simulate()</span><span> </span><span class="gd_word" id="A6.p9.1.2.w6">method</span><span> </span><span class="gd_word" id="A6.p9.1.2.w7">to</span><span> </span><span class="gd_word" id="A6.p9.1.2.w8">select</span><span> </span><span class="gd_word" id="A6.p9.1.2.w9">which</span><span> </span><span class="gd_word" id="A6.p9.1.2.w10">new</span><span> </span><span class="gd_word" id="A6.p9.1.2.w11">nodes</span><span> </span><span class="gd_word" id="A6.p9.1.2.w12">to</span><span> </span><span class="gd_word" id="A6.p9.1.2.w13">explore.
Second,</span><span> </span><span class="gd_word" id="A6.p9.1.2.w14">we</span><span> </span><span class="gd_word" id="A6.p9.1.2.w15">expand</span><span> </span><span class="gd_word" id="A6.p9.1.2.w16">these</span><span> </span><span class="gd_word" id="A6.p9.1.2.w17">new</span><span> </span><span class="gd_word" id="A6.p9.1.2.w18">nodes</span><span> </span><span class="gd_word" id="A6.p9.1.2.w19">(calling</span><span> </span><span class="gd_word" id="A6.p9.1.2.w20">our</span><span> </span><span class="gd_word" id="A6.p9.1.2.w21">neural</span><span> </span><span class="gd_word" id="A6.p9.1.2.w22">network</span><span> </span><span class="gd_word" id="A6.p9.1.2.w23">to</span><span> </span><span class="gd_word" id="A6.p9.1.2.w24">compute</span><span> </span><span class="gd_word" id="A6.p9.1.2.w25">both</span><span> </span><span class="gd_word" id="A6.p9.1.2.w26">the</span><span> </span><span class="gd_word" id="A6.p9.1.2.w27">policy</span><span> </span><span class="gd_word" id="A6.p9.1.2.w28">and</span><span> </span><span class="gd_word" id="A6.p9.1.2.w29">the</span><span> </span><span class="gd_word" id="A6.p9.1.2.w30">value</span><span> </span><span class="gd_word" id="A6.p9.1.2.w31">at</span><span> </span><span class="gd_word" id="A6.p9.1.2.w32">these</span><span> </span><span class="gd_word" id="A6.p9.1.2.w33">nodes).
Finally,</span><span> </span><span class="gd_word" id="A6.p9.1.2.w34">we</span><span> </span><span class="gd_word" id="A6.p9.1.2.w35">back</span><span> </span><span class="gd_word" id="A6.p9.1.2.w36">the</span><span> </span><span class="gd_word" id="A6.p9.1.2.w37">newly</span><span> </span><span class="gd_word" id="A6.p9.1.2.w38">computed</span><span> </span><span class="gd_word" id="A6.p9.1.2.w39">values</span><span> </span><span class="gd_word" id="A6.p9.1.2.w40">up</span><span> </span><span class="gd_word" id="A6.p9.1.2.w41">the</span><span> </span><span class="gd_word" id="A6.p9.1.2.w42">tree.</span></p>
</div>
<div id="A6.p10" class="ltx_para">
<p id="A6.p10.1" class="ltx_p"><span class="gd_word" id="A6.p10.1.1.w1">The</span><span> </span><span class="gd_word" id="A6.p10.1.1.w2">dense_visit_counts</span><span> </span><span class="gd_word" id="A6.p10.1.1.w3">method</span><span> </span><span class="gd_word" id="A6.p10.1.1.w4">allows</span><span> </span><span class="gd_word" id="A6.p10.1.1.w5">us</span><span> </span><span class="gd_word" id="A6.p10.1.1.w6">to</span><span> </span><span class="gd_word" id="A6.p10.1.1.w7">map</span><span> </span><span class="gd_word" id="A6.p10.1.1.w8">back</span><span> </span><span class="gd_word" id="A6.p10.1.1.w9">our</span><span> </span><span class="gd_word" id="A6.p10.1.1.w10">sparse</span><span> </span><span class="gd_word" id="A6.p10.1.1.w11">action</span><span> </span><span class="gd_word" id="A6.p10.1.1.w12">representation</span><span> </span><span class="gd_word" id="A6.p10.1.1.w13">into</span><span> </span><span class="gd_word" id="A6.p10.1.1.w14">the</span><span> </span><span class="gd_word" id="A6.p10.1.1.w15">original</span><span> </span><span class="gd_word" id="A6.p10.1.1.w16">action</span><span> </span><span class="gd_word" id="A6.p10.1.1.w17">space.</span></p>
<div id="A6.p10.2" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICBkZWYgc2VhcmNoKHNlbGYsIHJhd19zdGF0ZXMpOgogICAgc2VsZi5fcmVzZXRfdHJlZSgpCgogICAgIyBFdmFsdWF0ZSB0aGUgcm9vdC4KICAgIHByaW9yLCB2YWx1ZXMsIHN0YXRlcyA9IHNlbGYuX3Jvb3RfZnVuKHJhd19zdGF0ZXMpCgogICAgc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlcyA9IHZhbHVlcwogICAgc2VsZi5fYWRhcHRpdmVfbWF4X3ZhbHVlcyA9IHZhbHVlcyArIDFlLTYKCiAgICByb290X2luZGV4ID0gMAogICAgc2VsZi5fY3JlYXRlX25vZGUocm9vdF9pbmRleCwgcHJpb3IsIHZhbHVlcywgc3RhdGVzLCBucC5mdWxsKHNlbGYuX2JhdGNoX3NpemUsIEZhbHNlLCBkdHlwZT1ucC5ib29sKSkKCiAgICAjIERvIHNpbXVsYXRpb25zLCBleHBhbnNpb25zLCBhbmQgYmFja3dhcmRzLgogICAgbGVhZl9pbmRpY2VzID0gbnAuemVyb3MoKHNlbGYuX2JhdGNoX3NpemUpLCBucC5pbnQzMikKICAgIGZvciBzaW0gaW4gcmFuZ2Uoc2VsZi5fbnVtX3NpbXVsYXRpb25zKToKICAgICAgbm9kZV9pbmRpY2VzLCBhY3Rpb25zID0gc2VsZi5zaW11bGF0ZSgpCiAgICAgIG5leHRfbm9kZV9pbmRleCA9IHNpbSArIDEgICMgcm9vdCBpcyAwLCB0aGVyZWZvcmUgd2Ugb2Zmc2V0IGJ5IDEuCiAgICAgIHNlbGYuZXhwYW5kKG5vZGVfaW5kaWNlcywgYWN0aW9ucywgbmV4dF9ub2RlX2luZGV4KQogICAgICBsZWFmX2luZGljZXMuZmlsbChuZXh0X25vZGVfaW5kZXgpCiAgICAgIHNlbGYuYmFja3dhcmQobGVhZl9pbmRpY2VzKQoKICAgIHJldHVybiBzZWxmLmRlbnNlX3Zpc2l0X2NvdW50cygpCgogIGRlZiBkZW5zZV92aXNpdF9jb3VudHMoc2VsZik6CiAgICByb290X2luZGV4ID0gMAogICAgcm9vdF92aXNpdF9jb3VudHMgPSBzZWxmLl9jaGlsZHJlbl92aXNpdHNbOiwgcm9vdF9pbmRleCwgOl0KICAgIGRlbnNlX3Zpc2l0X2NvdW50cyA9IG5wLnplcm9zKChzZWxmLl9iYXRjaF9zaXplLCBzZWxmLl9udW1fYWN0aW9ucykpCiAgICBkZW5zZV92aXNpdF9jb3VudHNbc2VsZi5fYmF0Y2hfcmFuZ2VbOiwgTm9uZV0sIHNlbGYuX3RvcGtfbWFwcGluZ1s6LCByb290X2luZGV4LCA6XV0gPSByb290X3Zpc2l0X2NvdW50cwogICAgcmV0dXJuIGRlbnNlX3Zpc2l0X2NvdW50cw==" download="">⬇</a></div>
<div id="lstnumberx62" class="ltx_listingline">
  def search(self, raw_states):
</div>
<div id="lstnumberx63" class="ltx_listingline">
    self._reset_tree()
</div>
<div id="lstnumberx64" class="ltx_listingline">
</div>
<div id="lstnumberx65" class="ltx_listingline">
    # Evaluate the root.
</div>
<div id="lstnumberx66" class="ltx_listingline">
    prior, values, states = self._root_fun(raw_states)
</div>
<div id="lstnumberx67" class="ltx_listingline">
</div>
<div id="lstnumberx68" class="ltx_listingline">
    self._adaptive_min_values = values
</div>
<div id="lstnumberx69" class="ltx_listingline">
    self._adaptive_max_values = values + 1e-6
</div>
<div id="lstnumberx70" class="ltx_listingline">
</div>
<div id="lstnumberx71" class="ltx_listingline">
    root_index = 0
</div>
<div id="lstnumberx72" class="ltx_listingline">
    self._create_node(root_index, prior, values, states, np.full(self._batch_size, False, dtype=np.bool))
</div>
<div id="lstnumberx73" class="ltx_listingline">
</div>
<div id="lstnumberx74" class="ltx_listingline">
    # Do simulations, expansions, and backwards.
</div>
<div id="lstnumberx75" class="ltx_listingline">
    leaf_indices = np.zeros((self._batch_size), np.int32)
</div>
<div id="lstnumberx76" class="ltx_listingline">
    for sim in range(self._num_simulations):
</div>
<div id="lstnumberx77" class="ltx_listingline">
      node_indices, actions = self.simulate()
</div>
<div id="lstnumberx78" class="ltx_listingline">
      next_node_index = sim + 1  # root is 0, therefore we offset by 1.
</div>
<div id="lstnumberx79" class="ltx_listingline">
      self.expand(node_indices, actions, next_node_index)
</div>
<div id="lstnumberx80" class="ltx_listingline">
      leaf_indices.fill(next_node_index)
</div>
<div id="lstnumberx81" class="ltx_listingline">
      self.backward(leaf_indices)
</div>
<div id="lstnumberx82" class="ltx_listingline">
</div>
<div id="lstnumberx83" class="ltx_listingline">
    return self.dense_visit_counts()
</div>
<div id="lstnumberx84" class="ltx_listingline">
</div>
<div id="lstnumberx85" class="ltx_listingline">
  def dense_visit_counts(self):
</div>
<div id="lstnumberx86" class="ltx_listingline">
    root_index = 0
</div>
<div id="lstnumberx87" class="ltx_listingline">
    root_visit_counts = self._children_visits[:, root_index, :]
</div>
<div id="lstnumberx88" class="ltx_listingline">
    dense_visit_counts = np.zeros((self._batch_size, self._num_actions))
</div>
<div id="lstnumberx89" class="ltx_listingline">
    dense_visit_counts[self._batch_range[:, None], self._topk_mapping[:, root_index, :]] = root_visit_counts
</div>
<div id="lstnumberx90" class="ltx_listingline">
    return dense_visit_counts
</div>
</div>
</div>
<div id="A6.p11" class="ltx_para">
<p id="A6.p11.1" class="ltx_p"><span class="gd_word" id="A6.p11.1.1.w1">The</span><span> </span><span class="gd_word" id="A6.p11.1.1.w2">simulate</span><span> </span><span class="gd_word" id="A6.p11.1.1.w3">method</span><span> </span><span class="gd_word" id="A6.p11.1.1.w4">consists</span><span> </span><span class="gd_word" id="A6.p11.1.1.w5">in</span><span> </span><span class="gd_word" id="A6.p11.1.1.w6">applying</span><span> </span><span class="gd_word" id="A6.p11.1.1.w7">the</span><span> </span><span class="gd_word" id="A6.p11.1.1.w8">UCT</span><span> </span><span class="gd_word" id="A6.p11.1.1.w9">formula</span><span> </span><span class="gd_word" id="A6.p11.1.1.w10">recursively</span><span> </span><span class="gd_word" id="A6.p11.1.1.w11">until</span><span> </span><span class="gd_word" id="A6.p11.1.1.w12">we</span><span> </span><span class="gd_word" id="A6.p11.1.1.w13">have</span><span> </span><span class="gd_word" id="A6.p11.1.1.w14">reached</span><span> </span><span class="gd_word" id="A6.p11.1.1.w15">a</span><span> </span><span class="gd_word" id="A6.p11.1.1.w16">new</span><span> </span><span class="gd_word" id="A6.p11.1.1.w17">node</span><span> </span><span class="gd_word" id="A6.p11.1.1.w18">to</span><span> </span><span class="gd_word" id="A6.p11.1.1.w19">open</span><span> </span><span class="gd_word" id="A6.p11.1.1.w20">for</span><span> </span><span class="gd_word" id="A6.p11.1.1.w21">each</span><span> </span><span class="gd_word" id="A6.p11.1.1.w22">element</span><span> </span><span class="gd_word" id="A6.p11.1.1.w23">of</span><span> </span><span class="gd_word" id="A6.p11.1.1.w24">the</span><span> </span><span class="gd_word" id="A6.p11.1.1.w25">batch.
The</span><span> </span><span class="gd_word" id="A6.p11.1.1.w26">UCT</span><span> </span><span class="gd_word" id="A6.p11.1.1.w27">formula</span><span> </span><span class="gd_word" id="A6.p11.1.1.w28">itself</span><span> </span><span class="gd_word" id="A6.p11.1.1.w29">can</span><span> </span><span class="gd_word" id="A6.p11.1.1.w30">be</span><span> </span><span class="gd_word" id="A6.p11.1.1.w31">computed</span><span> </span><span class="gd_word" id="A6.p11.1.1.w32">in</span><span> </span><span class="gd_word" id="A6.p11.1.1.w33">a</span><span> </span><span class="gd_word" id="A6.p11.1.1.w34">fully</span><span> </span><span class="gd_word" id="A6.p11.1.1.w35">batched</span><span> </span><span class="gd_word" id="A6.p11.1.1.w36">fashion,</span><span> </span><span class="gd_word" id="A6.p11.1.1.w37">as</span><span> </span><span class="gd_word" id="A6.p11.1.1.w38">demonstrate</span><span> </span><span class="gd_word" id="A6.p11.1.1.w39">by</span><span> </span><span class="gd_word" id="A6.p11.1.1.w40">method</span><span> </span><span class="gd_word" id="A6.p11.1.1.w41">uct_select_action.</span></p>
<div id="A6.p11.2" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICBkZWYgc2ltdWxhdGUoc2VsZik6CiAgICAiIiJHb2VzIGRvd24gdW50aWwgYWxsIGVsZW1lbnRzIGhhdmUgcmVhY2hlZCB1bmV4cGxvcmVkIGFjdGlvbnMuIiIiCiAgICBub2RlX2luZGljZXMgPSBucC56ZXJvcygoc2VsZi5fYmF0Y2hfc2l6ZSksIG5wLmludDMyKQogICAgZGVwdGggPSAwCiAgICB3aGlsZSBUcnVlOgogICAgICBkZXB0aCArPSAxCiAgICAgIGFjdGlvbnMgPSBzZWxmLnVjdF9zZWxlY3RfYWN0aW9uKG5vZGVfaW5kaWNlcykKICAgICAgbmV4dF9ub2RlX2luZGljZXMgPSBzZWxmLl9jaGlsZHJlbl9pbmRleFtzZWxmLl9iYXRjaF9yYW5nZSwgbm9kZV9pbmRpY2VzLCBhY3Rpb25zXQogICAgICBpc191bmV4cGxvcmVkID0gbmV4dF9ub2RlX2luZGljZXMgPT0gLTEKICAgICAgaWYgaXNfdW5leHBsb3JlZC5hbGwoKToKICAgICAgICByZXR1cm4gbm9kZV9pbmRpY2VzLCBhY3Rpb25zCiAgICAgIGVsc2U6CiAgICAgICAgbm9kZV9pbmRpY2VzID0gbnAud2hlcmUoaXNfdW5leHBsb3JlZCwgbm9kZV9pbmRpY2VzLCBuZXh0X25vZGVfaW5kaWNlcykKCiAgZGVmIHVjdF9zZWxlY3RfYWN0aW9uKHNlbGYsIG5vZGVfaW5kaWNlcyk6CiAgICAiIiJSZXR1cm5zIHRoZSBhY3Rpb24gc2VsZWN0ZWQgZm9yIGEgYmF0Y2ggb2Ygbm9kZSBpbmRpY2VzIG9mIHNoYXBlIChCKS4iIiIKICAgIG5vZGVfY2hpbGRyZW5fcHJpb3IgPSBzZWxmLl9jaGlsZHJlbl9wcmlvcltzZWxmLl9iYXRjaF9yYW5nZSwgbm9kZV9pbmRpY2VzLCA6XSAgIyAoQiwgQSkKICAgIG5vZGVfY2hpbGRyZW5fdmFsdWVzID0gc2VsZi5fY2hpbGRyZW5fdmFsdWVzW3NlbGYuX2JhdGNoX3JhbmdlLCBub2RlX2luZGljZXMsIDpdICAjIChCLCBBKQogICAgbm9kZV9jaGlsZHJlbl92aXNpdHMgPSBzZWxmLl9jaGlsZHJlbl92aXNpdHNbc2VsZi5fYmF0Y2hfcmFuZ2UsIG5vZGVfaW5kaWNlcywgOl0gICMgKEIsIEEpCiAgICBub2RlX3Zpc2l0cyA9IHNlbGYuX3Zpc2l0X2NvdW50c1tzZWxmLl9iYXRjaF9yYW5nZSwgbm9kZV9pbmRpY2VzXSAgIyAoQikKCiAgICBub2RlX3BvbGljeV9zY29yZSA9IG5wLnNxcnQobm9kZV92aXNpdHNbOiwgTm9uZV0pICogc2VsZi5fcGJfY19pbml0ICogbm9kZV9jaGlsZHJlbl9wcmlvciAvIChub2RlX2NoaWxkcmVuX3Zpc2l0cyArIDEpICAjIChCLCBBKQoKICAgICMgUmVtYXAgdmFsdWVzIGJldHdlZW4gMCBhbmQgMS4KICAgIG5vZGVfdmFsdWVfc2NvcmUgPSBub2RlX2NoaWxkcmVuX3ZhbHVlcwogICAgbm9kZV92YWx1ZV9zY29yZSA9IChub2RlX3ZhbHVlX3Njb3JlICE9IDApICogbm9kZV92YWx1ZV9zY29yZSArIChub2RlX3ZhbHVlX3Njb3JlID09IDApICogc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlc1s6LCBOb25lXQogICAgbm9kZV92YWx1ZV9zY29yZSA9IChub2RlX3ZhbHVlX3Njb3JlIC0gc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlc1s6LCBOb25lXSkgLyAoc2VsZi5fYWRhcHRpdmVfbWF4X3ZhbHVlc1s6LCBOb25lXSAtIHNlbGYuX2FkYXB0aXZlX21pbl92YWx1ZXNbOiwgTm9uZV0pCgogICAgbm9kZV91Y3Rfc2NvcmUgPSBub2RlX3ZhbHVlX3Njb3JlICsgbm9kZV9wb2xpY3lfc2NvcmUgICMgKEIsIEEpCiAgICBhY3Rpb25zID0gbnAuYXJnbWF4KG5vZGVfdWN0X3Njb3JlLCBheGlzPTEpCiAgICByZXR1cm4gYWN0aW9ucw==" download="">⬇</a></div>
<div id="lstnumberx91" class="ltx_listingline">
  def simulate(self):
</div>
<div id="lstnumberx92" class="ltx_listingline">
    """Goes down until all elements have reached unexplored actions."""
</div>
<div id="lstnumberx93" class="ltx_listingline">
    node_indices = np.zeros((self._batch_size), np.int32)
</div>
<div id="lstnumberx94" class="ltx_listingline">
    depth = 0
</div>
<div id="lstnumberx95" class="ltx_listingline">
    while True:
</div>
<div id="lstnumberx96" class="ltx_listingline">
      depth += 1
</div>
<div id="lstnumberx97" class="ltx_listingline">
      actions = self.uct_select_action(node_indices)
</div>
<div id="lstnumberx98" class="ltx_listingline">
      next_node_indices = self._children_index[self._batch_range, node_indices, actions]
</div>
<div id="lstnumberx99" class="ltx_listingline">
      is_unexplored = next_node_indices == -1
</div>
<div id="lstnumberx100" class="ltx_listingline">
      if is_unexplored.all():
</div>
<div id="lstnumberx101" class="ltx_listingline">
        return node_indices, actions
</div>
<div id="lstnumberx102" class="ltx_listingline">
      else:
</div>
<div id="lstnumberx103" class="ltx_listingline">
        node_indices = np.where(is_unexplored, node_indices, next_node_indices)
</div>
<div id="lstnumberx104" class="ltx_listingline">
</div>
<div id="lstnumberx105" class="ltx_listingline">
  def uct_select_action(self, node_indices):
</div>
<div id="lstnumberx106" class="ltx_listingline">
    """Returns the action selected for a batch of node indices of shape (B)."""
</div>
<div id="lstnumberx107" class="ltx_listingline">
    node_children_prior = self._children_prior[self._batch_range, node_indices, :]  # (B, A)
</div>
<div id="lstnumberx108" class="ltx_listingline">
    node_children_values = self._children_values[self._batch_range, node_indices, :]  # (B, A)
</div>
<div id="lstnumberx109" class="ltx_listingline">
    node_children_visits = self._children_visits[self._batch_range, node_indices, :]  # (B, A)
</div>
<div id="lstnumberx110" class="ltx_listingline">
    node_visits = self._visit_counts[self._batch_range, node_indices]  # (B)
</div>
<div id="lstnumberx111" class="ltx_listingline">
</div>
<div id="lstnumberx112" class="ltx_listingline">
    node_policy_score = np.sqrt(node_visits[:, None]) * self._pb_c_init * node_children_prior / (node_children_visits + 1)  # (B, A)
</div>
<div id="lstnumberx113" class="ltx_listingline">
</div>
<div id="lstnumberx114" class="ltx_listingline">
    # Remap values between 0 and 1.
</div>
<div id="lstnumberx115" class="ltx_listingline">
    node_value_score = node_children_values
</div>
<div id="lstnumberx116" class="ltx_listingline">
    node_value_score = (node_value_score != 0) * node_value_score + (node_value_score == 0) * self._adaptive_min_values[:, None]
</div>
<div id="lstnumberx117" class="ltx_listingline">
    node_value_score = (node_value_score - self._adaptive_min_values[:, None]) / (self._adaptive_max_values[:, None] - self._adaptive_min_values[:, None])
</div>
<div id="lstnumberx118" class="ltx_listingline">
</div>
<div id="lstnumberx119" class="ltx_listingline">
    node_uct_score = node_value_score + node_policy_score  # (B, A)
</div>
<div id="lstnumberx120" class="ltx_listingline">
    actions = np.argmax(node_uct_score, axis=1)
</div>
<div id="lstnumberx121" class="ltx_listingline">
    return actions
</div>
</div>
</div>
<div id="A6.p12" class="ltx_para">
<p id="A6.p12.1" class="ltx_p"><span class="gd_word" id="A6.p12.1.1.w1">Once</span><span> </span><span class="gd_word" id="A6.p12.1.1.w2">we</span><span> </span><span class="gd_word" id="A6.p12.1.1.w3">have</span><span> </span><span class="gd_word" id="A6.p12.1.1.w4">selected</span><span> </span><span class="gd_word" id="A6.p12.1.1.w5">nodes</span><span> </span><span class="gd_word" id="A6.p12.1.1.w6">to</span><span> </span><span class="gd_word" id="A6.p12.1.1.w7">expand,</span><span> </span><span class="gd_word" id="A6.p12.1.1.w8">we</span><span> </span><span class="gd_word" id="A6.p12.1.1.w9">can</span><span> </span><span class="gd_word" id="A6.p12.1.1.w10">proceed.
The</span><span> </span><span class="gd_word" id="A6.p12.1.1.w11">expand</span><span> </span><span class="gd_word" id="A6.p12.1.1.w12">method</span><span> </span><span class="gd_word" id="A6.p12.1.1.w13">is</span><span> </span><span class="gd_word" id="A6.p12.1.1.w14">where</span><span> </span><span class="gd_word" id="A6.p12.1.1.w15">we</span><span> </span><span class="gd_word" id="A6.p12.1.1.w16">call</span><span> </span><span class="gd_word" id="A6.p12.1.1.w17">our</span><span> </span><span class="gd_word" id="A6.p12.1.1.w18">neural</span><span> </span><span class="gd_word" id="A6.p12.1.1.w19">networks</span><span> </span><span class="gd_word" id="A6.p12.1.1.w20">to</span><span> </span><span class="gd_word" id="A6.p12.1.1.w21">compute</span><span> </span><span class="gd_word" id="A6.p12.1.1.w22">policies</span><span> </span><span class="gd_word" id="A6.p12.1.1.w23">and</span><span> </span><span class="gd_word" id="A6.p12.1.1.w24">values.
We</span><span> </span><span class="gd_word" id="A6.p12.1.1.w25">then</span><span> </span><span class="gd_word" id="A6.p12.1.1.w26">create</span><span> </span><span class="gd_word" id="A6.p12.1.1.w27">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w28">nodes</span><span> </span><span class="gd_word" id="A6.p12.1.1.w29">in</span><span> </span><span class="gd_word" id="A6.p12.1.1.w30">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w31">object</span><span> </span><span class="gd_word" id="A6.p12.1.1.w32">fields</span><span> </span><span class="gd_word" id="A6.p12.1.1.w33">through</span><span> </span><span class="gd_word" id="A6.p12.1.1.w34">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w35">create_node</span><span> </span><span class="gd_word" id="A6.p12.1.1.w36">method.
Finally,</span><span> </span><span class="gd_word" id="A6.p12.1.1.w37">we</span><span> </span><span class="gd_word" id="A6.p12.1.1.w38">update</span><span> </span><span class="gd_word" id="A6.p12.1.1.w39">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w40">tree</span><span> </span><span class="gd_word" id="A6.p12.1.1.w41">topology</span><span> </span><span class="gd_word" id="A6.p12.1.1.w42">to</span><span> </span><span class="gd_word" id="A6.p12.1.1.w43">connect</span><span> </span><span class="gd_word" id="A6.p12.1.1.w44">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w45">new</span><span> </span><span class="gd_word" id="A6.p12.1.1.w46">nodes</span><span> </span><span class="gd_word" id="A6.p12.1.1.w47">to</span><span> </span><span class="gd_word" id="A6.p12.1.1.w48">the</span><span> </span><span class="gd_word" id="A6.p12.1.1.w49">tree.</span></p>
<div id="A6.p12.2" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICBkZWYgZXhwYW5kKHNlbGYsIG5vZGVfaW5kaWNlcywgYWN0aW9ucywgbmV4dF9ub2RlX2luZGV4KToKICAgICIiIkNyZWF0ZXMgYW5kIGV2YWx1YXRlIGNoaWxkIG5vZGVzIGZyb20gZ2l2ZW4gbm9kZXMgYW5kIHVuZXhwbG9yZWQgYWN0aW9ucy4iIiIKCiAgICAjIFJldHJpZXZlIHN0YXRlcyBmb3Igbm9kZXMgdG8gYmUgZXZhbHVhdGVkLgogICAgc3RhdGVzID0gW3NlbGYuX3N0YXRlc1soYiwgbildIGZvciBiLCBuIGluIGVudW1lcmF0ZShub2RlX2luZGljZXMpXQogICAgcHJldmlvdXNfbm9kZV9pc190ZXJtaW5hbCA9IHNlbGYuX2lzX3Rlcm1pbmFsW3NlbGYuX2JhdGNoX3JhbmdlLCBub2RlX2luZGljZXNbc2VsZi5fYmF0Y2hfcmFuZ2VdXSAgIyAoQikKCiAgICAjIENvbnZlcnQgc3BhcnNlIGFjdGlvbnMgdG8gZGVuc2UgYWN0aW9ucyBmb3IgbmV0d29yayBjb21wdXRhdGlvbgogICAgZGVuc2VfYWN0aW9ucyA9IHNlbGYuX3RvcGtfbWFwcGluZ1tzZWxmLl9iYXRjaF9yYW5nZSwgbm9kZV9pbmRpY2VzLCBhY3Rpb25zXQoKICAgICMgRXZhbHVhdGUgbm9kZXMuCiAgICAocHJpb3IsIHZhbHVlcywgbmV4dF9zdGF0ZXMsIGV4cGFuZGVkX25vZGVfaXNfdGVybWluYWwpID0gc2VsZi5fcmVjX2Z1bihzdGF0ZXMsIGRlbnNlX2FjdGlvbnMpCgogICAgIyBDcmVhdGUgdGhlIG5ldyBub2Rlcy4KICAgIHNlbGYuY3JlYXRlX25vZGUobmV4dF9ub2RlX2luZGV4LCBwcmlvciwgdmFsdWVzLCBuZXh0X3N0YXRlcywgZXhwYW5kZWRfbm9kZV9pc190ZXJtaW5hbCkKCiAgICAjIFVwZGF0ZSB0aGUgbWluIGFuZCBtYXggdmFsdWVzIGFycmF5cwogICAgc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlcyA9IG5wLm1pbmltdW0oc2VsZi5fYWRhcHRpdmVfbWluX3ZhbHVlcywgdmFsdWVzKQogICAgc2VsZi5fYWRhcHRpdmVfbWF4X3ZhbHVlcyA9IG5wLm1heGltdW0oc2VsZi5fYWRhcHRpdmVfbWF4X3ZhbHVlcywgdmFsdWVzKQoKICAgICMgVXBkYXRlIHRyZWUgdG9wb2xvZ3kuCiAgICBzZWxmLl9jaGlsZHJlbl9pbmRleFtzZWxmLl9iYXRjaF9yYW5nZSwgbm9kZV9pbmRpY2VzLCBhY3Rpb25zXSA9IG5leHRfbm9kZV9pbmRleAogICAgc2VsZi5fcGFyZW50c1s6LCBuZXh0X25vZGVfaW5kZXhdID0gbm9kZV9pbmRpY2VzCiAgICBzZWxmLl9hY3Rpb25fZnJvbV9wYXJlbnRzWzosIG5leHRfbm9kZV9pbmRleF0gPSBhY3Rpb25zCiAgICBzZWxmLl9kZXB0aFs6LCBuZXh0X25vZGVfaW5kZXhdID0gc2VsZi5fZGVwdGhbc2VsZi5fYmF0Y2hfcmFuZ2UsIG5vZGVfaW5kaWNlc10gKyAxCgogIGRlZiBjcmVhdGVfbm9kZShzZWxmLCBub2RlX2luZGV4LCBwcmlvciwgdmFsdWVzLCBuZXh0X3N0YXRlcywgZXhwYW5kZWRfbm9kZV9pc190ZXJtaW5hbCk6CiAgICAjIFRydW5jYXRlIHRoZSBwcmlvciB0byBvbmx5IGtlZXAgdGhlIHRvcCBrIGxvZ2l0cwogICAgcHJpb3JfdG9wa19pbmRpY2VzID0gbnAuYXJncGFydGl0aW9uKHByaW9yLCAtc2VsZi5fbnVtX3NwYXJzZV9hY3Rpb25zLCBheGlzPS0xKVs6LCAtc2VsZi5fbnVtX3NwYXJzZV9hY3Rpb25zOl0KICAgIHByaW9yID0gcHJpb3Jbc2VsZi5fYmF0Y2hfcmFuZ2VbOiwgTm9uZV0sIHByaW9yX3RvcGtfaW5kaWNlc10gICMgKEIsIEEpCgogICAgIyBTdG9yZSB0aGUgaW5kaWNlcyBvZiB0aGUgdG9wIGsgbG9naXRzCiAgICBzZWxmLl90b3BrX21hcHBpbmdbc2VsZi5fYmF0Y2hfcmFuZ2UsIG5vZGVfaW5kZXgsIDpdID0gcHJpb3JfdG9wa19pbmRpY2VzCgogICAgIyBVcGRhdGUgcHJpb3IsIHZhbHVlcyBhbmQgdmlzaXQgY291bnRzLgogICAgc2VsZi5fY2hpbGRyZW5fcHJpb3JbOiwgbm9kZV9pbmRleCwgOl0gPSBwcmlvcgogICAgc2VsZi5fdmFsdWVzWzosIG5vZGVfaW5kZXhdID0gdmFsdWVzCiAgICBzZWxmLl9yYXdfdmFsdWVzWzosIG5vZGVfaW5kZXhdID0gdmFsdWVzCiAgICBzZWxmLl92aXNpdF9jb3VudHNbOiwgbm9kZV9pbmRleF0gPSAxCiAgICBzZWxmLl9pc190ZXJtaW5hbFs6LCBub2RlX2luZGV4XSA9IGV4cGFuZGVkX25vZGVfaXNfdGVybWluYWwKCiAgICAjIFVwZGF0ZSBzdGF0ZXMuCiAgICBmb3IgYiwgbmV4dF9zdGF0ZSBpbiBlbnVtZXJhdGUobmV4dF9zdGF0ZXMpOgogICAgICBzZWxmLl9zdGF0ZXNbKGIsIG5vZGVfaW5kZXgpXSA9IG5leHRfc3RhdGUK" download="">⬇</a></div>
<div id="lstnumberx122" class="ltx_listingline">
  def expand(self, node_indices, actions, next_node_index):
</div>
<div id="lstnumberx123" class="ltx_listingline">
    """Creates and evaluate child nodes from given nodes and unexplored actions."""
</div>
<div id="lstnumberx124" class="ltx_listingline">
</div>
<div id="lstnumberx125" class="ltx_listingline">
    # Retrieve states for nodes to be evaluated.
</div>
<div id="lstnumberx126" class="ltx_listingline">
    states = [self._states[(b, n)] for b, n in enumerate(node_indices)]
</div>
<div id="lstnumberx127" class="ltx_listingline">
    previous_node_is_terminal = self._is_terminal[self._batch_range, node_indices[self._batch_range]]  # (B)
</div>
<div id="lstnumberx128" class="ltx_listingline">
</div>
<div id="lstnumberx129" class="ltx_listingline">
    # Convert sparse actions to dense actions for network computation
</div>
<div id="lstnumberx130" class="ltx_listingline">
    dense_actions = self._topk_mapping[self._batch_range, node_indices, actions]
</div>
<div id="lstnumberx131" class="ltx_listingline">
</div>
<div id="lstnumberx132" class="ltx_listingline">
    # Evaluate nodes.
</div>
<div id="lstnumberx133" class="ltx_listingline">
    (prior, values, next_states, expanded_node_is_terminal) = self._rec_fun(states, dense_actions)
</div>
<div id="lstnumberx134" class="ltx_listingline">
</div>
<div id="lstnumberx135" class="ltx_listingline">
    # Create the new nodes.
</div>
<div id="lstnumberx136" class="ltx_listingline">
    self.create_node(next_node_index, prior, values, next_states, expanded_node_is_terminal)
</div>
<div id="lstnumberx137" class="ltx_listingline">
</div>
<div id="lstnumberx138" class="ltx_listingline">
    # Update the min and max values arrays
</div>
<div id="lstnumberx139" class="ltx_listingline">
    self._adaptive_min_values = np.minimum(self._adaptive_min_values, values)
</div>
<div id="lstnumberx140" class="ltx_listingline">
    self._adaptive_max_values = np.maximum(self._adaptive_max_values, values)
</div>
<div id="lstnumberx141" class="ltx_listingline">
</div>
<div id="lstnumberx142" class="ltx_listingline">
    # Update tree topology.
</div>
<div id="lstnumberx143" class="ltx_listingline">
    self._children_index[self._batch_range, node_indices, actions] = next_node_index
</div>
<div id="lstnumberx144" class="ltx_listingline">
    self._parents[:, next_node_index] = node_indices
</div>
<div id="lstnumberx145" class="ltx_listingline">
    self._action_from_parents[:, next_node_index] = actions
</div>
<div id="lstnumberx146" class="ltx_listingline">
    self._depth[:, next_node_index] = self._depth[self._batch_range, node_indices] + 1
</div>
<div id="lstnumberx147" class="ltx_listingline">
</div>
<div id="lstnumberx148" class="ltx_listingline">
  def create_node(self, node_index, prior, values, next_states, expanded_node_is_terminal):
</div>
<div id="lstnumberx149" class="ltx_listingline">
    # Truncate the prior to only keep the top k logits
</div>
<div id="lstnumberx150" class="ltx_listingline">
    prior_topk_indices = np.argpartition(prior, -self._num_sparse_actions, axis=-1)[:, -self._num_sparse_actions:]
</div>
<div id="lstnumberx151" class="ltx_listingline">
    prior = prior[self._batch_range[:, None], prior_topk_indices]  # (B, A)
</div>
<div id="lstnumberx152" class="ltx_listingline">
</div>
<div id="lstnumberx153" class="ltx_listingline">
    # Store the indices of the top k logits
</div>
<div id="lstnumberx154" class="ltx_listingline">
    self._topk_mapping[self._batch_range, node_index, :] = prior_topk_indices
</div>
<div id="lstnumberx155" class="ltx_listingline">
</div>
<div id="lstnumberx156" class="ltx_listingline">
    # Update prior, values and visit counts.
</div>
<div id="lstnumberx157" class="ltx_listingline">
    self._children_prior[:, node_index, :] = prior
</div>
<div id="lstnumberx158" class="ltx_listingline">
    self._values[:, node_index] = values
</div>
<div id="lstnumberx159" class="ltx_listingline">
    self._raw_values[:, node_index] = values
</div>
<div id="lstnumberx160" class="ltx_listingline">
    self._visit_counts[:, node_index] = 1
</div>
<div id="lstnumberx161" class="ltx_listingline">
    self._is_terminal[:, node_index] = expanded_node_is_terminal
</div>
<div id="lstnumberx162" class="ltx_listingline">
</div>
<div id="lstnumberx163" class="ltx_listingline">
    # Update states.
</div>
<div id="lstnumberx164" class="ltx_listingline">
    for b, next_state in enumerate(next_states):
</div>
<div id="lstnumberx165" class="ltx_listingline">
      self._states[(b, node_index)] = next_state
</div>
</div>
</div>
<div id="A6.p13" class="ltx_para">
<p id="A6.p13.1" class="ltx_p"><span class="gd_word" id="A6.p13.1.1.w1">Finally,</span><span> </span><span class="gd_word" id="A6.p13.1.1.w2">we</span><span> </span><span class="gd_word" id="A6.p13.1.1.w3">back</span><span> </span><span class="gd_word" id="A6.p13.1.1.w4">the</span><span> </span><span class="gd_word" id="A6.p13.1.1.w5">newly</span><span> </span><span class="gd_word" id="A6.p13.1.1.w6">computed</span><span> </span><span class="gd_word" id="A6.p13.1.1.w7">values</span><span> </span><span class="gd_word" id="A6.p13.1.1.w8">up</span><span> </span><span class="gd_word" id="A6.p13.1.1.w9">using</span><span> </span><span class="gd_word" id="A6.p13.1.1.w10">the</span><span> </span><span class="gd_word" id="A6.p13.1.1.w11">backward</span><span> </span><span class="gd_word" id="A6.p13.1.1.w12">method,</span><span> </span><span class="gd_word" id="A6.p13.1.1.w13">which</span><span> </span><span class="gd_word" id="A6.p13.1.1.w14">can</span><span> </span><span class="gd_word" id="A6.p13.1.1.w15">again</span><span> </span><span class="gd_word" id="A6.p13.1.1.w16">be</span><span> </span><span class="gd_word" id="A6.p13.1.1.w17">done</span><span> </span><span class="gd_word" id="A6.p13.1.1.w18">in</span><span> </span><span class="gd_word" id="A6.p13.1.1.w19">a</span><span> </span><span class="gd_word" id="A6.p13.1.1.w20">fully</span><span> </span><span class="gd_word" id="A6.p13.1.1.w21">batched</span><span> </span><span class="gd_word" id="A6.p13.1.1.w22">fashion.
</span></p>
<div id="A6.p13.2" class="ltx_listing ltx_lst_language_Python ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain;base64,ICBkZWYgYmFja3dhcmQoc2VsZiwgbGVhZl9pbmRpY2VzKToKICAgICIiIkdvZXMgdXAgYW5kIHVwZGF0ZXMgdGhlIHRyZWUgdW50aWwgYWxsIG5vZGVzIHJlYWNoZWQgdGhlIHJvb3QuIiIiCiAgICBub2RlX2luZGljZXMgPSBsZWFmX2luZGljZXMgICMgKEIpCiAgICBsZWFmX3ZhbHVlcyA9IHNlbGYuX3ZhbHVlc1tzZWxmLl9iYXRjaF9yYW5nZSwgbGVhZl9pbmRpY2VzXQogICAgd2hpbGUgVHJ1ZToKICAgICAgaXNfcm9vdCA9IG5vZGVfaW5kaWNlcyA9PSAwCiAgICAgIGlmIGlzX3Jvb3QuYWxsKCk6CiAgICAgICAgcmV0dXJuCiAgICAgIHBhcmVudHMgPSBucC53aGVyZShpc19yb290LCAwLCBzZWxmLl9wYXJlbnRzW3NlbGYuX2JhdGNoX3JhbmdlLCBub2RlX2luZGljZXNdKQogICAgICByb290X21hc2sgPSAxLjAgKiBpc19yb290CiAgICAgIG5vdF9yb290X21hc2tfaW50ID0gKDEgLSBpc19yb290KQogICAgICBub3Rfcm9vdF9tYXNrID0gMS4wIC0gcm9vdF9tYXNrCiAgICAgICMgVXBkYXRlIHRoZSBwYXJlbnQgbm9kZXMgaWZmIHRoZWlyIGNoaWxkIGlzIG5vdCB0aGUgcm9vdC4KICAgICAgIyBXZSB0aGVyZWZvcmUgbWFzayB0aGUgdXBkYXRlcyB1c2luZyBub3Rfcm9vdF9tYXNrIGFuZCByb290X21hc2suCiAgICAgIHNlbGYuX3ZhbHVlc1tzZWxmLl9iYXRjaF9yYW5nZSwgcGFyZW50c10gPSBub3Rfcm9vdF9tYXNrICogKHNlbGYuX3ZhbHVlc1tzZWxmLl9iYXRjaF9yYW5nZSwgcGFyZW50c10gKiBzZWxmLl92aXNpdF9jb3VudHNbc2VsZi5fYmF0Y2hfcmFuZ2UsIHBhcmVudHNdICsgbGVhZl92YWx1ZXMpIC8gKHNlbGYuX3Zpc2l0X2NvdW50c1tzZWxmLl9iYXRjaF9yYW5nZSwgcGFyZW50c10gKyAxLjApICsgcm9vdF9tYXNrICogc2VsZi5fdmFsdWVzW3NlbGYuX2JhdGNoX3JhbmdlLCBwYXJlbnRzXQogICAgICBzZWxmLl92aXNpdF9jb3VudHNbc2VsZi5fYmF0Y2hfcmFuZ2UsIHBhcmVudHNdICs9IG5vdF9yb290X21hc2tfaW50CiAgICAgIGFjdGlvbnMgPSBucC53aGVyZShpc19yb290LCAwLCBzZWxmLl9hY3Rpb25fZnJvbV9wYXJlbnRzW3NlbGYuX2JhdGNoX3JhbmdlLCBub2RlX2luZGljZXNdKQogICAgICBzZWxmLl9jaGlsZHJlbl92YWx1ZXNbc2VsZi5fYmF0Y2hfcmFuZ2UsIHBhcmVudHMsIGFjdGlvbnNdID0gbm90X3Jvb3RfbWFzayAqIHNlbGYuX3ZhbHVlc1tzZWxmLl9iYXRjaF9yYW5nZSxub2RlX2luZGljZXNdICsgcm9vdF9tYXNrICogc2VsZi5fY2hpbGRyZW5fdmFsdWVzW3NlbGYuX2JhdGNoX3JhbmdlLCBwYXJlbnRzLCBhY3Rpb25zXQogICAgICBzZWxmLl9jaGlsZHJlbl92aXNpdHNbc2VsZi5fYmF0Y2hfcmFuZ2UsIHBhcmVudHMsIGFjdGlvbnNdICs9IG5vdF9yb290X21hc2tfaW50CgogICAgICAjIEdvIHVwCiAgICAgIG5vZGVfaW5kaWNlcyA9IHBhcmVudHM=" download="">⬇</a></div>
<div id="lstnumberx166" class="ltx_listingline">
  def backward(self, leaf_indices):
</div>
<div id="lstnumberx167" class="ltx_listingline">
    """Goes up and updates the tree until all nodes reached the root."""
</div>
<div id="lstnumberx168" class="ltx_listingline">
    node_indices = leaf_indices  # (B)
</div>
<div id="lstnumberx169" class="ltx_listingline">
    leaf_values = self._values[self._batch_range, leaf_indices]
</div>
<div id="lstnumberx170" class="ltx_listingline">
    while True:
</div>
<div id="lstnumberx171" class="ltx_listingline">
      is_root = node_indices == 0
</div>
<div id="lstnumberx172" class="ltx_listingline">
      if is_root.all():
</div>
<div id="lstnumberx173" class="ltx_listingline">
        return
</div>
<div id="lstnumberx174" class="ltx_listingline">
      parents = np.where(is_root, 0, self._parents[self._batch_range, node_indices])
</div>
<div id="lstnumberx175" class="ltx_listingline">
      root_mask = 1.0 * is_root
</div>
<div id="lstnumberx176" class="ltx_listingline">
      not_root_mask_int = (1 - is_root)
</div>
<div id="lstnumberx177" class="ltx_listingline">
      not_root_mask = 1.0 - root_mask
</div>
<div id="lstnumberx178" class="ltx_listingline">
      # Update the parent nodes iff their child is not the root.
</div>
<div id="lstnumberx179" class="ltx_listingline">
      # We therefore mask the updates using not_root_mask and root_mask.
</div>
<div id="lstnumberx180" class="ltx_listingline">
      self._values[self._batch_range, parents] = not_root_mask * (self._values[self._batch_range, parents] * self._visit_counts[self._batch_range, parents] + leaf_values) / (self._visit_counts[self._batch_range, parents] + 1.0) + root_mask * self._values[self._batch_range, parents]
</div>
<div id="lstnumberx181" class="ltx_listingline">
      self._visit_counts[self._batch_range, parents] += not_root_mask_int
</div>
<div id="lstnumberx182" class="ltx_listingline">
      actions = np.where(is_root, 0, self._action_from_parents[self._batch_range, node_indices])
</div>
<div id="lstnumberx183" class="ltx_listingline">
      self._children_values[self._batch_range, parents, actions] = not_root_mask * self._values[self._batch_range,node_indices] + root_mask * self._children_values[self._batch_range, parents, actions]
</div>
<div id="lstnumberx184" class="ltx_listingline">
      self._children_visits[self._batch_range, parents, actions] += not_root_mask_int
</div>
<div id="lstnumberx185" class="ltx_listingline">
</div>
<div id="lstnumberx186" class="ltx_listingline">
      # Go up
</div>
<div id="lstnumberx187" class="ltx_listingline">
      node_indices = parents
</div>
</div>
</div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Dec  1 10:30:31 2021 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"/></a>
</div></footer>
</div>
</body>
</html>
